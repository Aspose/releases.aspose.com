<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.Words for Java 17.8 Release Notes</title><meta name=description content="Aspose.Words for Java 17.8 Release Notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/words/java/release-notes/2017/aspose-words-for-java-17-8-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/words/java/release-notes/2017/aspose-words-for-java-17-8-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.Words for Java 17.8 Release Notes "><meta property="og:description" content="Aspose.Words for Java 17.8 Release Notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/words/java/release-notes/2017/aspose-words-for-java-17-8-release-notes/"><meta itemprop=name content="Aspose.Words for Java 17.8 Release Notes"><meta itemprop=description content="Aspose.Words for Java 17.8 Release Notes – the latest updates and fixes."><meta itemprop=wordCount content="3722"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.Words for Java 17.8 Release Notes"><meta name=twitter:description content="Aspose.Words for Java 17.8 Release Notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css preload><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/words/>Aspose.Words Product Family</a><span class=divider></span></li><li><a href=/words/java/>Aspose.Words for Java</a><span class=divider></span></li><li><a href=/words/java/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/words/java/release-notes/2017/>2017</a><span class=divider></span></li><li><a href=/words/java/release-notes/2017/aspose-words-for-java-17-8-release-notes/>Aspose.Words for Java 17.8 Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><section role=main class="container main-container page-package-details"><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section package-details-main"><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.Words for Java 17.8 Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><div class="alert alert-primary" role=alert>This page contains release notes for <a href=https://releases.aspose.com/words/java/17-8/>Aspose.Words for Java 17.8</a></div><h2 id=major-features>Major Features</h2><p>There are 104 improvements and fixes in this regular monthly release. The most notable are:</p><ul><li>Rendering into PCL format (Printer Command Language) was implemented.</li><li>A significant optimization of PDF rendering engine has been carried out.</li><li>Performance and heap space optimizations.</li><li>Compression of document structure data and cross-reference table in PDF 1.5 output. Now the output PDF documents with the logical structure are much smaller.</li><li>Image tag in Fixed HTML documents can now contain an alternative text string.</li><li>API for &lsquo;Mark Comment Done&rsquo; option.</li><li>Sign the signature line in Word document.</li><li>Add feature to set/get &ldquo;Specify line and character grid&rdquo;.</li><li>Detect comment resolved and comment replies and reply to which comment.</li><li>Added feature to format Data Labels of chart.</li></ul><h2 id=full-list-of-issues-covering-all-changes-in-this-release>Full List of Issues Covering all Changes in this Release</h2><table><thead><tr><th style=text-align:left>Key</th><th style=text-align:left>Summary</th><th style=text-align:left>Category</th></tr></thead><tbody><tr><td style=text-align:left>WORDSJAVA-1552</td><td style=text-align:left>Image&rsquo;s color is changed after re-saving DOC.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-1560</td><td style=text-align:left>Visio object is not rendered correctly in output HTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-1592</td><td style=text-align:left>Chart&rsquo;s X-Axis is not rendered correctly in output PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-1593</td><td style=text-align:left>Chart&rsquo;s plot area is not rendered correctly in output PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-1601</td><td style=text-align:left>DOCX to PDF conversion file size issue</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-1613</td><td style=text-align:left>DOCX to JPEG conversion generates empty output</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-1622</td><td style=text-align:left>Image lost in HTML to DOC conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-1624</td><td style=text-align:left>Output DOC shows warning message in MS Word</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-1631</td><td style=text-align:left>Rendering diagram with negative width, offset and breakpoints.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-1618</td><td style=text-align:left>Spaces lost while rendering bold Gabriola font.</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSJAVA-1619</td><td style=text-align:left>Aspose.Words 17.6 Saved Document is broken after Digital signing</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSJAVA-1620</td><td style=text-align:left>Correctly read HTML nested lists with unsupported/broken CSS counter properties and content values.</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSJAVA-1632</td><td style=text-align:left>Character spacing control works poorly for Asian fonts.</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSJAVA-1612</td><td style=text-align:left>Word to PDF conversion issue in Mendix application</td><td style=text-align:left>Exception</td></tr><tr><td style=text-align:left>WORDSJAVA-1614</td><td style=text-align:left>OutOfMemoryError Java heap space</td><td style=text-align:left>Exception</td></tr><tr><td style=text-align:left>WORDSJAVA-1621</td><td style=text-align:left>DOCX to PDF conversion throws IO exception</td><td style=text-align:left>Exception</td></tr><tr><td style=text-align:left>WORDSJAVA-1617</td><td style=text-align:left>Save document in the PCL (Printer Control Language) format.</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>WORDSJAVA-1608</td><td style=text-align:left>NodeImporter is removing the shapes</td><td style=text-align:left>Regression</td></tr><tr><td style=text-align:left>WORDSJAVA-1626</td><td style=text-align:left>Picture is lost after conversion from Docx to Doc.</td><td style=text-align:left>Regression</td></tr><tr><td style=text-align:left>WORDSNET-10493</td><td style=text-align:left>/table grid/ Table&rsquo;s cell width is decreased after conversion from Docx to Pdf</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-11904</td><td style=text-align:left>/character spacing control/ Contents move to next page after conversion from Doc to fixed file format</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-11988</td><td style=text-align:left>/character spacing control/ Japanese content move to next line after conversion from Doc to Pdf</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-12248</td><td style=text-align:left>/character spacing control/ Extra page after DOC to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-12294</td><td style=text-align:left>/character spacing control/ Some characters are misplaced after DOC to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-12893</td><td style=text-align:left>/character spacing control/ Chinese text rendering issue in Pdf</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-13271</td><td style=text-align:left>/character spacing control/ Table&rsquo;s row renders on next page. The input document have one page</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-13273</td><td style=text-align:left>/character spacing control/ The compressed punctuation feature is not supported</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-13876</td><td style=text-align:left>/character spacing control/ Chinese text moves to next line and pushes text to next page in HtmlFixed</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-13905</td><td style=text-align:left>3-D Surface chart incorrect rendering in PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-14242</td><td style=text-align:left>Document.Compare ignores delete revision</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-14367</td><td style=text-align:left>/character spacing control/ Chinese text is rendered on next line after conversion from Doc to HtmlFixed</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-14419</td><td style=text-align:left>SVG does not import correctly in Word document</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-14460</td><td style=text-align:left>Docx to Pdf conversion issue with text position</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-14716</td><td style=text-align:left>Chart&rsquo;s band color is changed in output HtmlFixed</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-14913</td><td style=text-align:left>Docx to Html conversion issue with list label</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15028</td><td style=text-align:left>Doc to Pdf conversion issue with table rendering</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15057</td><td style=text-align:left>The chart&rsquo;s legend are completely changed in HtmlFixed</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15058</td><td style=text-align:left>Docx to HtmlFixed conversion issue with chart&rsquo;s legend and lines</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15059</td><td style=text-align:left>Docx to HtmlFixed conversion issue with surface chart&rsquo;s lines</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15060</td><td style=text-align:left>Docx to HtmlFixed conversion issue with 3D chart&rsquo;s shading</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15204</td><td style=text-align:left>Paragraph is moved to next page after re-saving DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15300</td><td style=text-align:left>/floater position/ Image distracted in DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15302</td><td style=text-align:left>Docx to Pdf conversion issue with chart rendering (data labels are missed)</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15338</td><td style=text-align:left>DocumentBuilder.InsertHtml does not insert image from web URI</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15350</td><td style=text-align:left>Image&rsquo;s color is changed after re-saving DOC</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15388</td><td style=text-align:left>When DOCX is saved as PDF, the output looks different</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15452</td><td style=text-align:left>References failed when converting to PDF document.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15530</td><td style=text-align:left>Document.UpdateFields changes the left indentation of TOC</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15531</td><td style=text-align:left>Endnote line is thicker in output PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15535</td><td style=text-align:left>Footer layout messed up when printing after saving</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15555</td><td style=text-align:left>BuiltInDocumentProperties.Words returns incorrect word count</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15557</td><td style=text-align:left>Exception when setting license under Mono</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15558</td><td style=text-align:left>Table conversion issue in DOC</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15569</td><td style=text-align:left>Problems with a Chart Object rendered as an Image</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15575</td><td style=text-align:left>DOCX does not open in MS Word after re-saving it</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15584</td><td style=text-align:left>Transparent images are missing in PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15585</td><td style=text-align:left>Comparing documents with AW gives different revision from Word compare.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15600</td><td style=text-align:left>DOCX to PDF, references missing</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15601</td><td style=text-align:left>Converting Word to PDF produces black squares</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15603</td><td style=text-align:left>Aspose.Words 17.06 Incorrect signing OpenDocument file formats (.odt) with Digital Signature</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15606</td><td style=text-align:left>Extra spaces issue at the end of the bookmark value in IF field</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15618</td><td style=text-align:left>FileFormatUtil.DetectFileFormat method returns wrong value</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15620</td><td style=text-align:left>When Document.UpdateFields() is used, PDF output is incorrect.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15662</td><td style=text-align:left>AW produces slightly different TOC than MS Word</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15672</td><td style=text-align:left>Pie chart the value numbers show as [VALUE] after printing.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15677</td><td style=text-align:left>Formula is clipped in PDF rendition.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15709</td><td style=text-align:left>TextBox.InternalMarginXXX returns incorrect values</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15714</td><td style=text-align:left>Empty pages are generated when DOCX is converted to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15724</td><td style=text-align:left>Charts appearance changes upon open and resave DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-4917</td><td style=text-align:left>Page number is incorrect in TOC for items after exlicit column break in a multicolumn section.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-5173</td><td style=text-align:left>Formatting restrictions are lost after open/save DOCX document.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-5990</td><td style=text-align:left>Docx to PDF conversion problem with table layout</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-6178</td><td style=text-align:left>/table grid/ Table width is incorrect while converting docx to Pdf/XPS/Tiff</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-6627</td><td style=text-align:left>MERGEFIELD located in page header is not updated properly during mail merge.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-6628</td><td style=text-align:left>Page header is present at multipage IF field content.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-6629</td><td style=text-align:left>IF field containing condition with MERGEFIELD involved seems not to be updated properly.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-13878</td><td style=text-align:left>Extra spaces render after conversion from Doc to HtmlFixed/Pdf</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-14164</td><td style=text-align:left>Ins/del tags missing on equations when converting docx to html</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-14574</td><td style=text-align:left>Vertical space added between header and body content on 2nd page in HtmlFixed</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-14575</td><td style=text-align:left>Header content is different on 3rd page of HtmlFixed</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-14947</td><td style=text-align:left>Question about values of margins in tables</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-15196</td><td style=text-align:left>Add alt text information into images tag in FixedHtml</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-15412</td><td style=text-align:left>Text is rendered on next page in output PDF</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-15497</td><td style=text-align:left>DOCX to tagged PDF conversion file size issue</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-15628</td><td style=text-align:left>Chart created in MS Word 2016 looks incorrect after open/save with AW.</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-7508</td><td style=text-align:left>Extra empty space appears in output fixed file format after conversion from Dotx</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-9200</td><td style=text-align:left>Spacing between words is increaed in fixed page formats</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-14687</td><td style=text-align:left>/ SvmReader/Overflow Exception occurs while reading the odt file</td><td style=text-align:left>Exception</td></tr><tr><td style=text-align:left>WORDSNET-15427</td><td style=text-align:left>NullReferenceException occurs upon DOCX export.</td><td style=text-align:left>Exception</td></tr><tr><td style=text-align:left>WORDSNET-15568</td><td style=text-align:left>UpdatePageLayout throws NullReference Exception</td><td style=text-align:left>Exception</td></tr><tr><td style=text-align:left>WORDSNET-15680</td><td style=text-align:left>Loading RTF throws FileCorruptedException</td><td style=text-align:left>Exception</td></tr><tr><td style=text-align:left>WORDSNET-10901</td><td style=text-align:left>Provide API for &lsquo;Mark Comment Done&rsquo; option</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>WORDSNET-10992</td><td style=text-align:left>Position of DrawingML is changed after conversion from Docx to Pdf</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>WORDSNET-11879</td><td style=text-align:left>/layoutRawTableWidth compat option/ Tight Wrap Text for Image is not preserved in PDF</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>WORDSNET-12844</td><td style=text-align:left>Ability to sign a signature line with adding a digital signature</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>WORDSNET-14378</td><td style=text-align:left>Add feature to set/get &ldquo;Specify line and character grid&rdquo;</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>WORDSNET-14471</td><td style=text-align:left>Detect comment resolved and comment replies and reply to which comment</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>WORDSNET-15521</td><td style=text-align:left>Adding the data labels format in a chart.</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>WORDSNET-15576</td><td style=text-align:left>Add feature to format Data Labels of chart</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>WORDSNET-15641</td><td style=text-align:left>Sign the signature line in Word document</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>WORDSNET-15512</td><td style=text-align:left>NodeImporter is removing the shapes</td><td style=text-align:left>Regression</td></tr><tr><td style=text-align:left>WORDSNET-15573</td><td style=text-align:left>Aspose.Words.FileCorruptedException occurs upone loading a RTF</td><td style=text-align:left>Regression</td></tr><tr><td style=text-align:left>WORDSNET-15648</td><td style=text-align:left>MathML throws NullReferenceException in rendering</td><td style=text-align:left>Regression</td></tr><tr><td style=text-align:left>WORDSNET-15702</td><td style=text-align:left>DOCX to PDF conversion throws NullReferenceException in 17.7</td><td style=text-align:left>Regression</td></tr></tbody></table><h2 id=public-api-and-backward-incompatble-changes>Public API and Backward Incompatble Changes</h2><p>This section lists public API changes that were introduced in Aspose.Words 17.8. It includes not only new and obsoleted public methods, but also a description of any changes in the behavior behind the scenes in Aspose.Words which may affect existing code. Any behavior introduced that could be seen as a regression and modifies existing behavior is especially important and is documented here.</p><h3 id=wordsnet-6118---rendering-word-document-to-pcl-format-supported>WORDSNET-6118 - Rendering Word Document to PCL format Supported</h3><p>New saving format is introduced - PCL (Printer Command Language). Aspose.Words can save documents to PCL 6 (PCL 6 Enhanced or PCL XL) format.</p><p>New value was added to enum SaveFormat:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>SaveFormat.PCL</span></span></code></pre></div><p>Example of how to save document to PCL:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// Load the document from disk.</span>
</span></span><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(dataDir + <span style=color:#e6db74>&#34;Document.doc&#34;</span>);
</span></span><span style=display:flex><span>PclSaveOptions saveOptions = <span style=color:#66d9ef>new</span> PclSaveOptions();
</span></span><span style=display:flex><span>saveOptions.setSaveFormat(SaveFormat.PCL);
</span></span><span style=display:flex><span>saveOptions.setRasterizeTransformedElements(<span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Export the document as an PCL file.</span>
</span></span><span style=display:flex><span>doc.save(dataDir + <span style=color:#e6db74>&#34;Document.PclConversion_out.pcl&#34;</span>, saveOptions);</span></span></code></pre></div><p>PclSaveOptions has following public options and methods:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Gets or sets a value determining whether or not complex transformed elements</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// should be rasterized before saving to PCL document.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Default is &lt;c&gt;true&lt;/c&gt;.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// PCL doesn&#39;t support some kind of transformations that are used by Aspose Words.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// E.g. rotated, skewed images and texture brushes. To properly render such elements</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// rasterization process is used, i.e. saving to image and clipping.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// This process can take additional time and memory.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// If flag is set to &lt;c&gt;false&lt;/c&gt;, some content in output may be different</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// as compared with the source document.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> boolean getRasterizeTransformedElements()
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> setRasterizeTransformedElements(boolean <span style=color:#66d9ef>value</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Adds information about font that is uploaded to the printer by manufacturer.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;fontFullName&#34;&gt;Full name of the font (e.g. &#34;Times New Roman Bold Italic&#34;).&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;fontPclName&#34;&gt;Name of the font that is used in Pcl document.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// There are 52 fonts that are to be built in any printer according to Pcl specification.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// However manufactures can add some other fonts to their devices.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> addPrinterFont(String fontFullName, String fontPclName);
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Name of the font that will be used</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// if no expected font is found in printer and built-in fonts collections.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// If no fallback is found, warning is generated and &#34;Arial&#34; font is used.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> String getFalllbackFontName()
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> setFallbackFontName(String <span style=color:#66d9ef>value</span>)</span></span></code></pre></div><p>There is one major feature of PCL that is unsupported in current version of Aspose.Words i.e. custom fonts. It is rather big and complex problem, but we will implement this feature in future.</p><h3 id=wordsnet-14378---new-properties-added-into-the-pagesetup-class-allowing-to-define-document-grid>WORDSNET-14378 - New Properties Added into the PageSetup Class Allowing to Define Document Grid</h3><p>The following new public properties have been added into the PageSetup class to allow defining document grid behavior:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Gets or sets the layout mode of this section. The value of the property is SectionLayoutMode integer constant.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> getLayoutMode()
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> setLayoutMode(<span style=color:#66d9ef>int</span> <span style=color:#66d9ef>value</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Gets or sets the number of characters per line in the document grid.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Minimum value of the property is 1. Maximum value depends on page width and font size of the Normal</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// style. Minimum character pitch is 90 percent of the font size. For example, maximum number of characters</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// per line of a Letter page with one-inch margins is 43.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// By default, the property has a value, on which character pitch equals to font size of the Normal style.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> getCharactersPerLine()
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> setCharactersPerLine(<span style=color:#66d9ef>int</span> <span style=color:#66d9ef>value</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Gets or sets the number of lines per page in the document grid.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Minimum value of the property is 1. Maximum value depends on page height and font size of the Normal</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// style. Minimum line pitch is 136 percent of the font size. For example, maximum number of lines per page of</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// a Letter page with one-inch margins is 39.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// By default, the property has a value, on which line pitch is in 1.5 times greater than font size of the Normal style.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> getLinesPerPage()
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> setLinesPerPage(<span style=color:#66d9ef>int</span> <span style=color:#66d9ef>value</span>)</span></span></code></pre></div><p>Also the following public enum has been implemented:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Specifies the layout mode for a section allowing to define the document grid behavior.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> SectionLayoutMode
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Specifies that no document grid shall be applied to the contents of the corresponding section in the document.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    Default = <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Specifies that the corresponding section shall have both the additional line pitch and character pitch added to</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// each line and character within it in order to maintain a specific number of lines per page and characters per line.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Characters will not be automatically aligned with gridlines on typing.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    Grid = <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Specifies that the corresponding section shall have additional line pitch added to each line within it in order</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// to maintain the specified number of lines per page.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    LineGrid = <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Specifies that the corresponding section shall have both the additional line pitch and character pitch added to</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// each line and character within it in order to maintain a specific number of lines per page and characters per line.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Characters will be automatically aligned with gridlines on typing.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    SnapToChars = <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>The Document Grid tab becomes visible in the Page Setup dialog of MS Word if any Asian language is defined as editing language.</p><h3 id=wordsnet-14471-detect-comment-resolved-and-comment-replies-and-reply-to-which-comment>WORDSNET-14471. Detect Comment Resolved and Comment Replies and Reply to Which Comment</h3><p>Added read-only public API to get extended comment properties.</p><p>Following methods were added to the <strong>Comment</strong> class.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// Returns the parent Comment object. Returns null for top-level comments.</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> Comment getAncestor()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Returns a collection of &lt;see cref=&#34;Comment&#34;/&gt; objects that are immediate children of the specified comment.</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> CommentCollection getReplies()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Gets or sets flag indicating that the comment has been marked done.</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> boolean getDone()
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> setDone(boolean <span style=color:#66d9ef>value</span>)</span></span></code></pre></div><p>Added new public class <strong>CommentCollection</strong> which represents collection of Comment nodes.</p><p><strong>UC</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(filename);
</span></span><span style=display:flex><span>NodeCollection&lt;Comment&gt; comments = doc.getChildNodes(NodeType.COMMENT, <span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>Comment parentComment = (Comment) comments.<span style=color:#66d9ef>get</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>for</span> (Comment childComment : parentComment.getReplies()) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Get comment parent and status.</span>
</span></span><span style=display:flex><span>        System.<span style=color:#66d9ef>out</span>.println(childComment.getAncestor().getId());
</span></span><span style=display:flex><span>        System.<span style=color:#66d9ef>out</span>.println(childComment.getDone());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// And update comment Done mark.</span>
</span></span><span style=display:flex><span>        childComment.setDone(<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>    }</span></span></code></pre></div><h3 id=wordsnet-14947distanceleft-distanceright-distancetop-distancebottom-properties-addedin-table-class>WORDSNET-14947. DistanceLeft, DistanceRight, DistanceTop, DistanceBottom Properties Added in Table Class</h3><p>Added new public read-only properties to the <strong>Table</strong> class.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// Gets distance between table left and the surrounding text, in points.</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> getDistanceLeft()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Gets distance between table right and the surrounding text, in points.</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> getDistanceRight()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Gets distance between table top and the surrounding text, in points.</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> getDistanceTop()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Gets distance between table bottom and the surrounding text, in points.</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>double</span> getDistanceBottom()</span></span></code></pre></div><p><strong>Typical UC</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Table table = (Table) doc.getChild(NodeType.TABLE, <span style=color:#ae81ff>0</span>, <span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>System.<span style=color:#66d9ef>out</span>.println(table.getDistanceTop());
</span></span><span style=display:flex><span>System.<span style=color:#66d9ef>out</span>.println(table.getDistanceBottom());
</span></span><span style=display:flex><span>System.<span style=color:#66d9ef>out</span>.println(table.getDistanceRight());
</span></span><span style=display:flex><span>System.<span style=color:#66d9ef>out</span>.println(table.getDistanceLeft());</span></span></code></pre></div><h3 id=wordsnet-15497---compression-of-document-structure-data-and-cross-reference-table-in-pdf-15-output>WORDSNET-15497 - Compression of Document Structure Data and Cross-Reference Table in PDF 1.5 Output</h3><p>Now document structure data and cross-reference table are compressed when saving to PDF 1.5. This changes do not affect PDF/A-1 output due to limitations in specification.</p><h3 id=wordsnet-15521---new-property-numberformat-added-to-the-chartdatalabel-object>WORDSNET-15521 - New Property NumberFormat Added to the ChartDataLabel Object</h3><p>New public property NumberFormat is available in the ChartDataLabel class:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Returns number format of the parent element.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> ChartNumberFormat getNumberFormat()</span></span></code></pre></div><p>ChartNumberFormat class represents number formatting of the parent element and contains the following public properties:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Gets or sets the format code applied to a data label.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Number formatting is used to change the way a value appears in data label and can be used in some very creative ways.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// The examples of number formats:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;para&gt;Number - &#34;#,##0.00&#34;&lt;/para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;para&gt;Currency - &#34;\&#34;$\&#34;#,##0.00&#34;&lt;/para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;para&gt;Time - &#34;\[$-x-systime\]h:mm:ss AM/PM&#34;&lt;/para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;para&gt;Date - &#34;d/mm/yyyy&#34;&lt;/para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;para&gt;Percentage - &#34;0.00%&#34;&lt;/para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;para&gt;Fraction - &#34;# ?/?&#34;&lt;/para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;para&gt;Scientific - &#34;0.00E+00&#34;&lt;/para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;para&gt;Text - &#34;@&#34;&lt;/para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;para&gt;Accounting - &#34;_-\&#34;$\&#34;\* #,##0.00_-;-\&#34;$\&#34;\* #,##0.00_-;_-\&#34;$\&#34;\* \&#34;-\&#34;??_-;_-@_-&#34;&lt;/para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;para&gt;Custom with color - &#34;\[Red\]-#,##0.0&#34;&lt;/para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> java.lang.String getFormatCode()
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> setFormatCode(java.lang.String <span style=color:#66d9ef>value</span>)</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Specifies whether the format code is linked to a source cell.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Default is true.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;The NumberFormat will be reset to general if format code is linked to source.&lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> boolean isLinkedToSource()
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> boolean isLinkedToSource(boolean <span style=color:#66d9ef>value</span>)</span></span></code></pre></div><p><strong>UC:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document();
</span></span><span style=display:flex><span>DocumentBuilder builder = <span style=color:#66d9ef>new</span> DocumentBuilder(doc);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Add chart with default data.</span>
</span></span><span style=display:flex><span>Shape shape = builder.insertChart(ChartType.LINE, <span style=color:#ae81ff>432</span>, <span style=color:#ae81ff>252</span>);
</span></span><span style=display:flex><span>Chart chart = shape.getChart();
</span></span><span style=display:flex><span>chart.getTitle().setText(<span style=color:#e6db74>&#34;Data Labels With Different Number Format&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Delete default generated series.</span>
</span></span><span style=display:flex><span>chart.getSeries().clear();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Add new series</span>
</span></span><span style=display:flex><span>ChartSeries series0 = chart.getSeries().<span style=color:#66d9ef>add</span>(<span style=color:#e6db74>&#34;AW Series 0&#34;</span>, <span style=color:#66d9ef>new</span> String[] { <span style=color:#e6db74>&#34;AW0&#34;</span>, <span style=color:#e6db74>&#34;AW1&#34;</span>, <span style=color:#e6db74>&#34;AW2&#34;</span> }, <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[] { <span style=color:#ae81ff>2.5</span>, <span style=color:#ae81ff>1.5</span>, <span style=color:#ae81ff>3.5</span> });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Add DataLabel to the first point of the first series.</span>
</span></span><span style=display:flex><span>ChartDataLabel chartDataLabel0 = series0.getDataLabels().<span style=color:#66d9ef>add</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>chartDataLabel0.setShowValue(<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Set currency format code.</span>
</span></span><span style=display:flex><span>chartDataLabel0.getNumberFormat().setFormatCode(<span style=color:#e6db74>&#34;\&#34;$\&#34;#,##0.00&#34;</span>);
</span></span><span style=display:flex><span>ChartDataLabel chartDataLabel1 = series0.getDataLabels().<span style=color:#66d9ef>add</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>chartDataLabel1.setShowValue(<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Set date format code.</span>
</span></span><span style=display:flex><span>chartDataLabel1.getNumberFormat().setFormatCode(<span style=color:#e6db74>&#34;d/mm/yyyy&#34;</span>);
</span></span><span style=display:flex><span>ChartDataLabel chartDataLabel2 = series0.getDataLabels().<span style=color:#66d9ef>add</span>(<span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>chartDataLabel2.setShowValue(<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Set percentage format code.</span>
</span></span><span style=display:flex><span>chartDataLabel2.getNumberFormat().setFormatCode(<span style=color:#e6db74>&#34;0.00%&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Or you can set format code to be linked to a source cell,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// in this case NumberFormat will be reset to general and inherited from a source cell.</span>
</span></span><span style=display:flex><span>chartDataLabel2.getNumberFormat().isLinkedToSource(<span style=color:#66d9ef>true</span>);</span></span></code></pre></div><h3 id=wordsnet-15641---implemented-signing-signature-line-in-word-documents>WORDSNET-15641 - Implemented Signing Signature Line in Word Documents</h3><ol><li>Added new public property for SignatureLine class:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Gets or sets identifier for this signature line.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;p&gt;This identifier can be associated with a digital signature, when signing document using &lt;see cref=&#34;DigitalSignatureUtil&#34;/&gt;.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// This value must be unique and by default it is randomly generated with &lt;see cref=&#34;Guid.NewGuid&#34;/&gt;.&lt;/p&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> java.util.UUID getId()
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> setId(java.util.UUID <span style=color:#66d9ef>value</span>)</span></span></code></pre></div><ol start=2><li>Added new public class SignOptions:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Allows to specify options for document signing.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SignOptions</span></span></span></code></pre></div><p>It has the following public properties:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Specifies comments on the digital signature.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Default value is &lt;see cref=&#34;string.Empty&#34;/&gt;.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> java.lang.String getComments()
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> setComments(java.lang.String <span style=color:#66d9ef>value</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// The date of signing.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Default value is &lt;see cref=&#34;DateTime.Now&#34;/&gt;.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> java.util.Date getSignTime()
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> setSignTime(java.util.Date <span style=color:#66d9ef>value</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Signature line identifier.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Default value is &lt;see cref=&#34;Guid.Empty&#34;/&gt;.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// When set, it associates &lt;see cref=&#34;SignatureLine&#34;/&gt; with corresponding &lt;see cref=&#34;DigitalSignature&#34;/&gt;.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> java.util.UUID getSignatureLineId()
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> setSignatureLineId(java.util.UUID <span style=color:#66d9ef>value</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// The image that will be shown in associated &lt;see cref=&#34;SignatureLine&#34;/&gt;.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Default value is &lt;c&gt;null&lt;/c&gt;.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>byte</span>[] getSignatureLineImage()
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> setSignatureLineImage(<span style=color:#66d9ef>byte</span>[] <span style=color:#66d9ef>value</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// The password to decrypt source document.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Default value is &lt;see cref=&#34;string.Empty&#34;/&gt;.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// If OOXML document is encrypted, you should provide decryption password</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// to decrypt source document before it will be signed.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// This is not required for documents in binary DOC format.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> java.lang.String getDecryptionPassword()
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> setDecryptionPassword(java.lang.String <span style=color:#66d9ef>value</span>)</span></span></code></pre></div><ol start=3><li>New public methods are introduced in DigitalSignatureUtil class for signing documents:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>/// Signs source document using given &lt;see cref=&#34;CertificateHolder&#34;/&gt; and &lt;see cref=&#34;SignOptions&#34;/&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>/// with digital signature and writes signed document to destination stream.</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>/// &lt;p&gt;Document should be either &lt;see cref=&#34;LoadFormat.Doc&#34;/&gt; or &lt;see cref=&#34;LoadFormat.Docx&#34;/&gt;.&lt;/p&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>/// &lt;p&gt;&lt;b&gt;Output will be written to the start of stream and stream size will be updated with content length.&lt;/b&gt;&lt;/p&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>/// &lt;param name=&#34;srcStream&#34;&gt;The stream which contains the document to sign.&lt;/param&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>/// &lt;param name=&#34;dstStream&#34;&gt;The stream that signed document will be written to.&lt;/param&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>/// &lt;param name=&#34;certHolder&#34;&gt;&lt;see cref=&#34;CertificateHolder&#34;/&gt; object with certificate that used to sign file.</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>/// &lt;ms&gt;The certificate in holder MUST contain private keys and have the X509KeyStorageFlags.Exportable flag set.&lt;/ms&gt;&lt;/param&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#75715e>/// &lt;param name=&#34;signOptions&#34;&gt;&lt;see cref=&#34;SignOptions&#34;/&gt; object with various signing options.&lt;/param&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> sign(InputStream srcStream, InputStream dstStream, CertificateHolder certHolder, SignOptions signOptions)
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Signs source document using given &lt;see cref=&#34;CertificateHolder&#34;/&gt; and &lt;see cref=&#34;SignOptions&#34;/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// with digital signature and writes signed document to destination file.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;p&gt;Document should be either &lt;see cref=&#34;LoadFormat.Doc&#34;/&gt; or &lt;see cref=&#34;LoadFormat.Docx&#34;/&gt;.&lt;/p&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;srcFileName&#34;&gt;The file name of the document to sign.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;dstFileName&#34;&gt;The file name of the signed document output.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;certHolder&#34;&gt;&lt;see cref=&#34;CertificateHolder&#34;/&gt; object with certificate that used to sign file.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;ms&gt;The certificate in holder MUST contain private keys and have the X509KeyStorageFlags.Exportable flag set.&lt;/ms&gt;&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;signOptions&#34;&gt;&lt;see cref=&#34;SignOptions&#34;/&gt; object with various signing options.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> sign(<span style=color:#66d9ef>string</span> srcFileName, <span style=color:#66d9ef>string</span> dstFileName, CertificateHolder certHolder, SignOptions signOptions)
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Signs source document using given &lt;see cref=&#34;CertificateHolder&#34;/&gt; with digital signature</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// and writes signed document to destination stream.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;p&gt;Document should be either &lt;see cref=&#34;LoadFormat.Doc&#34;/&gt; or &lt;see cref=&#34;LoadFormat.Docx&#34;/&gt;.&lt;/p&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;p&gt;&lt;b&gt;Output will be written to the start of stream and stream size will be updated with content length.&lt;/b&gt;&lt;/p&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;srcStream&#34;&gt;The stream which contains the document to sign.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;dstStream&#34;&gt;The stream that signed document will be written to.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;certHolder&#34;&gt;&lt;see cref=&#34;CertificateHolder&#34;/&gt; object with certificate that used to sign file.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;ms&gt;The certificate in holder MUST contain private keys and have the X509KeyStorageFlags.Exportable flag set.&lt;/ms&gt;&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> sign(InputStream srcStream, InputStream dstStream, CertificateHolder certHolder)
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Signs source document using given &lt;see cref=&#34;CertificateHolder&#34;/&gt; with digital signature</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// and writes signed document to destination file.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;p&gt;Document should be either &lt;see cref=&#34;LoadFormat.Doc&#34;/&gt; or &lt;see cref=&#34;LoadFormat.Docx&#34;/&gt;.&lt;/p&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;srcFileName&#34;&gt;The file name of the document to sign.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;dstFileName&#34;&gt;The file name of the signed document output.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;certHolder&#34;&gt;&lt;see cref=&#34;CertificateHolder&#34;/&gt; object with certificate that used to sign file.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;ms&gt;The certificate in holder MUST contain private keys and have the X509KeyStorageFlags.Exportable flag set.&lt;/ms&gt;&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> sign(<span style=color:#66d9ef>string</span> srcFileName, <span style=color:#66d9ef>string</span> dstFileName, CertificateHolder certHolder)</span></span></code></pre></div><ol start=4><li>Old signing methods in DigitalSignatureUtil are marked as &lsquo;Obsolete&rsquo;:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> sign(<span style=color:#66d9ef>string</span> srcFileName, <span style=color:#66d9ef>string</span> dstFileName, System.Security.Cryptography.X509Certificates.X509Certificate2 certificate, <span style=color:#66d9ef>string</span> comments, DateTime signTime);
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> sign(<span style=color:#66d9ef>string</span> srcFileName, <span style=color:#66d9ef>string</span> dstFileName, CertificateHolder certHolder, <span style=color:#66d9ef>string</span> comments,DateTime signTime);
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> sign(<span style=color:#66d9ef>string</span> srcFileName, <span style=color:#66d9ef>string</span> dstFileName, CertificateHolder certHolder, <span style=color:#66d9ef>string</span> comments, DateTime signTime, <span style=color:#66d9ef>string</span> srcPassword);
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> sign(InputStream srcStream, InputStream dstStream, System.Security.Cryptography.X509Certificates.X509Certificate2 certificate, <span style=color:#66d9ef>string</span> comments, DateTime signTime);
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> sign(InputStream srcStream, InputStream dstStream, CertificateHolder certHolder, <span style=color:#66d9ef>string</span> comments, DateTime signTime);
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> sign(InputStream srcStream, InputStream dstStream, CertificateHolder certHolder, <span style=color:#66d9ef>string</span> comments, DateTime signTime, <span style=color:#66d9ef>string</span> srcPassword);</span></span></code></pre></div><p><strong>UC1 - simple document signing:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>CertificateHolder certHolder = CertificateHolder.create(dataDir + <span style=color:#e6db74>&#34;temp.pfx&#34;</span>, <span style=color:#e6db74>&#34;password&#34;</span>);
</span></span><span style=display:flex><span>DigitalSignatureUtil.sign(dataDir + <span style=color:#e6db74>&#34;Document.Signed.docx&#34;</span>, dataDir + <span style=color:#e6db74>&#34;Document.Signed_out.docx&#34;</span>, certHolder);</span></span></code></pre></div><p><strong>UC2 - signing encrypted document:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>SignOptions signOptions = <span style=color:#66d9ef>new</span> SignOptions();
</span></span><span style=display:flex><span>signOptions.setDecryptionPassword(<span style=color:#e6db74>&#34;decryptionPassword&#34;</span>);
</span></span><span style=display:flex><span>CertificateHolder certHolder = CertificateHolder.create(dataDir + <span style=color:#e6db74>&#34;temp.pfx&#34;</span>, <span style=color:#e6db74>&#34;password&#34;</span>);
</span></span><span style=display:flex><span>DigitalSignatureUtil.sign(dataDir + <span style=color:#e6db74>&#34;Document.Signed.docx&#34;</span>, dataDir + <span style=color:#e6db74>&#34;Document.EncryptedDocument_out.docx&#34;</span>, certHolder, signOptions);</span></span></code></pre></div><p><strong>UC3 - signing existing signature line:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(dataDir + <span style=color:#e6db74>&#34;Document.Signed.docx&#34;</span>);
</span></span><span style=display:flex><span>SignatureLine signatureLine = ((Shape)doc.getFirstSection().getBody().getChild(NodeType.SHAPE, <span style=color:#ae81ff>0</span>, <span style=color:#66d9ef>true</span>)).getSignatureLine();
</span></span><span style=display:flex><span>SignOptions signOptions = <span style=color:#66d9ef>new</span> SignOptions();
</span></span><span style=display:flex><span>signOptions.setSignatureLineId(signatureLine.getId());
</span></span><span style=display:flex><span>java.nio.file.Path path = java.nio.file.Paths.<span style=color:#66d9ef>get</span>(dataDir + <span style=color:#e6db74>&#34;SignatureImage.emf&#34;</span>);
</span></span><span style=display:flex><span>signOptions.setSignatureLineImage(Files.readAllBytes(path));
</span></span><span style=display:flex><span>CertificateHolder certHolder = CertificateHolder.create(dataDir + <span style=color:#e6db74>&#34;temp.pfx&#34;</span>, <span style=color:#e6db74>&#34;password&#34;</span>);
</span></span><span style=display:flex><span>DigitalSignatureUtil.sign(dataDir + <span style=color:#e6db74>&#34;Document.Signed.docx&#34;</span>, dataDir + <span style=color:#e6db74>&#34;Document.Signed.ExistingSignatureLine.docx&#34;</span>, certHolder, signOptions);</span></span></code></pre></div><p><strong>UC4 - creating and signing new signature line:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document();
</span></span><span style=display:flex><span>DocumentBuilder builder = <span style=color:#66d9ef>new</span> DocumentBuilder(doc);
</span></span><span style=display:flex><span>SignatureLine signatureLine = builder.insertSignatureLine(<span style=color:#66d9ef>new</span> SignatureLineOptions()).getSignatureLine();
</span></span><span style=display:flex><span>doc.save(dataDir + <span style=color:#e6db74>&#34;Document.NewSignatureLine.docx&#34;</span>);
</span></span><span style=display:flex><span>SignOptions signOptions = <span style=color:#66d9ef>new</span> SignOptions();
</span></span><span style=display:flex><span>signOptions.setSignatureLineId(signatureLine.getId());
</span></span><span style=display:flex><span>java.nio.file.Path path = java.nio.file.Paths.<span style=color:#66d9ef>get</span>(dataDir + <span style=color:#e6db74>&#34;SignatureImage.emf&#34;</span>);
</span></span><span style=display:flex><span>signOptions.setSignatureLineImage(Files.readAllBytes(path));
</span></span><span style=display:flex><span>CertificateHolder certHolder = CertificateHolder.create(dataDir + <span style=color:#e6db74>&#34;temp.pfx&#34;</span>, <span style=color:#e6db74>&#34;password&#34;</span>);
</span></span><span style=display:flex><span>DigitalSignatureUtil.sign(dataDir + <span style=color:#e6db74>&#34;Document.NewSignatureLine.docx&#34;</span>, dataDir + <span style=color:#e6db74>&#34;Document.NewSignatureLine.docx_out.docx&#34;</span>, certHolder, signOptions);</span></span></code></pre></div></p></div></div></div></div><hr></div></div></section></div></div></section></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>