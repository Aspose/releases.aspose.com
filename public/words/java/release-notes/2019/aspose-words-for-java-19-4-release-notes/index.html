<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.Words for Java 19.4 Release Notes</title><meta name=description content="Aspose.Words for Java 19.4 Release Notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/words/java/release-notes/2019/aspose-words-for-java-19-4-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/words/java/release-notes/2019/aspose-words-for-java-19-4-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.Words for Java 19.4 Release Notes "><meta property="og:description" content="Aspose.Words for Java 19.4 Release Notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/words/java/release-notes/2019/aspose-words-for-java-19-4-release-notes/"><meta itemprop=name content="Aspose.Words for Java 19.4 Release Notes"><meta itemprop=description content="Aspose.Words for Java 19.4 Release Notes – the latest updates and fixes."><meta itemprop=wordCount content="2005"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.Words for Java 19.4 Release Notes"><meta name=twitter:description content="Aspose.Words for Java 19.4 Release Notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css preload><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/words/>Aspose.Words Product Family</a><span class=divider></span></li><li><a href=/words/java/>Aspose.Words for Java</a><span class=divider></span></li><li><a href=/words/java/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/words/java/release-notes/2019/>2019</a><span class=divider></span></li><li><a href=/words/java/release-notes/2019/aspose-words-for-java-19-4-release-notes/>Aspose.Words for Java 19.4 Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><section role=main class="container main-container page-package-details"><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section package-details-main"><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.Words for Java 19.4 Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><div class="alert alert-primary" role=alert>This page contains release notes for <a href=https://releases.aspose.com/words/java/19-4/>Aspose.Words for Java 19.4</a>.</div><h2 id=major-features>Major Features</h2><ul><li>MailMerge performance improved.</li><li>Cold startup time improved by 10%.</li><li>Added a new ImportFormatOptions class for more flexible control over importing tasks.</li><li>Provide API to change how text is vertically aligned within the Text Box.</li><li>Added a new ImportFormatOptions.KeepSourceNumbering option for use in import operations.</li><li>Added a new ImportFormatOptions.IgnoreTextBoxes option for use in import operations.</li><li>Added property PdfSaveOptions.AdditionalTextPositioning to control the writing of additional text positioning operators in PDF.</li><li>Implemented processing of fonts with &ldquo;_GB2312&rdquo; name suffixes (e.g. “KaiTi” font) when rendering metafiles.</li><li>Improved calculation of extrema when rendering DrawingML charts.</li><li>Improved vertical axis scaling of the chart with a manual layout of the plot area when rendering.</li><li>Improved impact assessment of the chart title size on the vertical axis scaling when rendering.</li><li>Improved vertical axis scaling when rendering DrawingML charts with the specified legend and the manual layout of the plot area.</li><li>Fixed a bug that caused a violation of PDF A-1b compliance when writing large text position adjustment values.</li><li>Fixed a bug with calculating extremums of the vertical axis when rendering DrawingML charts.</li><li>Fixed a bug with exception when converting a radar chart with empty Y-values to PDF.</li><li>Fixed a bug with rendering of transparent shapes with line caps specified.</li><li>Fixed infinite loop when shape overlapping is computed.</li><li>Improved shading rendering for condensed text.</li><li>Improved overlapping logic for frames and tables.</li><li>Improved Keep With Next rule handling for paragraph splits.</li><li>Improved Keep Lines Together rule handling in presence of floaters.</li></ul><h2 id=full-list-of-issues-covering-all-changes-in-this-release>Full List of Issues Covering all Changes in this Release</h2><table><thead><tr><th style=text-align:left>Key</th><th style=text-align:left>Summary</th><th style=text-align:left>Category</th></tr></thead><tbody><tr><td style=text-align:left>WORDSJAVA-2018</td><td style=text-align:left>Reduce startup time</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSJAVA-2020</td><td style=text-align:left>Reduce Fields&rsquo; parsing time while MailMerge</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-14095</td><td style=text-align:left>Add a border to a DML shape</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-18027</td><td style=text-align:left>DOCX to PDF - additional gaps between characters in the printed text</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-17996</td><td style=text-align:left>Provide API to change how text is vertically aligned within the Text Box</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSJAVA-1935</td><td style=text-align:left>JDK11. Dashed line disappeared</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-1967</td><td style=text-align:left>Wrong(?) encoding name in EPUB document header.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-2007</td><td style=text-align:left>com.aspose.words.FileCorruptedException upon loading a DOC with broken Position field</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-2013</td><td style=text-align:left>Document.Compare throws exception</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-2014</td><td style=text-align:left>Issue opening a document (with broken Position field) using Document(InputStream) ctor</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17534</td><td style=text-align:left>NodeImporter. ListFormat not imported</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18107</td><td style=text-align:left>Document.Save method does not stop while saving DOCX to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18130</td><td style=text-align:left>Vertical container bounds for shapes in compatibility mode</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-9890</td><td style=text-align:left>TextBox with vertical text in Header is not preserved in PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15523</td><td style=text-align:left>Image missing when converting .docx to .pdf</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17951</td><td style=text-align:left>Font formatting of Empty Paragraph is not preserved after DOCX->HTML->DOCX conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18189</td><td style=text-align:left>DocumentBuilder.insertHtml inserts extra space just before line break</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18231</td><td style=text-align:left>Aspose.Words.FileCorruptedException is thrown while loading DOC</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18296</td><td style=text-align:left>System.NullReferenceException occurs upon converting DOC to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17894</td><td style=text-align:left>Images with absolute path but no scheme are not saved</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18363</td><td style=text-align:left>Content of the comments can&rsquo;t be highlighted in some cases</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18263</td><td style=text-align:left>System.IndexOutOfRangeException is thrown while saving DOCX to HTML/PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17821</td><td style=text-align:left>Incorrect scaling of the second vertical axis after conversion to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18065</td><td style=text-align:left>UpdateFields throws &lsquo;Requested default value for an unknown attribute&rsquo; exception</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18110</td><td style=text-align:left>Characters are overlapped after conversion from RTF to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18143</td><td style=text-align:left>DOCX to HTML to DOC - &ldquo;behind text&rdquo; shape is positioned behind text because blank lines are removed</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18230</td><td style=text-align:left>DOCX to PDF conversion issue with Chinese text rendering</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18159</td><td style=text-align:left>ShapeRenderer crashes when rendering Emoji on macOS</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17961</td><td style=text-align:left>Replacement of text produces duplicated text lines</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-14740</td><td style=text-align:left>AW does not split a paragraph to satisfy &ldquo;keep with next&rdquo; rule</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18016</td><td style=text-align:left>Aspose.Words.FileCorruptedException is thrown while loading HTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18220</td><td style=text-align:left>Incorrect shape position on conversion to fixed page formats</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18281</td><td style=text-align:left>Update Aspose.TestBenchmark to the latest BenchmarkDotNet library</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17255</td><td style=text-align:left>Page field returns incorrect value (wrong document layout)</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18115</td><td style=text-align:left>DOCX to PDF - content moved to next page</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18390</td><td style=text-align:left>First page is missing when saving ODT file</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18136</td><td style=text-align:left>Style property for items starting with 10 is absent when we include the font</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-14974</td><td style=text-align:left>Slope of Drawing Line is incorrect after conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-10664</td><td style=text-align:left>MSWord2013 can split a table row due to &ldquo;Keep with next&rdquo; option</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-11824</td><td style=text-align:left>Paragraph rules are not applied to paragraphs inside cells</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-13063</td><td style=text-align:left>Paragraph does&rsquo; t apply &ldquo;keep lines together&rdquo; rule</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18266</td><td style=text-align:left>System.OverflowException is thrown while loading MHTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17868</td><td style=text-align:left>Range of Y-Axis of chart is changed in output PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17862</td><td style=text-align:left>Text overlapping in rendered PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17901</td><td style=text-align:left>The vertical axis gets the incorrect interval scaling in PDF output</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18198</td><td style=text-align:left>The textbox is improperly aligned after HTML round trip</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18005</td><td style=text-align:left>Document.Save throws System.NullReferenceException at Ubuntu</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18205</td><td style=text-align:left>The equation is converted to the image in DOCX output</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18086</td><td style=text-align:left>Add support for .ICO files with PNG images inside</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18197</td><td style=text-align:left>InsertImage throws System.NullReferenceException when SVG is inserted into Document</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18319</td><td style=text-align:left>Aspose.Words.FileCorruptedException is thrown while loading DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17526</td><td style=text-align:left>Process hangs during DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17939</td><td style=text-align:left>Strange code in DmlChartPlaneCartesian3D class</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17952</td><td style=text-align:left>Document.UpdateFields throws System.NotSupportedException</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18215</td><td style=text-align:left>&ldquo;width&rdquo; of HTML cells specified in percents is ignored if &ldquo;min-width&rdquo; is also present</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18274</td><td style=text-align:left>UpdateFields() method does not finish</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-14397</td><td style=text-align:left>Inserting documents does not preserve numbering</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18265</td><td style=text-align:left>NodeImporter.ImportNode throws exception after UpdatePageLayout</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17544</td><td style=text-align:left>Table borders in fixed-page HTML disappear in Chrome at lower zoom levels</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18095</td><td style=text-align:left>Table Cell Line Spacing lost when converting to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17866</td><td style=text-align:left>Incorrect rendering of Axis labels after converting to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18320</td><td style=text-align:left>Aspose.Words.FileCorruptedException is thrown while loading DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18279</td><td style=text-align:left>Header and Footer are lost after re-saving DOC</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17083</td><td style=text-align:left>InsertDocument inserts a white space at the start of content</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17504</td><td style=text-align:left>Section break is lost after DOCX>HTML>DOCX conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18392</td><td style=text-align:left>PDF A-1b compliance validation issues</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-11660</td><td style=text-align:left>Table objects in MS Word are not shown in PDF rendition</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18202</td><td style=text-align:left>Problems with NodeImporter using ImportFormatMode KeepSourceFormatting</td><td style=text-align:left>Bug</td></tr></tbody></table><h2 id=public-api-and-backward-incompatible-changes>Public API and Backward Incompatible Changes</h2><p>This section lists public API changes that were introduced in Aspose.Words 19.4. It includes not only new and obsoleted public methods, but also a description of any changes in the behavior behind the scenes in Aspose.Words which may affect existing code. Any behavior introduced that could be seen as regression and modifies existing behavior is especially important and is documented here.</p><h3 id=added-a-new-importformatoptions-class-for-more-flexible-control-over-importing-tasks>Added a new ImportFormatOptions class for more flexible control over importing tasks</h3><p>Related issue:WORDSNET-14397 has now been resolved.</p><p>Added a new <strong>ImportFormatOptions</strong> class with only a single public property <strong>SmartStyleBehavior</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Allows to specify various import options to format output.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ImportFormatOptions</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/// Smart style behavior.</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/// Default value is &lt;c&gt;false&lt;/c&gt;.</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> SmartStyleBehavior
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>This option starts working when styles clashes upon importing. </p><p>When this option is <strong>enabled</strong>, a source style will be expanded into direct attributes inside a destination document, if KeepSourceFormatting importing mode is used. </p><p>When this option is <strong>disabled</strong>, a source style will be expanded only if it is numbered. Existing destination attributes will not be overridden, including lists. </p><p>For a moment this option can be used only with a new public method of a DocumentBuilder class:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Inserts a document at the cursor position.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> Node InsertDocument(Document srcDoc, ImportFormatMode importFormatMode, ImportFormatOptions options)</span></span></code></pre></div><p><strong>UseCase:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document srcDoc = <span style=color:#66d9ef>new</span> Document(<span style=color:#e6db74>&#34;source.docx&#34;</span>);
</span></span><span style=display:flex><span>Document dstDoc = <span style=color:#66d9ef>new</span> Document(<span style=color:#e6db74>&#34;destination.docx&#34;</span>);
</span></span><span style=display:flex><span>DocumentBuilder builder = <span style=color:#66d9ef>new</span> DocumentBuilder(dstDoc);
</span></span><span style=display:flex><span>builder.MoveToDocumentEnd();
</span></span><span style=display:flex><span>builder.InsertBreak(BreakType.PageBreak);
</span></span><span style=display:flex><span>ImportFormatOptions options = <span style=color:#66d9ef>new</span> ImportFormatOptions();
</span></span><span style=display:flex><span>options.SmartStyleBehavior = <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>builder.InsertDocument(srcDoc, ImportFormatMode.UseDestinationStyles, options);</span></span></code></pre></div><h3 id=changes-in-font-resolving-while-loading-html-svg-document>Changes in font resolving while loading HTML (SVG) document</h3><p>Related issue:WORDSNET-17383 has now been resolved:</p><p>Previously while loading HTML (SVG) document font families resolved by font names were found on the system. </p><p>If font family wasn’t found on the system original font family kept in the model. </p><p>This led to a situation when resolved font name depended on the local system. </p><p>For example, if ‘UnknownFont1’ is absent on the system the following font family declaration resolved as ‘Arial’ (‘Arial’ is name for ‘san-serif’ generic font name.)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>p</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;font-family:UnknownFont1, sans-serif;&#39;</span>&gt;This is a paragraph.&lt;/<span style=color:#f92672>p</span>&gt;</span></span></code></pre></div><p>Now the customer can use font settings before loading the document (add substitution rule, specify fonts folder and etc). </p><p>The following example shows how to add font substitution rule while loading the document.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>FontSettings fontSettings = <span style=color:#66d9ef>new</span> FontSettings();
</span></span><span style=display:flex><span>TableSubstitutionRule substitutionRule = fontSettings.SubstitutionSettings.TableSubstitution;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// If &#34;UnknownFont1&#34; font family is not available then substitute it by &#34;Comic Sans MS&#34;.</span>
</span></span><span style=display:flex><span>substitutionRule.AddSubstitutes(<span style=color:#e6db74>&#34;UnknownFont1&#34;</span>, <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>string</span>[] { <span style=color:#e6db74>&#34;Comic Sans MS&#34;</span> });
</span></span><span style=display:flex><span>LoadOptions lo = <span style=color:#66d9ef>new</span> LoadOptions();
</span></span><span style=display:flex><span>lo.FontSettings = fontSettings;
</span></span><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(MyDir + <span style=color:#e6db74>&#34;myfile.html&#34;</span>, lo);</span></span></code></pre></div><p>The resulting model will contain &lsquo;UnknownFont1&rsquo; as resolved font name for a paragraph from example. </p><h3 id=api-to-change-how-text-is-vertically-aligned-within-the-text-box>API to change how text is vertically aligned within the Text Box</h3><p>Related issue:WORDSNET-17996 has now been resolved.</p><p>Added new property for specifying vertical anchor of shape&rsquo;s textbox.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Specifies the vertical alignment of the text within a shape.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;p&gt;The default value is &lt;see cref=&#34;TextBoxAnchor.Top&#34;/&gt;.&lt;/p&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> TextBoxAnchor VerticalAnchor
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>get</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>set</span>;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>The property allows to specify text anchor within the shape (Top, Middle, Bottom).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(fileName);
</span></span><span style=display:flex><span>Shape shape = doc.FirstSection.Body.Shapes[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>shape.TextBox.VerticalAnchor = TextBoxAnchor.Middle;</span></span></code></pre></div><p>Saving warnings will be thrown for unsupported formats (WordML) and for incompatible Word versions above 2007 (DOC, DOT).</p><h3 id=added-public-property-pdfsaveoptionsadditionaltextpositioning>Added public property PdfSaveOptions.AdditionalTextPositioning</h3><p>Related issue: WORDSNET-18027 has now been resolved.</p><p>The following new property has been added into the PdfSaveOptions class:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// A flag specifying whether to write additional text positioning operators or not.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// If &lt;c&gt;true&lt;/c&gt;, additional text positioning operators are written to the output PDF. This may help to overcome</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// issues with inaccurate text positioning with some printers. The downside is the increased PDF document size.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/para&gt; </span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;para&gt;The default value is &lt;c&gt;false&lt;/c&gt;.&lt;/para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> AdditionalTextPositioning
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>get</span> { <span style=color:#66d9ef>return</span> mAdditionalTextPositioning; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>set</span> { mAdditionalTextPositioning = <span style=color:#66d9ef>value</span>; }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h3 id=added-a-new-importformatoptionskeepsourcenumbering-option-for-use-in-import-operations>Added a new ImportFormatOptions.KeepSourceNumbering option for use in import operations</h3><p>Related issue:WORDSNET-17534 has now been resolved.</p><p>When import nodes between different documents there can be a situation when source document has lists with the same identifiers that were already used in a destination document. Word in such case always uses formatting from the destination lists.</p><p>To allow users to choose an appropriate behavior, the following option was introduced in ImportFormatOptions class:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Gets or sets a boolean value that specifies how the numbering will be imported when it clashes in source and destination documents.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// The default value is &lt;c&gt;false&lt;/c&gt;.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> KeepSourceNumbering</span></span></code></pre></div><p>Also, a new public method that accepts the new KeepSourceNumbering option was introduced as the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Initializes a new instance of the &lt;see cref=&#34;NodeImporter&#34;/&gt; class.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;srcDoc&#34;&gt;The source document.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;dstDoc&#34;&gt;The destination document that will be the owner of imported nodes.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;importFormatMode&#34;&gt;Specifies how to merge style formatting that clashes.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;importFormatOptions&#34;&gt;Specifies various options to format imported node.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> NodeImporter(DocumentBase srcDoc, DocumentBase dstDoc, ImportFormatMode importFormatMode, ImportFormatOptions importFormatOptions)</span></span></code></pre></div><p><strong>UseCase:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document srcDoc = TestUtil.Open(<span style=color:#e6db74>@&#34;source.docx&#34;</span>);
</span></span><span style=display:flex><span>Document dstDoc = TestUtil.Open(<span style=color:#e6db74>@&#34;destination.docx&#34;</span>);
</span></span><span style=display:flex><span>ImportFormatOptions importFormatOptions = <span style=color:#66d9ef>new</span> ImportFormatOptions();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Keep source list formatting when importing numbered paragraphs.</span>
</span></span><span style=display:flex><span>importFormatOptions.KeepSourceNumbering = <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>NodeImporter importer = <span style=color:#66d9ef>new</span> NodeImporter(srcDoc, dstDoc, ImportFormatMode.KeepSourceFormatting, importFormatOptions);
</span></span><span style=display:flex><span>ParagraphCollection srcParas = srcDoc.FirstSection.Body.Paragraphs;
</span></span><span style=display:flex><span><span style=color:#66d9ef>foreach</span> (Paragraph srcPara <span style=color:#66d9ef>in</span> srcParas)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    Node importedNode = importer.ImportNode(srcPara, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>    dstDoc.FirstSection.Body.AppendChild(importedNode);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>dstDoc.Save(<span style=color:#e6db74>&#34;output.docx&#34;</span>);</span></span></code></pre></div><h3 id=added-a-new-importformatoptionsignoretextboxes-option-for-use-in-import-operations>Added a new ImportFormatOptions.IgnoreTextBoxes option for use in import operations</h3><p>Related issue:WORDSNET-18202 has now been resolved.</p><p>When import a text box between different documents, the formatting of the destination document is applied to it. This corresponds to the behavior of Word. To allow users to choose an appropriate behavior, the following option was introduced in ImportFormatOptions class:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Gets or sets a boolean value that indicates whether to ignore formatting in the text boxes of</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// the source destination during the import.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Default value is &lt;c&gt;true&lt;/c&gt;.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> IgnoreTextBoxes</span></span></code></pre></div><p><strong>UseCase:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document srcDoc = TestUtil.Open(<span style=color:#e6db74>@&#34;source.docx&#34;</span>);
</span></span><span style=display:flex><span>Document dstDoc = TestUtil.Open(<span style=color:#e6db74>@&#34;destination.docx&#34;</span>);
</span></span><span style=display:flex><span>ImportFormatOptions importFormatOptions = <span style=color:#66d9ef>new</span> ImportFormatOptions();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Keep the source text boxes formatting when importing.</span>
</span></span><span style=display:flex><span>importFormatOptions.IgnoreTextBoxes = <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>NodeImporter importer = <span style=color:#66d9ef>new</span> NodeImporter(srcDoc, dstDoc, ImportFormatMode.KeepSourceFormatting, importFormatOptions);
</span></span><span style=display:flex><span>ParagraphCollection srcParas = srcDoc.FirstSection.Body.Paragraphs;
</span></span><span style=display:flex><span><span style=color:#66d9ef>foreach</span> (Paragraph srcPara <span style=color:#66d9ef>in</span> srcParas)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    Node importedNode = importer.ImportNode(srcPara, <span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>    dstDoc.FirstSection.Body.AppendChild(importedNode);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>dstDoc.Save(<span style=color:#e6db74>&#34;output.docx&#34;</span>);</span></span></code></pre></div></p></div></div></div></div><hr></div></div></section></div></div></section></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>