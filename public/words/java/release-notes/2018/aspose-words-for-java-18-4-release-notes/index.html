<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.Words for Java 18.4 Release Notes</title><meta name=description content="Aspose.Words for Java 18.4 Release Notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/words/java/release-notes/2018/aspose-words-for-java-18-4-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/words/java/release-notes/2018/aspose-words-for-java-18-4-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.Words for Java 18.4 Release Notes "><meta property="og:description" content="Aspose.Words for Java 18.4 Release Notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/words/java/release-notes/2018/aspose-words-for-java-18-4-release-notes/"><meta itemprop=name content="Aspose.Words for Java 18.4 Release Notes"><meta itemprop=description content="Aspose.Words for Java 18.4 Release Notes – the latest updates and fixes."><meta itemprop=wordCount content="1809"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.Words for Java 18.4 Release Notes"><meta name=twitter:description content="Aspose.Words for Java 18.4 Release Notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/words/>Aspose.Words Product Family</a><span class=divider></span></li><li><a href=/words/java/>Aspose.Words for Java</a><span class=divider></span></li><li><a href=/words/java/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/words/java/release-notes/2018/>2018</a><span class=divider></span></li><li><a href=/words/java/release-notes/2018/aspose-words-for-java-18-4-release-notes/>Aspose.Words for Java 18.4 Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><div class=container><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section"><div class=box1><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.Words for Java 18.4 Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><div class="alert alert-primary" role=alert>This page contains release notes for <a href=https://releases.aspose.com/words/java/18-4/>Aspose.Words for Java 18.4</a>.</div><h2 id=major-features>Major Features</h2><p>There are 75 improvements and fixes in this regular monthly release. The most notable are:</p><ul><li>Added public Ref&lt;T> class for out/ref emulation in public API.</li><li>Provide an ability to work with password-protected ODT and OTT file formats</li><li>Preserve PaperTray information in PCL       </li><li>Added ShapeBase.IsLayoutInCell property </li><li>Implemented optimization of metafile rendering vector output. Optimization includes applying intermediate transformations directly to the graphics and removing redundant canvases. Such optimization is also performed by MW when saving metafiles as vector graphics to PDF, XPS, etc.</li><li>PaperTray information is now saved in PCL output</li><li>&ldquo;DrawingML shapes are not fully supported&rdquo; warning is not thrown anymore, more specific warnings are used instead while rendering</li><li>DrawingML shapes with auto-size and empty textboxes don&rsquo;t throw exception while rendering now</li><li>WordArt objects with empty fill now cast only outline shadows while rendering. Previously the whole shape cast a shadow</li><li>Improved rendering of MathAccentElement. The accent symbol is rendered in accordance with the letter&rsquo;s height</li><li>Improved rendering of PieChart, if data labels have a manual layout</li><li>Improved rendering of the text boxes with OleObjects (e.g. Math equation)</li><li>Improved rendering of WordArt objects with gradient fill</li><li>Fixed a bug causing the corruption of radial gradient fill for rotated shapes while rendering</li><li>Fixed rendering of “Monotype Hadassah” font with legacy encoding</li><li>Fixed a problem with META_SETPIXEL WMF record while rendering meta-files</li><li>Improved frame width calculation when paragraph has right indent</li><li>Improved computation of widths of ideographic space when combined with document grid, space inside footnotes</li><li>Improved floating table positioning for RTL tables in 2013 compatibility mode</li><li>Improved layout of 2013 compatible documents when page break overlaps footer</li><li>Improved positioning of wrapped lines in 2013 compatibility mode, and lines with large inline images</li><li>Fixed issue with character compressing when Kinsoku rule is ignored by document</li><li>Fixed incorrect glyph selection for Zero Width No-Break Space when font does not have this glyph</li><li>Fixed comment range highlighting issue when comment spans multiple pages inside a repeated header row of a table</li><li>Fixed rendering of text in merged cells when row contains hidemark attribute on the cell break and all remaining cells are merged</li></ul><h2 id=full-list-of-issues-covering-all-changes-in-this-release>Full List of Issues Covering all Changes in this Release</h2><table><thead><tr><th style=text-align:left>Key</th><th style=text-align:left>Summary</th><th style=text-align:left>Category</th></tr></thead><tbody><tr><td style=text-align:left>WORDSJAVA-1737</td><td style=text-align:left>Multiple Print Jobs for each Page in a Single Document Created</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-1740</td><td style=text-align:left>Black and white is inverted in TIFF Viewer when converting from DOCX to TIFF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-1741</td><td style=text-align:left>Images background is changed to black color after conversion from DOCX to PDF/A</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-1742</td><td style=text-align:left>Yellow background not same after converting docx to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-1744</td><td style=text-align:left>ResolutionUnit Tag is not set when converting from DOCX to TIFF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSJAVA-1709</td><td style=text-align:left>New Digital Signature OfficeCrypto ODT tests.</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSJAVA-1710</td><td style=text-align:left>Autodetection of Japanese encoding in short text file.</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSJAVA-1769</td><td style=text-align:left>How to save Tiff in the Intel Encoding/byte order.</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSJAVA-1756</td><td style=text-align:left>Public Ref class for out/ref emulation in public API.</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>WORDSNET-16587</td><td style=text-align:left>Content are pushed down to the page in output PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16585</td><td style=text-align:left>DOCX to PDF - text split next line</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16580</td><td style=text-align:left>The output PDF document contains blank page after page 9.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16578</td><td style=text-align:left>Missing text during word to pdf conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16567</td><td style=text-align:left>OMathPara with added text is &ldquo;inline&rdquo; in DOCX, but not &ldquo;inline&rdquo; in PDF.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16563</td><td style=text-align:left>Cell background becomes black upon rendering</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16559</td><td style=text-align:left>Japanese characters are misaligned in PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16557</td><td style=text-align:left>Aspose.Words.UnsupportedFileFormatException is thrown for DOTX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16525</td><td style=text-align:left>Some artifacts in AutoCAD.Drawing.18 are dimmed or missed in PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16523</td><td style=text-align:left>Field.Unlink does not unlink IF fields</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16514</td><td style=text-align:left>DocumentBuilder.InsertImage causes issue with vertical dashed lines in SVG drawings for PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16510</td><td style=text-align:left>Handle &ldquo;DrawingML shapes are not fully supported&rdquo; warning correctly</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16507</td><td style=text-align:left>WordArt Style lost in PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16505</td><td style=text-align:left>Image presentation of OLE object is changed after re-saving ODT</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16502</td><td style=text-align:left>DOCX to PDF - ToC link not pointing to same table</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16500</td><td style=text-align:left>Character is being turned in to &ldquo;6&rdquo; in PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16484</td><td style=text-align:left>DOCX to PDF conversion issue with zero width no-break space character</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16482</td><td style=text-align:left>PDF output is corrupted after rendition</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16467</td><td style=text-align:left>Chart image is not rendered correctly in output PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16465</td><td style=text-align:left>Math equation is truncated after conversion from DOC to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16460</td><td style=text-align:left>Syntax issue in output PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16450</td><td style=text-align:left>Wrong radial gradient if object is rotated</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16449</td><td style=text-align:left>Wrong pen thickness in EMF metafile</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16446</td><td style=text-align:left>DocumentBuilder.InsertImage causes issue with dashed lines in SVG drawings</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16440</td><td style=text-align:left>Y position of the line after floaters is computed improperly for MS Word 2013</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16422</td><td style=text-align:left>A Drawing truncates from right in PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16418</td><td style=text-align:left>System.NullReferenceException is thrown when RevisionOptions.ShowRevisionBalloons is set to true.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16393</td><td style=text-align:left>Charts&rsquo; size is smaller in output PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16350</td><td style=text-align:left>Incorrect TOC page number in RTF to DOCX conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16337</td><td style=text-align:left>WordArt is not rendered correctly</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16303</td><td style=text-align:left>Insert revisions are inserted into Document using Document.TrackRevisions</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16289</td><td style=text-align:left>Images have been misplaced in PDF output.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16252</td><td style=text-align:left>DOCX to PDF issue with Characters with above bar line</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16169</td><td style=text-align:left>Highlighted text issue in Rendered PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16072</td><td style=text-align:left>Page and Table margin are not preserved during DOCX-HTML-DOCX round trip</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15226</td><td style=text-align:left>List label is changed after conversion from DOC to DOCX/PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15016</td><td style=text-align:left>Paragraph text inside StructuredDocumentTag is not modified after DOCX-HTML-DOCX round trip</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-14763</td><td style=text-align:left>Diagram Shapes coming oddly when exporting Word to HTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-11370</td><td style=text-align:left>/table grid/ Barcodes and Tables do not render to their complete widths in PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-9743</td><td style=text-align:left>Some images are missing from output Pdf</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-7586</td><td style=text-align:left>Support C1 control character mapping (MHTML to Tiff conversion issue with text rendering after lower quotes)</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-6840</td><td style=text-align:left>Table background Shading color is not preserved when saving to MHTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-5799</td><td style=text-align:left>Text of list items in a comment is not rendered</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16546</td><td style=text-align:left>Watermark on each page is not at correct position</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-16530</td><td style=text-align:left>Loading RTF hangs</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-16490</td><td style=text-align:left>DOCX to PDF - text moved to right</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-16479</td><td style=text-align:left>Add warnings when document has issues with its content</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-16396</td><td style=text-align:left>Remove obsolete LoadOptions.WebRequestTimeout</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-16349</td><td style=text-align:left>Review the methods depending on DocPr.IsGutterSide as it may return an incorrect value</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-15811</td><td style=text-align:left>Incorrect digital signing with DSA certificate</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-15490</td><td style=text-align:left>DOCX to PDF conversion issue with text color</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-15004</td><td style=text-align:left>Formatting of StructuredDocumentTag is lost during DOCX-HTML-DOCX round trip</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNETSTD-47</td><td style=text-align:left>TypeInitializationException on .NET Standard</td><td style=text-align:left>Exception</td></tr><tr><td style=text-align:left>WORDSNET-16584</td><td style=text-align:left>System.NullReferenceException occurs upon rendering to PDF</td><td style=text-align:left>Exception</td></tr><tr><td style=text-align:left>WORDSNET-16552</td><td style=text-align:left>System.NullReferenceException is thrown while saving DOCX to PDF</td><td style=text-align:left>Exception</td></tr><tr><td style=text-align:left>WORDSNET-16541</td><td style=text-align:left>FileCorruptedException loading html with SVG</td><td style=text-align:left>Exception</td></tr><tr><td style=text-align:left>WORDSNET-16456</td><td style=text-align:left>Document.ImportNode throws System.InvalidOperationException</td><td style=text-align:left>Exception</td></tr><tr><td style=text-align:left>WORDSNET-16453</td><td style=text-align:left>An exception raises while saving the output in PDF format.</td><td style=text-align:left>Exception</td></tr><tr><td style=text-align:left>WORDSNET-16425</td><td style=text-align:left>FileCorruptedException occurs upon loading a ODT</td><td style=text-align:left>Exception</td></tr><tr><td style=text-align:left>WORDSNET-16408</td><td style=text-align:left>System.InvalidCastException occurs when loading a ODT file</td><td style=text-align:left>Exception</td></tr><tr><td style=text-align:left>WORDSNET-16135</td><td style=text-align:left>Appending document throws InvalidOperation Exception</td><td style=text-align:left>Exception</td></tr><tr><td style=text-align:left>WORDSNET-16513</td><td style=text-align:left>Provide ability to extract Subject and the Issuer of a certificate</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>WORDSNET-16391</td><td style=text-align:left>Preserve PaperTray information in PCL</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>WORDSNET-16353</td><td style=text-align:left>Improve the rendering of compound lines and DrawingML shapes</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>WORDSNET-16133</td><td style=text-align:left>Provide an ability to work with password-protected ODT and OTT file formats</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>WORDSNET-16565</td><td style=text-align:left>UpdateFields caused hidden fields to be shown</td><td style=text-align:left>Regression</td></tr></tbody></table><h2 id=public-api-and-backward-incompatible-changes>Public API and Backward Incompatible Changes</h2><p>This section lists public API changes that were introduced in Aspose.Words 18.4. It includes not only new and obsoleted public methods, but also a description of any changes in the behavior behind the scenes in Aspose. Words which may affect existing code. Any behavior introduced that could be seen as a regression and modifies existing behavior is especially important and is documented here.</p><h3 id=public-ref-class-for-out-ref-emulation-in-public-java-api>Public Ref Class for out-ref Emulation in Public Java API</h3><p>Related issue: WORDSJAVA-1756</p><p>On .NET baseline, some public API methods contain out/ref params in signatures. Service classes Ref&lt;T>, RefInt, RefBoolean, etc. are added to emulate out/ref in Java.</p><p>Now, the code like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>void</span> SomeMethod(<span style=color:#66d9ef>ref</span> Document doc, <span style=color:#66d9ef>out</span> <span style=color:#66d9ef>int</span> i)</span></span></code></pre></div><p>is autoported to Java as:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>void</span> someMethod(Ref&lt;Document&gt; doc, RefInt i)</span></span></code></pre></div><p>The Ref* classes contain get() and set() methods to get and set the value.</p><h3 id=ability-to-work-with-password-protected-odt-and-ott-file-formats-added>Ability to Work with Password-Protected ODT and OTT File Formats Added</h3><p>Related issue: WORDSNET-16133</p><p>Supported encryption for ODF documents.</p><p>The following public API has been added to the OdtSaveOptions class:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Initializes a new instance of this class that can be used to save a document in the &lt;see cref=&#34;Words.SaveFormat.Odt&#34;/&gt; format</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// encrypted with a password.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> OdtSaveOptions(String password)</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Gets or sets a password to encrypt document.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;para&gt;In order to save document without encryption this property should be null or empty string.&lt;/para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> String Password</span></span></code></pre></div><h4 id=uc1-load-encrypted-odt-document>UC1: Load encrypted ODT document.</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(<span style=color:#e6db74>&#34;\\encrypted.odt&#34;</span>, <span style=color:#66d9ef>new</span> LoadOptions(<span style=color:#e6db74>&#34;password&#34;</span>));</span></span></code></pre></div><p><strong>UC2: Save ODT document encrypted with a password.</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document();
</span></span><span style=display:flex><span>doc.save(<span style=color:#e6db74>&#34;\\encryped.odt&#34;</span>, <span style=color:#66d9ef>new</span> OdtSaveOptions(<span style=color:#e6db74>&#34;password&#34;</span>));</span></span></code></pre></div><h5 id=uc3-verify-odt-document-is-encrypted>UC3: Verify ODT document is encrypted.</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>FileFormatInfo info = FileFormatUtil.detectFileFormat(<span style=color:#e6db74>&#34;\\encryped.odt&#34;</span>);
</span></span><span style=display:flex><span>System.<span style=color:#66d9ef>out</span>.println(info.isEncrypted());</span></span></code></pre></div><h3 id=ability-topreserve-papertray-information-in-pcl-added>Ability to Preserve PaperTray Information in PCL Added</h3><p>Related issue: WORDSNET-16391</p><p>Paper tray information is now preserved when saving document to PCL format.
Following information is transferred from document&rsquo;s model to PCL file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>PageSetup.FirstPageTray
</span></span><span style=display:flex><span>PageSetup.OtherPagesTray</span></span></code></pre></div><p>No additional code is required.
Please note the value of paper tray is passed from document &ldquo;as is&rdquo;.
PCL format supports only 8-bit identifiers for paper tray so make sure this values are correct for PCL printer.</p><h3 id=added-shapebaseislayoutincell-property>Added ShapeBase.IsLayoutInCell property</h3><p>Related issue: WORDSNET-16546</p><p>The following public property has been added into the <strong>ShapeBase</strong> class:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Gets or sets a flag indicating whether the shape is displayed inside a table or outside of it.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// The default value is &lt;b&gt;true&lt;/b&gt;.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Has effect only for top level shapes, the property &lt;see cref=&#34;WrapType&#34;/&gt; of which is set to value</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// other than &lt;see cref=&#34;WrapType.Inline&#34;/&gt;.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> boolean isLayoutInCell
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>The property may be helpful for shapes (mainly VML) that are placed into a table cell but are needed to position without binding to the cell.</p><h4 id=usage>Usage</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(dataDir + <span style=color:#e6db74>&#34;LayoutInCell.docx&#34;</span>);
</span></span><span style=display:flex><span>DocumentBuilder builder = <span style=color:#66d9ef>new</span> DocumentBuilder(doc);
</span></span><span style=display:flex><span>Shape watermark = <span style=color:#66d9ef>new</span> Shape(doc, ShapeType.TEXT_PLAIN_TEXT);
</span></span><span style=display:flex><span>watermark.setRelativeHorizontalPosition(RelativeHorizontalPosition.PAGE);
</span></span><span style=display:flex><span>watermark.setRelativeVerticalPosition(RelativeVerticalPosition.PAGE);
</span></span><span style=display:flex><span>watermark.isLayoutInCell(<span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span> <span style=color:#75715e>// Display the shape outside of table cell if it will be placed into a cell.</span>
</span></span><span style=display:flex><span>watermark.setWidth(<span style=color:#ae81ff>300</span>);
</span></span><span style=display:flex><span>watermark.setHeight(<span style=color:#ae81ff>70</span>);
</span></span><span style=display:flex><span>watermark.setHorizontalAlignment(HorizontalAlignment.CENTER);
</span></span><span style=display:flex><span>watermark.setVerticalAlignment(VerticalAlignment.CENTER);
</span></span><span style=display:flex><span>watermark.setRotation(-<span style=color:#ae81ff>40</span>);
</span></span><span style=display:flex><span>watermark.getFill().setColor(Color.GRAY);
</span></span><span style=display:flex><span>watermark.setStrokeColor(Color.GRAY);
</span></span><span style=display:flex><span>watermark.getTextPath().setText(<span style=color:#e6db74>&#34;watermarkText&#34;</span>);
</span></span><span style=display:flex><span>watermark.getTextPath().setFontFamily(<span style=color:#e6db74>&#34;Arial&#34;</span>);
</span></span><span style=display:flex><span>watermark.setName(<span style=color:#e6db74>&#34;WaterMark_0&#34;</span>);
</span></span><span style=display:flex><span>watermark.setWrapType(WrapType.NONE);
</span></span><span style=display:flex><span>Run run = (Run) doc.getChildNodes(NodeType.RUN, <span style=color:#66d9ef>true</span>).<span style=color:#66d9ef>get</span>(doc.getChildNodes(NodeType.RUN, <span style=color:#66d9ef>true</span>).getCount() - <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>builder.moveTo(run);
</span></span><span style=display:flex><span>builder.insertNode(watermark);
</span></span><span style=display:flex><span>doc.getCompatibilityOptions().optimizeFor(MsWordVersion.WORD_2010);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Save the document to disk.</span>
</span></span><span style=display:flex><span>dataDir = dataDir + <span style=color:#e6db74>&#34;Shape_IsLayoutInCell_out.docx&#34;</span>;
</span></span><span style=display:flex><span>doc.save(dataDir);</span></span></code></pre></div><h3 id=optimization-of-vector-graphics-output-of-metafile-rendering>Optimization of Vector Graphics Output of Metafile Rendering</h3><p>Related issues: WORDSNET-16449, WORDSNET-15490</p><p>Implemented optimization of metafile rendering vector output. Optimization includes applying intermediate transformations directly to the graphics and removing redundant canvases. Such optimization is also performed by MW when saving metafiles as vector graphics to PDF, XPS, etc.</p><p>Optimization may affect the visual appearance of metafile vector graphics in viewer applications due to peculiarities of vector graphics rendering. For example, there are cases when not optimized output looks faded out in Acrobat Reader comparing to optimized output.</p><p>Metafile output optimization is controlled by existing FixedPageSaveOptions.OptimizeOutput flag.</p><h3 id=obsolete-property-loadoptionswebrequesttimeout-was-removed>Obsolete property LoadOptions.WebRequestTimeout was removed</h3><p>Obsolete property WebRequestTimeout was removed from the LoadOptions class. Please use the HtmlLoadOptions.WebRequestTimeout property instead.</p></p></div></div></div></div><hr></div></div></section></div></div></div></div></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>