<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.Words for .NET 21.7 Release Notes</title><meta name=description content="Aspose.Words for .NET 21.7 Release Notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/words/net/release-notes/2021/aspose-words-for-net-21-7-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/words/net/release-notes/2021/aspose-words-for-net-21-7-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.Words for .NET 21.7 Release Notes "><meta property="og:description" content="Aspose.Words for .NET 21.7 Release Notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/words/net/release-notes/2021/aspose-words-for-net-21-7-release-notes/"><meta itemprop=name content="Aspose.Words for .NET 21.7 Release Notes"><meta itemprop=description content="Aspose.Words for .NET 21.7 Release Notes – the latest updates and fixes."><meta itemprop=wordCount content="2935"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.Words for .NET 21.7 Release Notes"><meta name=twitter:description content="Aspose.Words for .NET 21.7 Release Notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/words/>Aspose.Words Product Family</a><span class=divider></span></li><li><a href=/words/net/>Aspose.Words for .NET</a><span class=divider></span></li><li><a href=/words/net/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/words/net/release-notes/2021/>2021</a><span class=divider></span></li><li><a href=/words/net/release-notes/2021/aspose-words-for-net-21-7-release-notes/>Aspose.Words for .NET 21.7 Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><div class=container><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section"><div class=box1><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.Words for .NET 21.7 Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><div class="alert alert-primary" role=alert>This page contains release notes for <a href=https://www.nuget.org/packages/Aspose.Words/21.7.0>Aspose.Words for .NET 21.7</a>.</div><h2 id=major-features>Major Features</h2><p>There are 93 improvements and fixes in this regular monthly release. The most notable are:</p><ul><li>Implemented rendering to PDF/A-2 format.</li><li>Added an ability to work with Framesets.</li><li>Introduced a new overload of DocumentBuilder.InsertHtml and a new enumeration HtmlInsertOptions.</li><li>Provided new API for working with Fill patterns.</li><li>Supported several exact date-time parse formats while loading JSON for LINQ Reporting Engine.</li></ul><h2 id=full-list-of-issues-covering-all-changes-in-this-release>Full List of Issues Covering all Changes in this Release</h2><table><thead><tr><th style=text-align:left>Key</th><th style=text-align:left>Summary</th><th style=text-align:left>Category</th></tr></thead><tbody><tr><td style=text-align:left>WORDSNET-22279</td><td style=text-align:left>Implement Fill.Patterned method</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-17557</td><td style=text-align:left>Provide way to get URL from Target attribute inside webSettings.xml.rels file</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-21750</td><td style=text-align:left>Highlighted Content is not visible after exporting to PDF</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-15400</td><td style=text-align:left>Implement maskPen rasterOp mode in InkML rendering</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-22370</td><td style=text-align:left>Support several exact date-time parse formats while loading JSON</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-15984</td><td style=text-align:left>Ink annotations are not aligned in PDF output</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-21781</td><td style=text-align:left>Support using of arrays with data bands and LINQ extension methods for Java</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-22159</td><td style=text-align:left>Implement rendering of brushes with maskPen rasterOp mode</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-22009</td><td style=text-align:left>Make links clickable when converting CHM to HTML when the file pointing itself</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-5971</td><td style=text-align:left>Support of PdfCompliance PDF/A-2</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-11488</td><td style=text-align:left>Add feature to support of PdfCompliance PDF/A-2a</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-15836</td><td style=text-align:left>Add feature to support array type identifiers in template syntax</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-20505</td><td style=text-align:left>Add support for PDF/A-2u, PDF/A-2a, PDF/A-3u, PDF/A-3a compliance</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-15129</td><td style=text-align:left>Support of DOCX to PDF_A_2U conversion</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-15126</td><td style=text-align:left>Support of DOCX to PDF_A_2B conversion</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-15125</td><td style=text-align:left>Support of DOCX to PDF_A_2A conversion</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-13778</td><td style=text-align:left>Add feature to support of PdfCompliance PDF/A-2b</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-17478</td><td style=text-align:left>API needed to set the Scope attribute in Table in rendered PDF</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-21089</td><td style=text-align:left>Shapes are lost after RTF to PDF conversion</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-22397</td><td style=text-align:left>How to use &ldquo;Mark as decorative&rdquo; IsDecorative property</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-22255</td><td style=text-align:left>About Data Source Name in ReportingEngine.BuildReport Method</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-17726</td><td style=text-align:left>Notify user when he tries to load MOBI document but the document is AZW3</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-21259</td><td style=text-align:left>Unwanted spaces are added after conversion from DOCX>HTML>DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22312</td><td style=text-align:left>NullReferenceException when save attached document as PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22263</td><td style=text-align:left>ReportingEngine.BuildReport throws System.InvalidCastException</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22416</td><td style=text-align:left>DOCX to PDF: Output file text not formated properly</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21766</td><td style=text-align:left>Document.Compare generates incorrect revisions</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16528</td><td style=text-align:left>Incorrect convert DOCX to PDF when docx in compatible mode</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22404</td><td style=text-align:left>Incorrect page number for FieldPageRef</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-19592</td><td style=text-align:left>Exception is thrown when converting DOCX to HTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21940</td><td style=text-align:left>HTML img&rsquo;s base64 data is not getting converted to doc in Aspose.words java</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18852</td><td style=text-align:left>Empty paragraphs added when inserting unordered list using DocumentBuilder.InsertHtml</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22277</td><td style=text-align:left>OutOfMemoryException throws wnen extract pages and save it to PNG</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21669</td><td style=text-align:left>Mobi file - Huffman compression is not yet supported for specific file</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21963</td><td style=text-align:left>Value of attribute &ldquo;lang&rdquo; is invalid</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22388</td><td style=text-align:left>NullPointerException when calling mailMerge.execute()</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21988</td><td style=text-align:left>Incorrect page size during conversion of HTML with landscape orientation to DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22228</td><td style=text-align:left>Text is pushed down to next pages after DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22357</td><td style=text-align:left>System.NullReferenceException occurs upon DOC to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22311</td><td style=text-align:left>Duplicate list item created when inserting multiple paragraph breaks using Range.Replace()</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22321</td><td style=text-align:left>Replacing text containing a paragraph break is poorly represented with TrackRevisions in enabled</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21500</td><td style=text-align:left>Image displays as red cross in converted documents</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22387</td><td style=text-align:left>Content are lost after PDF to DOCX conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17077</td><td style=text-align:left>Row height increases after DOCX-HTML-DOCX roundtrip</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-19823</td><td style=text-align:left>Paragraph is pushed down to next page after DOCX>HTML>DOCX conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22303</td><td style=text-align:left>DOCX does not open in MS Word after after re-saving</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22389</td><td style=text-align:left>System.InvalidCastException occurs upon loading DOC</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20793</td><td style=text-align:left>DOCX to PDF conversion issue with PDF accessibility</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22330</td><td style=text-align:left>Series lines are rendered incorrectly after converting to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20708</td><td style=text-align:left>Wrong position of chart legend in output PNG file</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22356</td><td style=text-align:left>Object reference not set to an instance of an object</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22374</td><td style=text-align:left>File Corrupted Exception occurs upon loading a RTF Document</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20964</td><td style=text-align:left>DOCX to PDF conversion issue with chart rendering</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22358</td><td style=text-align:left>System.NullReferenceException occurs upon DOC to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22386</td><td style=text-align:left>Document is corrupted exception thrown while loading DOC</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22293</td><td style=text-align:left>HTML to TXT conversion issue with table layout</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22364</td><td style=text-align:left>Document word find and replace issue</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21454</td><td style=text-align:left>FileCorruptedException is thrown during import HTML file</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21137</td><td style=text-align:left>Image is not loaded from HTML if the &ldquo;src&rdquo; attribute value has leading or trailing whitespace characters</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22333</td><td style=text-align:left>Paragraph border is rendered at different position when ExportDocumentStructure is used</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18137</td><td style=text-align:left>Document.UpdateFields does not update TEMPLATE field</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22360</td><td style=text-align:left>Field.Update does not update FieldHyperlink and show</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22332</td><td style=text-align:left>Bullet symbol is lost after DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22355</td><td style=text-align:left>Incorrectly read SPRM:D62F. Expected 0, but read 11 bytes.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20958</td><td style=text-align:left>Page number in the footer is wrong in output TIFF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21944</td><td style=text-align:left>ODT to HTML | Frame&rsquo;s bottom border is missing</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22285</td><td style=text-align:left>Exception is thrown when loading MOBI file</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22231</td><td style=text-align:left>Negative letter-spacing after conversion from PDF to HTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21789</td><td style=text-align:left>Aspose.Words.FileCorruptedException error when converting MHTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22233</td><td style=text-align:left>System.NullReferenceException is thrown when DOC is saved to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20402</td><td style=text-align:left>HTML export issues</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22152</td><td style=text-align:left>Tab stop in a list item gets considerably wider after conversion to HTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21796</td><td style=text-align:left>DOCX to PDF/A conversion and validation fails: Several cases with header cells that are not tagged</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21947</td><td style=text-align:left>DOCX to PDF/A conversion: accessibility validation fails: Bullet list items are broken into several tags</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-14245</td><td style=text-align:left>Document.Compare generates incorrect format revisions</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22297</td><td style=text-align:left>Extra Text becomes Visible in PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22191</td><td style=text-align:left>Problem with nested tables in RTF content</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21035</td><td style=text-align:left>Incorrect rendering of Clustered Column Type Chart in PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18229</td><td style=text-align:left>The title of the horizontal axis overlaps the axis labels</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20135</td><td style=text-align:left>The Units are no longer aligned with the tick marks in Chart when rendered to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17543</td><td style=text-align:left>Document.UpdateFields leaves INCLUDETEXT field with &ldquo;Error! Not a valid filename.&rdquo;</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22262</td><td style=text-align:left>Track changes - Comments are shown in the outline</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22083</td><td style=text-align:left>Accessibility issues are appeared after DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22242</td><td style=text-align:left>Accessibility tags not behaving properly in Aspose PDF compared to Acrobat/Word PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22190</td><td style=text-align:left>Table header tags are not exported after DOCX to PDF/a conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21161</td><td style=text-align:left>Table tag structure is incorrect after DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22223</td><td style=text-align:left>Transparent PNG image became non-transparent after DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21846</td><td style=text-align:left>DOCX to PDF (PdfA1a) conversion issue with transparent image rendering</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17086</td><td style=text-align:left>PDF version support // Text effects are lost in PDFA_1B output</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16968</td><td style=text-align:left>Saving to PDF with PdfCompliance.PdfA1a results in a large file</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21123</td><td style=text-align:left>SmartArt drawing corruption during open save a DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21127</td><td style=text-align:left>Images and and text content are changed after re-saving DOCX at Windows Server 2019</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17657</td><td style=text-align:left>Document.UpdateFields does not process FieldStyleRef.SuppressNonDelimiters</td><td style=text-align:left>Bug</td></tr></tbody></table><h2 id=public-api-and-backward-incompatible-changes>Public API and Backward Incompatible Changes</h2><p>This section lists public API changes that were introduced in Aspose.Words 21.7. It includes not only new and obsoleted public methods, but also a description of any changes in the behavior behind the scenes in Aspose.Words which may affect existing code. Any behavior introduced that could be seen as regression and modifies the existing behavior is especially important and is documented here.</p><h3 id=added-new-public-property-isdecorative>Added new public property IsDecorative</h3><p>Related issue: WORDSNET-22397</p><p>A new public property IsDecorative has been added to ShapeBase class.<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Gets or sets the flag that specifies whether the shape is decorative.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Note that shape having not empty &lt;see cref=&#34;ShapeBase.AlternativeText&#34;/&gt; cannot be decorative.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> IsDecorative { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }</span></span></code></pre></div></p><p>Use Case: Explains how to use IsDecorative property.<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(<span style=color:#e6db74>&#34;input.docx&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Shape shape = doc.FirstSection.Body.Shapes[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>shape.IsDecorative = <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>doc.Save(<span style=color:#e6db74>&#34;output.docx&#34;</span>);</span></span></code></pre></div></p><h3 id=implemented-rendering-to-pdfa-2-format>Implemented rendering to PDF/A-2 format</h3><p>New values added to PdfCompliance enum.<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> PdfCompliance
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// The output file will comply with the PDF/A-2a standard.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// This level includes all the requirements of PDF/A-2u and additionally requires</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// that document structure be included (also known as being &#34;tagged&#34;),</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// with the objective of ensuring that document content can be searched and repurposed.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// Note that exporting the document structure significantly increases the memory consumption, especially</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// for the large documents.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>        PdfA2a,
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// The output file will comply with the PDF/A-2u standard.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// PDF/A-2u has the objective of preserving document static visual appearance over time, independent of the tools</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// and systems used for creating, storing or rendering the files. Additionally any text contained in the document</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// can be reliably extracted as a series of Unicode codepoints.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>        PdfA2u
</span></span><span style=display:flex><span>}</span></span></code></pre></div></p><p>PDF/A-2 is based on PDF-1.7 format and removes significant limitations of PDF/A-1 like prohibited transparency and prohibited object compression.</p><p>There are only PDF/A-2a and PDF/A-2u conformance levels and there are not PDF/A-2b because Aspose.Words regular output already conforms to PDF/A-2u level which is more strict than PDF/A-2b.</p><p>Please note that PDF/A-2 standard adds two new requirements to the content of the document in addition to the requirements of PDF/A-1:</p><ol><li>Both PDF/A-2a and PDF/A-2u standards prohibits the usage of .notdef glyph</li><li>PDF/A-2a prohibits the usage of Unicode PUA codepoints. They are commonly used in symbolic fonts like &ldquo;Symbol&rdquo;, &ldquo;Wingdings&rdquo;, etc.</li></ol><p>PdfCompliance.PdfA1a and PdfCompliance.PdfA1b are marked as obsolete.
Aspose.Words PDF/A-2 output do not have limitations of PDF/A-1 output described above and is more consistent. So there is no reason to keep saving to PDF/A-1.
However if you have requirements to save particularly to PDF/A-1 please report it and we may reconsider this decision.</p><p>Several PdfSaveOptions made prohibited when saving to PDF/A-1 and PDF/A-2<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PdfSaveOptions</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// Specifies whether to preserve Microsoft Word form fields as form fields in PDF or convert them to text.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// Default is &lt;c&gt;false&lt;/c&gt;.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span>        ...
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;para&gt;This value is ignored when saving to PDF/A compliance because editable forms are prohibited.&lt;/para&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> PreserveFormFields;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// Gets or sets a value determining the way &lt;see cref=&#34;Document.CustomDocumentProperties&#34;/&gt; are exported to PDF file.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span>        ...
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;para&gt;&lt;see cref=&#34;PdfCustomPropertiesExport.Metadata&#34;/&gt; value is not supported when saving to PDF/A.&lt;/para&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> PdfCustomPropertiesExport CustomPropertiesExport;
</span></span><span style=display:flex><span>     
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// Gets or sets a value determining whether hyperlinks in the output Pdf document</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// are forced to be opened in a new window (or tab) of a browser.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span>        ...
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;para&gt;Settings this value to &lt;c&gt;true&lt;/c&gt; is not allowed when saving to PDF/A because JavaScript actions are prohibited.&lt;/para&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>     
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> OpenHyperlinksInNewWindow;
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// Specifies how the color space will be selected for the images in PDF document.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span>        ...
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;para&gt;&lt;see cref=&#34;PdfImageColorSpaceExportMode.SimpleCmyk&#34;/&gt; value is not supported when saving to PDF/A.&lt;/para&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> PdfImageColorSpaceExportMode ImageColorSpaceExportMode;
</span></span><span style=display:flex><span>     
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// A flag indicating whether image interpolation shall be performed by a conforming reader.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// When &lt;c&gt;false&lt;/c&gt; is specified, the flag is not written to the output document and</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// the default behaviour of reader is used instead.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span>        ...
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;para&gt;Settings this value to &lt;c&gt;true&lt;/c&gt; is not allowed when saving to PDF/A according to compliance requirements.&lt;/para&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> InterpolateImages;
</span></span><span style=display:flex><span>}</span></span></code></pre></div></p><h3 id=a-typo-in-a-new-enum-name-introduced-in-216-corrected>A typo in a new enum name introduced in 21.6 corrected</h3><p>&ldquo;Aspose.Words.Layout.ContinuosSectionRestart&rdquo; enum introduced in 21.6 was renamed to ContinuousSectionRestart in order to correct a typo.</p><h3 id=implemented-frameset-api>Implemented Frameset API</h3><p>Related issue: WORDSNET-17557</p><p>Implemented a new Frameset API for accessing and updating a frame URL. It is available through the new Frameset property of a document.<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>namespace</span> Aspose.Words
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Document</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// Returns a &lt;see cref=&#34;Frameset&#34;/&gt; instance if this document represents a frames page.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// If the document is not framed, the property has the &lt;b&gt;null&lt;/b&gt; value.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> Frameset Frameset { <span style=color:#66d9ef>get</span>; }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> Aspose.Words.Framesets
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Represents a frames page or a single frame on a frames page.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// If the &lt;see cref=&#34;ChildFramesets&#34;/&gt; property contains items, this instance is a frames page, otherwise it is</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// a single frame.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Frameset</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// Gets or sets the web page URL or document file name to display in this frame.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> FrameDefaultUrl { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// Gets or sets a value indicating whether the web page or document file name specified in the</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;see cref=&#34;FrameDefaultUrl&#34;/&gt; property is an external resource the frame is linked with.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> IsFrameLinkToFile { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>     
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// Gets the collection of child frames and frames pages.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> FramesetCollection ChildFramesets { <span style=color:#66d9ef>get</span>; }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>     
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Represents a collection of instances of the &lt;see cref=&#34;Frameset&#34;/&gt; class.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FramesetCollection</span> : IEnumerable&lt;Frameset&gt;
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// Gets the number of frames/frames pages contained in the collection.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Count { <span style=color:#66d9ef>get</span>; }
</span></span><span style=display:flex><span>     
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// Gets a frame or frames page at the specified index.</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> Frameset <span style=color:#66d9ef>this</span>[<span style=color:#66d9ef>int</span> index] { <span style=color:#66d9ef>get</span>; }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div></p><p>Use Case:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(<span style=color:#e6db74>&#34;input.docx&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>doc.Frameset.ChildFramesets[<span style=color:#ae81ff>0</span>].FrameDefaultUrl = <span style=color:#e6db74>&#34;https://www.aspose.com&#34;</span>;
</span></span><span style=display:flex><span>doc.Frameset.ChildFramesets[<span style=color:#ae81ff>0</span>].IsFrameLinkToFile = <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>doc.Save(<span style=color:#e6db74>&#34;output.docx&#34;</span>);</span></span></code></pre></div></p><h3 id=introduced-a-new-overload-of-documentbuilderinserthtml-and-a-new-enumeration-htmlinsertoptions>Introduced a new overload of DocumentBuilder.InsertHtml and a new enumeration HtmlInsertOptions</h3><p>Related issue: WORDSNET-18852</p><p>The following new overload of DocumentBuilder.InsertHtml has been implemented:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Inserts an HTML string into the document. Allows to specify additional options.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;html&#34;&gt;An HTML string to insert into the document.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;options&#34;&gt;Options that are used when HTML string is inserted.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// You can use this method to insert an HTML fragment or whole HTML document.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> InsertHtml(<span style=color:#66d9ef>string</span> html, HtmlInsertOptions options)</span></span></code></pre></div></p><p>And the following public enumeration has been introduced:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Specifies options for the &lt;see cref=&#34;DocumentBuilder.InsertHtml(string, HtmlInsertOptions)&#34;/&gt; method.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>[Flags]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> HtmlInsertOptions
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Use the default options when inserting HTML.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    None = <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Use font and paragraph formatting specified in &lt;see cref=&#34;DocumentBuilder&#34;/&gt; as base formatting for text</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// inserted from HTML.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;para&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// If this option is not specified, formatting of &lt;see cref=&#34;DocumentBuilder&#34;/&gt; is ignored and text is inserted</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// with default HTML formatting. As a result, the text looks as it is rendered in browsers.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/para&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;para&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// If this option is specified, formatting of inserted text is based on formatting specified in</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;see cref=&#34;DocumentBuilder&#34;/&gt;, and the text looks as if it were inserted using &lt;see cref=&#34;DocumentBuilder.Write&#34;/&gt;.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/para&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>    UseBuilderFormatting = <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>     
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Remove the empty paragraph that is normally inserted after HTML that ends with a block-level element.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// By default, &lt;see cref=&#34;DocumentBuilder&#34;/&gt; makes sure that the last block-level element imported from HTML</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// is closed after import and inserts a paragraph break after the element. This paragraph break separates</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// content imported from HTML from content of the template document. However, if a HTML fragment is inserted into</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// an empty paragraph, that paragraph break will create an extra empty paragraph. If this behavior is undesired,</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// specify this option.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>    RemoveLastEmptyParagraph = <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></p><p>The old DocumentBuilder.InsertHtml overloads are now aliases for the new overload of DocumentBuilder.InsertHtml as follows:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>builder.InsertHtml(html);
</span></span><span style=display:flex><span><span style=color:#75715e>// Is equivalent to:</span>
</span></span><span style=display:flex><span>builder.InsertHtml(html, HtmlInsertOptions.None);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>builder.InsertHtml(html, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// Is equivalent to:</span>
</span></span><span style=display:flex><span>builder.InsertHtml(html, HtmlInsertOptions.None);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>builder.InsertHtml(html, <span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// Is equivalent to:</span>
</span></span><span style=display:flex><span>builder.InsertHtml(html, HtmlInsertOptions.UseBuilderFormatting);</span></span></code></pre></div></p><p>Use Case:
When DocumentBuilder.InsertHtml inserts a HTML fragment that ends with a block-level HTML element (for example, a paragraph or a list), it normally closes that block-level element and inserts a paragraph break.
As a result, a new empty paragraph appears after inserted document. This behavior may be undesired when HTML fragments are inserted into a template document.
For example, consider the following mail merge scenario.<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// Default behavior.</span>
</span></span><span style=display:flex><span>builder.MoveToMergeField(<span style=color:#e6db74>&#34;NAME&#34;</span>);
</span></span><span style=display:flex><span>builder.InsertHtml(<span style=color:#e6db74>&#34;&lt;p&gt;John Smith&lt;/p&gt;&#34;</span>, <span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>builder.MoveToMergeField(<span style=color:#e6db74>&#34;EMAIL&#34;</span>);
</span></span><span style=display:flex><span>builder.InsertHtml(<span style=color:#e6db74>&#34;&lt;p&gt;jsmith@example.com&lt;/p&gt;&#34;</span>, <span style=color:#66d9ef>true</span>);</span></span></code></pre></div></p><p>In the resulting document, there will be an extra empty paragraph after each inserted HTML paragraph.
However, if we specify HtmlInsertOptions.RemoveLastEmptyParagraph, those extra empty paragraphs will be removed.<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// RemoveLastEmptyParagraph is specified.</span>
</span></span><span style=display:flex><span>builder.MoveToMergeField(<span style=color:#e6db74>&#34;NAME&#34;</span>);
</span></span><span style=display:flex><span>builder.InsertHtml(<span style=color:#e6db74>&#34;&lt;p&gt;John Smith&lt;/p&gt;&#34;</span>, HtmlInsertOptions.UseBuilderFormatting | HtmlInsertOptions.RemoveLastEmptyParagraph);
</span></span><span style=display:flex><span>builder.MoveToMergeField(<span style=color:#e6db74>&#34;EMAIL&#34;</span>);
</span></span><span style=display:flex><span>builder.InsertHtml(<span style=color:#e6db74>&#34;&lt;p&gt;jsmith@example.com&lt;/p&gt;&#34;</span>, HtmlInsertOptions.UseBuilderFormatting | HtmlInsertOptions.RemoveLastEmptyParagraph);</span></span></code></pre></div></p><p>Inside the resulting document the empty paragraphs will be removed.</p><h3 id=introduced-fieldoptionstemplatename-property>Introduced FieldOptions.TemplateName property</h3><p>Related issue: WORDSNET-18137</p><p>As a part of implementing WORDSNET-18137, we have introduced the FieldOptions.TemplateName property which is used to specify template file name for the TEMPLATE field:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Gets or sets the file name of the template used by the document.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;p&gt;This property is used by the &lt;see cref=&#34;FieldTemplate&#34;/&gt; field if the &lt;see cref=&#34;Document.AttachedTemplate&#34;/&gt; property is empty.&lt;/p&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;p&gt;If this property is empty the default template file name &lt;c&gt;Normal.dotm&lt;/c&gt; is used.&lt;/p&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> TemplateName { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }</span></span></code></pre></div></p><p>Use Case:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>document.FieldOptions.TemplateName = <span style=color:#e6db74>@&#34;C:\Users\AW\AppData\Roaming\Microsoft\Templates\Normal.dotm&#34;</span>;</span></span></code></pre></div></p><h3 id=public-api-for-working-with-patterns-has-been-introduced>Public API for working with patterns has been introduced</h3><p>Related issue: WORDSNET-22279</p><p>The following new public methods were added into the Fill class:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Sets the specified fill to a pattern.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;patternType&#34;&gt;&lt;see cref=&#34;Drawing.PatternType&#34;/&gt;&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Patterned(PatternType patternType)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Sets the specified fill to a pattern.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;patternType&#34;&gt;&lt;see cref=&#34;Drawing.PatternType&#34;/&gt;&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;foreColor&#34;&gt;The color of the foreground fill.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;backColor&#34;&gt;The color of the background fill.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Patterned(PatternType patternType, Color foreColor, Color backColor)
</span></span><span style=display:flex><span>A <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>public</span> property Fill.Pattern has been added:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Gets a &lt;see cref=&#34;Drawing.PatternType&#34;/&gt; for the fill.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> PatternType Pattern { <span style=color:#66d9ef>get</span>; }
</span></span><span style=display:flex><span>A <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> has been introduced:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Specifies the fill pattern to be used to fill a shape.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> PatternType</span></span></code></pre></div></p><p>Use Case: Explains how to get and apply a pattern to a fill.<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// Open some document with a shape.</span>
</span></span><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(<span style=color:#e6db74>&#34;DocWithShape.docx&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Get Fill object for the first shape.</span>
</span></span><span style=display:flex><span>Fill fill = doc.FirstSection.Body.Shapes[<span style=color:#ae81ff>0</span>].Fill;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Check Fill Pattern value.</span>
</span></span><span style=display:flex><span>Console.WriteLine(<span style=color:#e6db74>&#34;Pattern value is: {0}&#34;</span>, fill.Pattern);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Apply DiagonalBrick pattern to the shape fill.</span>
</span></span><span style=display:flex><span>fill.Patterned(PatternType.DiagonalBrick);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>doc.Save(<span style=color:#e6db74>&#34;DiagonalBrick.docx&#34;</span>);</span></span></code></pre></div></p></p></div></div></div></div><hr></div></div></section></div></div></div></div></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>