<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.Words for .NET 21.12 Release Notes</title><meta name=description content="Aspose.Words for .NET 21.12 Release Notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/words/net/release-notes/2021/aspose-words-for-net-21-12-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/words/net/release-notes/2021/aspose-words-for-net-21-12-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.Words for .NET 21.12 Release Notes "><meta property="og:description" content="Aspose.Words for .NET 21.12 Release Notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/words/net/release-notes/2021/aspose-words-for-net-21-12-release-notes/"><meta itemprop=name content="Aspose.Words for .NET 21.12 Release Notes"><meta itemprop=description content="Aspose.Words for .NET 21.12 Release Notes – the latest updates and fixes."><meta itemprop=wordCount content="2100"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.Words for .NET 21.12 Release Notes"><meta name=twitter:description content="Aspose.Words for .NET 21.12 Release Notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css preload><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/words/>Aspose.Words Product Family</a><span class=divider></span></li><li><a href=/words/net/>Aspose.Words for .NET</a><span class=divider></span></li><li><a href=/words/net/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/words/net/release-notes/2021/>2021</a><span class=divider></span></li><li><a href=/words/net/release-notes/2021/aspose-words-for-net-21-12-release-notes/>Aspose.Words for .NET 21.12 Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><section role=main class="container main-container page-package-details"><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section package-details-main"><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.Words for .NET 21.12 Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><div class="alert alert-primary" role=alert>This page contains release notes for <a href=https://www.nuget.org/packages/Aspose.Words/21.12.0>Aspose.Words for .NET 21.12</a>.</div><h2 id=major-features>Major Features</h2><p>There are 79 improvements and fixes in this regular monthly release. The most notable are:</p><ul><li>Introduced an ability to get OOXML of content control.</li><li>Implemented loading previously saved font search cache to speed up the font cache initialization process upon rendering.</li><li>Added recognition of non-standard footnotes in PDF documents during the import workflow.</li><li>Implemented support for &lsquo;Allow Latin text to wrap in the middle of a word&rsquo; feature.</li><li>Provided the workaround for SkiaSharp bug, which causes application crash on Linux when new SkiaSharp 2.80.3 is used.</li></ul><h2 id=full-list-of-issues-covering-all-changes-in-this-release-reported-by-net-users>Full List of Issues Covering all Changes in this Release (Reported by .NET Users)</h2><table><thead><tr><th style=text-align:left>Key</th><th style=text-align:left>Summary</th><th style=text-align:left>Category</th></tr></thead><tbody><tr><td style=text-align:left>WORDSNET-22409</td><td style=text-align:left>Requesting feature to get OOXML of content control</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-22278</td><td style=text-align:left>Add a possibility to cache FontSearchInfos in a file and then load it</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-22892</td><td style=text-align:left>Add loading progress notification upon Markdown loading</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-22811</td><td style=text-align:left>Implement Fill.SetImage() method</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-16511</td><td style=text-align:left>Path gradient fill of rotated shape is rendered incorrectly</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22564</td><td style=text-align:left>Comments for Content controls are messed up after clone</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20192</td><td style=text-align:left>Curved lines of SmartArt render are rendered incorrectly in output PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22907</td><td style=text-align:left>DrawingML textbox position and text orientation is changed after updating page layout</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23049</td><td style=text-align:left>Too big font size when notes are written on the page borders</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22916</td><td style=text-align:left>Image is lost after DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22917</td><td style=text-align:left>Opening MHT file encoded quoted-printable hangs indefinitely</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23048</td><td style=text-align:left>Text was skipped because of incorrect ClippingBounds calculation</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20056</td><td style=text-align:left>Document comparison result issue if comments are there in document</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22192</td><td style=text-align:left>DOCX to HTML and Back to DOCX conversion loses the footer page number alignment</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23021</td><td style=text-align:left>NullReferenceException at CSJ2K&rsquo;s FileBitstreamReaderAgent..ctor</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23020</td><td style=text-align:left>NullReferenceException at CSJ2K&rsquo;s readBox()</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22928</td><td style=text-align:left>ArgumentNullException: Value cannot be null. (Parameter &lsquo;buffer&rsquo;) with SkiaSharp 20.8.3 in Docker</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22780</td><td style=text-align:left>Shape is shifted when rendering</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22782</td><td style=text-align:left>System.ArgumentOutOfRangeException is raised while exporting into Markdown format</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22946</td><td style=text-align:left>Incorrect position calculation for East Asian characters in MathTextElement</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22949</td><td style=text-align:left>draft2digital.com shows exception for EPUB generated by Aspose.Words</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22958</td><td style=text-align:left>System.ArgumentNullException with SkiaSharp 20.8.3 in Docker</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22406</td><td style=text-align:left>System.InvalidOperationException is thrown when DOCX is saved to HTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22850</td><td style=text-align:left>Convert docx to PDF radar chart missing category labels and incorrect scale</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22968</td><td style=text-align:left>System.IO.FileLoadException while loading PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22969</td><td style=text-align:left>PDF to DOCX - content is missing</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22967</td><td style=text-align:left>Variables declared in document header when using LINQ are not working in document body</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22970</td><td style=text-align:left>PDF to DOCX - extra content added</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22974</td><td style=text-align:left>XmlException while saving to FOPC</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22934</td><td style=text-align:left>Missing font fallback settings for the Geometric Shapes Extended Unicode block</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22960</td><td style=text-align:left>Comment ranges are lost after comparing documents</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22980</td><td style=text-align:left>FileCorruptedException is thrown upon loading RTF document</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22906</td><td style=text-align:left>Rich text content control is not visible when the SetMapping function is used</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22978</td><td style=text-align:left>Unexpected behavior of UpdateFields()</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23060</td><td style=text-align:left>Duplicated letters in words after the conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22988</td><td style=text-align:left>DOCX to PDF/a: Empty &lsquo;P&rsquo; tag added to output</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22877</td><td style=text-align:left>Unable to set bit depth of output TIFF image</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23047</td><td style=text-align:left>NotImplementedException: Security handler is not implemented for V=5, R=6</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23050</td><td style=text-align:left>NullReferenceException when a PDF file has empty cross-reference stream</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23061</td><td style=text-align:left>NullReferenceException at TableOfContentsTabStorage.NumberIsIncreasing</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23062</td><td style=text-align:left>InvalidOperationException: Subtype must be present in a Font resource</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22839</td><td style=text-align:left>Infinite loop in FloaterOverlapResolver due to shape with zero height</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22743</td><td style=text-align:left>Build logical structure for layout graphics</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23065</td><td style=text-align:left>InvalidOperationException: Pdf corrupted</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22955</td><td style=text-align:left>TOC in document prevents replacements with Range.Replace below the TOC if IgnoreFields = True</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23139</td><td style=text-align:left>System.InvalidOperationException: Collection was modified</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23140</td><td style=text-align:left>InvalidOperationException: Footnotes are only allowed inside the main text of the document</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23150</td><td style=text-align:left>Rotated PathGradient shapes inside group are rendered incorrectly</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22875</td><td style=text-align:left>DOCX to PDF conversion issue with hyperlink</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22876</td><td style=text-align:left>Conversion issue with hyperlink upon converting to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22874</td><td style=text-align:left>WML to PDF conversion issue with hyperlink</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22931</td><td style=text-align:left>Sigma is rendered as S in EQ Field</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22723</td><td style=text-align:left>Word to PDF Conversion loses space and lines</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23158</td><td style=text-align:left>FileCorruptedException is thrown while loading DOC</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22886</td><td style=text-align:left>Extra characters are added in output after DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22791</td><td style=text-align:left>Setting mapping creates corrupted output</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22881</td><td style=text-align:left>RTF to HTML - System.ArgumentNullException</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23051</td><td style=text-align:left>DivideByZeroException in TextCorrectionService if language is incorrect</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23165</td><td style=text-align:left>Text of Field&rsquo;s code part is exported into Markdown format</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22903</td><td style=text-align:left>Some SVG symbols look distorted</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-23028</td><td style=text-align:left>NullReferenceException at CSJ2K&rsquo;s FileFormatReader.readFileFormat</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22198</td><td style=text-align:left>Text position is changed after DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22795</td><td style=text-align:left>Incorrect rendering of Chinese font</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22979</td><td style=text-align:left>string.IsNullOrEmpty() method in LINQ template throws an exception</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22859</td><td style=text-align:left>Image disappears when render document to PDF with SkiaSharp 2.80.3</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22909</td><td style=text-align:left>ArgumentNullException is thrown in Linux when render Mhtml</td><td style=text-align:left>Bug</td></tr></tbody></table><h2 id=full-list-of-issues-covering-all-changes-in-this-release-reported-by-java-users>Full List of Issues Covering all Changes in this Release (Reported by Java Users)</h2><table><thead><tr><th style=text-align:left>Key</th><th style=text-align:left>Summary</th><th style=text-align:left>Category</th></tr></thead><tbody><tr><td style=text-align:left>WORDSNET-22923</td><td style=text-align:left>DOCX to PDF: Differences in generated output files</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22922</td><td style=text-align:left>Exporting highlighted paragraphs to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22961</td><td style=text-align:left>DOCX to HTML conversion throws System.NullReferenceException</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22971</td><td style=text-align:left>DOC to PDF conversion issue - new line in wrong place</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22977</td><td style=text-align:left>IndexOutOfBoundsException when setting alternate text on the shape</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22972</td><td style=text-align:left>getBoundsWithEffects returns 0 width and 0 height</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22670</td><td style=text-align:left>Wrong text commented after comparing DOCX files</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22480</td><td style=text-align:left>DOCX to PDF conversion issue with hidden bookmark</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22862</td><td style=text-align:left>Chart conversion issue upon converting to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-19833</td><td style=text-align:left>IndexOutOfRangeException is thorwn while saving DOCX to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22895</td><td style=text-align:left>Insert SVG with special characters in Text fails to render in output DOCX and PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18902</td><td style=text-align:left>Size of SVG images are not displayed correctly</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22976</td><td style=text-align:left>DOCX to PDF: Inserted image has different dimensions</td><td style=text-align:left>Bug</td></tr></tbody></table><h2 id=public-api-and-backward-incompatible-changes>Public API and Backward Incompatible Changes</h2><p>This section lists public API changes that were introduced in Aspose.Words 21.12. It includes not only new and obsoleted public methods, but also a description of any changes in the behavior behind the scenes in Aspose.Words which may affect existing code. Any behavior introduced that could be seen as regression and modifies the existing behavior is especially important and is documented here.</p><h3 id=added-new-feature-to-save-and-load-font-search-cache>Added new feature to save and load font search cache</h3><p>Related issue: WORDSNET-22278</p><p>Loading previously saved font search cache will speed up the font cache initialization process. It is especially useful when access to font sources is complicated (e.g. when fonts are loaded via network).</p><p>To provide this feature following methods and properties has been added:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FontSettings</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Saves the font search cache to the stream.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;param name=&#34;outputStream&#34;&gt;Output stream.&lt;/param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// See &lt;see cref=&#34;SetFontsSources(FontSourceBase[], Stream)&#34;/&gt; method description for more info.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> SaveSearchCache(Stream outputStream);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Sets the sources where Aspose.Words looks for TrueType fonts and additionally loads previously saved</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// font search cache.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;param name=&#34;sources&#34;&gt;An array of sources that contain TrueType fonts.&lt;/param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;param name=&#34;cacheInputStream&#34;&gt;Input stream with saved font search cache.&lt;/param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;para&gt;Loading previously saved font search cache will speed up the font cache initialization process. It is</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// especially useful when access to font sources is complicated (e.g. when fonts are loaded via network).&lt;/para&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>///</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;para&gt;When saving and loading font search cache, fonts in the provided sources are identified via cache key.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// For the fonts in the &lt;see cref=&#34;SystemFontSource&#34;/&gt; and &lt;see cref=&#34;FolderFontSource&#34;/&gt; cache key is the path</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// to the font file. For &lt;see cref=&#34;MemoryFontSource&#34;/&gt; and &lt;see cref=&#34;StreamFontSource&#34;/&gt; cache key is defined</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// in the &lt;see cref=&#34;MemoryFontSource.CacheKey&#34;/&gt; and &lt;see cref=&#34;StreamFontSource.CacheKey&#34;/&gt; properties</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// respectively. For the &lt;see cref=&#34;FileFontSource&#34;/&gt; cache key is either &lt;see cref=&#34;FileFontSource.CacheKey&#34;/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// property or a file path if the &lt;see cref=&#34;FileFontSource.CacheKey&#34;/&gt; is &lt;b&gt;null&lt;/b&gt;.&lt;/para&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>///</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;para&gt;It is highly recommended to provide the same font sources when loading cache as at the time the cache was saved.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Any changes in the font sources (e.g. adding new fonts, moving font files or changing the cache key) may lead to the</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// inaccurate font resolving by Aspose.Words.&lt;/para&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> SetFontsSources(FontSourceBase[] sources, Stream cacheInputStream);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FileFontSource</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Ctor.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;param name=&#34;filePath&#34;&gt;Path to font file.&lt;/param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;param name=&#34;priority&#34;&gt;Font source priority. See the &lt;see cref=&#34;FontSourceBase.Priority&#34;/&gt; property description for more information.&lt;/param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;param name=&#34;cacheKey&#34;&gt;The key of this source in the cache. See &lt;see cref=&#34;CacheKey&#34;/&gt; property description for more information.&lt;/param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> FileFontSource(<span style=color:#66d9ef>string</span> filePath, <span style=color:#66d9ef>int</span> priority, <span style=color:#66d9ef>string</span> cacheKey);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// The key of this source in the cache.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;para&gt;This key is used to identify cache item when saving/loading font search cache with</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;see cref=&#34;FontSettings.SaveSearchCache&#34;/&gt; and</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;see cref=&#34;FontSettings.SetFontsSources(FontSourceBase[], Stream)&#34;/&gt; methods.&lt;/para&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>///</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;para&gt;If key is not specified then &lt;see cref=&#34;FilePath&#34;/&gt; will be used as a key instead.&lt;/para&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> CacheKey { <span style=color:#66d9ef>get</span>; }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MemoryFontSource</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Ctor.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;param name=&#34;fontData&#34;&gt;Binary font data.&lt;/param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;param name=&#34;priority&#34;&gt;Font source priority. See the &lt;see cref=&#34;FontSourceBase.Priority&#34;/&gt; property description for more information.&lt;/param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;param name=&#34;cacheKey&#34;&gt;The key of this source in the cache. See &lt;see cref=&#34;CacheKey&#34;/&gt; property description for more information.&lt;/param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> MemoryFontSource(<span style=color:#66d9ef>byte</span>[] fontData, <span style=color:#66d9ef>int</span> priority, <span style=color:#66d9ef>string</span> cacheKey);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// The key of this source in the cache.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// This key is used to identify cache item when saving/loading font search cache with</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;see cref=&#34;FontSettings.SaveSearchCache&#34;/&gt; and &lt;see cref=&#34;FontSettings.SetFontsSources(FontSourceBase[], Stream)&#34;/&gt; methods.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> CacheKey { <span style=color:#66d9ef>get</span>; }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>StreamFontSource</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// Ctor.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;param name=&#34;priority&#34;&gt;Font source priority. See the &lt;see cref=&#34;FontSourceBase.Priority&#34;/&gt; property description for more information.&lt;/param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;param name=&#34;cacheKey&#34;&gt;The key of this source in the cache. See &lt;see cref=&#34;CacheKey&#34;/&gt; property description for more information.&lt;/param&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>protected</span> StreamFontSource(<span style=color:#66d9ef>int</span> priority, <span style=color:#66d9ef>string</span> cacheKey);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// The key of this source in the cache.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// This key is used to identify cache item when saving/loading font search cache with</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;see cref=&#34;FontSettings.SaveSearchCache&#34;/&gt; and &lt;see cref=&#34;FontSettings.SetFontsSources(FontSourceBase[], Stream)&#34;/&gt; methods.</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> CacheKey { <span style=color:#66d9ef>get</span>; }
</span></span><span style=display:flex><span>}</span></span></code></pre></div></p><p>Use Case:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// Prepare font sources and generate font search cache beforehand.</span>
</span></span><span style=display:flex><span>FileFontSource fileSource = <span style=color:#66d9ef>new</span> FileFontSource(filePath, fileSourcePriority, fileSourceKey);
</span></span><span style=display:flex><span>MemoryFontSource memorySource = <span style=color:#66d9ef>new</span> MemoryFontSource(fontData, memorySourcePriority, memorySourceKey);
</span></span><span style=display:flex><span>StreamFontSource streamSource = <span style=color:#66d9ef>new</span> StreamFontSourceMemoryImpl(streamSourcePriority, streamSourceKey);
</span></span><span style=display:flex><span>FontSettings settings = <span style=color:#66d9ef>new</span> FontSettings();
</span></span><span style=display:flex><span>settings.SetFontsSources(<span style=color:#66d9ef>new</span> FontSourceBase[] { fileSource, memorySource, streamSource });
</span></span><span style=display:flex><span>settings.SaveSearchCache(cacheOutputStream);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// Set font sources and load search cache before processing documents. Note that sources should be the same as when saving font search cache.</span>
</span></span><span style=display:flex><span>FileFontSource fileSource = <span style=color:#66d9ef>new</span> FileFontSource(filePath, fileSourcePriority, fileSourceKey);
</span></span><span style=display:flex><span>MemoryFontSource memorySource = <span style=color:#66d9ef>new</span> MemoryFontSource(fontData, memorySourcePriority, memorySourceKey);
</span></span><span style=display:flex><span>StreamFontSource streamSource = <span style=color:#66d9ef>new</span> StreamFontSourceMemoryImpl(streamSourcePriority, streamSourceKey);
</span></span><span style=display:flex><span>FontSettings settings = <span style=color:#66d9ef>new</span> FontSettings();
</span></span><span style=display:flex><span>settings.SetFontsSources(<span style=color:#66d9ef>new</span> FontSourceBase[] { fileSource, memorySource, streamSource }, cacheInputStream);</span></span></code></pre></div></p><h3 id=added-new-public-methods-fillsetimage>Added new public methods Fill.SetImage</h3><p>Related issue: WORDSNET-22811</p><p>Added the following methods to Fill class:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Changes the fill type to single image.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;fileName&#34;&gt;The path to the image file.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> SetImage(<span style=color:#66d9ef>string</span> fileName)
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Changes the fill type to single image.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;stream&#34;&gt;The stream that contains the image bytes.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> SetImage(Stream stream)
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Changes the fill type to single image.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;imageBytes&#34;&gt;The image bytes array.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> SetImage(<span style=color:#66d9ef>byte</span>[] imageBytes)</span></span></code></pre></div></p><p>Use Case: Explains how to work with Fill.SetImage.<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>DocumentBuilder builder = <span style=color:#66d9ef>new</span> DocumentBuilder();
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// Add new rectangle shape.</span>
</span></span><span style=display:flex><span>Shape shape = builder.InsertShape(ShapeType.Rectangle, <span style=color:#ae81ff>80</span>, <span style=color:#ae81ff>80</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// Apply one single image to the shape.</span>
</span></span><span style=display:flex><span>shape.Fill.SetImage(<span style=color:#e6db74>&#34;ShapeBackground.jpg&#34;</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>builder.Document.Save(<span style=color:#e6db74>&#34;SingleImageDocument.docx&#34;</span>);</span></span></code></pre></div></p><h3 id=added-wordopenxml-property-for-content-control-nodes>Added WordOpenXML property for content control nodes</h3><p>Related issue: WORDSNET-22409</p><p>The following member has been added to the StructuredDocumentTag and StructuredDocumentTagRangeStart nodes:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Gets a string that represents the XML contained within the node in the &lt;see cref=&#34;SaveFormat.FlatOpc&#34;/&gt; format.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> WordOpenXML { <span style=color:#66d9ef>get</span>; }</span></span></code></pre></div></p><p>Use Case:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(<span style=color:#e6db74>&#34;Test.docx&#34;</span>);
</span></span><span style=display:flex><span>StructuredDocumentTag sdt = (StructuredDocumentTag)doc.GetChild(NodeType.StructuredDocumentTag, <span style=color:#ae81ff>0</span>, <span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>string</span> fopcContent = sdt.WordOpenXML;</span></span></code></pre></div></p><h3 id=added-the-reportbuildoptionsuselegacyheaderfootervisiting-enum-member>Added the ReportBuildOptions.UseLegacyHeaderFooterVisiting enum member</h3><p>Related issue: WORDSNET-22967</p><p>The following member has been added to the ReportBuildOptions enum:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Specifies that the engine should visit section child nodes (headers, footers, bodies) in an order</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// compatible with Aspose.Words versions prior 21.9.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// By default, the engine treats headers and footers as if they were linked to section breaks. That is,</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// when visiting section child nodes, a body is visited first and only then, headers and footers are visited.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// This agrees with Microsoft Word behavior when copy-pasting or removing multi-section contents and produces</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// more correct results in most scenarios.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Prior to Aspose.Words 21.9, the engine used another visiting order: Section child nodes were visited in</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// an order they appear in a document. Apply this value to &lt;see cref=&#34;ReportingEngine.Options&#34;/&gt; if</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// compatibility with older versions of Aspose.Words is required.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>UseLegacyHeaderFooterVisiting</span></span></code></pre></div></p><p>The option can be applied while building a report in the following way:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>ReportingEngine engine = <span style=color:#66d9ef>new</span> ReportingEngine();
</span></span><span style=display:flex><span>engine.Options |= ReportBuildOptions.UseLegacyHeaderFooterVisiting;
</span></span><span style=display:flex><span>engine.BuildReport(...);</span></span></code></pre></div></p></div></div></div></div><hr></div></div></section></div></div></section></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>