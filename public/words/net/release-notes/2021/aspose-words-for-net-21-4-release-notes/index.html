<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.Words for .NET 21.4 Release Notes</title><meta name=description content="Aspose.Words for .NET 21.4 Release Notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/words/net/release-notes/2021/aspose-words-for-net-21-4-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/words/net/release-notes/2021/aspose-words-for-net-21-4-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.Words for .NET 21.4 Release Notes "><meta property="og:description" content="Aspose.Words for .NET 21.4 Release Notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/words/net/release-notes/2021/aspose-words-for-net-21-4-release-notes/"><meta itemprop=name content="Aspose.Words for .NET 21.4 Release Notes"><meta itemprop=description content="Aspose.Words for .NET 21.4 Release Notes – the latest updates and fixes."><meta itemprop=wordCount content="1991"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.Words for .NET 21.4 Release Notes"><meta name=twitter:description content="Aspose.Words for .NET 21.4 Release Notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css preload><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/words/>Aspose.Words Product Family</a><span class=divider></span></li><li><a href=/words/net/>Aspose.Words for .NET</a><span class=divider></span></li><li><a href=/words/net/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/words/net/release-notes/2021/>2021</a><span class=divider></span></li><li><a href=/words/net/release-notes/2021/aspose-words-for-net-21-4-release-notes/>Aspose.Words for .NET 21.4 Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><section role=main class="container main-container page-package-details"><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section package-details-main"><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.Words for .NET 21.4 Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><div class="alert alert-primary" role=alert>This page contains release notes for <a href=https://www.nuget.org/packages/Aspose.Words/21.4.0>Aspose.Words for .NET 21.4</a>.</div><h2 id=major-features>Major Features</h2><p>There are 95 improvements and fixes in this regular monthly release. The most notable are:</p><ul><li>Added an ability to remove unused BuiltIn Styles.</li><li>The Fill class was extended with a functionality for processing solid fills.</li><li>Public API of Structured Document Tag range was extended.</li><li>Advanced typography supported when saving to images on .NET and .NET Standard.</li></ul><h2 id=full-list-of-issues-covering-all-changes-in-this-release>Full List of Issues Covering all Changes in this Release</h2><table><thead><tr><th style=text-align:left>Key</th><th style=text-align:left>Summary</th><th style=text-align:left>Category</th></tr></thead><tbody><tr><td style=text-align:left>WORDSNET-21246</td><td style=text-align:left>Provide more properties/methods in StructuredDocumentTagRangeStart Class</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-21991</td><td style=text-align:left>Support advanced typography in SkiaSharp image renderer</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-5643</td><td style=text-align:left>Consider providing a way to save user specified page ranges when saving to flow formats</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-20580</td><td style=text-align:left>Improve list item padding simulation in Html list writer</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-21597</td><td style=text-align:left>Add &ldquo;IsDecorative&rdquo; flag for DML shapes</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-3449</td><td style=text-align:left>Improve support of large files</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-21966</td><td style=text-align:left>DOCX to PDF conversion: System.ArgumentOutOfRangeException: &lsquo;Index was out of range.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21801</td><td style=text-align:left>URL is changed after Word to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20987</td><td style=text-align:left>Unexpected format change revision appears for a Table after Compare</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20190</td><td style=text-align:left>Chart series are lost after DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20191</td><td style=text-align:left>Chart X-axis and Axis Title render incorrectly in output PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22024</td><td style=text-align:left>System.InvalidOperationException: NC sync failed occurs upon comparing DOCX files</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22016</td><td style=text-align:left>Provide example to process BARCODE fields</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21400</td><td style=text-align:left>Aspose.Words enters a infinite loop when converting file from DOCX to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21636</td><td style=text-align:left>Content formatting changed after delete XmlMapping</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21977</td><td style=text-align:left>Unused styles are not cleaned from DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21979</td><td style=text-align:left>Does not update SDT content in document.xml parts after calling UpdatePageLayout()</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21981</td><td style=text-align:left>FileCorruptedException is thrown while importing DOC</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21983</td><td style=text-align:left>Uneoected FileCorruptedException is thrown while importing document</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20758</td><td style=text-align:left>Table does not export correctly in output PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21986</td><td style=text-align:left>Track changes - Ghost formatted table</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21959</td><td style=text-align:left>DOCX to HTML: Incorrect SVG image rendering</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21997</td><td style=text-align:left>w:instrText is added in document header after re-saving DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21999</td><td style=text-align:left>System.ArgumentOutOfRangeException is thrown while saving DOCX to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21998</td><td style=text-align:left>w:instrText is added in comments.xml after re-saving DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16679</td><td style=text-align:left>Metafile is rendered improperly</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16689</td><td style=text-align:left>Spacing between asian and latin numbers is rendered improperly</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-4539</td><td style=text-align:left>Setting FormField text to empty does not display default text in MS Word</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16698</td><td style=text-align:left>When MetafileRenderingMode.Bitmap is used, quality of image is not good</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20597</td><td style=text-align:left>Incorrect automatic font color inside VML shape</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21663</td><td style=text-align:left>Vertical Chinese Text Collapses into a Single Line in HTML Fixed</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16509</td><td style=text-align:left>Not able to save as PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16971</td><td style=text-align:left>Cell background color is incorrect in .NET Standard</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21838</td><td style=text-align:left>Docx -> PDF: conversion never ends for a file</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21862</td><td style=text-align:left>Conversion from ODT to PDF throws IndexOutOfRangeException</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21680</td><td style=text-align:left>Missed footnotes during conversion between DOCX and Markdown</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-22025</td><td style=text-align:left>LINQ Reporting Engine throws NullPointerException when ReportBuildOptions.RemoveEmptyParagraphs is used</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21875</td><td style=text-align:left>Table rows are lost after PDF to DOCX conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18770</td><td style=text-align:left>Unable to save the HTML version of DOCX file</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18092</td><td style=text-align:left>Document.UpdateFields method throws System.InvalidOperationException</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21330</td><td style=text-align:left>Rendering of some Japanese characters changes their orientation</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21886</td><td style=text-align:left>Hyperlink DisplayResult not present in result DOTX document</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21859</td><td style=text-align:left>Text from paragraphs with zero line spacing becomes visible in rendered documents</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18969</td><td style=text-align:left>List bullet image is duplicated after conversion to HTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21685</td><td style=text-align:left>Image dimension is changed while importing Markdown</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21691</td><td style=text-align:left>ArgumentOutOfRangeException is thrown when call UpdatePageLayout</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-15169</td><td style=text-align:left>Direction of Text Characters is changed in DOCX to JPG conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21096</td><td style=text-align:left>Infinite loop on call of UpdatePageLayout</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21899</td><td style=text-align:left>DOC to PDF conversion issue with Chinese text rendering</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21722</td><td style=text-align:left>Some tests fail sometimes while running in parallel</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21435</td><td style=text-align:left>Styles are not imported correctly after HTML to DOCX conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21733</td><td style=text-align:left>Combo Custom Combination Chart - Updating a Combinated Chart Corrupts Document</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21151</td><td style=text-align:left>Bar char is not rendered correctly</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21910</td><td style=text-align:left>System.IndexOutOfRangeException occurs upon DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21911</td><td style=text-align:left>System.ArgumentOutOfRangeException occurs upon Word DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21912</td><td style=text-align:left>Word to PDF conversion never ends for a DOC File</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20607</td><td style=text-align:left>Contents are pushed down to next page in output PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21188</td><td style=text-align:left>An interval between list label end and first line text is different depending on HtmlSaveOptions.PrettyFormat</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21602</td><td style=text-align:left>Table row is lost when HTML and Table is inserted into document using DocumentBuilder</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21604</td><td style=text-align:left>Infinite loop during call of Document.UpdatePageLayout</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21748</td><td style=text-align:left>System.ArgumentOutOfRangeException for UpdatePageLayout method</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21484</td><td style=text-align:left>Incorrectly displayed form fields in PDF when viewed in Google Chrome Web Browser</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21844</td><td style=text-align:left>Line extends out of bounds in pdf file after saving DPCX to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21763</td><td style=text-align:left>DOCX to TIFF conversion issue with simplified Arabic text rendering</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21929</td><td style=text-align:left>Text is moved to previous line after DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21928</td><td style=text-align:left>Barcode position is changed after DOC to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21800</td><td style=text-align:left>Japanese top to down text issue when converting DOCX to HTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21607</td><td style=text-align:left>New style introduced after adding a new SDT</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21592</td><td style=text-align:left>Links are broken when rendering CHM files to HTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-13730</td><td style=text-align:left>System.TypeInitializationException is thrown while loading Document</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21930</td><td style=text-align:left>DOCX to PDF conversion issue with background</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21642</td><td style=text-align:left>Zny.Common.Document uses our AW.NET, check is it legal or not</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18507</td><td style=text-align:left>DOC to HtmlFixed conversion issue with table rendering</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21935</td><td style=text-align:left>Table row is shifted towards left side of page after DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21649</td><td style=text-align:left>Bookmarks are lost after initiating LayoutEnumerator</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21939</td><td style=text-align:left>FileCorruptedException occurs upon loading a DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21797</td><td style=text-align:left>DOCX to PDF/A conversion and validation fails: Table spanned over 2 pages is tagged as two tables instead of one.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21761</td><td style=text-align:left>Conversion process hangs on Linux</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-19297</td><td style=text-align:left>Layout difference for the document</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21967</td><td style=text-align:left>Extract text from PDF file line by line and save data values inside SQL server database</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21978</td><td style=text-align:left>Document.Cleanup() not removing all unused Styles and Lists</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-13487</td><td style=text-align:left>Watermark positioning is incorrect in PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16697</td><td style=text-align:left>TryParse does not work for &ldquo;fr-CH&rdquo;</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20979</td><td style=text-align:left>text-align : left style inside table column is not exported in output HTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16683</td><td style=text-align:left>Document has incorrect tab size</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16705</td><td style=text-align:left>Original date value is incorrect</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21518</td><td style=text-align:left>Nested Textboxes inside Tables are missing in generated HTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-12069</td><td style=text-align:left>Extra empty page appears after conversion form DOCX to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-12153</td><td style=text-align:left>Contents position is changed after conversion from DOCX to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-12393</td><td style=text-align:left>Some Tables are pushed to next page in rendered document</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20242</td><td style=text-align:left>DOC to HtmlFixed conversion is incorrect when HtmlFixedSaveOptions.ResourcesFolder is used</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-13531</td><td style=text-align:left>Incorrect conversion from DOCX to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20729</td><td style=text-align:left>MHTML to PDF conversion hangs</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-16722</td><td style=text-align:left>Document has incorrect field values</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21590</td><td style=text-align:left>PDF to MS word formatting issues</td><td style=text-align:left>Bug</td></tr></tbody></table><h2 id=public-api-and-backward-incompatible-changes>Public API and Backward Incompatible Changes</h2><p>This section lists public API changes that were introduced in Aspose.Words 21.4. It includes not only new and obsoleted public methods, but also a description of any changes in the behavior behind the scenes in Aspose.Words which may affect existing code. Any behavior introduced that could be seen as regression and modifies the existing behavior is especially important and is documented here.</p><h3 id=asposewordscomparing-namespace-was-introduced>Aspose.Words.Comparing namespace was introduced</h3><p>Due to refactoring work on Aspose.Words namespaces, CompareOptions, ComparisonTargetType, Granularity classes were moved to new separate namespace Aspose.Words.Comparing.
In case of compilation error - please add using Aspose.Words.Comparing.</p><h3 id=asposewordsnotes-namespace-was-introduced>Aspose.Words.Notes namespace was introduced</h3><p>Due to refactoring work on Aspose.Words namespaces, Footnote, EndnoteOptions, FootnoteOptions, EndnotePosition, FootnotePosition, FootnoteType, FootnoteNumberingRule classes were moved to new separate namespace Aspose.Words.Notes.
In case of compilation error - please add using Aspose.Words.Notes.</p><h3 id=the-classes-related-to-load-options-were-moved-to-asposewordsloading-namespace>The classes related to load options were moved to Aspose.Words.Loading namespace</h3><p>Due to refactoring work on Aspose.Words namespaces, LoadOptions, PdfLoadOptions, RtfLoadOptions, TxtLoadOptions classes and corresponding enums were moved to Aspose.Words.Loading namespace.
In case of compilation error - please add using Aspose.Words.Loading.</p><h3 id=added-a-new-public-property-cleanupoptionsunusedbuiltinstyles>Added a new public property CleanupOptions.UnusedBuiltinStyles</h3><p>Related issue: WORDSNET-21977</p><p>Added a new public property to CleanupOptions:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Specifies that unused BuiltIn styles should be removed from document.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> UnusedBuiltinStyles { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }</span></span></code></pre></div><p>Use Case: Explains how to use UnusedBuiltinStyles property.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(<span style=color:#e6db74>&#34;input.docx&#34;</span>);
</span></span><span style=display:flex><span>CleanupOptions cleanupOptions = <span style=color:#66d9ef>new</span> CleanupOptions();
</span></span><span style=display:flex><span>cleanupOptions.UnusedBuiltinStyles = <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>doc.Cleanup(cleanupOptions);</span></span></code></pre></div><h3 id=advanced-typography-supported-when-saving-to-images-on-net-and-net-standard>Advanced typography supported when saving to images on .NET and .NET Standard</h3><p>Related issue: WORDSNET-21330, WORDSNET-21991</p><p>Advanced typography is now supported when saving to images with GDI+ or SkiaSharp (i.e. on all .NET platforms and .NET Standard).</p><p>Use Case: Saving document to image with advanced typography features.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(<span style=color:#e6db74>&#34;input.docx&#34;</span>);
</span></span><span style=display:flex><span>doc.LayoutOptions.TextShaperFactory = HarfBuzzTextShaperFactory.Instance;
</span></span><span style=display:flex><span>doc.Save(<span style=color:#e6db74>&#34;output.png&#34;</span>);</span></span></code></pre></div><h3 id=fillsolid-method-was-introduced>Fill.Solid() method was introduced</h3><p>Related issue: WORDSNET-21808</p><p>The following new public methods were added into the Fill class:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Sets the fill to a uniform color.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Use this method to convert any of the fills back to solid fill.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Solid()
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Sets the fill to a specified uniform color.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Use this method to convert any of the fills back to solid fill.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Solid(Color color)</span></span></code></pre></div><p>Use Case: Explains how to change fill to Solid.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>// Open some document with text effects.</span>
</span></span><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(<span style=color:#e6db74>&#34;TextTwoColorGradient.docx&#34;</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// Get Fill object for Font of the first Run.</span>
</span></span><span style=display:flex><span>Fill fill = doc.FirstSection.Body.FirstParagraph.Runs[<span style=color:#ae81ff>0</span>].Font.Fill;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// Check Fill properties of the Font.</span>
</span></span><span style=display:flex><span>Console.WriteLine(<span style=color:#e6db74>&#34;The type of the fill is: {0}&#34;</span>, fill.FillType);
</span></span><span style=display:flex><span>Console.WriteLine(<span style=color:#e6db74>&#34;The foreground color of the fill is: {0}&#34;</span>, fill.ForeColor);
</span></span><span style=display:flex><span>Console.WriteLine(<span style=color:#e6db74>&#34;The fill is transparent at {0}%&#34;</span>, fill.Transparency * <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// Change type of the fill to Solid with uniform green color.</span>
</span></span><span style=display:flex><span>fill.Solid(Color.Green);
</span></span><span style=display:flex><span>Console.WriteLine(<span style=color:#e6db74>&#34;\nThe fill is changed:&#34;</span>);
</span></span><span style=display:flex><span>Console.WriteLine(<span style=color:#e6db74>&#34;The type of the fill is: {0}&#34;</span>, fill.FillType);
</span></span><span style=display:flex><span>Console.WriteLine(<span style=color:#e6db74>&#34;The foreground color of the fill is: {0}&#34;</span>, fill.ForeColor);
</span></span><span style=display:flex><span>Console.WriteLine(<span style=color:#e6db74>&#34;The fill transparency is {0}%&#34;</span>, fill.Transparency * <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>doc.Save(<span style=color:#e6db74>&#34;TextSolidOut.docx&#34;</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e>This code example produces the following results:
</span></span></span><span style=display:flex><span><span style=color:#75715e> 
</span></span></span><span style=display:flex><span><span style=color:#75715e>The type of the fill is: Gradient
</span></span></span><span style=display:flex><span><span style=color:#75715e>The foreground color of the fill is: Color [A=255, R=0, G=128, B=128]
</span></span></span><span style=display:flex><span><span style=color:#75715e>The fill is transparent at 65%
</span></span></span><span style=display:flex><span><span style=color:#75715e> 
</span></span></span><span style=display:flex><span><span style=color:#75715e>The fill is changed:
</span></span></span><span style=display:flex><span><span style=color:#75715e>The type of the fill is: Solid
</span></span></span><span style=display:flex><span><span style=color:#75715e>The foreground color of the fill is: Color [A=255, R=0, G=128, B=0]
</span></span></span><span style=display:flex><span><span style=color:#75715e>The fill transparency is 0%
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span></span></span></code></pre></div><h3 id=public-api-of-structured-document-tag-range-was-extended>Public API of Structured Document Tag range was extended</h3><p>Related issue: WORDSNET-21246</p><p>The constructors for StructuredDocumentTagRangeStart and StructuredDocumentTagRangeEnd classes have been made public. Now the instances of these classes can be created manually.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Initializes a new instance of the &lt;b&gt;Structured document tag range start&lt;/b&gt; class.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;para&gt;The following types of SDT can be created:&lt;/para&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;list type=&#34;bullet&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;item&gt;&lt;see cref=&#34;Markup.SdtType.Checkbox&#34;/&gt;&lt;/item&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;item&gt;&lt;see cref=&#34;Markup.SdtType.DropDownList&#34;/&gt;&lt;/item&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;item&gt;&lt;see cref=&#34;Markup.SdtType.ComboBox&#34;/&gt;&lt;/item&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;item&gt;&lt;see cref=&#34;Markup.SdtType.Date&#34;/&gt;&lt;/item&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;item&gt;&lt;see cref=&#34;Markup.SdtType.BuildingBlockGallery&#34;/&gt;&lt;/item&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;item&gt;&lt;see cref=&#34;Markup.SdtType.Group&#34;/&gt;&lt;/item&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;item&gt;&lt;see cref=&#34;Markup.SdtType.Picture&#34;/&gt;&lt;/item&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;item&gt;&lt;see cref=&#34;Markup.SdtType.RichText&#34;/&gt;&lt;/item&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;item&gt;&lt;see cref=&#34;Markup.SdtType.PlainText&#34;/&gt;&lt;/item&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/list&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;doc&#34;&gt;The owner document.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;type&#34;&gt;Type of SDT node.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> StructuredDocumentTagRangeStart(DocumentBase doc, SdtType type)
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Initializes a new instance of the &lt;b&gt;Structured document tag range end&lt;/b&gt; class.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;doc&#34;&gt;The owner document.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;id&#34;&gt;Identifier of the corresponding structured document tag range start.&lt;/param&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> StructuredDocumentTagRangeEnd(DocumentBase doc, <span style=color:#66d9ef>int</span> id)</span></span></code></pre></div><p>Use Case:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(<span style=color:#e6db74>&#34;input.docx&#34;</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>StructuredDocumentTagRangeStart start = <span style=color:#66d9ef>new</span> StructuredDocumentTagRangeStart(doc, SdtType.RepeatingSectionItem);
</span></span><span style=display:flex><span>StructuredDocumentTagRangeEnd end = <span style=color:#66d9ef>new</span> StructuredDocumentTagRangeEnd(doc, start.Id);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>doc.FirstSection.Body.InsertAfter(start, doc.FirstSection.Body.FirstParagraph);
</span></span><span style=display:flex><span>doc.LastSection.Body.InsertBefore(end, doc.LastSection.Body.LastParagraph);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>doc.Save(<span style=color:#e6db74>&#34;output.docx&#34;</span>);
</span></span><span style=display:flex><span>IEnumerable <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>is</span> implemented <span style=color:#66d9ef>in</span> StructuredDocumentTagRangeStart <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>for</span> full LINQ support (i.e. Last(), LastOrDefault() and other methods).
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(<span style=color:#e6db74>&#34;input.docx&#34;</span>);
</span></span><span style=display:flex><span>StructuredDocumentTagRangeStart start = (StructuredDocumentTagRangeStart)doc.FirstSection.Body.GetChild(NodeType.StructuredDocumentTagRangeStart, <span style=color:#ae81ff>0</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>Console.WriteLine(start.LastOrDefault().GetText());</span></span></code></pre></div><p>A new public RemoveAllChildren() method has been added.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Removes all the nodes between this range start node and the range end node.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> RemoveAllChildren()</span></span></code></pre></div><p>Use Case: Explains how to use RemoveAllChildren() method.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(<span style=color:#e6db74>&#34;input.docx&#34;</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> nodeCountBefore = doc.GetChildNodes(NodeType.Any, <span style=color:#66d9ef>true</span>).Count;
</span></span><span style=display:flex><span>StructuredDocumentTagRangeStart start = (StructuredDocumentTagRangeStart)doc.FirstSection.Body.GetChild(NodeType.StructuredDocumentTagRangeStart, <span style=color:#ae81ff>0</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>start.RemoveAllChildren();
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> nodeCountAfter = doc.GetChildNodes(NodeType.Any, <span style=color:#66d9ef>true</span>).Count;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>Console.WriteLine(nodeCountBefore);
</span></span><span style=display:flex><span>Console.WriteLine(nodeCountAfter);</span></span></code></pre></div><p>A new public RemoveSelfOnly() method has been added.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Removes this range start and appropriate range end nodes of the structured document tag,</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// but keeps its content inside the document tree.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> RemoveSelfOnly()</span></span></code></pre></div><p>Use Case: Explains how to use RemoveSelfOnly() method.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(<span style=color:#e6db74>&#34;input.docx&#34;</span>);
</span></span><span style=display:flex><span>StructuredDocumentTagRangeStart start = (StructuredDocumentTagRangeStart)doc.FirstSection.Body.GetChild(NodeType.StructuredDocumentTagRangeStart, <span style=color:#ae81ff>0</span>, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>start.RemoveSelfOnly();</span></span></code></pre></div><h3 id=removed-obsolete-pdfsaveoptionsescapeuri-property>Removed obsolete PdfSaveOptions.EscapeUri property</h3><p>This option is not needed anymore because writing of URI to PDF was improved and cases when disabled escaping was required are handled well now.</p></p></div></div></div></div><hr></div></div></section></div></div></section></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>