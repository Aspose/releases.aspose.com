<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.Words for .NET 20.9 Release Notes</title><meta name=description content="Aspose.Words for .NET 20.9 Release Notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/words/net/release-notes/2020/aspose-words-for-net-20-9-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/words/net/release-notes/2020/aspose-words-for-net-20-9-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.Words for .NET 20.9 Release Notes "><meta property="og:description" content="Aspose.Words for .NET 20.9 Release Notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/words/net/release-notes/2020/aspose-words-for-net-20-9-release-notes/"><meta itemprop=name content="Aspose.Words for .NET 20.9 Release Notes"><meta itemprop=description content="Aspose.Words for .NET 20.9 Release Notes – the latest updates and fixes."><meta itemprop=wordCount content="1636"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.Words for .NET 20.9 Release Notes"><meta name=twitter:description content="Aspose.Words for .NET 20.9 Release Notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/words/>Aspose.Words Product Family</a><span class=divider></span></li><li><a href=/words/net/>Aspose.Words for .NET</a><span class=divider></span></li><li><a href=/words/net/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/words/net/release-notes/2020/>2020</a><span class=divider></span></li><li><a href=/words/net/release-notes/2020/aspose-words-for-net-20-9-release-notes/>Aspose.Words for .NET 20.9 Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><div class=container><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section"><div class=box1><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.Words for .NET 20.9 Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><div class="alert alert-primary" role=alert>This page contains release notes for <a href=https://releases.aspose.com/words/net/new-releases/aspose.words-for-.net-20.9/>Aspose.Words for .NET 20.9</a>.</div><h2 id=major-features>Major Features</h2><p>There are 82 improvements and fixes in this regular monthly release. The most notable are:</p><ul><li>VbaReferenceCollection and related types are exposed publicly.</li><li>Implemented support of footnotes upon loading PDF documents.</li><li>Implemented rendering of metafiles with EMF+ containers.</li><li>The FormField font formatting API was extended.</li></ul><h2 id=full-list-of-issues-covering-all-changes-in-this-release>Full List of Issues Covering all Changes in this Release</h2><table><thead><tr><th style=text-align:left>Key</th><th style=text-align:left>Summary</th><th style=text-align:left>Category</th></tr></thead><tbody><tr><td style=text-align:left>WORDSNET-20589</td><td style=text-align:left>PDF to DOCX - footnotes</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-522</td><td style=text-align:left>Allow applying font formatting to FormField as a whole</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-20289</td><td style=text-align:left>Passing correct border parameters through Words-HTML-Words roundtrip</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-13678</td><td style=text-align:left>Provide a way to remove template reference from a Word document</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>WORDSNET-20986</td><td style=text-align:left>&lsquo;Keep with next&rsquo; property is changed after RTF to DOCX conversion</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-19977</td><td style=text-align:left>Aspose.Words 20.2.0 does not work in Alpine Linux container</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-20868</td><td style=text-align:left>UnsupportedFileFormatException while loading RTF</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>WORDSNET-14910</td><td style=text-align:left>Nesting a Continuous Section Break in a content control tag breaks Aspose?s tree traversal</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20791</td><td style=text-align:left>java.lang.NullPointerException on Mail Merging DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20585</td><td style=text-align:left>Infinite loop with a table in a footnote</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20996</td><td style=text-align:left>OutOfMemoryException when SaveAs document with charts as PNG</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-9660</td><td style=text-align:left>Add tests for different row height rule/vertically merged cell combinations</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20399</td><td style=text-align:left>Image is lost after DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20356</td><td style=text-align:left>Convert DOC to PDF - Bullets getting renumbered</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21014</td><td style=text-align:left>Position of rotated shapes with a relative size is incorrect</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-14444</td><td style=text-align:left>Shape flip is missing after re-saving document</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20489</td><td style=text-align:left>Incorrect text flow for a paragraph wrapped around a floater</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-21019</td><td style=text-align:left>Incorrect width of cells after import from RTF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20496</td><td style=text-align:left>Some text in &lsquo;TestJira13969&rsquo; aligned incorrectly</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20601</td><td style=text-align:left>Incorrect text wrapping for a line started with the sequence of spaces in compatibility mode</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17533</td><td style=text-align:left>Incorrect vertical position of the text in the cell</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18261</td><td style=text-align:left>DOCX to PDF conversion issue with table rendering</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-5808</td><td style=text-align:left>Header format is lost after conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-17815</td><td style=text-align:left>Some Arabic characters are improperly rendered to another font</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-11384</td><td style=text-align:left>Vertically merged cell contents is not broken correctly when the cell is broken in 2013 mode</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-14369</td><td style=text-align:left>Relations between linked textbox are broken after re-saving document</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-19094</td><td style=text-align:left>DOCX to Epub convertion -> NCX-identifier does not match OPF identifier</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20258</td><td style=text-align:left>DOC to HTML throws System.InvalidOperationException</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20370</td><td style=text-align:left>Extra spaces are created after links when ODT is re-saved</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20727</td><td style=text-align:left>Text order changed when converting word to PDF using 20.6</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20744</td><td style=text-align:left>Chart data labels are lost after DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20621</td><td style=text-align:left>[LINQ Reporting Engine] Cannot access value when child and parent has the same name</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20327</td><td style=text-align:left>DOCX to HTML - Single Table represented by 11 Tables in HTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20530</td><td style=text-align:left>Text and footnotes pushed to the next page - convert to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20823</td><td style=text-align:left>Insert and Delete Revisions appear against Image when Comparing similar Documents</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20771</td><td style=text-align:left>Numbers are reversed after DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-19889</td><td style=text-align:left>System.InvalidOperationException is thrown while saving HTML to DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20085</td><td style=text-align:left>HTML to DOCX throw exception</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20839</td><td style=text-align:left>FileCorruptedException occurs upon loading a DOCX - Unexpected ST_TrueFalse value</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20840</td><td style=text-align:left>Extra space created during Load and Save a DOC</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-19942</td><td style=text-align:left>Conversion from RTF cutting off page and losing data</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20845</td><td style=text-align:left>The document appears to be corrupted and cannot be loaded</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20662</td><td style=text-align:left>Incorrect breaking of a vertically merged cell when first cell content does not fit</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20847</td><td style=text-align:left>NullReferenceException when saving a document page as HTML</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20848</td><td style=text-align:left>System.ArgumentException when import node from another document</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20850</td><td style=text-align:left>System.ArgumentNullException throws when convert attached ODT document to TXT</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20579</td><td style=text-align:left>Incorrect numbering during Word to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20804</td><td style=text-align:left>Footer text lost during open/save a DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20630</td><td style=text-align:left>Textbox&rsquo;s text does not move to next linked Textbox</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20862</td><td style=text-align:left>Text position changed after DOCX to PDF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20867</td><td style=text-align:left>System.InvalidCastException while loading RTF files</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20872</td><td style=text-align:left>Incorret rendering of the legend items</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20873</td><td style=text-align:left>Incorrect rendering of the data label markers</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20869</td><td style=text-align:left>Embedded Excel have dif. bits after extraction</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20674</td><td style=text-align:left>PDF Conversion causes double spacing in header and footer</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20481</td><td style=text-align:left>Vertical Chinese Text in Table Cell Lost during Rendering</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20883</td><td style=text-align:left>System.InvalidOperationException occurs upon DOC to RTF conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20810</td><td style=text-align:left>Condition with removeif tag failed with Aspose.Words 20.7</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20887</td><td style=text-align:left>DOCX to PDF conversion issue with David font rendering</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20602</td><td style=text-align:left>Content Controls Lost during loading and saving a DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20914</td><td style=text-align:left>Aspose.Words.FileCorruptedException occurs upon HTML to PDF Conversion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20918</td><td style=text-align:left>List item&rsquo;s formatting is incorrect after DOCX->HTML->DOCX round-trip</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20926</td><td style=text-align:left>System.NullReferenceException is thrown while saving RTF to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20928</td><td style=text-align:left>Aspose.Words.FileCorruptedException occurs upon loading a DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20932</td><td style=text-align:left>System.InvalidOperationException is thrown while saving DOC to DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20929</td><td style=text-align:left>Document.UpdateFields does not update the TOC correctly</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-14743</td><td style=text-align:left>Content control is split into two once child document content is inserted</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20957</td><td style=text-align:left>Stack Overflow observed during processing a DOC</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20962</td><td style=text-align:left>Additional pages appear in output PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18318</td><td style=text-align:left>Export correct styles for list items using Node.ToString</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20614</td><td style=text-align:left>Space between ）and ：Chinese charterers increased in PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20637</td><td style=text-align:left>System.ArgumentOutOfRangeException is thrown by LINQ Reporting engine</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-13509</td><td style=text-align:left>Incorrect breaking of vertically merged cell contents</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-14951</td><td style=text-align:left>Content Controls lost during open/save a DOCX</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-14742</td><td style=text-align:left>Content control is getting deleted while merging two documents</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18284</td><td style=text-align:left>Content of nested table is not rendered correctly in output PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-18285</td><td style=text-align:left>Text of the table&rsquo;s cell does not render correctly in output PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-5535</td><td style=text-align:left>Space characters take too little space in the rendered output</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20849</td><td style=text-align:left>UpdatePageLayout throws System.Runtime.InteropServices.ExternalException</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-20194</td><td style=text-align:left>Layout API returns incorrect position for GroupShape and Shapes</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-3493</td><td style=text-align:left>Checkboxes are rendered incorrectly</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>WORDSNET-4066</td><td style=text-align:left>Incorrect floating table position</td><td style=text-align:left>Bug</td></tr></tbody></table><h2 id=public-api-and-backward-incompatible-changes>Public API and Backward Incompatible Changes</h2><p>This section lists public API changes that were introduced in Aspose.Words 20.9. It includes not only new and obsoleted public methods, but also a description of any changes in the behavior behind the scenes in Aspose.Words which may affect existing code. Any behavior introduced that could be seen as regression and modifies existing behavior is especially important and is documented here.</p><h3 id=changed-the-behavior-of-the-formfieldfont-property>Changed the behavior of the FormField.Font property</h3><p>Related issue: WORDSNET-522
Changed the behavior of the &lsquo;FormField.Font&rsquo; property.
It is currently allowed to apply font formatting to the FormField as a whole.
When new Font properties are set, they take effect for the entire FormField, including the field value.</p><p>Use Case. Explains how to apply font formatting to the FormField as a whole:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Document doc = <span style=color:#66d9ef>new</span> Document(<span style=color:#e6db74>&#34;in.doc&#34;</span>);
</span></span><span style=display:flex><span>doc.Range.FormFields[<span style=color:#ae81ff>0</span>].Font.Size = <span style=color:#ae81ff>20</span>;
</span></span><span style=display:flex><span>doc.Range.FormFields[<span style=color:#ae81ff>0</span>].Font.Color = Color.Red;
</span></span><span style=display:flex><span>doc.Save(<span style=color:#e6db74>&#34;out.doc&#34;</span>);</span></span></code></pre></div></p><h3 id=deprecated-find-replace-algorithm-returned-for-compatibility-reason>Deprecated find replace algorithm returned for compatibility reason</h3><p>Related issue: WORDSNET-21018
Following member has been added to FindReplaceOptions class<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Gets or sets a boolean value indicating that old find/replace algorithm is used.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Use this flag if you need exactly the same behavior as before advanced find/replace feature was introduced.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Note that old algorithm does not support advanced features such as replace with breaks, apply formatting and so on.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>bool</span> LegacyMode { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }</span></span></code></pre></div></p><h3 id=vbareferencecollection-and-related-types-are-exposed-publicly>VbaReferenceCollection and related types are exposed publicly</h3><p>Related issue: WORDSNET-13678</p><p>Implemented a new VbaReferenceCollection class:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Represents a collection of &lt;see cref=&#34;VbaReference&#34;/&gt; objects.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>sealed</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>VbaReferenceCollection</span> : IEnumerable&lt;VbaReference&gt;
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// Removes the first occurrence of a specified VbaReference item from the collection. </span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Remove(VbaReference item)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// Removes the VbaReference element at the specified index of the collection. </span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> RemoveAt(<span style=color:#66d9ef>int</span> index)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// Returns the number of VBA references in the collection.</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Count
</span></span><span style=display:flex><span>}</span></span></code></pre></div></p><p>Implemented a new VbaReference class:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Implements a reference to an Automation type library or VBA project.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>VbaReference</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// Gets &lt;see cref=&#34;VbaReferenceType&#34;/&gt; object that indicates the type of reference that a VbaReference object represents.</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> VbaReferenceType Type { <span style=color:#66d9ef>get</span>; }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// Gets a string value containing the identifier of an Automation type library.</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// Depending on reference type, the value of this property can be:</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &lt;list type=&#34;bullet&#34;&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &lt;item&gt;a LibidReference specified at 2.1.1.8 LibidReference of [MS-OVBA]:</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &lt;item&gt;a ProjectReference specified at 2.1.1.12 ProjectReference of [MS-OVBA]:</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &lt;/list&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>abstract</span> <span style=color:#66d9ef>string</span> LibId { <span style=color:#66d9ef>get</span>; }
</span></span><span style=display:flex><span>}</span></span></code></pre></div></p><p>Implemented a new public enum VbaReferenceType:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Allows to specify the type of a &lt;see cref=&#34;VbaReference&#34;/&gt; object.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>enum</span> VbaReferenceType</span></span></code></pre></div></p><p>Added a new public property into VbaProject class:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Gets a collection of VBA project references.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> VbaReferenceCollection References</span></span></code></pre></div></p><p>Use Case. Explains how to remove some reference from the collection of references of VbaProject:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> Main()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    Document doc = <span style=color:#66d9ef>new</span> Document(<span style=color:#e6db74>&#34;test.doc&#34;</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Find and remove the reference with some LibId path.</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>string</span> brokenPath = <span style=color:#e6db74>&#34;brokenPath.dll&#34;</span>;
</span></span><span style=display:flex><span>    VbaReferenceCollection references = doc.VbaProject.References;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i = references.Count - <span style=color:#ae81ff>1</span>; i &gt;= <span style=color:#ae81ff>0</span>; i--)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        VbaReference reference = doc.VbaProject.References[i];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>string</span> path = GetLibIdPath(reference);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (path == brokenPath)
</span></span><span style=display:flex><span>            references.RemoveAt(i);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    doc.Save(<span style=color:#e6db74>&#34;NoBrokenRef.doc&#34;</span>); 
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Returns string representing LibId path of a specified reference. </span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>string</span> GetLibIdPath(VbaReference reference)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> (reference.Type)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> VbaReferenceType.Registered:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> VbaReferenceType.Original:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> VbaReferenceType.Control:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> GetLibIdReferencePath(reference.LibId);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> VbaReferenceType.Project:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> GetLibIdProjectPath(reference.LibId);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>default</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> ArgumentOutOfRangeException();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Returns path from a specified identifier of an Automation type library.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Please see details for the syntax at [MS-OVBA], 2.1.1.8 LibidReference. </span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>string</span> GetLibIdReferencePath(<span style=color:#66d9ef>string</span> libIdReference)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (libIdReference != <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>string</span>[] refParts = libIdReference.Split(<span style=color:#e6db74>&#39;#&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (refParts.Length &gt; <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> refParts[<span style=color:#ae81ff>3</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Returns path from a specified identifier of an Automation type library.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Please see details for the syntax at [MS-OVBA], 2.1.1.12 ProjectReference. </span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/remarks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>string</span> GetLibIdProjectPath(<span style=color:#66d9ef>string</span> libIdProject)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> (libIdProject != <span style=color:#66d9ef>null</span>) ? libIdProject.Substring(<span style=color:#ae81ff>3</span>) : <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>}</span></span></code></pre></div></p></p></div></div></div></div><hr></div></div></section></div></div></div></div></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>