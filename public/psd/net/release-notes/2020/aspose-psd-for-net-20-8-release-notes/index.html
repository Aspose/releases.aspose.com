<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.PSD for .NET 20.8 - Release Notes</title><meta name=description content="Aspose.PSD for .NET 20.8 - Release Notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/psd/net/release-notes/2020/aspose-psd-for-net-20-8-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/psd/net/release-notes/2020/aspose-psd-for-net-20-8-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.PSD for .NET 20.8 - Release Notes "><meta property="og:description" content="Aspose.PSD for .NET 20.8 - Release Notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/psd/net/release-notes/2020/aspose-psd-for-net-20-8-release-notes/"><meta itemprop=name content="Aspose.PSD for .NET 20.8 - Release Notes"><meta itemprop=description content="Aspose.PSD for .NET 20.8 - Release Notes – the latest updates and fixes."><meta itemprop=wordCount content="1638"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.PSD for .NET 20.8 - Release Notes"><meta name=twitter:description content="Aspose.PSD for .NET 20.8 - Release Notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/psd/>Aspose.PSD Product Family</a><span class=divider></span></li><li><a href=/psd/net/>Aspose.PSD for .NET</a><span class=divider></span></li><li><a href=/psd/net/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/psd/net/release-notes/2020/>2020</a><span class=divider></span></li><li><a href=/psd/net/release-notes/2020/aspose-psd-for-net-20-8-release-notes/>Aspose.PSD for .NET 20.8 - Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><div class=container><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section"><div class=box1><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.PSD for .NET 20.8 - Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><div class="alert alert-primary" role=alert>This page contains release notes for <a href=https://www.nuget.org/packages/Aspose.PSD/>Aspose.PSD for .NET 20.8</a></div><table><thead><tr><th style=text-align:left><strong>Key</strong></th><th style=text-align:left><strong>Summary</strong></th><th style=text-align:left><strong>Category</strong></th></tr></thead><tbody><tr><td style=text-align:left>PSDNET-390</td><td style=text-align:left>Support of PlLdResource (placed layer resource for Smart Object Layer)</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>PSDNET-400</td><td style=text-align:left>Support of SoLdResource (Smart Object Layer Data resource)</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>PSDNET-693</td><td style=text-align:left>Add Object Array and Unit Array structures support: ObAr / UnFl signatures</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>PSDNET-600</td><td style=text-align:left>Fix saving modified PSD image with CMYK ColorMode 16 bit per channel</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDNET-664</td><td style=text-align:left>Underline and strikethrough lost after focusing on the text in file saved with Aspose.PSD</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDNET-710</td><td style=text-align:left>Regression: Aspose.PSD 20.7.0 breaks font sizes for older files</td><td style=text-align:left>Bug</td></tr></tbody></table><h2 id=public-api-changes><strong>Public API Changes</strong></h2><h1 id=added-apis><strong>Added APIs:</strong></h1><ul><li>M:Aspose.PSD.FileFormats.Psd.Layers.FillLayers.FillLayer.ReplaceNonTransparentColors(System.Int32)</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.ClassID.#ctor(System.Byte[],System.Boolean)</li><li>T:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.ObjectArrayStructure</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.ObjectArrayStructure.#ctor(System.String,System.String,Aspose.PSD.FileFormats.Psd.Layers.LayerResources.OSTypeStructure[])</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.ObjectArrayStructure.#ctor(System.Int32,Aspose.PSD.FileFormats.Psd.Layers.LayerResources.ClassID,Aspose.PSD.FileFormats.Psd.Layers.LayerResources.ClassID,System.String,Aspose.PSD.FileFormats.Psd.Layers.LayerResources.OSTypeStructure[])</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.ObjectArrayStructure.Key</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.ObjectArrayStructure.StructureCount</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.ObjectArrayStructure.ClassName</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.ObjectArrayStructure.ClassID</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.ObjectArrayStructure.Structures</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.ObjectArrayStructure.Length</li><li>F:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.ObjectArrayStructure.StructureKey</li><li>T:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.UnitArrayStructure</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.UnitArrayStructure.#ctor(Aspose.PSD.FileFormats.Psd.Layers.LayerResources.ClassID,Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.UnitTypes,System.Double[])</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.UnitArrayStructure.UnitType</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.UnitArrayStructure.Values</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.UnitArrayStructure.ValueCount</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.UnitArrayStructure.Key</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.UnitArrayStructure.Length</li><li>F:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.TypeToolInfoStructures.UnitArrayStructure.StructureKey</li><li>T:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.#ctor(System.Guid,System.Boolean)</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Version</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.UniqueId</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.IsCustom</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.PageNumber</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.TotalPages</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.AntiAliasPolicy</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.PlacedLayerType</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Left</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Top</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Right</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Bottom</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Bounds</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.TransformMatrix</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.HorizontalMeshPoints</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.VerticalMeshPoints</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.HorizontalMeshPointUnit</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.VerticalMeshPointUnit</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Signature</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Key</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Length</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.PsdVersion</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Value</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Perspective</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.PerspectiveOther</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.UOrder</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.VOrder</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Items</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Save(Aspose.PSD.StreamContainer,System.Int32)</li><li>F:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.TypeToolKey</li><li>T:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedLayerType</li><li>F:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedLayerType.Unknown</li><li>F:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedLayerType.Vector</li><li>F:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedLayerType.Raster</li><li>F:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedLayerType.ImageStack</li><li>T:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.Version</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.UniqueId</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.IsCustom</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.PageNumber</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.TotalPages</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.AntiAliasPolicy</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.PlacedLayerType</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.Left</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.Top</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.Right</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.Bottom</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.Bounds</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.TransformMatrix</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.HorizontalMeshPoints</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.VerticalMeshPoints</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.HorizontalMeshPointUnit</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.VerticalMeshPointUnit</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.Value</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.Perspective</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.PerspectiveOther</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.UOrder</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.VOrder</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.IPlacedLayerResource.Items</li><li>T:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.#ctor(System.Guid,System.Boolean,System.Boolean)</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.CompId</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.OriginalCompId</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Version</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.UniqueId</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.PlacedId</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.IsCustom</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.PageNumber</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.TotalPages</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.AntiAliasPolicy</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.PlacedLayerType</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Left</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Top</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Right</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Bottom</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Bounds</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.TransformMatrix</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.NonAffineTransformMatrix</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.HorizontalMeshPoints</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.VerticalMeshPoints</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.HorizontalMeshPointUnit</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.VerticalMeshPointUnit</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Signature</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Key</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Length</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.PsdVersion</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Value</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Perspective</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.PerspectiveOther</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.UOrder</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.VOrder</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Items</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Crop</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.FrameCount</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Resolution</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.ResolutionUnit</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Comp</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Width</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Height</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.FrameStepNumerator</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.FrameStepDenominator</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.DurationNumerator</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.DurationDenominator</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Save(Aspose.PSD.StreamContainer,System.Int32)</li><li>F:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.TypeToolKey</li></ul><h1 id=removed-apis><strong>Removed APIs:</strong></h1><ul><li>None</li></ul><h2 id=usage-examples><strong>Usage examples:</strong></h2><p><strong>PSDNET-390. Support of PlLdResource (placed layer resource for Smart Object Layer)</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>        <span style=color:#66d9ef>void</span> AssertAreEqual(<span style=color:#66d9ef>object</span> actual, <span style=color:#66d9ef>object</span> expected)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> areEqual = <span style=color:#66d9ef>object</span>.Equals(actual, expected);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (!areEqual &amp;&amp; actual <span style=color:#66d9ef>is</span> Array &amp;&amp; expected <span style=color:#66d9ef>is</span> Array)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> actualArray = (Array)actual;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> expectedArray = (Array)actual;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (actualArray.Length == expectedArray.Length)
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i = <span style=color:#ae81ff>0</span>; i &lt; actualArray.Length; i++)
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> (!<span style=color:#66d9ef>object</span>.Equals(actualArray.GetValue(i), expectedArray.GetValue(i)))
</span></span><span style=display:flex><span>                        {
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    areEqual = <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (!areEqual)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> FormatException(
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>string</span>.Format(<span style=color:#e6db74>&#34;Actual value {0} are not equal to expected {1}.&#34;</span>, actual, expected));
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>string</span> dataDir = <span style=color:#e6db74>&#34;PSDNET390_1\\&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> sourceFilePath = dataDir + <span style=color:#e6db74>&#34;LayeredSmartObjects8bit2.psd&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> outputFilePath = dataDir + <span style=color:#e6db74>&#34;LayeredSmartObjects8bit2_output.psd&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> expectedValues = <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>object</span>[]
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>object</span>[]
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;76f05a3b-7523-5e42-a1bb-27f4735bffa0&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0x10</span>,
</span></span><span style=display:flex><span>                PlacedLayerType.Raster,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>29.937922786050663</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>95.419959734187131</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>126.85445817782261</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>1.0540625423957124</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>172.20861031651307</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>47.634102808208553</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>75.292074924741144</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>142</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>149d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>310d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                UnitTypes.Pixels,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>16</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0d</span>, <span style=color:#ae81ff>103.33333333333333d</span>, <span style=color:#ae81ff>206.66666666666666d</span>, <span style=color:#ae81ff>310.0d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0d</span>, <span style=color:#ae81ff>103.33333333333333d</span>, <span style=color:#ae81ff>206.66666666666666d</span>, <span style=color:#ae81ff>310.0d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0d</span>, <span style=color:#ae81ff>103.33333333333333d</span>, <span style=color:#ae81ff>206.66666666666666d</span>, <span style=color:#ae81ff>310.0d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0d</span>, <span style=color:#ae81ff>103.33333333333333d</span>, <span style=color:#ae81ff>206.66666666666666d</span>, <span style=color:#ae81ff>310.0d</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                UnitTypes.Pixels,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>16</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0d</span>, <span style=color:#ae81ff>0.0d</span>, <span style=color:#ae81ff>0.0d</span>, <span style=color:#ae81ff>0.0d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>49.666666666666664d</span>, <span style=color:#ae81ff>49.666666666666664d</span>, <span style=color:#ae81ff>49.666666666666664d</span>, <span style=color:#ae81ff>49.666666666666664d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>99.333333333333329d</span>, <span style=color:#ae81ff>99.333333333333329d</span>, <span style=color:#ae81ff>99.333333333333329d</span>, <span style=color:#ae81ff>99.333333333333329d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>149</span>, <span style=color:#ae81ff>149</span>, <span style=color:#ae81ff>149</span>, <span style=color:#ae81ff>149</span>,
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>object</span>[]
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;cf0477a8-8f92-ac4f-9462-f78e26234851&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0x10</span>,
</span></span><span style=display:flex><span>                PlacedLayerType.Raster,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>37.900314592235681</span>,
</span></span><span style=display:flex><span>                    -<span style=color:#ae81ff>0.32118219433001371</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>185.94210608826535</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>57.7076819802063</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>153.32047433609358</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>140.9311755779743</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>5.2786828400639294</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>82.902311403437977</span>,
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>721d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1280d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                UnitTypes.Pixels,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>16</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>426.66666666666663</span>, <span style=color:#ae81ff>853.33333333333326</span>, <span style=color:#ae81ff>1280</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>426.66666666666663</span>, <span style=color:#ae81ff>853.33333333333326</span>, <span style=color:#ae81ff>1280</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>426.66666666666663</span>, <span style=color:#ae81ff>853.33333333333326</span>, <span style=color:#ae81ff>1280</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>426.66666666666663</span>, <span style=color:#ae81ff>853.33333333333326</span>, <span style=color:#ae81ff>1280</span>,
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                UnitTypes.Pixels,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>16</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>240.33333333333331</span>, <span style=color:#ae81ff>240.33333333333331</span>, <span style=color:#ae81ff>240.33333333333331</span>, <span style=color:#ae81ff>240.33333333333331</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>480.66666666666663</span>, <span style=color:#ae81ff>480.66666666666663</span>, <span style=color:#ae81ff>480.66666666666663</span>, <span style=color:#ae81ff>480.66666666666663</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>721</span>, <span style=color:#ae81ff>721</span>, <span style=color:#ae81ff>721</span>, <span style=color:#ae81ff>721</span>,
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>using</span> (PsdImage image = (PsdImage)Image.Load(sourceFilePath))
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            PlLdResource resource = <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> index = <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>foreach</span> (Layer imageLayer <span style=color:#66d9ef>in</span> image.Layers)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>foreach</span> (<span style=color:#66d9ef>var</span> imageResource <span style=color:#66d9ef>in</span> imageLayer.Resources)
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    resource = imageResource <span style=color:#66d9ef>as</span> PlLdResource;
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (resource != <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>var</span> expectedValue = (<span style=color:#66d9ef>object</span>[])expectedValues[index++];
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>0</span>], resource.IsCustom);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>1</span>], resource.UniqueId.ToString());
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>2</span>], resource.PageNumber);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>3</span>], resource.TotalPages);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>4</span>], resource.AntiAliasPolicy);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>5</span>], resource.PlacedLayerType);
</span></span><span style=display:flex><span>                        AssertAreEqual(<span style=color:#ae81ff>8</span>, resource.TransformMatrix.Length);
</span></span><span style=display:flex><span>                        AssertAreEqual((<span style=color:#66d9ef>double</span>[])expectedValue[<span style=color:#ae81ff>6</span>], resource.TransformMatrix);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>7</span>], resource.Value);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>8</span>], resource.Perspective);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>9</span>], resource.PerspectiveOther);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>10</span>], resource.Top);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>11</span>], resource.Left);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>12</span>], resource.Bottom);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>13</span>], resource.Right);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>14</span>], resource.UOrder);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>15</span>], resource.VOrder);
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> (resource.IsCustom)
</span></span><span style=display:flex><span>                        {
</span></span><span style=display:flex><span>                            AssertAreEqual(expectedValue[<span style=color:#ae81ff>16</span>], resource.HorizontalMeshPointUnit);
</span></span><span style=display:flex><span>                            AssertAreEqual((<span style=color:#66d9ef>double</span>[])expectedValue[<span style=color:#ae81ff>17</span>], resource.HorizontalMeshPoints);
</span></span><span style=display:flex><span>                            AssertAreEqual(expectedValue[<span style=color:#ae81ff>18</span>], resource.VerticalMeshPointUnit);
</span></span><span style=display:flex><span>                            AssertAreEqual((<span style=color:#66d9ef>double</span>[])expectedValue[<span style=color:#ae81ff>19</span>], resource.VerticalMeshPoints);
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>var</span> temp = resource.VerticalMeshPoints;
</span></span><span style=display:flex><span>                            resource.VerticalMeshPoints = resource.HorizontalMeshPoints;
</span></span><span style=display:flex><span>                            resource.HorizontalMeshPoints = temp;
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                            resource.PageNumber = <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>                            resource.TotalPages = <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>                            resource.AntiAliasPolicy = <span style=color:#ae81ff>30</span>;
</span></span><span style=display:flex><span>                            resource.Value = <span style=color:#ae81ff>1.23456789</span>;
</span></span><span style=display:flex><span>                            resource.Perspective = <span style=color:#ae81ff>0.123456789</span>;
</span></span><span style=display:flex><span>                            resource.PerspectiveOther = <span style=color:#ae81ff>0.987654321</span>;
</span></span><span style=display:flex><span>                            resource.Top = -<span style=color:#ae81ff>126</span>;
</span></span><span style=display:flex><span>                            resource.Left = -<span style=color:#ae81ff>215</span>;
</span></span><span style=display:flex><span>                            resource.Bottom = <span style=color:#ae81ff>248</span>;
</span></span><span style=display:flex><span>                            resource.Right = <span style=color:#ae81ff>145</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                            <span style=color:#75715e>// Be careful with some parameters: image may became unreadable by Adobe® Photoshop®</span>
</span></span><span style=display:flex><span>                            <span style=color:#75715e>////resource.UOrder = 6;</span>
</span></span><span style=display:flex><span>                            <span style=color:#75715e>////resource.VOrder = 9;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                            <span style=color:#75715e>// Do no change this otherwise you won&#39;t be able to use free transform</span>
</span></span><span style=display:flex><span>                            <span style=color:#75715e>// or change the underlining smart object to the vector type</span>
</span></span><span style=display:flex><span>                            <span style=color:#75715e>////resource.PlacedLayerType = PlacedLayerType.Vector;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                            <span style=color:#75715e>// There should be valid PlLdResource with this unique Id</span>
</span></span><span style=display:flex><span>                            <span style=color:#75715e>////resource.UniqueId = new Guid(&#34;98765432-10fe-cba0-1234-56789abcdef0&#34;);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            AssertAreEqual(<span style=color:#66d9ef>true</span>, resource != <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>            image.Save(outputFilePath, <span style=color:#66d9ef>new</span> PsdOptions(image));
</span></span><span style=display:flex><span>        }</span></span></code></pre></div><strong>PSDNET-400. Support of SoLdResource (Smart Object Layer Data resource)</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>        <span style=color:#75715e>// This example shows how to get or set the smart object layer data properties of the PSD file.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span> AssertAreEqual(<span style=color:#66d9ef>object</span> actual, <span style=color:#66d9ef>object</span> expected)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> areEqual = <span style=color:#66d9ef>object</span>.Equals(actual, expected);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (!areEqual &amp;&amp; actual <span style=color:#66d9ef>is</span> Array &amp;&amp; expected <span style=color:#66d9ef>is</span> Array)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> actualArray = (Array)actual;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> expectedArray = (Array)actual;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (actualArray.Length == expectedArray.Length)
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i = <span style=color:#ae81ff>0</span>; i &lt; actualArray.Length; i++)
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> (!<span style=color:#66d9ef>object</span>.Equals(actualArray.GetValue(i), expectedArray.GetValue(i)))
</span></span><span style=display:flex><span>                        {
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    areEqual = <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (!areEqual)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> FormatException(
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>string</span>.Format(<span style=color:#e6db74>&#34;Actual value {0} are not equal to expected {1}.&#34;</span>, actual, expected));
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>string</span> dataDir = <span style=color:#e6db74>&#34;PSDNET400_1\\&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> sourceFilePath = dataDir + <span style=color:#e6db74>&#34;LayeredSmartObjects8bit2.psd&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> outputFilePath = dataDir + <span style=color:#e6db74>&#34;LayeredSmartObjects8bit2_output.psd&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> expectedValues = <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>object</span>[]
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>object</span>[]
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;76f05a3b-7523-5e42-a1bb-27f4735bffa0&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0x10</span>,
</span></span><span style=display:flex><span>                PlacedLayerType.Raster,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>29.937922786050663</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>95.419959734187131</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>126.85445817782261</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>1.0540625423957124</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>172.20861031651307</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>47.634102808208553</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>75.292074924741144</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>142</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0.0</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0.0</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0.0</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>149d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>310d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>600</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>600</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>310d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>149d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>72d</span>,
</span></span><span style=display:flex><span>                UnitTypes.Density,
</span></span><span style=display:flex><span>                -<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                -<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                -<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;d3388655-19e4-9742-82f2-f553bb01046a&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>29.937922786050663</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>95.419959734187131</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>126.85445817782261</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>1.0540625423957124</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>172.20861031651307</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>47.634102808208553</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>75.292074924741144</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>142</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                UnitTypes.Pixels,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>16</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0d</span>, <span style=color:#ae81ff>103.33333333333333d</span>, <span style=color:#ae81ff>206.66666666666666d</span>, <span style=color:#ae81ff>310.0d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0d</span>, <span style=color:#ae81ff>103.33333333333333d</span>, <span style=color:#ae81ff>206.66666666666666d</span>, <span style=color:#ae81ff>310.0d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0d</span>, <span style=color:#ae81ff>103.33333333333333d</span>, <span style=color:#ae81ff>206.66666666666666d</span>, <span style=color:#ae81ff>310.0d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0d</span>, <span style=color:#ae81ff>103.33333333333333d</span>, <span style=color:#ae81ff>206.66666666666666d</span>, <span style=color:#ae81ff>310.0d</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                UnitTypes.Pixels,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>16</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0d</span>, <span style=color:#ae81ff>0.0d</span>, <span style=color:#ae81ff>0.0d</span>, <span style=color:#ae81ff>0.0d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>49.666666666666664d</span>, <span style=color:#ae81ff>49.666666666666664d</span>, <span style=color:#ae81ff>49.666666666666664d</span>, <span style=color:#ae81ff>49.666666666666664d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>99.333333333333329d</span>, <span style=color:#ae81ff>99.333333333333329d</span>, <span style=color:#ae81ff>99.333333333333329d</span>, <span style=color:#ae81ff>99.333333333333329d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>149</span>, <span style=color:#ae81ff>149</span>, <span style=color:#ae81ff>149</span>, <span style=color:#ae81ff>149</span>,
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>object</span>[]
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;cf0477a8-8f92-ac4f-9462-f78e26234851&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0x10</span>,
</span></span><span style=display:flex><span>                PlacedLayerType.Raster,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>37.900314592235681</span>,
</span></span><span style=display:flex><span>                    -<span style=color:#ae81ff>0.32118219433001371</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>185.94210608826535</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>57.7076819802063</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>153.32047433609358</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>140.9311755779743</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>5.2786828400639294</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>82.902311403437977</span>,
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0.0</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0.0</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0.0</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>721d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1280d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>600</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>600</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1280d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>721d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>72d</span>,
</span></span><span style=display:flex><span>                UnitTypes.Density,
</span></span><span style=display:flex><span>                -<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                -<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                -<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;625cc4b9-2c5f-344f-8636-03caf2bd3489&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>37.900314592235681</span>,
</span></span><span style=display:flex><span>                    -<span style=color:#ae81ff>0.32118219433001371</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>185.94210608826535</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>57.7076819802063</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>153.32047433609358</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>140.9311755779743</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>5.2786828400639294</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>82.902311403437977</span>,
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                UnitTypes.Pixels,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>16</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>426.66666666666663</span>, <span style=color:#ae81ff>853.33333333333326</span>, <span style=color:#ae81ff>1280</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>426.66666666666663</span>, <span style=color:#ae81ff>853.33333333333326</span>, <span style=color:#ae81ff>1280</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>426.66666666666663</span>, <span style=color:#ae81ff>853.33333333333326</span>, <span style=color:#ae81ff>1280</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>426.66666666666663</span>, <span style=color:#ae81ff>853.33333333333326</span>, <span style=color:#ae81ff>1280</span>,
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                UnitTypes.Pixels,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>16</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>, <span style=color:#ae81ff>0.0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>240.33333333333331</span>, <span style=color:#ae81ff>240.33333333333331</span>, <span style=color:#ae81ff>240.33333333333331</span>, <span style=color:#ae81ff>240.33333333333331</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>480.66666666666663</span>, <span style=color:#ae81ff>480.66666666666663</span>, <span style=color:#ae81ff>480.66666666666663</span>, <span style=color:#ae81ff>480.66666666666663</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>721</span>, <span style=color:#ae81ff>721</span>, <span style=color:#ae81ff>721</span>, <span style=color:#ae81ff>721</span>,
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>using</span> (PsdImage image = (PsdImage)Image.Load(sourceFilePath))
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            SoLdResource resource = <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> index = <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>foreach</span> (Layer imageLayer <span style=color:#66d9ef>in</span> image.Layers)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>foreach</span> (<span style=color:#66d9ef>var</span> imageResource <span style=color:#66d9ef>in</span> imageLayer.Resources)
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    resource = imageResource <span style=color:#66d9ef>as</span> SoLdResource;
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (resource != <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>var</span> expectedValue = (<span style=color:#66d9ef>object</span>[])expectedValues[index++];
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>0</span>], resource.IsCustom);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>1</span>], resource.UniqueId.ToString());
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>2</span>], resource.PageNumber);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>3</span>], resource.TotalPages);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>4</span>], resource.AntiAliasPolicy);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>5</span>], resource.PlacedLayerType);
</span></span><span style=display:flex><span>                        AssertAreEqual(<span style=color:#ae81ff>8</span>, resource.TransformMatrix.Length);
</span></span><span style=display:flex><span>                        AssertAreEqual((<span style=color:#66d9ef>double</span>[])expectedValue[<span style=color:#ae81ff>6</span>], resource.TransformMatrix);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>7</span>], resource.Value);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>8</span>], resource.Perspective);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>9</span>], resource.PerspectiveOther);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>10</span>], resource.Top);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>11</span>], resource.Left);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>12</span>], resource.Bottom);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>13</span>], resource.Right);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>14</span>], resource.UOrder);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>15</span>], resource.VOrder);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>16</span>], resource.Crop);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>17</span>], resource.FrameStepNumerator);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>18</span>], resource.FrameStepDenominator);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>19</span>], resource.DurationNumerator);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>20</span>], resource.DurationDenominator);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>21</span>], resource.FrameCount);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>22</span>], resource.Width);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>23</span>], resource.Height);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>24</span>], resource.Resolution);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>25</span>], resource.ResolutionUnit);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>26</span>], resource.Comp);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>27</span>], resource.CompId);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>28</span>], resource.OriginalCompId);
</span></span><span style=display:flex><span>                        AssertAreEqual(expectedValue[<span style=color:#ae81ff>29</span>], resource.PlacedId.ToString());
</span></span><span style=display:flex><span>                        AssertAreEqual((IEnumerable)expectedValue[<span style=color:#ae81ff>30</span>], resource.NonAffineTransformMatrix);
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> (resource.IsCustom)
</span></span><span style=display:flex><span>                        {
</span></span><span style=display:flex><span>                            AssertAreEqual(expectedValue[<span style=color:#ae81ff>31</span>], resource.HorizontalMeshPointUnit);
</span></span><span style=display:flex><span>                            AssertAreEqual((<span style=color:#66d9ef>double</span>[])expectedValue[<span style=color:#ae81ff>32</span>], resource.HorizontalMeshPoints);
</span></span><span style=display:flex><span>                            AssertAreEqual(expectedValue[<span style=color:#ae81ff>33</span>], resource.VerticalMeshPointUnit);
</span></span><span style=display:flex><span>                            AssertAreEqual((<span style=color:#66d9ef>double</span>[])expectedValue[<span style=color:#ae81ff>34</span>], resource.VerticalMeshPoints);
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>var</span> temp = resource.VerticalMeshPoints;
</span></span><span style=display:flex><span>                            resource.VerticalMeshPoints = resource.HorizontalMeshPoints;
</span></span><span style=display:flex><span>                            resource.HorizontalMeshPoints = temp;
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>// This values should be changed in the PlLdResource (with the specified UniqueId) as well</span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>// and some of them must be in accord with the underlining smart object in the LinkDataSource</span>
</span></span><span style=display:flex><span>                        resource.PageNumber = <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>                        resource.TotalPages = <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>                        resource.AntiAliasPolicy = <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>                        resource.Value = <span style=color:#ae81ff>1.23456789</span>;
</span></span><span style=display:flex><span>                        resource.Perspective = <span style=color:#ae81ff>0.123456789</span>;
</span></span><span style=display:flex><span>                        resource.PerspectiveOther = <span style=color:#ae81ff>0.987654321</span>;
</span></span><span style=display:flex><span>                        resource.Top = -<span style=color:#ae81ff>126</span>;
</span></span><span style=display:flex><span>                        resource.Left = -<span style=color:#ae81ff>215</span>;
</span></span><span style=display:flex><span>                        resource.Bottom = <span style=color:#ae81ff>248</span>;
</span></span><span style=display:flex><span>                        resource.Right = <span style=color:#ae81ff>145</span>;
</span></span><span style=display:flex><span>                        resource.Crop = <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>                        resource.FrameStepNumerator = <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>                        resource.FrameStepDenominator = <span style=color:#ae81ff>601</span>;
</span></span><span style=display:flex><span>                        resource.DurationNumerator = <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>                        resource.DurationDenominator = <span style=color:#ae81ff>602</span>;
</span></span><span style=display:flex><span>                        resource.FrameCount = <span style=color:#ae81ff>11</span>;
</span></span><span style=display:flex><span>                        resource.Width = <span style=color:#ae81ff>541</span>;
</span></span><span style=display:flex><span>                        resource.Height = <span style=color:#ae81ff>249</span>;
</span></span><span style=display:flex><span>                        resource.Resolution = <span style=color:#ae81ff>144</span>;
</span></span><span style=display:flex><span>                        resource.Comp = <span style=color:#ae81ff>21</span>;
</span></span><span style=display:flex><span>                        resource.CompId = <span style=color:#ae81ff>22</span>;
</span></span><span style=display:flex><span>                        resource.TransformMatrix = <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>                        {
</span></span><span style=display:flex><span>                            <span style=color:#ae81ff>12.937922786050663</span>,
</span></span><span style=display:flex><span>                            <span style=color:#ae81ff>19.419959734187131</span>,
</span></span><span style=display:flex><span>                            <span style=color:#ae81ff>2.85445817782261</span>,
</span></span><span style=display:flex><span>                            <span style=color:#ae81ff>1.0540625423957124</span>,
</span></span><span style=display:flex><span>                            <span style=color:#ae81ff>7.20861031651307</span>,
</span></span><span style=display:flex><span>                            <span style=color:#ae81ff>14.634102808208553</span>,
</span></span><span style=display:flex><span>                            <span style=color:#ae81ff>17.292074924741144</span>,
</span></span><span style=display:flex><span>                            <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>                        };
</span></span><span style=display:flex><span>                        resource.NonAffineTransformMatrix = <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>                        {
</span></span><span style=display:flex><span>                            <span style=color:#ae81ff>129.937922786050663</span>,
</span></span><span style=display:flex><span>                            <span style=color:#ae81ff>195.419959734187131</span>,
</span></span><span style=display:flex><span>                            <span style=color:#ae81ff>26.85445817782261</span>,
</span></span><span style=display:flex><span>                            <span style=color:#ae81ff>12.0540625423957124</span>,
</span></span><span style=display:flex><span>                            <span style=color:#ae81ff>72.20861031651307</span>,
</span></span><span style=display:flex><span>                            <span style=color:#ae81ff>147.634102808208553</span>,
</span></span><span style=display:flex><span>                            <span style=color:#ae81ff>175.292074924741144</span>,
</span></span><span style=display:flex><span>                            <span style=color:#ae81ff>42</span>
</span></span><span style=display:flex><span>                        };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>// This unique Id should be changed in references if any</span>
</span></span><span style=display:flex><span>                        resource.PlacedId = <span style=color:#66d9ef>new</span> Guid(<span style=color:#e6db74>&#34;12345678-9abc-def0-9876-54321fecba98&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>// Be careful with some parameters: image may became unreadable by Adobe® Photoshop®</span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>////resource.UOrder = 6;</span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>////resource.VOrder = 9;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>// Do no change this otherwise you won&#39;t be able to use free transform</span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>// or change the underlining smart object to the vector type</span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>////resource.PlacedLayerType = PlacedLayerType.Vector;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>// There should be valid PlLdResource with this unique Id</span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>////resource.UniqueId = new Guid(&#34;98765432-10fe-cba0-1234-56789abcdef0&#34;);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            AssertAreEqual(<span style=color:#66d9ef>true</span>, resource != <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>            image.Save(outputFilePath, <span style=color:#66d9ef>new</span> PsdOptions(image));
</span></span><span style=display:flex><span>        }</span></span></code></pre></div><strong>PSDNET-693. Add Object Array and Unit Array structures support: ObAr / UnFl signatures</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>            <span style=color:#66d9ef>void</span> AssertAreEqual(<span style=color:#66d9ef>object</span> actual, <span style=color:#66d9ef>object</span> expected)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (!<span style=color:#66d9ef>object</span>.Equals(actual, expected))
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> FormatException(<span style=color:#66d9ef>string</span>.Format(<span style=color:#e6db74>&#34;Actual value {0} are not equal to expected {1}.&#34;</span>, actual, expected));
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> dataDir = <span style=color:#e6db74>&#34;PSDNET693_1\\&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> sourceFilePath = dataDir + <span style=color:#e6db74>&#34;LayeredSmartObjects8bit2.psd&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>using</span> (PsdImage image = (PsdImage)Image.Load(sourceFilePath))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                UnitArrayStructure verticalStructure = <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>foreach</span> (Layer imageLayer <span style=color:#66d9ef>in</span> image.Layers)
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>foreach</span> (<span style=color:#66d9ef>var</span> imageResource <span style=color:#66d9ef>in</span> imageLayer.Resources)
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>var</span> resource = imageResource <span style=color:#66d9ef>as</span> PlLdResource;
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> (resource != <span style=color:#66d9ef>null</span> &amp;&amp; resource.IsCustom)
</span></span><span style=display:flex><span>                        {
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>foreach</span> (OSTypeStructure structure <span style=color:#66d9ef>in</span> resource.Items)
</span></span><span style=display:flex><span>                            {
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>if</span> (structure.KeyName.ClassName == <span style=color:#e6db74>&#34;customEnvelopeWarp&#34;</span>)
</span></span><span style=display:flex><span>                                {
</span></span><span style=display:flex><span>                                    AssertAreEqual(<span style=color:#66d9ef>typeof</span>(DescriptorStructure), structure.GetType());
</span></span><span style=display:flex><span>                                    <span style=color:#66d9ef>var</span> custom = (DescriptorStructure)structure;
</span></span><span style=display:flex><span>                                    AssertAreEqual(custom.Structures.Length, <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>                                    <span style=color:#66d9ef>var</span> mesh = custom.Structures[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>                                    AssertAreEqual(<span style=color:#66d9ef>typeof</span>(ObjectArrayStructure), mesh.GetType());
</span></span><span style=display:flex><span>                                    <span style=color:#66d9ef>var</span> meshObjectArray = (ObjectArrayStructure)mesh;
</span></span><span style=display:flex><span>                                    AssertAreEqual(meshObjectArray.Structures.Length, <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>                                    <span style=color:#66d9ef>var</span> vertical = meshObjectArray.Structures[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>                                    AssertAreEqual(<span style=color:#66d9ef>typeof</span>(UnitArrayStructure), vertical.GetType());
</span></span><span style=display:flex><span>                                    verticalStructure = (UnitArrayStructure)vertical;
</span></span><span style=display:flex><span>                                    AssertAreEqual(verticalStructure.UnitType, UnitTypes.Pixels);
</span></span><span style=display:flex><span>                                    AssertAreEqual(verticalStructure.ValueCount, <span style=color:#ae81ff>16</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                                    <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                                }
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                AssertAreEqual(<span style=color:#66d9ef>true</span>, verticalStructure != <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>            }</span></span></code></pre></div><strong>PSDNET-600. Fix saving modified PSD image with CMYK ColorMode 16 bit per channel</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>           <span style=color:#66d9ef>using</span> (PsdImage image = (PsdImage)Image.Load(<span style=color:#e6db74>&#34;cub16bit_cmyk.psd&#34;</span>))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                RasterCachedImage raster = image.Layers[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>                Aspose.PSD.Graphics graphics = <span style=color:#66d9ef>new</span> Graphics(raster);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>int</span> width = raster.Width;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>int</span> height = raster.Height;
</span></span><span style=display:flex><span>                Rectangle rect = <span style=color:#66d9ef>new</span> Rectangle(width / <span style=color:#ae81ff>3</span>, height / <span style=color:#ae81ff>3</span>, width - (<span style=color:#ae81ff>2</span> * (width / <span style=color:#ae81ff>3</span>)) - <span style=color:#ae81ff>1</span>, height - (<span style=color:#ae81ff>2</span> * (height / <span style=color:#ae81ff>3</span>)) - <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>                graphics.DrawRectangle(<span style=color:#66d9ef>new</span> Aspose.PSD.Pen(Color.DarkGray, <span style=color:#ae81ff>1</span>),  rect);
</span></span><span style=display:flex><span>                image.Save(<span style=color:#e6db74>&#34;output.png&#34;</span>, <span style=color:#66d9ef>new</span> PngOptions());
</span></span><span style=display:flex><span>            }</span></span></code></pre></div><strong>PSDNET-664. Underline and strikethrough lost after focusing on the text in file saved with Aspose.PSD</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>            <span style=color:#66d9ef>string</span> sourceFile = <span style=color:#e6db74>&#34;source.psd&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> outputFile = <span style=color:#e6db74>&#34;output.psd&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>using</span> (<span style=color:#66d9ef>var</span> image = (PsdImage)Image.Load(sourceFile))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> layers = image.Layers;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> textLayer = (TextLayer)layers[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                textLayer.TextData.Items[<span style=color:#ae81ff>0</span>].Style.Underline = <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>                textLayer.TextData.Items[<span style=color:#ae81ff>1</span>].Style.Strikethrough = <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                textLayer.TextData.UpdateLayerData();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                image.Save(outputFile, <span style=color:#66d9ef>new</span> PsdOptions(image));
</span></span><span style=display:flex><span>            }</span></span></code></pre></div><strong>PSDNET-710. Regression: Aspose.PSD 20.7.0 breaks font sizes for older files</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>            <span style=color:#66d9ef>string</span> srcFile = <span style=color:#e6db74>&#34;font_size_lost.psd&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> outputFilePng = <span style=color:#e6db74>&#34;output.png&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>using</span> (<span style=color:#66d9ef>var</span> psdImage = (PsdImage)Image.Load(srcFile))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> textLayer = (TextLayer)psdImage.Layers[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>                textLayer.TextData.UpdateLayerData();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                psdImage.Save(outputFilePng, <span style=color:#66d9ef>new</span> PngOptions());
</span></span><span style=display:flex><span>            }</span></span></code></pre></div></p></p></div></div></div></div><hr></div></div></section></div></div></div></div></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>