<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.PSD for .NET 20.9 - Release Notes</title><meta name=description content="Aspose.PSD for .NET 20.9 - Release Notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/psd/net/release-notes/2020/aspose-psd-for-net-20-9-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/psd/net/release-notes/2020/aspose-psd-for-net-20-9-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.PSD for .NET 20.9 - Release Notes "><meta property="og:description" content="Aspose.PSD for .NET 20.9 - Release Notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/psd/net/release-notes/2020/aspose-psd-for-net-20-9-release-notes/"><meta itemprop=name content="Aspose.PSD for .NET 20.9 - Release Notes"><meta itemprop=description content="Aspose.PSD for .NET 20.9 - Release Notes – the latest updates and fixes."><meta itemprop=wordCount content="2679"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.PSD for .NET 20.9 - Release Notes"><meta name=twitter:description content="Aspose.PSD for .NET 20.9 - Release Notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/psd/>Aspose.PSD Product Family</a><span class=divider></span></li><li><a href=/psd/net/>Aspose.PSD for .NET</a><span class=divider></span></li><li><a href=/psd/net/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/psd/net/release-notes/2020/>2020</a><span class=divider></span></li><li><a href=/psd/net/release-notes/2020/aspose-psd-for-net-20-9-release-notes/>Aspose.PSD for .NET 20.9 - Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><div class=container><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section"><div class=box1><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.PSD for .NET 20.9 - Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><div class="alert alert-primary" role=alert>This page contains release notes for <a href=https://www.nuget.org/packages/Aspose.PSD/>Aspose.PSD for .NET 20.9</a></div><table><thead><tr><th style=text-align:left><strong>Key</strong></th><th style=text-align:left><strong>Summary</strong></th><th style=text-align:left><strong>Category</strong></th></tr></thead><tbody><tr><td style=text-align:left>PSDNET-408</td><td style=text-align:left>Support of SoLEResource (Smart Object Layer External resource)</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>PSDNET-614</td><td style=text-align:left>Support of Linked Smart objects</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>PSDNET-615</td><td style=text-align:left>Support of Embedded Smart objects</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>PSDNET-690</td><td style=text-align:left>Updating text in given PSD file and saving it changes some layer and many text parameters</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDNET-696</td><td style=text-align:left>FillLayer are not updated after the creation and can not be rendered correctly</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDNET-712</td><td style=text-align:left>Regression: Aspose.PSD 20.8.0 can’t open file</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDNET-714</td><td style=text-align:left>In a specific PSD file, resizing TextLayer breaks the location value</td><td style=text-align:left>Bug</td></tr></tbody></table><h2 id=public-api-changes><strong>Public API Changes</strong></h2><h1 id=added-apis><strong>Added APIs:</strong></h1><ul><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.Txt2Resource.AddTextRecord(System.String,Aspose.PSD.RectangleF)</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.Text.ITextStyle.AutoKerning</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.Text.ITextStyle.StandardLigatures</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.Text.ITextStyle.DiscretionaryLigatures</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.Text.ITextStyle.ContextualAlternates</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.Text.ITextStyle.LanguageIndex</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.Text.ITextStyle.VerticalScale</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.Text.ITextStyle.HorizontalScale</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.Text.ITextStyle.Fractions</li><li>T:Aspose.PSD.FileFormats.Psd.AutoKerning</li><li>F:Aspose.PSD.FileFormats.Psd.AutoKerning.Manual</li><li>F:Aspose.PSD.FileFormats.Psd.AutoKerning.Metric</li><li>F:Aspose.PSD.FileFormats.Psd.AutoKerning.Optical</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.LinkResource.Item(System.Guid)</li><li>T:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.ISmartObjectLayerResource</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.ISmartObjectLayerResource.PlacedId</li><li>T:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.Version</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.UniqueId</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.IsCustom</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.PageNumber</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.TotalPages</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.AntiAliasPolicy</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.PlacedLayerType</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.Left</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.Top</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.Right</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.Bottom</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.Bounds</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.TransformMatrix</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.HorizontalMeshPoints</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.VerticalMeshPoints</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.HorizontalMeshPointUnit</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.VerticalMeshPointUnit</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.Signature</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.Value</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.Perspective</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.PerspectiveOther</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.UOrder</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.VOrder</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource.Items</li><li>T:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.CompId</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.OriginalCompId</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.UniqueId</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.PlacedId</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.PageNumber</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.TotalPages</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.AntiAliasPolicy</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.PlacedLayerType</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.TransformMatrix</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.NonAffineTransformMatrix</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.Signature</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.Length</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.PsdVersion</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.Items</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.Crop</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.FrameCount</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.Resolution</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.ResolutionUnit</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.Comp</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.Width</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.Height</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.FrameStepNumerator</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.FrameStepDenominator</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.DurationNumerator</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.DurationDenominator</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartObjectResource.Save(Aspose.PSD.StreamContainer,System.Int32)</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.#ctor</li><li>T:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLeResource</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLeResource.#ctor(System.Guid,System.Boolean,System.Boolean)</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLeResource.#ctor</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLeResource.Key</li><li>F:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLeResource.TypeToolKey</li><li>T:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartResourceCreator</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartResourceCreator.#ctor</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartResourceCreator.#ctor(Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlacedResource)</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartResourceCreator.#ctor(System.Boolean,System.Boolean)</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartResourceCreator.GeneratePlacedResource</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartResourceCreator.GenerateSmartEmbeddedResource</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SmartResourceCreator.GenerateSmartExternalResource</li><li>T:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectLayer</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectLayer.ContentsBounds</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectLayer.ContentsSource</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectLayer.Contents</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectLayer.ContentType</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectLayer.SmartObjectProvider</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectLayer.ExportContents(System.String)</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectLayer.LoadContents(Aspose.PSD.LoadOptions)</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectLayer.ReplaceContents(Aspose.PSD.Image)</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectLayer.ReplaceContents(System.String)</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectLayer.EmbedLinked</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectLayer.ConvertToLinked(System.String)</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectLayer.RelinkToFile(System.String)</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectLayer.UpdateModifiedContent</li><li>T:Aspose.PSD.FileFormats.Psd.SmartObjectProvider</li><li>M:Aspose.PSD.FileFormats.Psd.SmartObjectProvider.EmbedAllLinked</li><li>M:Aspose.PSD.FileFormats.Psd.SmartObjectProvider.UpdateAllModifiedContent</li><li>T:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectType</li><li>F:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectType.Embedded</li><li>F:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectType.AvailableLinked</li><li>F:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectType.UnavailableLinked</li><li>F:Aspose.PSD.FileFormats.Psd.Layers.SmartObjects.SmartObjectType.LibraryLink</li><li>P:Aspose.PSD.FileFormats.Psd.PsdImage.SmartObjectProvider</li></ul><h1 id=removed-apis><strong>Removed APIs:</strong></h1><ul><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.Txt2Resource.AddTextRecord(System.String)</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.#ctor(System.Guid,System.Boolean)</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Version</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.UniqueId</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.IsCustom</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.PageNumber</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.TotalPages</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.AntiAliasPolicy</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.PlacedLayerType</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Left</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Top</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Right</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Bottom</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Bounds</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.TransformMatrix</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.HorizontalMeshPoints</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.VerticalMeshPoints</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.HorizontalMeshPointUnit</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.VerticalMeshPointUnit</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Value</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.UOrder</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.VOrder</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.PlLdResource.Items</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.CompId</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.OriginalCompId</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Version</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.UniqueId</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.PlacedId</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.IsCustom</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.PageNumber</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.TotalPages</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.AntiAliasPolicy</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.PlacedLayerType</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Left</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Top</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Right</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Bottom</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Bounds</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.TransformMatrix</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.NonAffineTransformMatrix</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.HorizontalMeshPoints</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.VerticalMeshPoints</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.HorizontalMeshPointUnit</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.VerticalMeshPointUnit</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Signature</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Length</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.PsdVersion</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Value</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Perspective</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.PerspectiveOther</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.UOrder</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.VOrder</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Items</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Crop</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.FrameCount</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Resolution</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.ResolutionUnit</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Comp</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Width</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.FrameStepNumerator</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.FrameStepDenominator</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.DurationNumerator</li><li>P:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.DurationDenominator</li><li>M:Aspose.PSD.FileFormats.Psd.Layers.LayerResources.SoLdResource.Save(Aspose.PSD.StreamContainer,System.Int32)</li></ul><h2 id=usage-examples><strong>Usage examples:</strong></h2><p><strong>PSDNET-408. Support of SoLEResource (Smart Object Layer External resource)</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>            <span style=color:#66d9ef>void</span> AssertIsTrue(<span style=color:#66d9ef>bool</span> condition)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (!condition)
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> FormatException(<span style=color:#66d9ef>string</span>.Format(<span style=color:#e6db74>&#34;Expected true&#34;</span>));
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>void</span> AssertAreEqual(<span style=color:#66d9ef>object</span> actual, <span style=color:#66d9ef>object</span> expected)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> areEqual = <span style=color:#66d9ef>object</span>.Equals(actual, expected);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (!areEqual &amp;&amp; actual <span style=color:#66d9ef>is</span> Array &amp;&amp; expected <span style=color:#66d9ef>is</span> Array)
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>var</span> actualArray = (Array)actual;
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>var</span> expectedArray = (Array)actual;
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (actualArray.Length == expectedArray.Length)
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i = <span style=color:#ae81ff>0</span>; i &lt; actualArray.Length; i++)
</span></span><span style=display:flex><span>                        {
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>if</span> (!<span style=color:#66d9ef>object</span>.Equals(actualArray.GetValue(i), expectedArray.GetValue(i)))
</span></span><span style=display:flex><span>                            {
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        areEqual = <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (!areEqual)
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> FormatException(
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>string</span>.Format(<span style=color:#e6db74>&#34;Actual value {0} are not equal to expected {1}.&#34;</span>, actual, expected));
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>void</span> CheckSmartObjectResourceValues(<span style=color:#66d9ef>object</span>[] expectedValue, SmartObjectResource resource)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>0</span>], resource.IsCustom);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>2</span>], resource.PageNumber);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>3</span>], resource.TotalPages);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>4</span>], resource.AntiAliasPolicy);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>5</span>], resource.PlacedLayerType);
</span></span><span style=display:flex><span>                AssertAreEqual(<span style=color:#ae81ff>8</span>, resource.TransformMatrix.Length);
</span></span><span style=display:flex><span>                AssertAreEqual((<span style=color:#66d9ef>double</span>[])expectedValue[<span style=color:#ae81ff>6</span>], resource.TransformMatrix);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>7</span>], resource.Value);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>8</span>], resource.Perspective);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>9</span>], resource.PerspectiveOther);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>10</span>], resource.Top);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>11</span>], resource.Left);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>12</span>], resource.Bottom);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>13</span>], resource.Right);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>14</span>], resource.UOrder);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>15</span>], resource.VOrder);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>16</span>], resource.Crop);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>17</span>], resource.FrameStepNumerator);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>18</span>], resource.FrameStepDenominator);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>19</span>], resource.DurationNumerator);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>20</span>], resource.DurationDenominator);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>21</span>], resource.FrameCount);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>22</span>], resource.Width);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>23</span>], resource.Height);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>24</span>], resource.Resolution);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>25</span>], resource.ResolutionUnit);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>26</span>], resource.Comp);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>27</span>], resource.CompId);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>28</span>], resource.OriginalCompId);
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>29</span>], resource.PlacedId.ToString());
</span></span><span style=display:flex><span>                AssertAreEqual(expectedValue[<span style=color:#ae81ff>30</span>], resource.NonAffineTransformMatrix);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (resource.IsCustom)
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    AssertAreEqual(expectedValue[<span style=color:#ae81ff>31</span>], resource.HorizontalMeshPointUnit);
</span></span><span style=display:flex><span>                    AssertAreEqual((<span style=color:#66d9ef>double</span>[])expectedValue[<span style=color:#ae81ff>32</span>], resource.HorizontalMeshPoints);
</span></span><span style=display:flex><span>                    AssertAreEqual(expectedValue[<span style=color:#ae81ff>33</span>], resource.VerticalMeshPointUnit);
</span></span><span style=display:flex><span>                    AssertAreEqual((<span style=color:#66d9ef>double</span>[])expectedValue[<span style=color:#ae81ff>34</span>], resource.VerticalMeshPoints);
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>void</span> SetNewSmartValues(SmartObjectResource resource, <span style=color:#66d9ef>object</span>[] newValues)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#75715e>// This values we do not change in resource</span>
</span></span><span style=display:flex><span>                newValues[<span style=color:#ae81ff>0</span>] = resource.IsCustom;
</span></span><span style=display:flex><span>                newValues[<span style=color:#ae81ff>1</span>] = resource.UniqueId.ToString();
</span></span><span style=display:flex><span>                newValues[<span style=color:#ae81ff>5</span>] = resource.PlacedLayerType;
</span></span><span style=display:flex><span>                newValues[<span style=color:#ae81ff>14</span>] = resource.UOrder;
</span></span><span style=display:flex><span>                newValues[<span style=color:#ae81ff>15</span>] = resource.VOrder;
</span></span><span style=display:flex><span>                newValues[<span style=color:#ae81ff>28</span>] = resource.OriginalCompId;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// This values should be changed in the PlLdResource (with the specified UniqueId) as well</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// and some of them must be in accord with the underlining smart object in the LinkDataSource</span>
</span></span><span style=display:flex><span>                resource.PageNumber = (<span style=color:#66d9ef>int</span>)newValues[<span style=color:#ae81ff>2</span>]; <span style=color:#75715e>// 2;</span>
</span></span><span style=display:flex><span>                resource.TotalPages = (<span style=color:#66d9ef>int</span>)newValues[<span style=color:#ae81ff>3</span>]; <span style=color:#75715e>// 3;</span>
</span></span><span style=display:flex><span>                resource.AntiAliasPolicy = (<span style=color:#66d9ef>int</span>)newValues[<span style=color:#ae81ff>4</span>]; <span style=color:#75715e>// 0;</span>
</span></span><span style=display:flex><span>                resource.TransformMatrix = (<span style=color:#66d9ef>double</span>[])newValues[<span style=color:#ae81ff>6</span>];
</span></span><span style=display:flex><span>                resource.Value = (<span style=color:#66d9ef>double</span>)newValues[<span style=color:#ae81ff>7</span>]; <span style=color:#75715e>// 1.23456789;</span>
</span></span><span style=display:flex><span>                resource.Perspective = (<span style=color:#66d9ef>double</span>)newValues[<span style=color:#ae81ff>8</span>]; <span style=color:#75715e>// 0.123456789;</span>
</span></span><span style=display:flex><span>                resource.PerspectiveOther = (<span style=color:#66d9ef>double</span>)newValues[<span style=color:#ae81ff>9</span>]; <span style=color:#75715e>// 0.987654321;</span>
</span></span><span style=display:flex><span>                resource.Top = (<span style=color:#66d9ef>double</span>)newValues[<span style=color:#ae81ff>10</span>]; <span style=color:#75715e>// -126;</span>
</span></span><span style=display:flex><span>                resource.Left = (<span style=color:#66d9ef>double</span>)newValues[<span style=color:#ae81ff>11</span>]; <span style=color:#75715e>// -215;</span>
</span></span><span style=display:flex><span>                resource.Bottom = (<span style=color:#66d9ef>double</span>)newValues[<span style=color:#ae81ff>12</span>]; <span style=color:#75715e>// 248;</span>
</span></span><span style=display:flex><span>                resource.Right = (<span style=color:#66d9ef>double</span>)newValues[<span style=color:#ae81ff>13</span>]; <span style=color:#75715e>// 145;</span>
</span></span><span style=display:flex><span>                resource.Crop = (<span style=color:#66d9ef>int</span>)newValues[<span style=color:#ae81ff>16</span>]; <span style=color:#75715e>// 5;</span>
</span></span><span style=display:flex><span>                resource.FrameStepNumerator = (<span style=color:#66d9ef>int</span>)newValues[<span style=color:#ae81ff>17</span>]; <span style=color:#75715e>// 1;</span>
</span></span><span style=display:flex><span>                resource.FrameStepDenominator = (<span style=color:#66d9ef>int</span>)newValues[<span style=color:#ae81ff>18</span>]; <span style=color:#75715e>// 601;</span>
</span></span><span style=display:flex><span>                resource.DurationNumerator = (<span style=color:#66d9ef>int</span>)newValues[<span style=color:#ae81ff>19</span>]; <span style=color:#75715e>// 2;</span>
</span></span><span style=display:flex><span>                resource.DurationDenominator = (<span style=color:#66d9ef>int</span>)newValues[<span style=color:#ae81ff>20</span>]; <span style=color:#75715e>// 602;</span>
</span></span><span style=display:flex><span>                resource.FrameCount = (<span style=color:#66d9ef>int</span>)newValues[<span style=color:#ae81ff>21</span>]; <span style=color:#75715e>// 11;</span>
</span></span><span style=display:flex><span>                resource.Width = (<span style=color:#66d9ef>double</span>)newValues[<span style=color:#ae81ff>22</span>]; <span style=color:#75715e>// 541;</span>
</span></span><span style=display:flex><span>                resource.Height = (<span style=color:#66d9ef>double</span>)newValues[<span style=color:#ae81ff>23</span>]; <span style=color:#75715e>// 249;</span>
</span></span><span style=display:flex><span>                resource.Resolution = (<span style=color:#66d9ef>double</span>)newValues[<span style=color:#ae81ff>24</span>]; <span style=color:#75715e>// 144;</span>
</span></span><span style=display:flex><span>                resource.ResolutionUnit = (UnitTypes)newValues[<span style=color:#ae81ff>25</span>];
</span></span><span style=display:flex><span>                resource.Comp = (<span style=color:#66d9ef>int</span>)newValues[<span style=color:#ae81ff>26</span>]; <span style=color:#75715e>// 21;</span>
</span></span><span style=display:flex><span>                resource.CompId = (<span style=color:#66d9ef>int</span>)newValues[<span style=color:#ae81ff>27</span>]; <span style=color:#75715e>// 22;</span>
</span></span><span style=display:flex><span>                resource.NonAffineTransformMatrix = (<span style=color:#66d9ef>double</span>[])newValues[<span style=color:#ae81ff>30</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// This unique Id should be changed in references if any</span>
</span></span><span style=display:flex><span>                resource.PlacedId = <span style=color:#66d9ef>new</span> Guid((<span style=color:#66d9ef>string</span>)newValues[<span style=color:#ae81ff>29</span>]);  <span style=color:#75715e>// &#34;12345678-9abc-def0-9876-54321fecba98&#34;);</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (resource.IsCustom)
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    resource.HorizontalMeshPointUnit = (UnitTypes)newValues[<span style=color:#ae81ff>31</span>];
</span></span><span style=display:flex><span>                    resource.HorizontalMeshPoints = (<span style=color:#66d9ef>double</span>[])newValues[<span style=color:#ae81ff>32</span>];
</span></span><span style=display:flex><span>                    resource.VerticalMeshPointUnit = (UnitTypes)newValues[<span style=color:#ae81ff>33</span>];
</span></span><span style=display:flex><span>                    resource.VerticalMeshPoints = (<span style=color:#66d9ef>double</span>[])newValues[<span style=color:#ae81ff>34</span>];
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// Be careful with some parameters: the saved image may become unreadable by Adobe® Photoshop®</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>////resource.UOrder = 6;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>////resource.VOrder = 9;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// Do no change this otherwise you won&#39;t be able to use free transform</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// or change the underlining smart object to the vector type</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>////resource.PlacedLayerType = PlacedLayerType.Vector;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// There should be valid PlLdResource with this unique Id</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>////resource.UniqueId = new Guid(&#34;98765432-10fe-cba0-1234-56789abcdef0&#34;);</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>object</span>[] newSmartValues = <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>object</span>[]
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                PlacedLayerType.ImageStack,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>12.937922786050663</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>19.419959734187131</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>2.85445817782261</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>1.0540625423957124</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>7.20861031651307</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>14.634102808208553</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>17.292074924741144</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1.23456789</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0.123456789</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>0.987654321</span>,
</span></span><span style=display:flex><span>                -<span style=color:#ae81ff>126d</span>,
</span></span><span style=display:flex><span>                -<span style=color:#ae81ff>215d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>248d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>145d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>5</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>601</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>602</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>11</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>541d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>249d</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>144d</span>,
</span></span><span style=display:flex><span>                UnitTypes.Percent,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>21</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>22</span>,
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>23</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;12345678-9abc-def0-9876-54321fecba98&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>129.937922786050663</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>195.419959734187131</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>26.85445817782261</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>12.0540625423957124</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>72.20861031651307</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>147.634102808208553</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>175.292074924741144</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>42</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                UnitTypes.Points,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>16</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.01d</span>, <span style=color:#ae81ff>103.33333333333433d</span>, <span style=color:#ae81ff>206.66686666666666d</span>, <span style=color:#ae81ff>310.02d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.20d</span>, <span style=color:#ae81ff>103.33333333333533d</span>, <span style=color:#ae81ff>206.69666666666666d</span>, <span style=color:#ae81ff>310.03d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>30.06d</span>, <span style=color:#ae81ff>103.33333333336333d</span>, <span style=color:#ae81ff>206.66660666666666d</span>, <span style=color:#ae81ff>310.04d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>04.05d</span>, <span style=color:#ae81ff>103.33333333373333d</span>, <span style=color:#ae81ff>206.66666166666666d</span>, <span style=color:#ae81ff>310.05d</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                UnitTypes.Distance,
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>16</span>]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0.06d</span>, <span style=color:#ae81ff>0.07d</span>, <span style=color:#ae81ff>0.08d</span>, <span style=color:#ae81ff>0.09d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>49.066666666666664d</span>, <span style=color:#ae81ff>49.266666666666664d</span>, <span style=color:#ae81ff>49.566666666666664d</span>, <span style=color:#ae81ff>49.766666666666664d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>99.133333333333329d</span>, <span style=color:#ae81ff>99.433333333333329d</span>, <span style=color:#ae81ff>99.633333333333329d</span>, <span style=color:#ae81ff>99.833333333333329d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>140</span>, <span style=color:#ae81ff>141</span>, <span style=color:#ae81ff>142</span>, <span style=color:#ae81ff>143</span>,
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>            };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>object</span>[] expectedValues = <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>object</span>[]
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>object</span>[]
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#34;5867318f-3174-9f41-abca-22f56a75247e&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0x10</span>,
</span></span><span style=display:flex><span>                    PlacedLayerType.Raster,
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>                    },
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>2d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>2d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>600</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>600</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>2d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>2d</span>,
</span></span><span style=display:flex><span>                    <span style=color:#ae81ff>72d</span>,
</span></span><span style=display:flex><span>                    UnitTypes.Density,
</span></span><span style=display:flex><span>                    -<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    -<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    -<span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#34;64b3997c-06e0-be40-a349-41acf397c897&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>double</span>[<span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>                    },
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> dataDir = <span style=color:#e6db74>&#34;PSDNET408_1\\&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> sourceFilePath = dataDir + <span style=color:#e6db74>&#34;rgb8_2x2_linked.psd&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> outputPath = dataDir + <span style=color:#e6db74>&#34;rgb8_2x2_linked_output.psd&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>using</span> (PsdImage image = (PsdImage)Image.Load(sourceFilePath))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                SoLeResource soleResource = <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>int</span> index = <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>foreach</span> (Layer imageLayer <span style=color:#66d9ef>in</span> image.Layers)
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>foreach</span> (<span style=color:#66d9ef>var</span> imageResource <span style=color:#66d9ef>in</span> imageLayer.Resources)
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>var</span> resource = imageResource <span style=color:#66d9ef>as</span> SoLeResource;
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> (resource != <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>                        {
</span></span><span style=display:flex><span>                            soleResource = resource;
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>var</span> expectedValue = (<span style=color:#66d9ef>object</span>[])expectedValues[index++];
</span></span><span style=display:flex><span>                            AssertAreEqual(expectedValue[<span style=color:#ae81ff>1</span>], resource.UniqueId.ToString());
</span></span><span style=display:flex><span>                            CheckSmartObjectResourceValues(expectedValue, resource);
</span></span><span style=display:flex><span>                            SetNewSmartValues(resource, newSmartValues);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                AssertIsTrue(soleResource != <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>                image.Save(outputPath, <span style=color:#66d9ef>new</span> PsdOptions(image));
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>using</span> (PsdImage savedImage = (PsdImage)Image.Load(outputPath))
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>foreach</span> (Layer imageLayer <span style=color:#66d9ef>in</span> image.Layers)
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>foreach</span> (<span style=color:#66d9ef>var</span> imageResource <span style=color:#66d9ef>in</span> imageLayer.Resources)
</span></span><span style=display:flex><span>                        {
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>var</span> resource = imageResource <span style=color:#66d9ef>as</span> SoLeResource;
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>if</span> (resource != <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>                            {
</span></span><span style=display:flex><span>                                CheckSmartObjectResourceValues(newSmartValues, resource);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }</span></span></code></pre></div><strong>PSDNET-614. Support of Linked Smart objects</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>        <span style=color:#66d9ef>void</span> AssertAreEqual(<span style=color:#66d9ef>object</span> actual, <span style=color:#66d9ef>object</span> expected)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> areEqual = <span style=color:#66d9ef>object</span>.Equals(actual, expected);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (!areEqual &amp;&amp; actual <span style=color:#66d9ef>is</span> Array &amp;&amp; expected <span style=color:#66d9ef>is</span> Array)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> actualArray = (Array)actual;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> expectedArray = (Array)actual;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (actualArray.Length == expectedArray.Length)
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i = <span style=color:#ae81ff>0</span>; i &lt; actualArray.Length; i++)
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> (!<span style=color:#66d9ef>object</span>.Equals(actualArray.GetValue(i), expectedArray.GetValue(i)))
</span></span><span style=display:flex><span>                        {
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    areEqual = <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (!areEqual)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> FormatException(
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>string</span>.Format(<span style=color:#e6db74>&#34;Actual value {0} are not equal to expected {1}.&#34;</span>, actual, expected));
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>string</span> rootDataDir = <span style=color:#e6db74>&#34;PSDNET614_1\\&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// This example demonstrates how to update the external or embedded smart object layer using these methods:</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// RelinkToFile, UpdateModifiedContent, ExportContents</span>
</span></span><span style=display:flex><span>        ExampleOfUpdatingSmartObjectLayer(<span style=color:#e6db74>&#34;rgb8_2x2_linked2.psd&#34;</span>, <span style=color:#ae81ff>0x53</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, FileFormat.Png);
</span></span><span style=display:flex><span>        ExampleOfUpdatingSmartObjectLayer(<span style=color:#e6db74>&#34;r-embedded-png.psd&#34;</span>, <span style=color:#ae81ff>0x207</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0xb</span>, <span style=color:#ae81ff>0x10</span>, FileFormat.Png);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span> ExampleOfUpdatingSmartObjectLayer(
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> filePath,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> contentsLength,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> left,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> top,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> right,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> bottom,
</span></span><span style=display:flex><span>            FileFormat format)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// This example demonstrates how to change the smart object layer in the PSD file and export / update its contents.</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> fileName = Path.GetFileNameWithoutExtension(filePath);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> dataDir = rootDataDir + <span style=color:#e6db74>&#34;updating_output\\&#34;</span>;
</span></span><span style=display:flex><span>            filePath = rootDataDir + filePath;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> pngOutputPath = dataDir + fileName + <span style=color:#e6db74>&#34;_modified.png&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> png2OutputPath = dataDir + fileName + <span style=color:#e6db74>&#34;_updated_modified.png&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> psd2OutputPath = dataDir + fileName + <span style=color:#e6db74>&#34;_updated_modified.psd&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> exportPath = dataDir + fileName + <span style=color:#e6db74>&#34;_exported.&#34;</span> + GetFormatExt(format);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>using</span> (PsdImage image = (PsdImage)Image.Load(filePath))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> smartObjectLayer = (SmartObjectLayer)image.Layers[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> contentType = smartObjectLayer.ContentType;
</span></span><span style=display:flex><span>                AssertAreEqual(contentsLength, smartObjectLayer.Contents.Length);
</span></span><span style=display:flex><span>                AssertAreEqual(left, smartObjectLayer.ContentsBounds.Left);
</span></span><span style=display:flex><span>                AssertAreEqual(top, smartObjectLayer.ContentsBounds.Top);
</span></span><span style=display:flex><span>                AssertAreEqual(right, smartObjectLayer.ContentsBounds.Right);
</span></span><span style=display:flex><span>                AssertAreEqual(bottom, smartObjectLayer.ContentsBounds.Bottom);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (contentType == SmartObjectType.AvailableLinked)
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// Let&#39;s export the external smart object image from the PSD smart object layer to a new location</span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// because we are going to modify it.</span>
</span></span><span style=display:flex><span>                    smartObjectLayer.ExportContents(exportPath);
</span></span><span style=display:flex><span>                    smartObjectLayer.RelinkToFile(exportPath);
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// Let&#39;s invert the content of the smart object: inner (not cached) image</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>using</span> (<span style=color:#66d9ef>var</span> innerImage = (RasterImage)smartObjectLayer.LoadContents(<span style=color:#66d9ef>new</span> LoadOptions()))
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    InvertImage(innerImage);
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>using</span> (<span style=color:#66d9ef>var</span> stream = <span style=color:#66d9ef>new</span> MemoryStream())
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        innerImage.Save(stream);
</span></span><span style=display:flex><span>                        smartObjectLayer.Contents = stream.ToArray();
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// Let&#39;s check whether the modified content does not affect rendering yet.</span>
</span></span><span style=display:flex><span>                image.Save(pngOutputPath, <span style=color:#66d9ef>new</span> PngOptions() { ColorType = PngColorType.TruecolorWithAlpha });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                smartObjectLayer.UpdateModifiedContent();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// Let&#39;s check whether the updated content affects rendering and the psd image is saved correctly</span>
</span></span><span style=display:flex><span>                image.Save(psd2OutputPath, <span style=color:#66d9ef>new</span> PsdOptions(image));
</span></span><span style=display:flex><span>                image.Save(png2OutputPath, <span style=color:#66d9ef>new</span> PngOptions() { ColorType = PngColorType.TruecolorWithAlpha });
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// This example demonstrates how to convert the embedded smart object to external linked contents using the ConvertToLinked method.</span>
</span></span><span style=display:flex><span>        ExampleOfEmbeddedSmartObjectLayerToLinkedConversion(<span style=color:#e6db74>&#34;new_panama-papers-4.psd&#34;</span>, <span style=color:#ae81ff>0x10caa</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0x280</span>, <span style=color:#ae81ff>0x169</span>, FileFormat.Jpeg);
</span></span><span style=display:flex><span>        ExampleOfEmbeddedSmartObjectLayerToLinkedConversion(<span style=color:#e6db74>&#34;r3-embedded.psd&#34;</span>, <span style=color:#ae81ff>0x207</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0xb</span>, <span style=color:#ae81ff>0x10</span>, FileFormat.Png);
</span></span><span style=display:flex><span>        ExampleOfEmbeddedSmartObjectLayerToLinkedConversion(<span style=color:#e6db74>&#34;r-embedded-tiff.psd&#34;</span>, <span style=color:#ae81ff>0xca94</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0xb</span>, <span style=color:#ae81ff>0x10</span>, FileFormat.Tiff);
</span></span><span style=display:flex><span>        ExampleOfEmbeddedSmartObjectLayerToLinkedConversion(<span style=color:#e6db74>&#34;r-embedded-bmp.psd&#34;</span>, <span style=color:#ae81ff>0x278</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0xb</span>, <span style=color:#ae81ff>0x10</span>, FileFormat.Bmp);
</span></span><span style=display:flex><span>        ExampleOfEmbeddedSmartObjectLayerToLinkedConversion(<span style=color:#e6db74>&#34;r-embedded-gif.psd&#34;</span>, <span style=color:#ae81ff>0x3ec</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0xb</span>, <span style=color:#ae81ff>0x10</span>, FileFormat.Gif);
</span></span><span style=display:flex><span>        ExampleOfEmbeddedSmartObjectLayerToLinkedConversion(<span style=color:#e6db74>&#34;r-embedded-jpeg.psd&#34;</span>, <span style=color:#ae81ff>0x327</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0xb</span>, <span style=color:#ae81ff>0x10</span>, FileFormat.Jpeg);
</span></span><span style=display:flex><span>        ExampleOfEmbeddedSmartObjectLayerToLinkedConversion(<span style=color:#e6db74>&#34;r-embedded-jpeg2000.psd&#34;</span>, <span style=color:#ae81ff>0x519f</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0xb</span>, <span style=color:#ae81ff>0x10</span>, FileFormat.Jpeg2000);
</span></span><span style=display:flex><span>        ExampleOfEmbeddedSmartObjectLayerToLinkedConversion(<span style=color:#e6db74>&#34;r-embedded-psd.psd&#34;</span>, <span style=color:#ae81ff>0xc074</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0xb</span>, <span style=color:#ae81ff>0x10</span>, FileFormat.Psd);
</span></span><span style=display:flex><span>        ExampleOfEmbeddedSmartObjectLayerToLinkedConversion(<span style=color:#e6db74>&#34;r-embedded-png.psd&#34;</span>, <span style=color:#ae81ff>0x207</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0xb</span>, <span style=color:#ae81ff>0x10</span>, FileFormat.Png);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span> ExampleOfEmbeddedSmartObjectLayerToLinkedConversion(
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> filePath,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> contentsLength,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> left,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> top,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> right,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> bottom,
</span></span><span style=display:flex><span>            FileFormat format)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// This demonstrates how to convert an embedded smart object layer in the PSD file to external one.</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> formatExt = GetFormatExt(format);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> fileName = Path.GetFileNameWithoutExtension(filePath);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> dataDir = rootDataDir + <span style=color:#e6db74>&#34;to_linked_output\\&#34;</span>;
</span></span><span style=display:flex><span>            filePath = rootDataDir + filePath;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> pngOutputPath = dataDir + fileName + <span style=color:#e6db74>&#34;_to_external.png&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> psdOutputPath = dataDir + fileName + <span style=color:#e6db74>&#34;_to_external.psd&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> externalPath = dataDir + fileName + <span style=color:#e6db74>&#34;_external.&#34;</span> + formatExt;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>using</span> (PsdImage image = (PsdImage)Image.Load(filePath))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> smartObjectLayer = (SmartObjectLayer)image.Layers[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>                smartObjectLayer.ConvertToLinked(externalPath);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                AssertAreEqual(contentsLength, smartObjectLayer.Contents.Length);
</span></span><span style=display:flex><span>                AssertAreEqual(left, smartObjectLayer.ContentsBounds.Left);
</span></span><span style=display:flex><span>                AssertAreEqual(top, smartObjectLayer.ContentsBounds.Top);
</span></span><span style=display:flex><span>                AssertAreEqual(right, smartObjectLayer.ContentsBounds.Right);
</span></span><span style=display:flex><span>                AssertAreEqual(bottom, smartObjectLayer.ContentsBounds.Bottom);
</span></span><span style=display:flex><span>                AssertAreEqual(SmartObjectType.AvailableLinked, smartObjectLayer.ContentType);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// Let&#39;s check if the converted image is saved correctly</span>
</span></span><span style=display:flex><span>                image.Save(psdOutputPath, <span style=color:#66d9ef>new</span> PsdOptions(image));
</span></span><span style=display:flex><span>                image.Save(pngOutputPath, <span style=color:#66d9ef>new</span> PngOptions() { ColorType = PngColorType.TruecolorWithAlpha });
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>using</span> (PsdImage image = (PsdImage)Image.Load(psdOutputPath))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> smartObjectLayer = (SmartObjectLayer)image.Layers[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>                AssertAreEqual(contentsLength, smartObjectLayer.Contents.Length);
</span></span><span style=display:flex><span>                AssertAreEqual(left, smartObjectLayer.ContentsBounds.Left);
</span></span><span style=display:flex><span>                AssertAreEqual(top, smartObjectLayer.ContentsBounds.Top);
</span></span><span style=display:flex><span>                AssertAreEqual(right, smartObjectLayer.ContentsBounds.Right);
</span></span><span style=display:flex><span>                AssertAreEqual(bottom, smartObjectLayer.ContentsBounds.Bottom);
</span></span><span style=display:flex><span>                AssertAreEqual(SmartObjectType.AvailableLinked, smartObjectLayer.ContentType);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// This example demonstrates how to embed one external smart object layer or all linked layers in the PSD file using the EmbedLinked method.</span>
</span></span><span style=display:flex><span>        ExampleOfLinkedSmartObjectLayerToEmbeddedConversion(<span style=color:#e6db74>&#34;rgb8_2x2_linked.psd&#34;</span>, <span style=color:#ae81ff>0x53</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, FileFormat.Png);
</span></span><span style=display:flex><span>        ExampleOfLinkedSmartObjectLayerToEmbeddedConversion(<span style=color:#e6db74>&#34;rgb8_2x2_linked2.psd&#34;</span>, <span style=color:#ae81ff>0x53</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, FileFormat.Png);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span> ExampleOfLinkedSmartObjectLayerToEmbeddedConversion(
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> filePath,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> contentsLength,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> left,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> top,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> right,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> bottom,
</span></span><span style=display:flex><span>            FileFormat format)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> fileName = Path.GetFileNameWithoutExtension(filePath);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> dataDir = rootDataDir + <span style=color:#e6db74>&#34;to_embedded_output\\&#34;</span>;
</span></span><span style=display:flex><span>            filePath = rootDataDir + filePath;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> pngOutputPath = dataDir + fileName + <span style=color:#e6db74>&#34;_to_embedded.png&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> psdOutputPath = dataDir + fileName + <span style=color:#e6db74>&#34;_to_embedded.psd&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>using</span> (PsdImage image = (PsdImage)Image.Load(filePath))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> smartObjectLayer0 = (SmartObjectLayer)image.Layers[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>                smartObjectLayer0.EmbedLinked();
</span></span><span style=display:flex><span>                AssertAreEqual(contentsLength, smartObjectLayer0.Contents.Length);
</span></span><span style=display:flex><span>                AssertAreEqual(left, smartObjectLayer0.ContentsBounds.Left);
</span></span><span style=display:flex><span>                AssertAreEqual(top, smartObjectLayer0.ContentsBounds.Top);
</span></span><span style=display:flex><span>                AssertAreEqual(right, smartObjectLayer0.ContentsBounds.Right);
</span></span><span style=display:flex><span>                AssertAreEqual(bottom, smartObjectLayer0.ContentsBounds.Bottom);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (image.Layers.Length &gt;= <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>var</span> smartObjectLayer1 = (SmartObjectLayer)image.Layers[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>                    AssertAreEqual(SmartObjectType.Embedded, smartObjectLayer0.ContentType);
</span></span><span style=display:flex><span>                    AssertAreEqual(SmartObjectType.AvailableLinked, smartObjectLayer1.ContentType);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    image.SmartObjectProvider.EmbedAllLinked();
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>foreach</span> (Layer layer <span style=color:#66d9ef>in</span> image.Layers)
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>var</span> smartLayer = layer <span style=color:#66d9ef>as</span> SmartObjectLayer;
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> (smartLayer != <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>                        {
</span></span><span style=display:flex><span>                            AssertAreEqual(SmartObjectType.Embedded, smartLayer.ContentType);
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// Let&#39;s check if the converted image is saved correctly</span>
</span></span><span style=display:flex><span>                image.Save(psdOutputPath, <span style=color:#66d9ef>new</span> PsdOptions(image));
</span></span><span style=display:flex><span>                image.Save(pngOutputPath, <span style=color:#66d9ef>new</span> PngOptions() { ColorType = PngColorType.TruecolorWithAlpha });
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>using</span> (PsdImage image = (PsdImage)Image.Load(psdOutputPath))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> smartObjectLayer = (SmartObjectLayer)image.Layers[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>                AssertAreEqual(contentsLength, smartObjectLayer.Contents.Length);
</span></span><span style=display:flex><span>                AssertAreEqual(left, smartObjectLayer.ContentsBounds.Left);
</span></span><span style=display:flex><span>                AssertAreEqual(top, smartObjectLayer.ContentsBounds.Top);
</span></span><span style=display:flex><span>                AssertAreEqual(right, smartObjectLayer.ContentsBounds.Right);
</span></span><span style=display:flex><span>                AssertAreEqual(bottom, smartObjectLayer.ContentsBounds.Bottom);
</span></span><span style=display:flex><span>                AssertAreEqual(SmartObjectType.Embedded, smartObjectLayer.ContentType);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// This example demonstrates how to change the Adobe® Photoshop® external smart object layer and export / update its contents</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// using the ExportContents and ReplaceContents methods.</span>
</span></span><span style=display:flex><span>        ExampleOfExternalSmartObjectLayerSupport(<span style=color:#e6db74>&#34;rgb8_2x2_linked.psd&#34;</span>, <span style=color:#ae81ff>0x53</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, FileFormat.Png);
</span></span><span style=display:flex><span>        ExampleOfExternalSmartObjectLayerSupport(<span style=color:#e6db74>&#34;rgb8_2x2_linked2.psd&#34;</span>, <span style=color:#ae81ff>0x4aea</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>10</span>, FileFormat.Psd);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span> ExampleOfExternalSmartObjectLayerSupport(<span style=color:#66d9ef>string</span> filePath, <span style=color:#66d9ef>int</span> contentsLength, <span style=color:#66d9ef>int</span> left, <span style=color:#66d9ef>int</span> top, <span style=color:#66d9ef>int</span> right, <span style=color:#66d9ef>int</span> bottom, FileFormat format)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> formatExt = GetFormatExt(format);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> fileName = Path.GetFileNameWithoutExtension(filePath);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> dataDir = rootDataDir + <span style=color:#e6db74>&#34;external_support_output\\&#34;</span>;
</span></span><span style=display:flex><span>            filePath = rootDataDir + filePath;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> pngOutputPath = dataDir + fileName + <span style=color:#e6db74>&#34;.png&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> psdOutputPath = dataDir + fileName + <span style=color:#e6db74>&#34;.psd&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> linkOutputPath = dataDir + fileName + <span style=color:#e6db74>&#34;_inverted.&#34;</span> + formatExt;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> png2OutputPath = dataDir + fileName + <span style=color:#e6db74>&#34;_updated.png&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> psd2OutputPath = dataDir + fileName + <span style=color:#e6db74>&#34;_updated.psd&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> exportPath = dataDir + fileName + <span style=color:#e6db74>&#34;_export.&#34;</span> + formatExt;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>using</span> (PsdImage image = (PsdImage)Image.Load(filePath))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> smartObjectLayer = (SmartObjectLayer)image.Layers[image.Layers.Length - <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>                AssertAreEqual(left, smartObjectLayer.ContentsBounds.Left);
</span></span><span style=display:flex><span>                AssertAreEqual(top, smartObjectLayer.ContentsBounds.Top);
</span></span><span style=display:flex><span>                AssertAreEqual(right, smartObjectLayer.ContentsBounds.Right);
</span></span><span style=display:flex><span>                AssertAreEqual(bottom, smartObjectLayer.ContentsBounds.Bottom);
</span></span><span style=display:flex><span>                AssertAreEqual(contentsLength, smartObjectLayer.Contents.Length);
</span></span><span style=display:flex><span>                AssertAreEqual(SmartObjectType.AvailableLinked, smartObjectLayer.ContentType);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// Let&#39;s export the linked smart object image from the PSD smart object layer</span>
</span></span><span style=display:flex><span>                smartObjectLayer.ExportContents(exportPath);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// Let&#39;s check if the original image is saved correctly</span>
</span></span><span style=display:flex><span>                image.Save(psdOutputPath, <span style=color:#66d9ef>new</span> PsdOptions(image));
</span></span><span style=display:flex><span>                image.Save(pngOutputPath, <span style=color:#66d9ef>new</span> PngOptions() { ColorType = PngColorType.TruecolorWithAlpha });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>using</span> (<span style=color:#66d9ef>var</span> innerImage = (RasterImage)smartObjectLayer.LoadContents(<span style=color:#66d9ef>null</span>))
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    AssertAreEqual(format, innerImage.FileFormat);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// Let&#39;s invert the linked smart object image</span>
</span></span><span style=display:flex><span>                    InvertImage(innerImage);
</span></span><span style=display:flex><span>                    innerImage.Save(linkOutputPath);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// Let&#39;s replace the linked smart object image in the PSD layer</span>
</span></span><span style=display:flex><span>                    smartObjectLayer.ReplaceContents(linkOutputPath);
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// Let&#39;s check if the updated image is saved correctly</span>
</span></span><span style=display:flex><span>                image.Save(psd2OutputPath, <span style=color:#66d9ef>new</span> PsdOptions(image));
</span></span><span style=display:flex><span>                image.Save(png2OutputPath, <span style=color:#66d9ef>new</span> PngOptions() { ColorType = PngColorType.TruecolorWithAlpha });
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Inverts the image.</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span> InvertImage(RasterImage innerImage)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> innerPsdImage = innerImage <span style=color:#66d9ef>as</span> PsdImage;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (innerPsdImage != <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                InvertRasterImage(innerPsdImage.Layers[<span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                InvertRasterImage(innerImage);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Inverts the raster image.</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>void</span> InvertRasterImage(RasterImage innerImage)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>var</span> pixels = innerImage.LoadArgb32Pixels(innerImage.Bounds);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i = <span style=color:#ae81ff>0</span>; i &lt; pixels.Length; i++)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> pixel = pixels[i];
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> alpha = (<span style=color:#66d9ef>int</span>)(pixel &amp; <span style=color:#ae81ff>0xff000000</span>);
</span></span><span style=display:flex><span>                pixels[i] = (~(pixel &amp; <span style=color:#ae81ff>0x00ffffff</span>)) | alpha;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            innerImage.SaveArgb32Pixels(innerImage.Bounds, pixels);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Gets the format extension.</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>string</span> GetFormatExt(FileFormat format)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> formatExt = format == FileFormat.Jpeg2000 ? <span style=color:#e6db74>&#34;jpf&#34;</span> : format.ToString().ToLowerInvariant();
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> formatExt;
</span></span><span style=display:flex><span>        }</span></span></code></pre></div><strong>PSDNET-615. Support of Embedded Smart objects</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>            <span style=color:#66d9ef>void</span> AssertAreEqual(<span style=color:#66d9ef>object</span> actual, <span style=color:#66d9ef>object</span> expected)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (!<span style=color:#66d9ef>object</span>.Equals(actual, expected))
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> FormatException(<span style=color:#66d9ef>string</span>.Format(<span style=color:#e6db74>&#34;Actual value {0} are not equal to expected {1}.&#34;</span>, actual, expected));
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// This example demonstrates how to change the smart object layer in the PSD file and export / update smart object original embedded contents.</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> dataDir = <span style=color:#e6db74>&#34;PSDNET615_1\\&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> left = <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> top = <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> right = <span style=color:#ae81ff>0xb</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> bottom = <span style=color:#ae81ff>0x10</span>;
</span></span><span style=display:flex><span>            FileFormat[] formats = <span style=color:#66d9ef>new</span>[]
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                FileFormat.Png, FileFormat.Psd, FileFormat.Bmp, FileFormat.Jpeg, FileFormat.Gif, FileFormat.Tiff, FileFormat.Jpeg2000
</span></span><span style=display:flex><span>            };
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>foreach</span> (FileFormat format <span style=color:#66d9ef>in</span> formats)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>string</span> formatString = format.ToString().ToLowerInvariant(); 
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>string</span> formatExt = format == FileFormat.Jpeg2000 ? <span style=color:#e6db74>&#34;jpf&#34;</span> : formatString;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>string</span> fileName = <span style=color:#e6db74>&#34;r-embedded-&#34;</span> + formatString;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>string</span> sourceFilePath = dataDir + fileName + <span style=color:#e6db74>&#34;.psd&#34;</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>string</span> pngOutputPath = dataDir + fileName + <span style=color:#e6db74>&#34;_output.png&#34;</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>string</span> psdOutputPath = dataDir + fileName + <span style=color:#e6db74>&#34;_output.psd&#34;</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>string</span> png2OutputPath = dataDir + fileName + <span style=color:#e6db74>&#34;_updated.png&#34;</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>string</span> psd2OutputPath = dataDir + fileName + <span style=color:#e6db74>&#34;_updated.psd&#34;</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>string</span> exportPath = dataDir + fileName + <span style=color:#e6db74>&#34;_export.&#34;</span> + formatExt;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>using</span> (PsdImage image = (PsdImage)Image.Load(sourceFilePath))
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>var</span> smartObjectLayer = (SmartObjectLayer)image.Layers[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    AssertAreEqual(left, smartObjectLayer.ContentsBounds.Left);
</span></span><span style=display:flex><span>                    AssertAreEqual(top, smartObjectLayer.ContentsBounds.Top);
</span></span><span style=display:flex><span>                    AssertAreEqual(right, smartObjectLayer.ContentsBounds.Right);
</span></span><span style=display:flex><span>                    AssertAreEqual(bottom, smartObjectLayer.ContentsBounds.Bottom);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// Let&#39;s export the embedded smart object image from the PSD smart object layer</span>
</span></span><span style=display:flex><span>                    smartObjectLayer.ExportContents(exportPath);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// Let&#39;s check if the original image is saved correctly</span>
</span></span><span style=display:flex><span>                    image.Save(psdOutputPath, <span style=color:#66d9ef>new</span> PsdOptions(image));
</span></span><span style=display:flex><span>                    image.Save(pngOutputPath, <span style=color:#66d9ef>new</span> PngOptions() { ColorType = PngColorType.TruecolorWithAlpha });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>using</span> (<span style=color:#66d9ef>var</span> innerImage = (RasterImage)smartObjectLayer.LoadContents(<span style=color:#66d9ef>null</span>))
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        AssertAreEqual(format, innerImage.FileFormat);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>// Let&#39;s invert original smart object image</span>
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>var</span> pixels = innerImage.LoadArgb32Pixels(innerImage.Bounds);
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i = <span style=color:#ae81ff>0</span>; i &lt; pixels.Length; i++)
</span></span><span style=display:flex><span>                        {
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>var</span> pixel = pixels[i];
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>var</span> alpha = (<span style=color:#66d9ef>int</span>)(pixel &amp; <span style=color:#ae81ff>0xff000000</span>);
</span></span><span style=display:flex><span>                            pixels[i] = (~(pixel &amp; <span style=color:#ae81ff>0x00ffffff</span>)) | alpha;
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        innerImage.SaveArgb32Pixels(innerImage.Bounds, pixels);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>// Let&#39;s replace the embedded smart object image in the PSD layer</span>
</span></span><span style=display:flex><span>                        smartObjectLayer.ReplaceContents(innerImage);
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// Let&#39;s check if the updated image is saved correctly</span>
</span></span><span style=display:flex><span>                    image.Save(psd2OutputPath, <span style=color:#66d9ef>new</span> PsdOptions(image));
</span></span><span style=display:flex><span>                    image.Save(png2OutputPath, <span style=color:#66d9ef>new</span> PngOptions() { ColorType = PngColorType.TruecolorWithAlpha });
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }</span></span></code></pre></div><strong>PSDNET-690. Updating text in given PSD file and saving it changes some layer and many text parameters</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>            <span style=color:#66d9ef>void</span> AssertAreEqual(<span style=color:#66d9ef>object</span> expected, <span style=color:#66d9ef>object</span> actual)
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (!<span style=color:#66d9ef>object</span>.Equals(expected, actual))
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> FormatException(
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>string</span>.Format(<span style=color:#e6db74>&#34;Actual value {0} are not equal to expected {1}.&#34;</span>, actual, expected));
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> srcFile = <span style=color:#e6db74>&#34;A.psd&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> outputFile = <span style=color:#e6db74>&#34;output.psd&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>using</span> (<span style=color:#66d9ef>var</span> psdImage = (PsdImage)Image.Load(srcFile))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> textLayer = (TextLayer)psdImage.Layers[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>                textLayer.UpdateText(<span style=color:#e6db74>&#34;abc&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                psdImage.Save(outputFile);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Check values</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>using</span> (<span style=color:#66d9ef>var</span> srcImage = (PsdImage)Image.Load(srcFile))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> srcTextLayer = (TextLayer)srcImage.Layers[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> etalonStyle = srcTextLayer.TextData.Items[<span style=color:#ae81ff>0</span>].Style;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>using</span> (<span style=color:#66d9ef>var</span> outImage = (PsdImage)Image.Load(outputFile))
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>var</span> outTextLayer = (TextLayer)outImage.Layers[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>var</span> resultStyle = outTextLayer.TextData.Items[<span style=color:#ae81ff>0</span>].Style;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    AssertAreEqual(etalonStyle.AutoLeading, resultStyle.AutoLeading);
</span></span><span style=display:flex><span>                    AssertAreEqual(etalonStyle.FontIndex, resultStyle.FontIndex);
</span></span><span style=display:flex><span>                    AssertAreEqual(etalonStyle.Underline, resultStyle.Underline);
</span></span><span style=display:flex><span>                    AssertAreEqual(etalonStyle.Strikethrough, resultStyle.Strikethrough);
</span></span><span style=display:flex><span>                    AssertAreEqual(etalonStyle.AutoKerning, resultStyle.AutoKerning);
</span></span><span style=display:flex><span>                    AssertAreEqual(etalonStyle.StandardLigatures, resultStyle.StandardLigatures);
</span></span><span style=display:flex><span>                    AssertAreEqual(etalonStyle.DiscretionaryLigatures, resultStyle.DiscretionaryLigatures);
</span></span><span style=display:flex><span>                    AssertAreEqual(etalonStyle.ContextualAlternates, resultStyle.ContextualAlternates);
</span></span><span style=display:flex><span>                    AssertAreEqual(etalonStyle.LanguageIndex, resultStyle.LanguageIndex);
</span></span><span style=display:flex><span>                    AssertAreEqual(etalonStyle.VerticalScale, resultStyle.VerticalScale);
</span></span><span style=display:flex><span>                    AssertAreEqual(etalonStyle.HorizontalScale, resultStyle.HorizontalScale);
</span></span><span style=display:flex><span>                    AssertAreEqual(etalonStyle.Fractions, resultStyle.Fractions);
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }</span></span></code></pre></div><strong>PSDNET-696. FillLayer are not updated after the creation and can not be rendered correctly</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>            <span style=color:#66d9ef>string</span> srcFile = <span style=color:#e6db74>&#34;TestSimple.psd&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> outputFile = <span style=color:#e6db74>&#34;output.png&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>using</span> (PsdImage image = (PsdImage)Image.Load(srcFile))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i = <span style=color:#ae81ff>0</span>; i &lt; image.Layers.Length; i++)
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>var</span> layer = image.Layers[i] <span style=color:#66d9ef>as</span> FillLayer;
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (layer != <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        layer.Update();
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                image.Save(outputFile, <span style=color:#66d9ef>new</span> PngOptions());
</span></span><span style=display:flex><span>            }</span></span></code></pre></div><strong>PSDNET-712. Regression: Aspose.PSD 20.8.0 can’t open file</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>            <span style=color:#66d9ef>string</span> dataDir = <span style=color:#e6db74>&#34;PSDNET712_1\\&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> filePath = dataDir + <span style=color:#e6db74>&#34;sample2.psd&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>using</span> (<span style=color:#66d9ef>var</span> <span style=color:#ae81ff>_</span> = (PsdImage)Image.Load(filePath))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>            }</span></span></code></pre></div><strong>PSDNET-714. In a specific PSD file, resizing TextLayer breaks the location value</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>            <span style=color:#66d9ef>string</span> srcFile = <span style=color:#e6db74>&#34;A.psd&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>string</span> outputFile = <span style=color:#e6db74>&#34;output.psd&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            RectangleF oldBoxBounds = <span style=color:#66d9ef>new</span> RectangleF(<span style=color:#ae81ff>16852.8613f</span>, <span style=color:#ae81ff>16861.332f</span>, <span style=color:#ae81ff>17.4458752f</span>, <span style=color:#ae81ff>14.327f</span>);
</span></span><span style=display:flex><span>            RectangleF newBoxBounds = <span style=color:#66d9ef>new</span> RectangleF(PointF.Empty, oldBoxBounds.Size);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>using</span> (<span style=color:#66d9ef>var</span> psdImage = (PsdImage)Image.Load(srcFile))
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>var</span> textLayer = (TextLayer)psdImage.Layers[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// fix the text box bounds value by shifting it to zero position.</span>
</span></span><span style=display:flex><span>                textLayer.TextBoundBox = newBoxBounds;
</span></span><span style=display:flex><span>                textLayer.TextData.UpdateLayerData();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                psdImage.Save(outputFile);
</span></span><span style=display:flex><span>            }</span></span></code></pre></div></p></p></div></div></div></div><hr></div></div></section></div></div></div></div></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>