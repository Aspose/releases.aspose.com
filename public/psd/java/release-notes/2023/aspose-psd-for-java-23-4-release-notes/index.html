<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.PSD for Java 23.4 - Release Notes</title><meta name=description content="Aspose.PSD for Java 23.4 - Release Notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/psd/java/release-notes/2023/aspose-psd-for-java-23-4-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/psd/java/release-notes/2023/aspose-psd-for-java-23-4-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.PSD for Java 23.4 - Release Notes "><meta property="og:description" content="Aspose.PSD for Java 23.4 - Release Notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/psd/java/release-notes/2023/aspose-psd-for-java-23-4-release-notes/"><meta itemprop=name content="Aspose.PSD for Java 23.4 - Release Notes"><meta itemprop=description content="Aspose.PSD for Java 23.4 - Release Notes – the latest updates and fixes."><meta itemprop=wordCount content="2454"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.PSD for Java 23.4 - Release Notes"><meta name=twitter:description content="Aspose.PSD for Java 23.4 - Release Notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/psd/>Aspose.PSD Product Family</a><span class=divider></span></li><li><a href=/psd/java/>Aspose.PSD for Java</a><span class=divider></span></li><li><a href=/psd/java/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/psd/java/release-notes/2023/>2023</a><span class=divider></span></li><li><a href=/psd/java/release-notes/2023/aspose-psd-for-java-23-4-release-notes/>Aspose.PSD for Java 23.4 - Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><div class=container><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section"><div class=box1><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.PSD for Java 23.4 - Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><div class="alert alert-primary" role=alert>This page contains release notes for <a href=https://releases.aspose.com/psd/java/23-4/>Aspose.PSD for Java 23.4</a></div><table><thead><tr><th style=text-align:left><strong>Key</strong></th><th style=text-align:left><strong>Summary</strong></th><th style=text-align:left><strong>Category</strong></th></tr></thead><tbody><tr><td style=text-align:left>PSDJAVA-446</td><td style=text-align:left>Port missed functionality from Aspose.PSD for .Net to Aspose.PSD for Java</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>PSDJAVA-441</td><td style=text-align:left>Design RawColor class for the public API to use it in PSD API instead of obsolete Color struct</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>PSDJAVA-418</td><td style=text-align:left>Integrate Modern Aspose License for Aspose.PSD</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>PSDJAVA-445</td><td style=text-align:left>Formatting move when is editing in photoshop</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDJAVA-443</td><td style=text-align:left>Editing of text using Text Portions doesn&rsquo;t save the correct result</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDJAVA-444</td><td style=text-align:left>The starting and ending of the styles or paragraphs appears in the incorrect place on the editing of Text Layer by ITextPortion</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDJAVA-445</td><td style=text-align:left>Formatting move when is editing in photoshop</td><td style=text-align:left>Bug</td></tr></tbody></table><h1 id=public-api-changes><strong>Public API Changes</strong></h1><h1 id=added-apis><strong>Added APIs:</strong></h1><ul><li>M:com.aspose.psd.FontSettings.getFontReplacements(java.lang.String)</li><li>M:com.aspose.psd.FontSettings.getReplacementFont(java.lang.String)</li><li>M:com.aspose.psd.FontSettings.setAllowedFonts(java.lang.String[])</li><li>M:com.aspose.psd.FontSettings.setFontReplacements(java.lang.String,java.lang.String[])</li><li>M:com.aspose.psd.FontSettings.isFontAllowed(java.lang.String)</li><li>M:com.aspose.psd.License.setLicense(java.io.File)</li><li>M:com.aspose.psd.License.getRenewSubscriptionStartMessage</li><li>M:com.aspose.psd.License.getErrorCodeMessages</li><li>M:com.aspose.psd.License.removeLicense</li><li>T:com.aspose.psd.fileformats.psd.layers.layerresources.FXidResource</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FXidResource.#ctor(int,int,com.aspose.psd.fileformats.psd.layers.layerresources.FilterEffectMaskData[])</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FXidResource.getSignature</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FXidResource.getKey</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FXidResource.getPsdVersion</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FXidResource.getVersion</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FXidResource.getFilterEffectMasks</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FXidResource.getLength</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FXidResource.save(com.aspose.psd.StreamContainer,int)</li><li>F:com.aspose.psd.fileformats.psd.layers.layerresources.FXidResource.FEidTypeToolKey</li><li>F:com.aspose.psd.fileformats.psd.layers.layerresources.FXidResource.FXidTypeToolKey</li><li>T:com.aspose.psd.fileformats.psd.resources.AnimatedDataSectionResource</li><li>M:com.aspose.psd.fileformats.psd.resources.AnimatedDataSectionResource.getDataSize</li><li>M:com.aspose.psd.fileformats.psd.resources.AnimatedDataSectionResource.getMinimalVersion</li><li>M:com.aspose.psd.fileformats.psd.resources.AnimatedDataSectionResource.getKeyName</li><li>M:com.aspose.psd.fileformats.psd.resources.AnimatedDataSectionResource.getAnimatedDataSection</li><li>M:com.aspose.psd.fileformats.psd.resources.AnimatedDataSectionResource.saveData(com.aspose.psd.StreamContainer)</li><li>M:com.aspose.psd.fileformats.psd.layers.ChannelInformation.#ctor(short,int,int)</li><li>M:com.aspose.psd.fileformats.psd.layers.IGradientColorPoint.getRawColor</li><li>M:com.aspose.psd.fileformats.psd.layers.IGradientColorPoint.getRawColor</li><li>M:com.aspose.psd.fileformats.psd.layers.IGradientColorPoint.setRawColor(com.aspose.psd.fileformats.psd.rawcolor.RawColor)</li><li>M:com.aspose.psd.fileformats.psd.layers.fillsettings.GradientColorPoint.setRawColor(com.aspose.psd.fileformats.psd.rawcolor.RawColor)</li><li>M:com.aspose.psd.fileformats.psd.layers.fillsettings.GradientColorPoint.getRawColor</li><li>T:com.aspose.psd.fileformats.psd.rawcolor.ColorComponent</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.ColorComponent.#ctor(byte,java.lang.String)</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.ColorComponent.getBitDepth</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.ColorComponent.getDescription</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.ColorComponent.getFullName</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.ColorComponent.getName</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.ColorComponent.getPermittedFullNames</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.ColorComponent.getValue</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.ColorComponent.setValue(long)</li><li>T:com.aspose.psd.fileformats.psd.rawcolor.RawColor</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.RawColor.#ctor(com.aspose.psd.fileformats.psd.rawcolor.ColorComponent[])</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.RawColor.#ctor(com.aspose.psd.PixelDataFormat)</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.RawColor.getAsInt</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.RawColor.getAsLong</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.RawColor.getBitDepth</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.RawColor.getComponents</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.RawColor.getColorModeName</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.RawColor.setAsInt(int)</li><li>M:com.aspose.psd.fileformats.psd.rawcolor.RawColor.setAsLong(long)</li><li>T:com.aspose.psd.fileformats.psd.layers.LayerHashCalculator</li><li>M:com.aspose.psd.fileformats.psd.layers.LayerHashCalculator.#ctor(com.aspose.psd.fileformats.psd.layers.Layer)</li><li>M:com.aspose.psd.fileformats.psd.layers.LayerHashCalculator.getChannelsHash</li><li>M:com.aspose.psd.fileformats.psd.layers.LayerHashCalculator.getBlendingHash</li><li>M:com.aspose.psd.fileformats.psd.layers.LayerHashCalculator.getContentHash</li><li>M:com.aspose.psd.fileformats.psd.layers.layereffects.BlendingOptions.addOuterGlow</li><li>M:com.aspose.psd.fileformats.psd.layers.layereffects.ILayerEffect.getEffectType</li><li>M:com.aspose.psd.fileformats.psd.layers.layereffects.ColorOverlayEffect.getEffectType</li><li>M:com.aspose.psd.fileformats.psd.layers.layereffects.InnerShadowEffect.getEffectType</li><li>M:com.aspose.psd.fileformats.psd.layers.layereffects.PatternOverlayEffect.getEffectType</li><li>M:com.aspose.psd.fileformats.psd.layers.layereffects.StrokeEffect.getEffectType</li><li>T:com.aspose.psd.fileformats.psd.layers.layereffects.StrokePositionExtensions</li><li>M:com.aspose.psd.fileformats.psd.layers.layereffects.StrokePositionExtensions.#ctor</li><li>T:com.aspose.psd.fileformats.psd.layers.layerresources.MlstResource</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.MlstResource.#ctor</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.MlstResource.getSignature</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.MlstResource.getKey</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.MlstResource.getPsdVersion</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.MlstResource.getDescriptorVersion</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.MlstResource.getItems</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.MlstResource.getLength</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.MlstResource.save(com.aspose.psd.StreamContainer,int)</li><li>F:com.aspose.psd.fileformats.psd.layers.layerresources.MlstResource.TypeToolKey</li><li>T:com.aspose.psd.fileformats.psd.layers.layerresources.AnimatedDataSectionStructure</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.AnimatedDataSectionStructure.saveData(com.aspose.psd.StreamContainer)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.AnimatedDataSectionStructure.getKey</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.AnimatedDataSectionStructure.getLength</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.AnimatedDataSectionStructure.getItems</li><li>F:com.aspose.psd.fileformats.psd.layers.layerresources.AnimatedDataSectionStructure.StructureKey</li><li>T:com.aspose.psd.fileformats.psd.layers.layerresources.VibAResource</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.VibAResource.#ctor</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.VibAResource.getVibrance</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.VibAResource.setVibrance(int)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.VibAResource.setSaturation(int)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.VibAResource.getSaturation</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.VibAResource.getKey</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.VibAResource.getLength</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.VibAResource.getPsdVersion</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.VibAResource.save(com.aspose.psd.StreamContainer,int)</li><li>F:com.aspose.psd.fileformats.psd.layers.layerresources.VibAResource.TypeToolKey</li><li>T:com.aspose.psd.fileformats.psd.layers.layereffects.outerglow.OuterGlowProcessor</li><li>M:com.aspose.psd.fileformats.psd.layers.layereffects.outerglow.OuterGlowProcessor.process(com.aspose.psd.Rectangle)</li><li>F:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.TypeToolKey2</li><li>F:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.TypeToolKey3</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.#ctor(int,com.aspose.psd.fileformats.psd.layers.layerresources.PattResourceData[])</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.getPatterns</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.setPatterns(com.aspose.psd.fileformats.psd.layers.layerresources.PattResourceData[])</li><li>T:com.aspose.psd.fileformats.psd.layers.layerresources.PattResourceData</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResourceData.#ctor</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResourceData.getHeight</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResourceData.getImageMode</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResourceData.getLength</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResourceData.getName</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResourceData.getPatternData</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResourceData.getPatternId</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResourceData.getVersion</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResourceData.getWidth</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResourceData.save(com.aspose.psd.StreamContainer)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResourceData.setName(java.lang.String)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResourceData.setPattern(int[],com.aspose.psd.Rectangle)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResourceData.setPatternId(java.lang.String)</li><li>T:com.aspose.psd.fileformats.psd.layers.layerresources.typetoolinfostructures.PathStructure</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.typetoolinfostructures.PathStructure.#ctor(com.aspose.psd.fileformats.psd.layers.layerresources.ClassID)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.typetoolinfostructures.PathStructure.setPath(java.lang.String)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.typetoolinfostructures.PathStructure.getPrefix</li><li>F:com.aspose.psd.fileformats.psd.layers.layerresources.typetoolinfostructures.PathStructure.StructureKey</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.typetoolinfostructures.PathStructure.getLength</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.typetoolinfostructures.PathStructure.getPath</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.typetoolinfostructures.PathStructure.getKey</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.typetoolinfostructures.PathStructure.saveData(com.aspose.psd.StreamContainer)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.typetoolinfostructures.PathStructure.setPrefix(java.lang.String)</li><li>T:com.aspose.psd.fileformats.psd.layers.adjustmentlayers.PosterizeLayer</li><li>M:com.aspose.psd.fileformats.psd.layers.adjustmentlayers.PosterizeLayer.getLevels</li><li>M:com.aspose.psd.fileformats.psd.layers.adjustmentlayers.PosterizeLayer.setLevels(short)</li><li>T:com.aspose.psd.fileformats.psd.layers.layerresources.FilterEffectMaskData</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FilterEffectMaskData.#ctor(java.lang.String,com.aspose.psd.Rectangle,int,int,com.aspose.psd.fileformats.psd.layers.ChannelInformation[],com.aspose.psd.fileformats.psd.layers.ChannelInformation,com.aspose.psd.Rectangle,com.aspose.psd.fileformats.psd.layers.ChannelInformation)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FilterEffectMaskData.getLength</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FilterEffectMaskData.getGUID</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FilterEffectMaskData.getRectangle</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FilterEffectMaskData.getPixelsDepth</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FilterEffectMaskData.getMaxChannels</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FilterEffectMaskData.getChannels</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FilterEffectMaskData.getUserMask</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FilterEffectMaskData.getMaskRectangle</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FilterEffectMaskData.getSheetMask</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.FilterEffectMaskData.saveData(com.aspose.psd.StreamContainer)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.ShmdResource.setSubResources(com.aspose.psd.fileformats.psd.layers.LayerResource[])</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.linkresources.LinkDataSource.getCompInfoKeyName</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.typetoolinfostructures.ListStructure.getItemList</li><li>M:com.aspose.psd.fileformats.psd.layers.smartobjects.SmartObjectLayer.getSmartFilters</li><li>T:com.aspose.psd.PixelsData</li><li>M:com.aspose.psd.PixelsData.#ctor</li><li>M:com.aspose.psd.PixelsData.#ctor(int[],com.aspose.psd.Rectangle)</li><li>M:com.aspose.psd.PixelsData.getBounds</li><li>M:com.aspose.psd.PixelsData.getPixels</li><li>M:com.aspose.psd.PixelsData.setBounds(com.aspose.psd.Rectangle)</li><li>M:com.aspose.psd.PixelsData.setPixels(int[])</li><li>M:com.aspose.psd.fileformats.psd.layers.text.IText.getTextOrientation</li><li>M:com.aspose.psd.fileformats.psd.layers.text.IText.setTextOrientation(int)</li><li>M:com.aspose.psd.fileformats.psd.layers.text.ITextStyle.get_noBreak</li><li>M:com.aspose.psd.fileformats.psd.layers.text.ITextStyle.set_noBreak(boolean)</li><li>M:com.aspose.psd.fileformats.psd.layers.text.ITextStyle.is_isStandardVerticalRomanAlignmentEnabled</li><li>M:com.aspose.psd.fileformats.psd.layers.text.ITextStyle.set_isStandardVerticalRomanAlignmentEnabled(boolean)</li><li>M:com.aspose.psd.imageloadoptions.PsdLoadOptions.getAllowWarpRepaint</li><li>M:com.aspose.psd.imageloadoptions.PsdLoadOptions.setAllowWarpRepaint(boolean)</li><li>M:com.aspose.psd.fileformats.psd.layers.Layer.save(com.aspose.psd.system.io.Stream)</li><li>M:com.aspose.psd.fileformats.psd.layers.LayerGroup.isOpen</li><li>M:com.aspose.psd.fileformats.psd.layers.LayerGroup.setOpen(boolean)</li><li>M:com.aspose.psd.fileformats.psd.layers.TextLayer.resize(int,int,int)</li><li>M:com.aspose.psd.xmp.Namespaces.#ctor</li></ul><h1 id=removed-apis><strong>Removed APIs:</strong></h1><ul><li>M:com.aspose.psd.FontSettings.addFontsFolder(java.lang.String)</li><li>M:com.aspose.psd.FontSettings.removeFontsFolder(java.lang.String)</li><li>M:com.aspose.psd.fileformats.psd.layers.ChannelInformation.#ctor</li><li>M:com.aspose.psd.fileformats.psd.layers.ChannelInformation.#ctor(short,byte[],byte[])</li><li>M:com.aspose.psd.fileformats.psd.layers.Layer.saveData(java.io.OutputStream)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.Lfx2Resource.getBlendMode</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.Lfx2Resource.getData</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.Lfx2Resource.getEffectColor</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.Lfx2Resource.getOpacity</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.Lfx2Resource.setBlendMode(long)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.Lfx2Resource.setData(byte[])</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.Lfx2Resource.setEffectColor(com.aspose.psd.Color)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.Lfx2Resource.setOpacity(double)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.#ctor(byte[])</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.getHeight</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.getImageMode</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.getName</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.getPatternData</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.getPatternId</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.getPatternLength</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.getVersion</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.getWidth</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.setHeight(short)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.setImageMode(short)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.setName(java.lang.String)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.setPattern(int[],com.aspose.psd.Rectangle)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.setPatternId(java.lang.String)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.setPatternLength(int)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.setVersion(int)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.PattResource.setWidth(short)</li></ul><h1 id=usage-examples><strong>Usage examples:</strong></h1><p><strong>PSDJAVA-446. Port missed functionality from Aspose.PSD for .Net to Aspose.PSD for Java</strong></p><p>Please check <a href=https://reference.aspose.com/psd/java/>API Reference for Aspose.PSD for Java </a>. Not all examples of using new API were copied and tested.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Examples will be provided later.
</span></span></span></code></pre></div><p><strong>PSDJAVA-441. Design RawColor class for the public API to use it in PSD API instead of obsolete Color struct</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>		PixelDataFormat rgb32Bpp <span style=color:#f92672>=</span> PixelDataFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>getRgb32Bpp</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>		RawColor color <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> RawColor<span style=color:#f92672>(</span>rgb32Bpp<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>		Color oldColor <span style=color:#f92672>=</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>fromArgb</span><span style=color:#f92672>(</span>5<span style=color:#f92672>,</span> 1<span style=color:#f92672>,</span> 2<span style=color:#f92672>,</span> 3<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>int</span> argbValue <span style=color:#f92672>=</span> oldColor<span style=color:#f92672>.</span><span style=color:#a6e22e>toArgb</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>		color<span style=color:#f92672>.</span><span style=color:#a6e22e>setAsInt</span><span style=color:#f92672>(</span>argbValue<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		Assertions<span style=color:#f92672>.</span><span style=color:#a6e22e>assertEquals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;ARGB&#34;</span><span style=color:#f92672>,</span> color<span style=color:#f92672>.</span><span style=color:#a6e22e>getColorModeName</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		Assertions<span style=color:#f92672>.</span><span style=color:#a6e22e>assertEquals</span><span style=color:#f92672>(</span>32<span style=color:#f92672>,</span> color<span style=color:#f92672>.</span><span style=color:#a6e22e>getBitDepth</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		Assertions<span style=color:#f92672>.</span><span style=color:#a6e22e>assertEquals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;A Alpha&#34;</span><span style=color:#f92672>,</span> color<span style=color:#f92672>.</span><span style=color:#a6e22e>getComponents</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getFullName</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		Assertions<span style=color:#f92672>.</span><span style=color:#a6e22e>assertEquals</span><span style=color:#f92672>(</span>5<span style=color:#f92672>,</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span><span style=color:#f92672>)</span>color<span style=color:#f92672>.</span><span style=color:#a6e22e>getComponents</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		Assertions<span style=color:#f92672>.</span><span style=color:#a6e22e>assertEquals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;R Red&#34;</span><span style=color:#f92672>,</span> color<span style=color:#f92672>.</span><span style=color:#a6e22e>getComponents</span><span style=color:#f92672>()[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getFullName</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		Assertions<span style=color:#f92672>.</span><span style=color:#a6e22e>assertEquals</span><span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span><span style=color:#f92672>)</span>color<span style=color:#f92672>.</span><span style=color:#a6e22e>getComponents</span><span style=color:#f92672>()[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		Assertions<span style=color:#f92672>.</span><span style=color:#a6e22e>assertEquals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;G Green&#34;</span><span style=color:#f92672>,</span> color<span style=color:#f92672>.</span><span style=color:#a6e22e>getComponents</span><span style=color:#f92672>()[</span>2<span style=color:#f92672>].</span><span style=color:#a6e22e>getFullName</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		Assertions<span style=color:#f92672>.</span><span style=color:#a6e22e>assertEquals</span><span style=color:#f92672>(</span>2<span style=color:#f92672>,</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span><span style=color:#f92672>)</span>color<span style=color:#f92672>.</span><span style=color:#a6e22e>getComponents</span><span style=color:#f92672>()[</span>2<span style=color:#f92672>].</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		Assertions<span style=color:#f92672>.</span><span style=color:#a6e22e>assertEquals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;B Blue&#34;</span><span style=color:#f92672>,</span> color<span style=color:#f92672>.</span><span style=color:#a6e22e>getComponents</span><span style=color:#f92672>()[</span>3<span style=color:#f92672>].</span><span style=color:#a6e22e>getFullName</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>		Assertions<span style=color:#f92672>.</span><span style=color:#a6e22e>assertEquals</span><span style=color:#f92672>(</span>3<span style=color:#f92672>,</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span><span style=color:#f92672>)</span>color<span style=color:#f92672>.</span><span style=color:#a6e22e>getComponents</span><span style=color:#f92672>()[</span>3<span style=color:#f92672>].</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		Assertions<span style=color:#f92672>.</span><span style=color:#a6e22e>assertEquals</span><span style=color:#f92672>(</span>argbValue<span style=color:#f92672>,</span> color<span style=color:#f92672>.</span><span style=color:#a6e22e>getAsInt</span><span style=color:#f92672>());</span></span></span></code></pre></div><p><strong>PSDJAVA-445. Formatting move when is editing in photoshop</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#66d9ef>throws</span> Exception <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    String strings1 <span style=color:#f92672>=</span> Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>getCurrentDirectory</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/input-lsaks-strings1-forTicket.txt&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    String psdInput <span style=color:#f92672>=</span> Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>getCurrentDirectory</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/input_for_ticket.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    PsdImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>psdInput<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> linesLsaks <span style=color:#f92672>=</span> Files<span style=color:#f92672>.</span><span style=color:#a6e22e>readAllLines</span><span style=color:#f92672>(</span>Paths<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span>strings1<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    Map<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> String<span style=color:#f92672>&gt;</span> lsaksDictionary <span style=color:#f92672>=</span> linesLsaks<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>line <span style=color:#f92672>-&gt;</span> line <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>line<span style=color:#f92672>.</span><span style=color:#a6e22e>trim</span><span style=color:#f92672>().</span><span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>map</span><span style=color:#f92672>(</span>line <span style=color:#f92672>-&gt;</span> line<span style=color:#f92672>.</span><span style=color:#a6e22e>split</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;=&#34;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>toMap</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>                    items <span style=color:#f92672>-&gt;</span> items<span style=color:#f92672>[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>trim</span><span style=color:#f92672>(),</span>
</span></span><span style=display:flex><span>                    items <span style=color:#f92672>-&gt;</span> items<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>trim</span><span style=color:#f92672>(),</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>(</span>oldValue<span style=color:#f92672>,</span> newValue<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> newValue<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//Step: Replace text
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Layer layerItem <span style=color:#f92672>:</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!(</span>layerItem <span style=color:#66d9ef>instanceof</span> TextLayer<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        TextLayer layerToExtractText <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>TextLayer<span style=color:#f92672>)</span> layerItem<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        Pattern p <span style=color:#f92672>=</span> Pattern<span style=color:#f92672>.</span><span style=color:#a6e22e>compile</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak[^#]+#&#34;</span><span style=color:#f92672>,</span> Pattern<span style=color:#f92672>.</span><span style=color:#a6e22e>CASE_INSENSITIVE</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        Matcher m <span style=color:#f92672>=</span> p<span style=color:#f92672>.</span><span style=color:#a6e22e>matcher</span><span style=color:#f92672>(</span>layerToExtractText<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>m<span style=color:#f92672>.</span><span style=color:#a6e22e>find</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        String resultLsakValue <span style=color:#f92672>=</span> m<span style=color:#f92672>.</span><span style=color:#a6e22e>group</span><span style=color:#f92672>().</span><span style=color:#a6e22e>trim</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>resultLsakValue<span style=color:#f92672>.</span><span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        replaceLsakText<span style=color:#f92672>(</span>layerToExtractText<span style=color:#f92672>.</span><span style=color:#a6e22e>getTextData</span><span style=color:#f92672>(),</span> lsaksDictionary<span style=color:#f92672>);</span> <span style=color:#75715e>// replaceLsakText needs to be defined
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//Step: Format and Center
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Layer layerItem <span style=color:#f92672>:</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!(</span>layerItem <span style=color:#66d9ef>instanceof</span> TextLayer<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        TextLayer layerToExtractText <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>TextLayer<span style=color:#f92672>)</span> layerItem<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        formatStyleText<span style=color:#f92672>(</span>layerToExtractText<span style=color:#f92672>.</span><span style=color:#a6e22e>getTextData</span><span style=color:#f92672>(),</span> lsaksDictionary<span style=color:#f92672>);</span> <span style=color:#75715e>// formatStyleText needs to be defined
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;c:\\output.psd&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>replaceText</span><span style=color:#f92672>(</span>String lsak<span style=color:#f92672>,</span> Map<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> String<span style=color:#f92672>&gt;</span> lsaksToReplace<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    StringBuilder sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>lsak<span style=color:#f92672>.</span><span style=color:#a6e22e>trim</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Map<span style=color:#f92672>.</span><span style=color:#a6e22e>Entry</span><span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> String<span style=color:#f92672>&gt;</span> kvp <span style=color:#f92672>:</span> lsaksToReplace<span style=color:#f92672>.</span><span style=color:#a6e22e>entrySet</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> index<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>((</span>index <span style=color:#f92672>=</span> sb<span style=color:#f92672>.</span><span style=color:#a6e22e>indexOf</span><span style=color:#f92672>(</span>kvp<span style=color:#f92672>.</span><span style=color:#a6e22e>getKey</span><span style=color:#f92672>()))</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span>1<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            sb<span style=color:#f92672>.</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span>index<span style=color:#f92672>,</span> index <span style=color:#f92672>+</span> kvp<span style=color:#f92672>.</span><span style=color:#a6e22e>getKey</span><span style=color:#f92672>().</span><span style=color:#a6e22e>length</span><span style=color:#f92672>(),</span> kvp<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> index<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#f92672>((</span>index <span style=color:#f92672>=</span> sb<span style=color:#f92672>.</span><span style=color:#a6e22e>indexOf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;\r&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span>1<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        sb<span style=color:#f92672>.</span><span style=color:#a6e22e>deleteCharAt</span><span style=color:#f92672>(</span>index<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#f92672>((</span>index <span style=color:#f92672>=</span> sb<span style=color:#f92672>.</span><span style=color:#a6e22e>indexOf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span>1<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        sb<span style=color:#f92672>.</span><span style=color:#a6e22e>deleteCharAt</span><span style=color:#f92672>(</span>index<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>replaceLsakText</span><span style=color:#f92672>(</span>IText textData<span style=color:#f92672>,</span> Map<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> String<span style=color:#f92672>&gt;</span> lsaksDictionary<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> countPortions <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>().</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    ITextStyle defaultStyle <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    ITextParagraph defaultParagraph <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    String textToReplace <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// remove old portions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> countPortions<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        textData<span style=color:#f92672>.</span><span style=color:#a6e22e>removePortion</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ITextPortion newPortion <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>producePortion</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultParagraph<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultStyle<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>setText</span><span style=color:#f92672>(</span>replaceText<span style=color:#f92672>(</span>textToReplace<span style=color:#f92672>,</span> lsaksDictionary<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    textData<span style=color:#f92672>.</span><span style=color:#a6e22e>addPortion</span><span style=color:#f92672>(</span>newPortion<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    textData<span style=color:#f92672>.</span><span style=color:#a6e22e>updateLayerData</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>formatStyleText</span><span style=color:#f92672>(</span>IText textData<span style=color:#f92672>,</span> Map<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> String<span style=color:#f92672>&gt;</span> lsaksToReplace<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// validate if there are tags
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Pattern tagPattern <span style=color:#f92672>=</span> Pattern<span style=color:#f92672>.</span><span style=color:#a6e22e>compile</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;&lt;[^&gt;]+&gt;&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    Matcher tagMatcher <span style=color:#f92672>=</span> tagPattern<span style=color:#f92672>.</span><span style=color:#a6e22e>matcher</span><span style=color:#f92672>(</span>textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>boolean</span> hasTags <span style=color:#f92672>=</span> tagMatcher<span style=color:#f92672>.</span><span style=color:#a6e22e>find</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> countPortions <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>().</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    ITextStyle defaultStyle <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    ITextParagraph defaultParagraph <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>hasTags<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        String tagRegex1 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;[^&lt;&gt;]+|&lt;\\s*([^ &gt;]+)[^&gt;]*&gt;.*?&lt;\\s*/\\s*\\1\\s*&gt;&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        Matcher matchesImgSrc <span style=color:#f92672>=</span> Pattern<span style=color:#f92672>.</span><span style=color:#a6e22e>compile</span><span style=color:#f92672>(</span>tagRegex1<span style=color:#f92672>,</span> Pattern<span style=color:#f92672>.</span><span style=color:#a6e22e>CASE_INSENSITIVE</span> <span style=color:#f92672>|</span> Pattern<span style=color:#f92672>.</span><span style=color:#a6e22e>DOTALL</span><span style=color:#f92672>).</span><span style=color:#a6e22e>matcher</span><span style=color:#f92672>(</span>textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        List<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> listlsaks <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>matchesImgSrc<span style=color:#f92672>.</span><span style=color:#a6e22e>find</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            listlsaks<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>matchesImgSrc<span style=color:#f92672>.</span><span style=color:#a6e22e>group</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        String<span style=color:#f92672>[]</span> textSplit <span style=color:#f92672>=</span> listlsaks<span style=color:#f92672>.</span><span style=color:#a6e22e>toArray</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> String<span style=color:#f92672>[</span>0<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> countPortions<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            textData<span style=color:#f92672>.</span><span style=color:#a6e22e>removePortion</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>String s <span style=color:#f92672>:</span> textSplit<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            ITextPortion newPortion <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>producePortion</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultParagraph<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultStyle<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>s<span style=color:#f92672>.</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;font:&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>setFontName</span><span style=color:#f92672>(</span>s<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>s<span style=color:#f92672>.</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;pt&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>setFontSize</span><span style=color:#f92672>(</span>Double<span style=color:#f92672>.</span><span style=color:#a6e22e>parseDouble</span><span style=color:#f92672>(</span>s<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>s<span style=color:#f92672>.</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;color:&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>setFillColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>fromName</span><span style=color:#f92672>(</span>s<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>s<span style=color:#f92672>.</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;br/&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                s <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;\r&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>setText</span><span style=color:#f92672>(</span>s<span style=color:#f92672>.</span><span style=color:#a6e22e>replaceAll</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;&lt;.*?&gt;&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>            textData<span style=color:#f92672>.</span><span style=color:#a6e22e>addPortion</span><span style=color:#f92672>(</span>newPortion<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        textData<span style=color:#f92672>.</span><span style=color:#a6e22e>updateLayerData</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>PSDJAVA-443. Editing of text using Text Portions doesn&rsquo;t save the correct result</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    String sourceFilePSDEmail <span style=color:#f92672>=</span> Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>getCurrentDirectory</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/files-input/inputv5.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    PsdImage imageTestEmail <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>sourceFilePSDEmail<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    var layers <span style=color:#f92672>=</span> imageTestEmail<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>Layer<span style=color:#f92672>&gt;</span> layersOnlyTextLayers <span style=color:#f92672>=</span> Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>(</span>imageTestEmail<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>layer <span style=color:#f92672>-&gt;</span> layer <span style=color:#66d9ef>instanceof</span> TextLayer<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>toList</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Layer layerItem <span style=color:#f92672>:</span> layers<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>boolean</span> isTextLayer <span style=color:#f92672>=</span> layerItem <span style=color:#66d9ef>instanceof</span> TextLayer<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>isTextLayer<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            var layerTLToUpdateText <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>TextLayer<span style=color:#f92672>)</span> layerItem<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>//Buscar lsak text
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>().</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;lsak&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                var textDataTL <span style=color:#f92672>=</span> layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getTextData</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>textDataTL<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>().</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;lsak&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>&amp;&amp;</span> textDataTL<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>().</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;\r&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>//Replace text
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    replaceLsakText<span style=color:#f92672>(</span>textDataTL<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>//Format text
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    formatStyleText<span style=color:#f92672>(</span>textDataTL<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    String outputFile <span style=color:#f92672>=</span> Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>getCurrentDirectory</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;TestEmailFifthMethod&#34;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    imageTestEmail<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outputFile<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>replaceText</span><span style=color:#f92672>(</span>String lsak<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    StringBuilder sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>lsak<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_007#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Power play.&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_008#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Πιο επεκτατικοί κόσμοι. Γρήγοροι χρόνοι φόρτωσης. Υψηλά ποσοστά καρέ και ευρύτερο φάσμα χρωμάτων. Ένας υπολογιστής με Windows ήταν πάντα η καλύτερη πλατφόρμα για παιχνίδια—και στα Windows 11, γίνεται ακόμα καλύτερος.&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_009#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Contoso.com で新しい Windows 11 PC を見つけてください。&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_010#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Buy now&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_011#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, &lt;font:Segoe UI Semibold&gt; quis nostrud exercitation ullamco&lt;/font&gt; laboris &lt;font:Segoe UI Semibold&gt;nisi ut aliquip&lt;/font&gt; ex ea commodo consequat. &lt;font:Segoe UI Semibold&gt;Duis aute irure dolor in reprehenderit &lt;/font&gt;in voluptate velit esse cillum dolore eu fugiat nulla pariatur.  &lt;br/&gt; Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;\r&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>replaceLsakText</span><span style=color:#f92672>(</span>IText textData<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    var countPortions <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>().</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    ITextStyle defaultStyle <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    ITextParagraph defaultParagraph <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    var textToReplace <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//remove old portions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> <span style=color:#f92672>(</span>countPortions<span style=color:#f92672>);</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        textData<span style=color:#f92672>.</span><span style=color:#a6e22e>removePortion</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ITextPortion newPortion <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>producePortion</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultParagraph<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultStyle<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>setText</span><span style=color:#f92672>(</span>replaceText<span style=color:#f92672>(</span>textToReplace<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    textData<span style=color:#f92672>.</span><span style=color:#a6e22e>addPortion</span><span style=color:#f92672>(</span>newPortion<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    textData<span style=color:#f92672>.</span><span style=color:#a6e22e>updateLayerData</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>formatStyleText</span><span style=color:#f92672>(</span>IText textData<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//validar si tiene tags
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Regex tagRegex <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Regex<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;&lt;[^&gt;]+&gt;&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>boolean</span> hasTags <span style=color:#f92672>=</span> tagRegex<span style=color:#f92672>.</span><span style=color:#a6e22e>isMatch</span><span style=color:#f92672>(</span>textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>    var countPortions <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>().</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    ITextStyle defaultStyle <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    ITextParagraph defaultParagraph <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>hasTags<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        var tagRegex2 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;[^&lt;&gt;]+|&lt;\s*([^ &gt;]+)[^&gt;]*&gt;.*?&lt;\s*/\s*\1\s*&gt;&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        var matchesImgSrc <span style=color:#f92672>=</span> Regex<span style=color:#f92672>.</span><span style=color:#a6e22e>matches</span><span style=color:#f92672>(</span>textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>(),</span> tagRegex2<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                RegexOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>IgnoreCase</span> <span style=color:#f92672>|</span> RegexOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>Singleline</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        List<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> listlsaks <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Match m <span style=color:#f92672>:</span> matchesImgSrc<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            listlsaks<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>m<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        String<span style=color:#f92672>[]</span> textSplit <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>String<span style=color:#f92672>[])</span> listlsaks<span style=color:#f92672>.</span><span style=color:#a6e22e>toArray</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> <span style=color:#f92672>(</span>countPortions<span style=color:#f92672>);</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            textData<span style=color:#f92672>.</span><span style=color:#a6e22e>removePortion</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> textSplit<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            ITextPortion newPortion <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>producePortion</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultParagraph<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultStyle<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>boolean</span> hasTagsIsaks <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            hasTagsIsaks <span style=color:#f92672>=</span> tagRegex<span style=color:#f92672>.</span><span style=color:#a6e22e>isMatch</span><span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>hasTagsIsaks<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>].</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;font:&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>setFontName</span><span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>].</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;pt&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>setFontSize</span><span style=color:#f92672>(</span>Double<span style=color:#f92672>.</span><span style=color:#a6e22e>parseDouble</span><span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>]));</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>].</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;color&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>setFillColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>fromName</span><span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>]));</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>setText</span><span style=color:#f92672>(</span>Regex<span style=color:#f92672>.</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>],</span> <span style=color:#e6db74>&#34;&lt;.*?&gt;&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>.</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;br/&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;//&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>                textData<span style=color:#f92672>.</span><span style=color:#a6e22e>addPortion</span><span style=color:#f92672>(</span>newPortion<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>setText</span><span style=color:#f92672>(</span>Regex<span style=color:#f92672>.</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>],</span> <span style=color:#e6db74>&#34;&lt;.*?&gt;&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>.</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;br/&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;//&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>                textData<span style=color:#f92672>.</span><span style=color:#a6e22e>addPortion</span><span style=color:#f92672>(</span>newPortion<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        var textToReplace <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> <span style=color:#f92672>(</span>countPortions<span style=color:#f92672>);</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            textData<span style=color:#f92672>.</span><span style=color:#a6e22e>removePortion</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        ITextPortion newPortion <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>producePortion</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultParagraph<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultStyle<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>setText</span><span style=color:#f92672>(</span>textToReplace
</span></span><span style=display:flex><span>                <span style=color:#f92672>.</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;\r&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>.</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;br/&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;//&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>        textData<span style=color:#f92672>.</span><span style=color:#a6e22e>addPortion</span><span style=color:#f92672>(</span>newPortion<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    textData<span style=color:#f92672>.</span><span style=color:#a6e22e>updateLayerData</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>PSDJAVA-444. The starting and ending of the styles or paragraphs appears in the incorrect place on the editing of Text Layer by ITextPortion</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    String sourceFilePSDEmail <span style=color:#f92672>=</span> Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>getCurrentDirectory</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/inputv2.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    String outputFile <span style=color:#f92672>=</span> Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>getCurrentDirectory</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/export.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    PsdImage imageTestEmail <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>sourceFilePSDEmail<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Layer<span style=color:#f92672>[]</span> layers <span style=color:#f92672>=</span> imageTestEmail<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Layer layerItem <span style=color:#f92672>:</span> layers<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>boolean</span> isTextLayer <span style=color:#f92672>=</span> layerItem <span style=color:#66d9ef>instanceof</span> TextLayer<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>isTextLayer<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            var layerTLToUpdateText <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>TextLayer<span style=color:#f92672>)</span> layerItem<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>//Buscar lsak text
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>().</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;lsak&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                var textDataTL <span style=color:#f92672>=</span> layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getTextData</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>textDataTL<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>().</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;lsak&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>//Step: Replace text
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    replaceLsakFourthMethod<span style=color:#f92672>(</span>textDataTL<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Replaced text &#34;</span> <span style=color:#f92672>+</span> textDataTL<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>//Step: Format text
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    formatLsakFourthMethod<span style=color:#f92672>(</span>textDataTL<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Formated text &#34;</span> <span style=color:#f92672>+</span> textDataTL<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>//Step: Center textlayer
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getDisplayName</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;cc&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>||</span> layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getDisplayName</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;tl&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>||</span> layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getDisplayName</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;cl&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>//old Values
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                        var boundBoxOld <span style=color:#f92672>=</span> layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getTextBoundBox</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        var wordSizeOld <span style=color:#f92672>=</span> layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getSize</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        var OldY <span style=color:#f92672>=</span> layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getTop</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        textDataTL<span style=color:#f92672>.</span><span style=color:#a6e22e>updateLayerData</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>// new values
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                        var wordSize <span style=color:#f92672>=</span> layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getSize</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        var boundBox <span style=color:#f92672>=</span> layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getTextBoundBox</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        var newSize <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Size<span style=color:#f92672>((</span><span style=color:#66d9ef>int</span><span style=color:#f92672>)</span> Math<span style=color:#f92672>.</span><span style=color:#a6e22e>ceil</span><span style=color:#f92672>(</span>boundBoxOld<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>()),</span> wordSize<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        var beforePoint <span style=color:#f92672>=</span> centerInRectangle<span style=color:#f92672>(</span>wordSize<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> RectangleF<span style=color:#f92672>(</span>layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getLeft</span><span style=color:#f92672>(),</span>
</span></span><span style=display:flex><span>                                layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getTop</span><span style=color:#f92672>(),</span> layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>(),</span> boundBoxOld<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>()));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>setTextBoundBox</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>new</span> RectangleF<span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> PointF<span style=color:#f92672>(</span>0<span style=color:#f92672>,</span> beforePoint<span style=color:#f92672>.</span><span style=color:#a6e22e>getY</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> OldY<span style=color:#f92672>),</span> Size<span style=color:#f92672>.</span><span style=color:#a6e22e>to_SizeF</span><span style=color:#f92672>(</span>newSize<span style=color:#f92672>)));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        var newPoint <span style=color:#f92672>=</span> centerInRectangle<span style=color:#f92672>(</span>wordSize<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> RectangleF<span style=color:#f92672>(</span>layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getLeft</span><span style=color:#f92672>(),</span>
</span></span><span style=display:flex><span>                                layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getTop</span><span style=color:#f92672>(),</span> layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>(),</span> boundBoxOld<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>()));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>setLeft</span><span style=color:#f92672>((</span><span style=color:#66d9ef>int</span><span style=color:#f92672>)</span> newPoint<span style=color:#f92672>.</span><span style=color:#a6e22e>getX</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        layerTLToUpdateText<span style=color:#f92672>.</span><span style=color:#a6e22e>setTop</span><span style=color:#f92672>((</span><span style=color:#66d9ef>int</span><span style=color:#f92672>)</span> newPoint<span style=color:#f92672>.</span><span style=color:#a6e22e>getY</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        textDataTL<span style=color:#f92672>.</span><span style=color:#a6e22e>updateLayerData</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Center text&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    imageTestEmail<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outputFile<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> PointF <span style=color:#a6e22e>centerInRectangle</span><span style=color:#f92672>(</span>Size inner<span style=color:#f92672>,</span> RectangleF outer<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    PointF pointF <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PointF<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    pointF<span style=color:#f92672>.</span><span style=color:#a6e22e>setX</span><span style=color:#f92672>(</span>outer<span style=color:#f92672>.</span><span style=color:#a6e22e>getX</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#f92672>(</span>outer<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> inner<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>())</span> <span style=color:#f92672>/</span> 2<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    pointF<span style=color:#f92672>.</span><span style=color:#a6e22e>setY</span><span style=color:#f92672>(</span>outer<span style=color:#f92672>.</span><span style=color:#a6e22e>getY</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#f92672>(</span>outer<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> inner<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>())</span> <span style=color:#f92672>/</span> 2<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> pointF<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>replaceLsakFourthMethod</span><span style=color:#f92672>(</span>IText textData<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//validar si tiene tags
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Regex tagRegex <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Regex<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;&lt;[^&gt;]+&gt;&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    var countPortions <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>().</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ITextStyle defaultStyle <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ITextParagraph defaultParagraph <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    var textToReplace <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//Quitar portions antiguos sin formato
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> <span style=color:#f92672>(</span>countPortions<span style=color:#f92672>);</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        textData<span style=color:#f92672>.</span><span style=color:#a6e22e>removePortion</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ITextPortion newPortion <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>producePortion</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultParagraph<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultStyle<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>setText</span><span style=color:#f92672>(</span>replaceBarraNBarraRByExelValuesFourthMethodFirst<span style=color:#f92672>(</span>textToReplace<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    textData<span style=color:#f92672>.</span><span style=color:#a6e22e>addPortion</span><span style=color:#f92672>(</span>newPortion<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    textData<span style=color:#f92672>.</span><span style=color:#a6e22e>updateLayerData</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>formatLsakFourthMethod</span><span style=color:#f92672>(</span>IText textData<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//validar si tiene tags
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Regex tagRegex <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Regex<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;&lt;[^&gt;]+&gt;&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>boolean</span> hasTags <span style=color:#f92672>=</span> tagRegex<span style=color:#f92672>.</span><span style=color:#a6e22e>isMatch</span><span style=color:#f92672>(</span>textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    var countPortions <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>().</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ITextStyle defaultStyle <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ITextParagraph defaultParagraph <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>hasTags<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        var tagRegex2 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;[^&lt;&gt;]+|&lt;\s*([^ &gt;]+)[^&gt;]*&gt;.*?&lt;\s*/\s*\1\s*&gt;&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        var matchesImgSrc <span style=color:#f92672>=</span> Regex<span style=color:#f92672>.</span><span style=color:#a6e22e>matches</span><span style=color:#f92672>(</span>textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>(),</span> tagRegex2<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                RegexOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>IgnoreCase</span> <span style=color:#f92672>|</span> RegexOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>Singleline</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        List<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> listlsaks <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Match m <span style=color:#f92672>:</span> matchesImgSrc<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            listlsaks<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>m<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        String<span style=color:#f92672>[]</span> textSplit <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>String<span style=color:#f92672>[])</span> listlsaks<span style=color:#f92672>.</span><span style=color:#a6e22e>toArray</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> <span style=color:#f92672>(</span>countPortions<span style=color:#f92672>);</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            textData<span style=color:#f92672>.</span><span style=color:#a6e22e>removePortion</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> textSplit<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            ITextPortion newPortion <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>producePortion</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultParagraph<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultStyle<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>].</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;font:&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>setFontName</span><span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>].</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;pt&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>setFontSize</span><span style=color:#f92672>(</span>Double<span style=color:#f92672>.</span><span style=color:#a6e22e>parseDouble</span><span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>]));</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>].</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;color&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>setFillColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>fromName</span><span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>]));</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>].</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;br&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>].</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;br/&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;//&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>setText</span><span style=color:#f92672>(</span>textSplit<span style=color:#f92672>[</span>i<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>boolean</span> hasTagsIsaks <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            hasTagsIsaks <span style=color:#f92672>=</span> tagRegex<span style=color:#f92672>.</span><span style=color:#a6e22e>isMatch</span><span style=color:#f92672>(</span>newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>hasTagsIsaks<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                String delimeters <span style=color:#f92672>=</span> <span style=color:#f92672>(</span><span style=color:#e6db74>&#34;&lt;[^&gt;]+&gt;&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                var partsIsaks <span style=color:#f92672>=</span> Regex<span style=color:#f92672>.</span><span style=color:#a6e22e>split</span><span style=color:#f92672>(</span>newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>(),</span> String<span style=color:#f92672>.</span><span style=color:#a6e22e>format</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>&#34;\s+(?={0})&#34;</span><span style=color:#f92672>,</span> String<span style=color:#f92672>.</span><span style=color:#a6e22e>join</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;| &#34;</span><span style=color:#f92672>,</span> delimeters<span style=color:#f92672>)));</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> j <span style=color:#f92672>&lt;</span> partsIsaks<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> j<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    var item <span style=color:#f92672>=</span> partsIsaks<span style=color:#f92672>[</span>j<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    ITextPortion newPortionFromIsak <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>producePortion</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    newPortionFromIsak<span style=color:#f92672>.</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultParagraph<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    newPortionFromIsak<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultStyle<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>partsIsaks<span style=color:#f92672>[</span>j<span style=color:#f92672>].</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;font:&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>||</span> partsIsaks<span style=color:#f92672>[</span>j<span style=color:#f92672>].</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;font :&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                        newPortionFromIsak<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>setFontName</span><span style=color:#f92672>(</span>partsIsaks<span style=color:#f92672>[</span>j<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>partsIsaks<span style=color:#f92672>[</span>j<span style=color:#f92672>].</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;pt&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                        newPortionFromIsak<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>setFontSize</span><span style=color:#f92672>(</span>Double<span style=color:#f92672>.</span><span style=color:#a6e22e>parseDouble</span><span style=color:#f92672>(</span>partsIsaks<span style=color:#f92672>[</span>j<span style=color:#f92672>]));</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>partsIsaks<span style=color:#f92672>[</span>j<span style=color:#f92672>].</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;color&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                        newPortionFromIsak<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>setFillColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>fromName</span><span style=color:#f92672>(</span>partsIsaks<span style=color:#f92672>[</span>j<span style=color:#f92672>]));</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    newPortionFromIsak<span style=color:#f92672>.</span><span style=color:#a6e22e>setText</span><span style=color:#f92672>(</span>Regex<span style=color:#f92672>.</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span>partsIsaks<span style=color:#f92672>[</span>j<span style=color:#f92672>],</span> <span style=color:#e6db74>&#34;&lt;.*?&gt;&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>                    textData<span style=color:#f92672>.</span><span style=color:#a6e22e>addPortion</span><span style=color:#f92672>(</span>newPortionFromIsak<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                textData<span style=color:#f92672>.</span><span style=color:#a6e22e>addPortion</span><span style=color:#f92672>(</span>newPortion<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        var textToReplace <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> <span style=color:#f92672>(</span>countPortions<span style=color:#f92672>);</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            textData<span style=color:#f92672>.</span><span style=color:#a6e22e>removePortion</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        ITextPortion newPortion <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>producePortion</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultParagraph<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultStyle<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>setText</span><span style=color:#f92672>(</span>replaceIsaksByExcelValuesFourthMethod<span style=color:#f92672>(</span>textToReplace<span style=color:#f92672>).</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;\r&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        textData<span style=color:#f92672>.</span><span style=color:#a6e22e>addPortion</span><span style=color:#f92672>(</span>newPortion<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    textData<span style=color:#f92672>.</span><span style=color:#a6e22e>updateLayerData</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>replaceIsaksByExcelValuesFourthMethod</span><span style=color:#f92672>(</span>String lsak<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    StringBuilder sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>lsak<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_011#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;[1] Terms and exclusions apply. Game catalog varies over time, by region, and by device. Requires Windows 11 (with updates); excludes S mode and ARM devices. See &lt;font:Segoe UI Semibold&gt;xbox.com/pcgamepass&lt;/font&gt; and &lt;font:Segoe UI Semibold&gt;https://www.ea.com/ea-play/terms&lt;/font&gt; and &lt;font:Segoe UI Semibold&gt;https://www.ea.com/ea-play&lt;/font&gt; for details. &lt;br/&gt;[2] See https://www.ea.com/ea-play/terms and https://www.ea.com/ea-play for details. The EA logo and Battlefield are trademarks of Electronic Arts Inc. © FIFA is a copyright and/or trademark of FIFA. All rights reserved. Manufactured under license by Electronic Arts Inc. STAR WARS © &amp; TM 2019 Lucasfilm Ltd. All rights reserved. &#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_012#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Privacy Statement&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_013#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Unsubscribe&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_014#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;[Retailer. Add in your own Unsubscribe and Privacy Policy links here]&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_015#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Partner Company, Inc.&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_016#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;XXX Streetname St.&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_017#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Cityname, State Zipcode&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;br/&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;\\&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;\r&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>replaceBarraNBarraRByExelValuesFourthMethodFirst</span><span style=color:#f92672>(</span>String lsak<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    StringBuilder sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>lsak<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_011#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;[1] Terms and exclusions apply. Game catalog varies over time, by region, and by device. Requires Windows 11 (with updates); excludes S mode and ARM devices. See &lt;font:Segoe UI Semibold&gt;xbox.com/pcgamepass&lt;/font&gt; and &lt;font:Segoe UI Semibold&gt;https://www.ea.com/ea-play/terms&lt;/font&gt; and &lt;font:Segoe UI Semibold&gt;https://www.ea.com/ea-play&lt;/font&gt; for details. &lt;br/&gt;[2] See https://www.ea.com/ea-play/terms and https://www.ea.com/ea-play for details. The EAC logo and Battlefield are trademarks of Electronic Arts Inc. © FIFAC is a copyright and/or trademark of FIFAC. All rights reserved. Manufactured under license by ElectroniX Srts Inc. SRA SAD © &amp; TM 2019 LsdjmLtd. All rights reserved. &#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_012#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Privacy Statement&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_013#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Unsubscribe&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_014#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;[Retailer. Add in your own Unsubscribe and Privacy Policy links here]&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_015#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Partner Company, Inc.&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_016#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;XXX Streetname St.&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak_017#&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Cityname, State Zipcode&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>().</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;\r&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>PSDJAVA-445|Formatting move when is editing in photoshop</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span><span style=color:#f92672>(</span>String<span style=color:#f92672>[]</span> args<span style=color:#f92672>)</span> <span style=color:#66d9ef>throws</span> Exception <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    String strings1 <span style=color:#f92672>=</span> Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>getCurrentDirectory</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/input-lsaks-strings1-forTicket.txt&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    String psdInput <span style=color:#f92672>=</span> Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>getCurrentDirectory</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/input_for_ticket.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    PsdImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>psdInput<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> linesLsaks <span style=color:#f92672>=</span> Files<span style=color:#f92672>.</span><span style=color:#a6e22e>readAllLines</span><span style=color:#f92672>(</span>Paths<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span>strings1<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    Map<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> String<span style=color:#f92672>&gt;</span> lsaksDictionary <span style=color:#f92672>=</span> linesLsaks<span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>filter</span><span style=color:#f92672>(</span>line <span style=color:#f92672>-&gt;</span> line <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>line<span style=color:#f92672>.</span><span style=color:#a6e22e>trim</span><span style=color:#f92672>().</span><span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>map</span><span style=color:#f92672>(</span>line <span style=color:#f92672>-&gt;</span> line<span style=color:#f92672>.</span><span style=color:#a6e22e>split</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;=&#34;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>.</span><span style=color:#a6e22e>collect</span><span style=color:#f92672>(</span>Collectors<span style=color:#f92672>.</span><span style=color:#a6e22e>toMap</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>                    items <span style=color:#f92672>-&gt;</span> items<span style=color:#f92672>[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>trim</span><span style=color:#f92672>(),</span>
</span></span><span style=display:flex><span>                    items <span style=color:#f92672>-&gt;</span> items<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>trim</span><span style=color:#f92672>(),</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>(</span>oldValue<span style=color:#f92672>,</span> newValue<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> newValue<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//Step: Replace text
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Layer layerItem <span style=color:#f92672>:</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!(</span>layerItem <span style=color:#66d9ef>instanceof</span> TextLayer<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        TextLayer layerToExtractText <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>TextLayer<span style=color:#f92672>)</span> layerItem<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        Pattern p <span style=color:#f92672>=</span> Pattern<span style=color:#f92672>.</span><span style=color:#a6e22e>compile</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#lsak[^#]+#&#34;</span><span style=color:#f92672>,</span> Pattern<span style=color:#f92672>.</span><span style=color:#a6e22e>CASE_INSENSITIVE</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        Matcher m <span style=color:#f92672>=</span> p<span style=color:#f92672>.</span><span style=color:#a6e22e>matcher</span><span style=color:#f92672>(</span>layerToExtractText<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>m<span style=color:#f92672>.</span><span style=color:#a6e22e>find</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        String resultLsakValue <span style=color:#f92672>=</span> m<span style=color:#f92672>.</span><span style=color:#a6e22e>group</span><span style=color:#f92672>().</span><span style=color:#a6e22e>trim</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>resultLsakValue<span style=color:#f92672>.</span><span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        replaceLsakText<span style=color:#f92672>(</span>layerToExtractText<span style=color:#f92672>.</span><span style=color:#a6e22e>getTextData</span><span style=color:#f92672>(),</span> lsaksDictionary<span style=color:#f92672>);</span> <span style=color:#75715e>// replaceLsakText needs to be defined
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//Step: Format and Center
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Layer layerItem <span style=color:#f92672>:</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!(</span>layerItem <span style=color:#66d9ef>instanceof</span> TextLayer<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>continue</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        TextLayer layerToExtractText <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>TextLayer<span style=color:#f92672>)</span> layerItem<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        formatStyleText<span style=color:#f92672>(</span>layerToExtractText<span style=color:#f92672>.</span><span style=color:#a6e22e>getTextData</span><span style=color:#f92672>(),</span> lsaksDictionary<span style=color:#f92672>);</span> <span style=color:#75715e>// formatStyleText needs to be defined
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;c:\\output.psd&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>replaceText</span><span style=color:#f92672>(</span>String lsak<span style=color:#f92672>,</span> Map<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> String<span style=color:#f92672>&gt;</span> lsaksToReplace<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    StringBuilder sb <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>(</span>lsak<span style=color:#f92672>.</span><span style=color:#a6e22e>trim</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Map<span style=color:#f92672>.</span><span style=color:#a6e22e>Entry</span><span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> String<span style=color:#f92672>&gt;</span> kvp <span style=color:#f92672>:</span> lsaksToReplace<span style=color:#f92672>.</span><span style=color:#a6e22e>entrySet</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> index<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>((</span>index <span style=color:#f92672>=</span> sb<span style=color:#f92672>.</span><span style=color:#a6e22e>indexOf</span><span style=color:#f92672>(</span>kvp<span style=color:#f92672>.</span><span style=color:#a6e22e>getKey</span><span style=color:#f92672>()))</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span>1<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            sb<span style=color:#f92672>.</span><span style=color:#a6e22e>replace</span><span style=color:#f92672>(</span>index<span style=color:#f92672>,</span> index <span style=color:#f92672>+</span> kvp<span style=color:#f92672>.</span><span style=color:#a6e22e>getKey</span><span style=color:#f92672>().</span><span style=color:#a6e22e>length</span><span style=color:#f92672>(),</span> kvp<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> index<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#f92672>((</span>index <span style=color:#f92672>=</span> sb<span style=color:#f92672>.</span><span style=color:#a6e22e>indexOf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;\r&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span>1<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        sb<span style=color:#f92672>.</span><span style=color:#a6e22e>deleteCharAt</span><span style=color:#f92672>(</span>index<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#f92672>((</span>index <span style=color:#f92672>=</span> sb<span style=color:#f92672>.</span><span style=color:#a6e22e>indexOf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span>1<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        sb<span style=color:#f92672>.</span><span style=color:#a6e22e>deleteCharAt</span><span style=color:#f92672>(</span>index<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sb<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>replaceLsakText</span><span style=color:#f92672>(</span>IText textData<span style=color:#f92672>,</span> Map<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> String<span style=color:#f92672>&gt;</span> lsaksDictionary<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> countPortions <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>().</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    ITextStyle defaultStyle <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    ITextParagraph defaultParagraph <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    String textToReplace <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// remove old portions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> countPortions<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        textData<span style=color:#f92672>.</span><span style=color:#a6e22e>removePortion</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ITextPortion newPortion <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>producePortion</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultParagraph<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultStyle<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>setText</span><span style=color:#f92672>(</span>replaceText<span style=color:#f92672>(</span>textToReplace<span style=color:#f92672>,</span> lsaksDictionary<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    textData<span style=color:#f92672>.</span><span style=color:#a6e22e>addPortion</span><span style=color:#f92672>(</span>newPortion<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    textData<span style=color:#f92672>.</span><span style=color:#a6e22e>updateLayerData</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>formatStyleText</span><span style=color:#f92672>(</span>IText textData<span style=color:#f92672>,</span> Map<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>,</span> String<span style=color:#f92672>&gt;</span> lsaksToReplace<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// validate if there are tags
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Pattern tagPattern <span style=color:#f92672>=</span> Pattern<span style=color:#f92672>.</span><span style=color:#a6e22e>compile</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;&lt;[^&gt;]+&gt;&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    Matcher tagMatcher <span style=color:#f92672>=</span> tagPattern<span style=color:#f92672>.</span><span style=color:#a6e22e>matcher</span><span style=color:#f92672>(</span>textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>boolean</span> hasTags <span style=color:#f92672>=</span> tagMatcher<span style=color:#f92672>.</span><span style=color:#a6e22e>find</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> countPortions <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>().</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    ITextStyle defaultStyle <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    ITextParagraph defaultParagraph <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getItems</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>hasTags<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        String tagRegex1 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;[^&lt;&gt;]+|&lt;\\s*([^ &gt;]+)[^&gt;]*&gt;.*?&lt;\\s*/\\s*\\1\\s*&gt;&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        Matcher matchesImgSrc <span style=color:#f92672>=</span> Pattern<span style=color:#f92672>.</span><span style=color:#a6e22e>compile</span><span style=color:#f92672>(</span>tagRegex1<span style=color:#f92672>,</span> Pattern<span style=color:#f92672>.</span><span style=color:#a6e22e>CASE_INSENSITIVE</span> <span style=color:#f92672>|</span> Pattern<span style=color:#f92672>.</span><span style=color:#a6e22e>DOTALL</span><span style=color:#f92672>).</span><span style=color:#a6e22e>matcher</span><span style=color:#f92672>(</span>textData<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        List<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> listlsaks <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>matchesImgSrc<span style=color:#f92672>.</span><span style=color:#a6e22e>find</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            listlsaks<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>matchesImgSrc<span style=color:#f92672>.</span><span style=color:#a6e22e>group</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        String<span style=color:#f92672>[]</span> textSplit <span style=color:#f92672>=</span> listlsaks<span style=color:#f92672>.</span><span style=color:#a6e22e>toArray</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> String<span style=color:#f92672>[</span>0<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> countPortions<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            textData<span style=color:#f92672>.</span><span style=color:#a6e22e>removePortion</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>String s <span style=color:#f92672>:</span> textSplit<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            ITextPortion newPortion <span style=color:#f92672>=</span> textData<span style=color:#f92672>.</span><span style=color:#a6e22e>producePortion</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getParagraph</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultParagraph<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>(</span>defaultStyle<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>s<span style=color:#f92672>.</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;font:&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>setFontName</span><span style=color:#f92672>(</span>s<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>s<span style=color:#f92672>.</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;pt&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>setFontSize</span><span style=color:#f92672>(</span>Double<span style=color:#f92672>.</span><span style=color:#a6e22e>parseDouble</span><span style=color:#f92672>(</span>s<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>s<span style=color:#f92672>.</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;color:&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>getStyle</span><span style=color:#f92672>().</span><span style=color:#a6e22e>setFillColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>fromName</span><span style=color:#f92672>(</span>s<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>s<span style=color:#f92672>.</span><span style=color:#a6e22e>contains</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;br/&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                s <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;\r&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            newPortion<span style=color:#f92672>.</span><span style=color:#a6e22e>setText</span><span style=color:#f92672>(</span>s<span style=color:#f92672>.</span><span style=color:#a6e22e>replaceAll</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;&lt;.*?&gt;&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>            textData<span style=color:#f92672>.</span><span style=color:#a6e22e>addPortion</span><span style=color:#f92672>(</span>newPortion<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        textData<span style=color:#f92672>.</span><span style=color:#a6e22e>updateLayerData</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p></p></div></div></div></div><hr></div></div></section></div></div></div></div></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>