<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.PSD for Java 20.7 - Release Notes</title><meta name=description content="Aspose.PSD for Java 20.7 - Release Notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/psd/java/release-notes/2020/aspose-psd-for-java-20-7-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/psd/java/release-notes/2020/aspose-psd-for-java-20-7-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.PSD for Java 20.7 - Release Notes "><meta property="og:description" content="Aspose.PSD for Java 20.7 - Release Notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/psd/java/release-notes/2020/aspose-psd-for-java-20-7-release-notes/"><meta itemprop=name content="Aspose.PSD for Java 20.7 - Release Notes"><meta itemprop=description content="Aspose.PSD for Java 20.7 - Release Notes – the latest updates and fixes."><meta itemprop=wordCount content="2616"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.PSD for Java 20.7 - Release Notes"><meta name=twitter:description content="Aspose.PSD for Java 20.7 - Release Notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/psd/>Aspose.PSD Product Family</a><span class=divider></span></li><li><a href=/psd/java/>Aspose.PSD for Java</a><span class=divider></span></li><li><a href=/psd/java/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/psd/java/release-notes/2020/>2020</a><span class=divider></span></li><li><a href=/psd/java/release-notes/2020/aspose-psd-for-java-20-7-release-notes/>Aspose.PSD for Java 20.7 - Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><div class=container><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section"><div class=box1><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.PSD for Java 20.7 - Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><div class="alert alert-primary" role=alert>This page contains release notes for <a href=https://releases.aspose.com/psd/java/20-7/>Aspose.PSD for Java 20.7</a></div><table><thead><tr><th style=text-align:left><strong>Key</strong></th><th style=text-align:left><strong>Summary</strong></th><th style=text-align:left><strong>Category</strong></th></tr></thead><tbody><tr><td style=text-align:left>PSDJAVA-231</td><td style=text-align:left>Support of the adding of Stroke Effect at runtime</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>PSDJAVA-249</td><td style=text-align:left>Support of lnk2 / lnk3 Resources (Resources of Smart Object Layer)</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>PSDJAVA-247</td><td style=text-align:left>Change Exception Message on trying to open not supported formats as an image</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>PSDJAVA-235</td><td style=text-align:left>If we save PSD file after the creation of new Layer Group we get Photoshop warning on the file opening.</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDJAVA-236</td><td style=text-align:left>Failed to save LayerMask</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDJAVA-237</td><td style=text-align:left>Clipping mask not applying to the folder</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDJAVA-238</td><td style=text-align:left>Cannot open file with Aspose.PSD for Java</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDJAVA-239</td><td style=text-align:left>Image saving failed exception when converting PSD to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDJAVA-240</td><td style=text-align:left>Crop operation makes Clipping path invalid in PSD image</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDJAVA-241</td><td style=text-align:left>NullReference Exception when trying to save Specific PSD file with the Shadow Effect</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDJAVA-243</td><td style=text-align:left>Aspose.PSD returns true on Image.CanLoad(pdfStream)</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDJAVA-244</td><td style=text-align:left>Layers failed to render in generated PNG</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDJAVA-245</td><td style=text-align:left>Exception on accessing TextData</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>PSDJAVA-246</td><td style=text-align:left>ImageSaveException on saving the PSD</td><td style=text-align:left>Bug</td></tr></tbody></table><h1 id=public-api-changes><strong>Public API Changes</strong></h1><h1 id=added-apis><strong>Added APIs:</strong></h1><ul><li>F:com.aspose.psd.fileformats.psd.layers.layereffects.StrokePosition.Center</li><li>F:com.aspose.psd.fileformats.psd.layers.layereffects.StrokePosition.Inside</li><li>F:com.aspose.psd.fileformats.psd.layers.layereffects.StrokePosition.Outside</li><li>F:com.aspose.psd.fileformats.psd.layers.layerresources.linkresources.Lnk3Resource.TypeToolKey</li><li>M:com.aspose.psd.fileformats.psd.PsdImage.addExposureAdjustmentLayer</li><li>M:com.aspose.psd.fileformats.psd.layers.layereffects.BlendingOptions.addStroke(int)</li><li>M:com.aspose.psd.fileformats.psd.layers.layereffects.StrokeEffect.getOverprint</li><li>M:com.aspose.psd.fileformats.psd.layers.layereffects.StrokeEffect.getPosition</li><li>M:com.aspose.psd.fileformats.psd.layers.layereffects.StrokeEffect.getSize</li><li>M:com.aspose.psd.fileformats.psd.layers.layereffects.StrokeEffect.setOverprint(boolean)</li><li>M:com.aspose.psd.fileformats.psd.layers.layereffects.StrokeEffect.setPosition(short)</li><li>M:com.aspose.psd.fileformats.psd.layers.layereffects.StrokeEffect.setSize(int)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.linkresources.LiFdDataSource.getData</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.linkresources.LiFdDataSource.setData(byte[])</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.linkresources.Lnk2Resource.#ctor</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.linkresources.Lnk2Resource.get_Item(int)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.linkresources.Lnk3Resource.#ctor</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.linkresources.Lnk3Resource.getKey</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.IVectorPathData.getPaths</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.IVectorPathData.getVersion</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.IVectorPathData.isDisabled</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.IVectorPathData.isInverted</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.IVectorPathData.isNotLinked</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.IVectorPathData.setDisabled(boolean)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.IVectorPathData.setInverted(boolean)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.IVectorPathData.setNotLinked(boolean)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.IVectorPathData.setPaths(com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathRecord[])</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.IVectorPathData.setVersion(int)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathData.#ctor</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathData.#ctor(byte[])</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathData.getLength</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathData.getPaths</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathData.getVersion</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathData.isDisabled</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathData.isInverted</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathData.isNotLinked</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathData.setDisabled(boolean)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathData.setInverted(boolean)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathData.setNotLinked(boolean)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathData.setPaths(com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathRecord[])</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathData.setVersion(int)</li><li>M:com.aspose.psd.fileformats.psd.resources.WorkingPathResource.#ctor(byte[])</li><li>M:com.aspose.psd.fileformats.psd.resources.WorkingPathResource.getDataSize</li><li>M:com.aspose.psd.fileformats.psd.resources.WorkingPathResource.getMinimalVersion</li><li>M:com.aspose.psd.fileformats.psd.resources.WorkingPathResource.getPaths</li><li>M:com.aspose.psd.fileformats.psd.resources.WorkingPathResource.getVersion</li><li>M:com.aspose.psd.fileformats.psd.resources.WorkingPathResource.isDisabled</li><li>M:com.aspose.psd.fileformats.psd.resources.WorkingPathResource.isInverted</li><li>M:com.aspose.psd.fileformats.psd.resources.WorkingPathResource.isNotLinked</li><li>M:com.aspose.psd.fileformats.psd.resources.WorkingPathResource.saveData(com.aspose.psd.StreamContainer)</li><li>M:com.aspose.psd.fileformats.psd.resources.WorkingPathResource.setDisabled(boolean)</li><li>M:com.aspose.psd.fileformats.psd.resources.WorkingPathResource.setInverted(boolean)</li><li>M:com.aspose.psd.fileformats.psd.resources.WorkingPathResource.setNotLinked(boolean)</li><li>M:com.aspose.psd.fileformats.psd.resources.WorkingPathResource.setPaths(com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathRecord[])</li><li>M:com.aspose.psd.fileformats.psd.resources.WorkingPathResource.setVersion(int)</li><li>T:com.aspose.psd.fileformats.psd.layers.layereffects.StrokePosition</li><li>T:com.aspose.psd.fileformats.psd.layers.layerresources.linkresources.Lnk3Resource</li><li>T:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.IVectorPathData</li><li>T:com.aspose.psd.fileformats.psd.layers.layerresources.vectorpaths.VectorPathData</li><li>T:com.aspose.psd.fileformats.psd.resources.WorkingPathResource</li></ul><h2 id=removed-apis><strong>Removed APIs:</strong></h2><ul><li>F:com.aspose.psd.fileformats.psd.layers.layerresources.linkresources.LinkDataSource.DescriptorVersion</li><li>F:com.aspose.psd.fileformats.psd.layers.layerresources.linkresources.LinkDataSource.UnexpectedLinkResourceTypeValue</li><li>F:com.aspose.psd.fileformats.psd.layers.layerresources.linkresources.LinkDataSource.ZeroChar</li><li>M:com.aspose.psd.fileformats.psd.PsdImage.addExposureLayer(float,float,float)</li><li>M:com.aspose.psd.fileformats.psd.layers.layerresources.linkresources.Lnk2Resource.#ctor(com.aspose.psd.fileformats.psd.layers.layerresources.linkresources.LinkDataSource[])</li></ul><h1 id=usage-examples><strong>Usage examples:</strong></h1><p><strong>PSDJAVA-231. Support of the adding of Stroke Effect at runtime</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// This example shows how to add a stroke effect (border) to existing layers of PSD file in Java.
</span></span></span><span style=display:flex><span><span style=color:#75715e>// There are three types of the stroke: color, gradient and pattern. Each of the type has
</span></span></span><span style=display:flex><span><span style=color:#75715e>// three ways (positions) in which the stroke is rendered: inside, center and outside.
</span></span></span><span style=display:flex><span><span style=color:#75715e>// This example demonstrates usage of all these cases.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>String srcPsdPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;StrokeEffectsSource.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>String dstPngPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;output.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PsdLoadOptions psdLoadOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PsdLoadOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>psdLoadOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setLoadEffectsResource</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>PsdImage psdImage <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>srcPsdPath<span style=color:#f92672>,</span> psdLoadOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    StrokeEffect strokeEffect<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    IColorFillSettings colorFillSettings<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    IGradientFillSettings gradientFillSettings<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    IPatternFillSettings patternFillSettings<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 1. Adds Color fill, at position Inside
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    strokeEffect <span style=color:#f92672>=</span> psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>()[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getBlendingOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>addStroke</span><span style=color:#f92672>(</span>FillType<span style=color:#f92672>.</span><span style=color:#a6e22e>Color</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setSize</span><span style=color:#f92672>(</span>7<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setPosition</span><span style=color:#f92672>(</span>StrokePosition<span style=color:#f92672>.</span><span style=color:#a6e22e>Inside</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    colorFillSettings <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>IColorFillSettings<span style=color:#f92672>)</span>strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>getFillSettings</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    colorFillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>setColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getGreen</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 2. Adds Color fill, at position Outside
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    strokeEffect <span style=color:#f92672>=</span> psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>()[</span>2<span style=color:#f92672>].</span><span style=color:#a6e22e>getBlendingOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>addStroke</span><span style=color:#f92672>(</span>FillType<span style=color:#f92672>.</span><span style=color:#a6e22e>Color</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setSize</span><span style=color:#f92672>(</span>7<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setPosition</span><span style=color:#f92672>(</span>StrokePosition<span style=color:#f92672>.</span><span style=color:#a6e22e>Outside</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    colorFillSettings <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>IColorFillSettings<span style=color:#f92672>)</span>strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>getFillSettings</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    colorFillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>setColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getGreen</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 3. Adds Color fill, at position Center
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    strokeEffect <span style=color:#f92672>=</span> psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>()[</span>3<span style=color:#f92672>].</span><span style=color:#a6e22e>getBlendingOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>addStroke</span><span style=color:#f92672>(</span>FillType<span style=color:#f92672>.</span><span style=color:#a6e22e>Color</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setSize</span><span style=color:#f92672>(</span>7<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setPosition</span><span style=color:#f92672>(</span>StrokePosition<span style=color:#f92672>.</span><span style=color:#a6e22e>Center</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    colorFillSettings <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>IColorFillSettings<span style=color:#f92672>)</span>strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>getFillSettings</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    colorFillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>setColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getGreen</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 4. Adds Gradient fill, at position Inside
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    strokeEffect <span style=color:#f92672>=</span> psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>()[</span>4<span style=color:#f92672>].</span><span style=color:#a6e22e>getBlendingOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>addStroke</span><span style=color:#f92672>(</span>FillType<span style=color:#f92672>.</span><span style=color:#a6e22e>Gradient</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setSize</span><span style=color:#f92672>(</span>5<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setPosition</span><span style=color:#f92672>(</span>StrokePosition<span style=color:#f92672>.</span><span style=color:#a6e22e>Inside</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    gradientFillSettings <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>IGradientFillSettings<span style=color:#f92672>)</span>strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>getFillSettings</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    gradientFillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>setAlignWithLayer</span><span style=color:#f92672>(</span><span style=color:#66d9ef>false</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    gradientFillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>setAngle</span><span style=color:#f92672>(</span>90<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 5. Adds Gradient fill, at position Outside
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    strokeEffect <span style=color:#f92672>=</span> psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>()[</span>5<span style=color:#f92672>].</span><span style=color:#a6e22e>getBlendingOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>addStroke</span><span style=color:#f92672>(</span>FillType<span style=color:#f92672>.</span><span style=color:#a6e22e>Gradient</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setSize</span><span style=color:#f92672>(</span>5<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setPosition</span><span style=color:#f92672>(</span>StrokePosition<span style=color:#f92672>.</span><span style=color:#a6e22e>Outside</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    gradientFillSettings <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>IGradientFillSettings<span style=color:#f92672>)</span>strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>getFillSettings</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    gradientFillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>setAlignWithLayer</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    gradientFillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>setAngle</span><span style=color:#f92672>(</span>90<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 6. Adds Gradient fill, at position Center
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    strokeEffect <span style=color:#f92672>=</span> psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>()[</span>6<span style=color:#f92672>].</span><span style=color:#a6e22e>getBlendingOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>addStroke</span><span style=color:#f92672>(</span>FillType<span style=color:#f92672>.</span><span style=color:#a6e22e>Gradient</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setSize</span><span style=color:#f92672>(</span>5<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setPosition</span><span style=color:#f92672>(</span>StrokePosition<span style=color:#f92672>.</span><span style=color:#a6e22e>Center</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    gradientFillSettings <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>IGradientFillSettings<span style=color:#f92672>)</span>strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>getFillSettings</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    gradientFillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>setAlignWithLayer</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    gradientFillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>setAngle</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 7. Adds Pattern fill, at position Inside
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    strokeEffect <span style=color:#f92672>=</span> psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>()[</span>7<span style=color:#f92672>].</span><span style=color:#a6e22e>getBlendingOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>addStroke</span><span style=color:#f92672>(</span>FillType<span style=color:#f92672>.</span><span style=color:#a6e22e>Pattern</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setSize</span><span style=color:#f92672>(</span>5<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setPosition</span><span style=color:#f92672>(</span>StrokePosition<span style=color:#f92672>.</span><span style=color:#a6e22e>Inside</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    patternFillSettings <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>IPatternFillSettings<span style=color:#f92672>)</span>strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>getFillSettings</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    patternFillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>setScale</span><span style=color:#f92672>(</span>200<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 8. Adds Pattern fill, at position Outside
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    strokeEffect <span style=color:#f92672>=</span> psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>()[</span>8<span style=color:#f92672>].</span><span style=color:#a6e22e>getBlendingOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>addStroke</span><span style=color:#f92672>(</span>FillType<span style=color:#f92672>.</span><span style=color:#a6e22e>Pattern</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setSize</span><span style=color:#f92672>(</span>10<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setPosition</span><span style=color:#f92672>(</span>StrokePosition<span style=color:#f92672>.</span><span style=color:#a6e22e>Outside</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    patternFillSettings <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>IPatternFillSettings<span style=color:#f92672>)</span>strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>getFillSettings</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    patternFillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>setScale</span><span style=color:#f92672>(</span>100<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 9. Adds Pattern fill, at position Center
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    strokeEffect <span style=color:#f92672>=</span> psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>()[</span>9<span style=color:#f92672>].</span><span style=color:#a6e22e>getBlendingOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>addStroke</span><span style=color:#f92672>(</span>FillType<span style=color:#f92672>.</span><span style=color:#a6e22e>Pattern</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setSize</span><span style=color:#f92672>(</span>10<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>setPosition</span><span style=color:#f92672>(</span>StrokePosition<span style=color:#f92672>.</span><span style=color:#a6e22e>Center</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    patternFillSettings <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>IPatternFillSettings<span style=color:#f92672>)</span>strokeEffect<span style=color:#f92672>.</span><span style=color:#a6e22e>getFillSettings</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    patternFillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>setScale</span><span style=color:#f92672>(</span>75<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>dstPngPath<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p><p><strong>PSDJAVA-249. Support of lnk2 / lnk3 Resources (Resources of Smart Object Layer)</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// This example demonstrates how to work with smart object resources (basically Lnk2Resource).
</span></span></span><span style=display:flex><span><span style=color:#75715e>// The program loads several Photoshop documents and exports their smart objects to
</span></span></span><span style=display:flex><span><span style=color:#75715e>// raster file formats. Also the code demonstrates usage of public methods of Lnk2Resource.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>LocalScopeExtension</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>assertAreEqual</span><span style=color:#f92672>(</span>Object expected<span style=color:#f92672>,</span> Object actual<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>actual<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>expected<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> FormatException<span style=color:#f92672>(</span>String<span style=color:#f92672>.</span><span style=color:#a6e22e>format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Actual value %s are not equal to expected %s.&#34;</span><span style=color:#f92672>,</span> actual<span style=color:#f92672>,</span> expected<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Saves the data of a smart object into PSD file
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>saveSmartObjectData</span><span style=color:#f92672>(</span>String filePath<span style=color:#f92672>,</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> data<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        FileStreamContainer container <span style=color:#f92672>=</span> FileStreamContainer<span style=color:#f92672>.</span><span style=color:#a6e22e>createFileStream</span><span style=color:#f92672>(</span>filePath<span style=color:#f92672>,</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            container<span style=color:#f92672>.</span><span style=color:#a6e22e>write</span><span style=color:#f92672>(</span>data<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            container<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Loads the new data for a smart object from a file
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> <span style=color:#a6e22e>loadNewData</span><span style=color:#f92672>(</span>String filePath<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        FileStreamContainer container <span style=color:#f92672>=</span> FileStreamContainer<span style=color:#f92672>.</span><span style=color:#a6e22e>openFileStream</span><span style=color:#f92672>(</span>filePath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> container<span style=color:#f92672>.</span><span style=color:#a6e22e>toBytes</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            container<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Gets and sets properties of the PSD Lnk2 / Lnk3 Resource and its liFD data sources in PSD image
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>exampleOfLnk2ResourceSupport</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>            String fileName<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> dataSourceCount<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> length<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> newLength<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>            Object<span style=color:#f92672>[]</span> dataSourceExpectedValues<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        String srcPsdPath <span style=color:#f92672>=</span> fileName<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        String dstPsdPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;out_&#34;</span> <span style=color:#f92672>+</span> fileName<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        PsdImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>srcPsdPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Search for Lnk2Resource
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            Lnk2Resource lnk2Resource <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>LayerResource resource <span style=color:#f92672>:</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getGlobalLayerResources</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>resource <span style=color:#66d9ef>instanceof</span> Lnk2Resource<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    lnk2Resource <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>Lnk2Resource<span style=color:#f92672>)</span>resource<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// Verify properties of Lnk2Resource
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    assertAreEqual<span style=color:#f92672>(</span>lnk2Resource<span style=color:#f92672>.</span><span style=color:#a6e22e>getDataSourceCount</span><span style=color:#f92672>(),</span> dataSourceCount<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    assertAreEqual<span style=color:#f92672>(</span>lnk2Resource<span style=color:#f92672>.</span><span style=color:#a6e22e>getLength</span><span style=color:#f92672>(),</span> length<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    assertAreEqual<span style=color:#f92672>(</span>lnk2Resource<span style=color:#f92672>.</span><span style=color:#a6e22e>isEmpty</span><span style=color:#f92672>(),</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> lnk2Resource<span style=color:#f92672>.</span><span style=color:#a6e22e>getDataSourceCount</span><span style=color:#f92672>();</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                        <span style=color:#75715e>// Verify and change properties of LiFdDataSource
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                        LiFdDataSource lifdSource <span style=color:#f92672>=</span> lnk2Resource<span style=color:#f92672>.</span><span style=color:#a6e22e>get_Item</span><span style=color:#f92672>(</span>i<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                        Object<span style=color:#f92672>[]</span> expected <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>Object<span style=color:#f92672>[])</span>dataSourceExpectedValues<span style=color:#f92672>[</span>i<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>                        assertAreEqual<span style=color:#f92672>(</span>LinkDataSourceType<span style=color:#f92672>.</span><span style=color:#a6e22e>liFD</span><span style=color:#f92672>,</span> lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>getType</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>                        assertAreEqual<span style=color:#f92672>(</span>expected<span style=color:#f92672>[</span>0<span style=color:#f92672>],</span> lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>getUniqueId</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>                        assertAreEqual<span style=color:#f92672>(</span>expected<span style=color:#f92672>[</span>1<span style=color:#f92672>],</span> lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>getOriginalFileName</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>                        assertAreEqual<span style=color:#f92672>(</span>expected<span style=color:#f92672>[</span>2<span style=color:#f92672>],</span> lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>getFileType</span><span style=color:#f92672>().</span><span style=color:#a6e22e>trim</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>                        assertAreEqual<span style=color:#f92672>(</span>expected<span style=color:#f92672>[</span>3<span style=color:#f92672>],</span> lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>getFileCreator</span><span style=color:#f92672>().</span><span style=color:#a6e22e>trim</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>                        assertAreEqual<span style=color:#f92672>(</span>expected<span style=color:#f92672>[</span>4<span style=color:#f92672>],</span> lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>getData</span><span style=color:#f92672>().</span><span style=color:#a6e22e>length</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                        assertAreEqual<span style=color:#f92672>(</span>expected<span style=color:#f92672>[</span>5<span style=color:#f92672>],</span> lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>getAssetModTime</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>                        assertAreEqual<span style=color:#f92672>(</span>expected<span style=color:#f92672>[</span>6<span style=color:#f92672>],</span> lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>getChildDocId</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>                        assertAreEqual<span style=color:#f92672>(</span>expected<span style=color:#f92672>[</span>7<span style=color:#f92672>],</span> lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>getVersion</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>                        assertAreEqual<span style=color:#f92672>(</span>expected<span style=color:#f92672>[</span>8<span style=color:#f92672>],</span> lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>hasFileOpenDescriptor</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>                        assertAreEqual<span style=color:#f92672>(</span>expected<span style=color:#f92672>[</span>9<span style=color:#f92672>],</span> lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>getLength</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>hasFileOpenDescriptor</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                            assertAreEqual<span style=color:#f92672>(-</span>1<span style=color:#f92672>,</span> lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>getCompId</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>                            assertAreEqual<span style=color:#f92672>(-</span>1<span style=color:#f92672>,</span> lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>getOriginalCompId</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>                            lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>setCompId</span><span style=color:#f92672>(</span>Integer<span style=color:#f92672>.</span><span style=color:#a6e22e>MAX_VALUE</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        saveSmartObjectData<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>                                fileName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;_&#34;</span> <span style=color:#f92672>+</span> lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>getOriginalFileName</span><span style=color:#f92672>(),</span>
</span></span><span style=display:flex><span>                                lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>getData</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>                        lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>setData</span><span style=color:#f92672>(</span>loadNewData<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;new_&#34;</span> <span style=color:#f92672>+</span> lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>getOriginalFileName</span><span style=color:#f92672>()));</span>
</span></span><span style=display:flex><span>                        assertAreEqual<span style=color:#f92672>(</span>expected<span style=color:#f92672>[</span>10<span style=color:#f92672>],</span> lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>getLength</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>setChildDocId</span><span style=color:#f92672>(</span>UUID<span style=color:#f92672>.</span><span style=color:#a6e22e>randomUUID</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>                        lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>setAssetModTime</span><span style=color:#f92672>(</span>Double<span style=color:#f92672>.</span><span style=color:#a6e22e>MAX_VALUE</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                        lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>setFileType</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;test&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                        lifdSource<span style=color:#f92672>.</span><span style=color:#a6e22e>setFileCreator</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;me&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    assertAreEqual<span style=color:#f92672>(</span>newLength<span style=color:#f92672>,</span> lnk2Resource<span style=color:#f92672>.</span><span style=color:#a6e22e>getLength</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Make sure that Lnk2Resource was found
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            assertAreEqual<span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>,</span> lnk2Resource <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Make a copy of the loaded PSD
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getBitsPerChannel</span><span style=color:#f92672>()</span> <span style=color:#f92672>&lt;</span> 32<span style=color:#f92672>)</span> <span style=color:#75715e>// 32 bit per channel saving is not supported yet
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>dstPsdPath<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PsdOptions<span style=color:#f92672>(</span>image<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>LocalScopeExtension $ <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> LocalScopeExtension<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>Object<span style=color:#f92672>[]</span> Lnk2ResourceSupportCases <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Object<span style=color:#f92672>[]</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> Object<span style=color:#f92672>[]</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;00af34a0-a90b-674d-a821-73ee508c5479&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;rgb8_2x2.png&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;png&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0x53<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0d<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                7<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>true</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0x124L<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0x74cL
</span></span><span style=display:flex><span>                        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Object<span style=color:#f92672>[]</span> LayeredLnk2ResourceSupportCases <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Object<span style=color:#f92672>[]</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> Object<span style=color:#f92672>[]</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;69ac1c0d-1b74-fd49-9c7e-34a7aa6299ef&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;huset.jpg&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;JPEG&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0x9d46<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0d<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;xmp.did:0F94B342065B11E395B1FD506DED6B07&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                7<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>true</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0x9E60L<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0xc60cL
</span></span><span style=display:flex><span>                        <span style=color:#f92672>},</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> Object<span style=color:#f92672>[]</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;5a7d1965-0eae-b24e-a82f-98c7646424c2&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;panama-papers.jpg&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;JPEG&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0xF56B<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0d<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;xmp.did:BDE940CBF51B11E59D759CDA690663E3&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                7<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>true</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0xF694L<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0x10dd4L
</span></span><span style=display:flex><span>                        <span style=color:#f92672>},</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Object<span style=color:#f92672>[]</span> LayeredLnk3ResourceSupportCases <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Object<span style=color:#f92672>[]</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> Object<span style=color:#f92672>[]</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;2fd7ba52-0221-de4c-bdc4-1210580c6caa&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;panama-papers.jpg&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;JPEG&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0xF56B<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0d<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;xmp.did:BDE940CBF51B11E59D759CDA690663E3&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                7<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>true</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0xF694l<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0x10dd4L
</span></span><span style=display:flex><span>                        <span style=color:#f92672>},</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>new</span> Object<span style=color:#f92672>[]</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;372d52eb-5825-8743-81a7-b6f32d51323d&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;huset.jpg&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;JPEG&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0x9d46<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0d<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#e6db74>&#34;xmp.did:0F94B342065B11E395B1FD506DED6B07&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                7<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                <span style=color:#66d9ef>true</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0x9E60L<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                                0xc60cL
</span></span><span style=display:flex><span>                        <span style=color:#f92672>},</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// This example demonstrates how to get and set properties of the PSD Lnk2 Resource and its liFD data sources for 8 bit per channel.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$<span style=color:#f92672>.</span><span style=color:#a6e22e>exampleOfLnk2ResourceSupport</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;rgb8_2x2_embedded_png.psd&#34;</span><span style=color:#f92672>,</span> 1<span style=color:#f92672>,</span> 0x12C<span style=color:#f92672>,</span> 0x0000079c<span style=color:#f92672>,</span> Lnk2ResourceSupportCases<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// This example demonstrates how to get and set properties of the PSD Lnk3 Resource and its liFD data sources for 32 bit per channel.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$<span style=color:#f92672>.</span><span style=color:#a6e22e>exampleOfLnk2ResourceSupport</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Layered PSD file smart objects.psd&#34;</span><span style=color:#f92672>,</span> 2<span style=color:#f92672>,</span> 0x19504<span style=color:#f92672>,</span> 0x0001d3e0<span style=color:#f92672>,</span> LayeredLnk3ResourceSupportCases<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// This example demonstrates how to get and set properties of the PSD Lnk2 Resource and its liFD data sources for 16 bit per channel.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>$<span style=color:#f92672>.</span><span style=color:#a6e22e>exampleOfLnk2ResourceSupport</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;LayeredSmartObjects16bit.psd&#34;</span><span style=color:#f92672>,</span> 2<span style=color:#f92672>,</span> 0x19504<span style=color:#f92672>,</span> 0x0001d3e0<span style=color:#f92672>,</span> LayeredLnk2ResourceSupportCases<span style=color:#f92672>);</span></span></span></code></pre></div></p><p><strong>PSDJAVA-247. Change Exception Message on trying to open not supported formats as an image</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// This example shows that an exception with a new more descriptive message is thrown on loading
</span></span></span><span style=display:flex><span><span style=color:#75715e>// raster images in the way that is not supported (raster images can be loaded only as layers).
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>String<span style=color:#f92672>[]</span> filesPaths <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> String<span style=color:#f92672>[]</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;BmpExample.bmp&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;GifExample.gif&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;Jpeg2000Example.jpf&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;JpegExample.jpg&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;PngExample.png&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;TiffExample.tif&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String expectedExceptionMessage <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Cannot open an image. The image file format may be not supported at the moment or cannot be opened in such way. If you try to add Layer, please Open File as a Stream and use AddLayer method instead. Check the documentation https://docs.aspose.com/display/psdnet/Add+Layer+to+PSD&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>String filePath <span style=color:#f92672>:</span> filesPaths<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>filePath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>Exception e<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Verify whether the thrown exception has new more descriptive message
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>e<span style=color:#f92672>.</span><span style=color:#a6e22e>getInnerException</span><span style=color:#f92672>()</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>!</span>e<span style=color:#f92672>.</span><span style=color:#a6e22e>getInnerException</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getMessage</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>expectedExceptionMessage<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> e<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p><p><strong>PSDJAVA-235. If we save PSD file after the creation of new Layer Group we get Photoshop warning on the file opening.</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// This example demonstrates that there is no exception on saving a generated PSD file
</span></span></span><span style=display:flex><span><span style=color:#75715e>// that contains inner layer groups.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>String dstPsdPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;psdnet_test_out.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Define particular rules for PSD image creation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>PsdOptions createOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PsdOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>createOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setSource</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> FileCreateSource<span style=color:#f92672>(</span>dstPsdPath<span style=color:#f92672>,</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>createOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPalette</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> PsdColorPalette<span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> Color<span style=color:#f92672>[]</span> <span style=color:#f92672>{</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getRed</span><span style=color:#f92672>(),</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getGreen</span><span style=color:#f92672>(),</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getBlue</span><span style=color:#f92672>()</span> <span style=color:#f92672>}));</span>
</span></span><span style=display:flex><span>PsdImage psdImage <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>create</span><span style=color:#f92672>(</span>createOptions<span style=color:#f92672>,</span> 500<span style=color:#f92672>,</span> 500<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Add a layer group hierarchy and a layer into PSD
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    LayerGroup group1 <span style=color:#f92672>=</span> psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>addLayerGroup</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Group 1&#34;</span><span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Layer layer1 <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Layer<span style=color:#f92672>(</span>psdImage<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    layer1<span style=color:#f92672>.</span><span style=color:#a6e22e>setName</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Layer 1&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    group1<span style=color:#f92672>.</span><span style=color:#a6e22e>addLayer</span><span style=color:#f92672>(</span>layer1<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    LayerGroup group2 <span style=color:#f92672>=</span> group1<span style=color:#f92672>.</span><span style=color:#a6e22e>addLayerGroup</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Group 2&#34;</span><span style=color:#f92672>,</span> 1<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Save the generated PSD to a physical file and make sure there is no exception
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>dstPsdPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p><p><strong>PSDJAVA-236. Failed to save LayerMask</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// This example demonstrates the ability of saving and rendering Layer Masks for
</span></span></span><span style=display:flex><span><span style=color:#75715e>// Layer Groups when layers are added from another PSD image.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>String srcPsdPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;MaskTest.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>String dstPsdPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;MaskTest_output.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>String dstJpgPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;MaskTest_output.jpg&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>String dstPngPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;MaskTest_output.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>String dstPngPath1 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;MaskTest_output_indirect.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PsdImage srcPsdImage <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>srcPsdPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    PsdImage dstPsdImage <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PsdImage<span style=color:#f92672>(</span>srcPsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>(),</span> srcPsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        LayerGroup openingLayerGroupTag <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        LayerGroup closingLayerGroupTag <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Manual cloning of layers from the source PSD to a destination PSD
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Layer layer <span style=color:#f92672>:</span> srcPsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>layer <span style=color:#66d9ef>instanceof</span> LayerGroup<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                LayerGroup srcGroup <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>LayerGroup<span style=color:#f92672>)</span>layer<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>closingLayerGroupTag <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>int</span> insertAt <span style=color:#f92672>=</span> dstPsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>().</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// Since layer group is internally implemented as two layers (opening
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#75715e>// and closing tags) to define layer group borders, the following
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#75715e>// statement returns a closing tag (layer)...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    closingLayerGroupTag <span style=color:#f92672>=</span> dstPsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>addLayerGroup</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Masked Group&#34;</span><span style=color:#f92672>,</span> insertAt<span style=color:#f92672>,</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// ...but this statement returns opening tag that is cached for further processing
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    openingLayerGroupTag <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>LayerGroup<span style=color:#f92672>)</span>dstPsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>()[</span>insertAt <span style=color:#f92672>+</span> 1<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>srcGroup<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayerMaskData</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// The commented statement below does not work because if a layer mask
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#75715e>// added to a closing tag of a layer group it would not make any sense
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#75715e>// since the closing tag does not keep any layer (it serves just as
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#75715e>// a marker) in addition it is not rendered (visible) in the editor
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#75715e>// closingLayerGroupTag.addLayerMask(oldGroup.getLayerMaskData());
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>                    openingLayerGroupTag<span style=color:#f92672>.</span><span style=color:#a6e22e>addLayerMask</span><span style=color:#f92672>(</span>srcGroup<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayerMaskData</span><span style=color:#f92672>());</span> <span style=color:#75715e>// Does work!
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// Be careful: Adding a layer to another image without copying or removing it
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#75715e>// from the original image may impact on rendering the original image because
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#75715e>// it changes the Container property of the layer.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>layer<span style=color:#f92672>.</span><span style=color:#a6e22e>getName</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Paper&#34;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    dstPsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>addLayer</span><span style=color:#f92672>(</span>layer<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    closingLayerGroupTag<span style=color:#f92672>.</span><span style=color:#a6e22e>addLayer</span><span style=color:#f92672>(</span>layer<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Export the result PSD to various file formats to make sure that a layer mask
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// was added to a layer group and it is rendered properly for those file formats
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        dstPsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>dstPsdPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        PngOptions pngOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        pngOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setColorType</span><span style=color:#f92672>(</span>PngColorType<span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        dstPsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>dstPngPath<span style=color:#f92672>,</span> pngOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        JpegOptions jpegOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> JpegOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        jpegOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setColorType</span><span style=color:#f92672>(</span>JpegCompressionColorMode<span style=color:#f92672>.</span><span style=color:#a6e22e>Rgb</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        dstPsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>dstJpgPath<span style=color:#f92672>,</span> jpegOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Use a control PSD image to make sure that Graphics renders the layer mask properly, as well
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        PsdImage controlPsdImage <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PsdImage<span style=color:#f92672>(</span>dstPsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>(),</span> dstPsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            Graphics graphics <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Graphics<span style=color:#f92672>(</span>controlPsdImage<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            graphics<span style=color:#f92672>.</span><span style=color:#a6e22e>drawImageUnscaled</span><span style=color:#f92672>(</span>dstPsdImage<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> 0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            controlPsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>dstPngPath1<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            controlPsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        dstPsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    srcPsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p><p><strong>PSDJAVA-237. Clipping mask not applying to the folder</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// This example verifies that clipping masks that are bound to layer groups are exported
</span></span></span><span style=display:flex><span><span style=color:#75715e>// properly for a predefined PSD file.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>String srcPsdPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;foldersAndFigures.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>String dstPngPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;output.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PsdImage psdImage <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>srcPsdPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Export the loaded PSD to a PNG file format to make sure that clipping masks are
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// exported properly that is they are visible on the output image
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>dstPngPath<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p><p><strong>PSDJAVA-238. Cannot open file with Aspose.PSD for Java</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// This example loads and saves a particular PSD file without throwing exception.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>String srcPsdPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sample.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>String dstPngPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;output.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PsdImage psdImage <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>srcPsdPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>dstPngPath<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p><p><strong>PSDJAVA-239. Image saving failed exception when converting PSD to PDF</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// This example exports a particular PSD file to PDF file format with the read only mode is
</span></span></span><span style=display:flex><span><span style=color:#75715e>// turned on and off to make sure that no error is throwing and the output file is correct.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>LocalScopeExtension</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>exportPsdToPdf</span><span style=color:#f92672>(</span>String srcFilePath<span style=color:#f92672>,</span> String dstFilePath<span style=color:#f92672>,</span> <span style=color:#66d9ef>boolean</span> readOnlyMode<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throws</span> IOException
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        FileInputStream fileStream <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> FileInputStream<span style=color:#f92672>(</span>srcFilePath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            PsdLoadOptions psdLoadOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PsdLoadOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            psdLoadOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setReadOnlyMode</span><span style=color:#f92672>(</span>readOnlyMode<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>fileStream<span style=color:#f92672>,</span> psdLoadOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>dstFilePath<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PdfOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            fileStream<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>LocalScopeExtension $ <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> LocalScopeExtension<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String srcPsdPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sample.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>String dstPdfPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;output-ReadOnlyMode-On.pdf&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>String dstPdfPath1 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;output-ReadOnlyMode-Off.pdf&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$<span style=color:#f92672>.</span><span style=color:#a6e22e>exportPsdToPdf</span><span style=color:#f92672>(</span>srcPsdPath<span style=color:#f92672>,</span> dstPdfPath<span style=color:#f92672>,</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>$<span style=color:#f92672>.</span><span style=color:#a6e22e>exportPsdToPdf</span><span style=color:#f92672>(</span>srcPsdPath<span style=color:#f92672>,</span> dstPdfPath1<span style=color:#f92672>,</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>);</span></span></span></code></pre></div></p><p><strong>PSDJAVA-240. Crop operation makes Clipping path invalid in PSD image</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// This example demonstrates that the crop operation does not make a clipping path invalid.
</span></span></span><span style=display:flex><span><span style=color:#75715e>// The program loads a particular PSD file then it crops and saves the file. After the program
</span></span></span><span style=display:flex><span><span style=color:#75715e>// opens the saved file and verifies that the crop operation was performed as expected.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>String srcPsdPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;original.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>String dstPsdPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;output.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Load, crop and save the image
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>PsdImage psdImage <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>srcPsdPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Search for a WorkingPathResource resource
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ResourceBlock<span style=color:#f92672>[]</span> imageResources <span style=color:#f92672>=</span> psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>getImageResources</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    WorkingPathResource workingPathResource <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>ResourceBlock imageResource <span style=color:#f92672>:</span> imageResources<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>imageResource <span style=color:#66d9ef>instanceof</span> WorkingPathResource<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            workingPathResource <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>WorkingPathResource<span style=color:#f92672>)</span>imageResource<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Check whether the initial position of the clipping mask has is correct
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    BezierKnotRecord record <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>BezierKnotRecord<span style=color:#f92672>)</span>workingPathResource<span style=color:#f92672>.</span><span style=color:#a6e22e>getPaths</span><span style=color:#f92672>()[</span>3<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>record<span style=color:#f92672>.</span><span style=color:#a6e22e>getPoints</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getX</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 2572506 <span style=color:#f92672>||</span> record<span style=color:#f92672>.</span><span style=color:#a6e22e>getPoints</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getY</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 8535408<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Exception<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Values is incorrect.&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Crop and save the image
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>crop</span><span style=color:#f92672>(</span>0<span style=color:#f92672>,</span> 500<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> 200<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>dstPsdPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Load the saved image and make sure there are no side effects
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>PsdImage psdImage1 <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>dstPsdPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Search for a WorkingPathResource resource
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ResourceBlock<span style=color:#f92672>[]</span> imageResources <span style=color:#f92672>=</span> psdImage1<span style=color:#f92672>.</span><span style=color:#a6e22e>getImageResources</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    WorkingPathResource workingPathResource <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>ResourceBlock imageResource <span style=color:#f92672>:</span> imageResources<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>imageResource <span style=color:#66d9ef>instanceof</span> WorkingPathResource<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            workingPathResource <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>WorkingPathResource<span style=color:#f92672>)</span>imageResource<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Verify whether the new position of the clipping mask is correct
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    BezierKnotRecord record <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>BezierKnotRecord<span style=color:#f92672>)</span>workingPathResource<span style=color:#f92672>.</span><span style=color:#a6e22e>getPaths</span><span style=color:#f92672>()[</span>3<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>record<span style=color:#f92672>.</span><span style=color:#a6e22e>getPoints</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getX</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 4630510 <span style=color:#f92672>||</span> record<span style=color:#f92672>.</span><span style=color:#a6e22e>getPoints</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getY</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 22761088<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Exception<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Values is incorrect.&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    psdImage1<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p><p><strong>PSDJAVA-241. NullReference Exception when trying to save Specific PSD file with the Shadow Effect</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// This example demonstrates that there is no exception on saving a particular PSD file.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>String srcPsdPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;PsdConvertToPngExample.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>String dstPsdPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;output.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Enable loading effects (required because the file contains a shadow effect)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>PsdLoadOptions psdLoadOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PsdLoadOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>psdLoadOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setLoadEffectsResource</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>PsdImage psdImage <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>srcPsdPath<span style=color:#f92672>,</span> psdLoadOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Export the loaded PSD file to PNG file format with some trivial options and
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// make sure there is no exception during the saving
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    PngOptions pngOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    pngOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setColorType</span><span style=color:#f92672>(</span>PngColorType<span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    pngOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setProgressive</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    pngOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setCompressionLevel</span><span style=color:#f92672>(</span>9<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>dstPsdPath<span style=color:#f92672>,</span> pngOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p><p><strong>PSDJAVA-243. Aspose.PSD returns true on Image.CanLoad(pdfStream)</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// This example verifies that Image.canLoad property was fixed and returns &#34;false&#34; for
</span></span></span><span style=display:flex><span><span style=color:#75715e>// unsupported files. The program just loops through a list of predefined un/supported files.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>String<span style=color:#f92672>[]</span> supportedFilePaths <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> String<span style=color:#f92672>[]</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;form_3.ai&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;form_3_jap.ai&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;form_8.ai&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;form_9.ai&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;form_10.ai&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;form_cs1.ai&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;form_cs2.ai&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;form_cs3.ai&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;form_cs4.ai&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;form_cs5.ai&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;form_cs4.ai&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;form_cs6.ai&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;form_cc.ai&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>String<span style=color:#f92672>[]</span> unsupportedFilePaths <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> String<span style=color:#f92672>[]</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;broken_cc.ai&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// These files should return True on CanLoad
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>String filepath <span style=color:#f92672>:</span> supportedFilePaths<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    FileInputStream stream <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> FileInputStream<span style=color:#f92672>(</span>filepath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>boolean</span> canLoad <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>canLoad</span><span style=color:#f92672>(</span>stream<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>canLoad<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Exception<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Should be True, but was False in &#34;</span> <span style=color:#f92672>+</span> filepath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        stream<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// These files should return False on CanLoad
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>String filepath <span style=color:#f92672>:</span> unsupportedFilePaths<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    FileInputStream stream <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> FileInputStream<span style=color:#f92672>(</span>filepath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>boolean</span> canLoad <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>canLoad</span><span style=color:#f92672>(</span>stream<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>canLoad<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Exception<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Should be False, but was True in &#34;</span> <span style=color:#f92672>+</span> filepath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        stream<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p><p><strong>PSDJAVA-244. Layers failed to render in generated PNG</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// This examples verifies that a particular PSD file is exported correctly after flattening.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>String srcPsdPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sccnn_2020053000075715XUHD.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>String dstPngPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sccnn_2020053000075715XUHD_output.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PngOptions pngOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>pngOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setColorType</span><span style=color:#f92672>(</span>PngColorType<span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>PsdImage psdImage <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>srcPsdPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Merge all layers and export the result layer as an image
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>flattenImage</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>    psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>dstPngPath<span style=color:#f92672>,</span> pngOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p><p><strong>PSDJAVA-245. Exception on accessing TextData</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// This examples verifies that there is no exception on accessing particular text data.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>String srcPsdPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;A.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PsdImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>srcPsdPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Access and modify text data without exception
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    TextLayer textLayer <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>TextLayer<span style=color:#f92672>)</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>()[</span>1<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>    String text <span style=color:#f92672>=</span> textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>getText</span><span style=color:#f92672>();</span> <span style=color:#75715e>// no exception here...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    IText textData <span style=color:#f92672>=</span> textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>getTextData</span><span style=color:#f92672>();</span> <span style=color:#75715e>// no exception here...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>updateText</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;abc&#34;</span><span style=color:#f92672>);</span>  <span style=color:#75715e>// no exception here...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p><p><strong>PSDJAVA-246. ImageSaveException on saving the PSD</strong><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// This example verifies that there is no exception on saving particular PSD file.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>String srcPsdPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;snowflake-ui-kit.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>String dstPsdPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;snowflake-ui-kit-output.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PsdImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>srcPsdPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>dstPsdPath<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PsdOptions<span style=color:#f92672>(</span>image<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p></p></div></div></div></div><hr></div></div></section></div></div></div></div></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>