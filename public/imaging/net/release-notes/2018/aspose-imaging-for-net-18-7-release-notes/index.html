<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.Imaging for .NET 18.7 - Release Notes</title><meta name=description content="Aspose.Imaging for .NET 18.7 - Release Notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/imaging/net/release-notes/2018/aspose-imaging-for-net-18-7-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/imaging/net/release-notes/2018/aspose-imaging-for-net-18-7-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.Imaging for .NET 18.7 - Release Notes "><meta property="og:description" content="Aspose.Imaging for .NET 18.7 - Release Notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/imaging/net/release-notes/2018/aspose-imaging-for-net-18-7-release-notes/"><meta itemprop=name content="Aspose.Imaging for .NET 18.7 - Release Notes"><meta itemprop=description content="Aspose.Imaging for .NET 18.7 - Release Notes – the latest updates and fixes."><meta itemprop=wordCount content="1308"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.Imaging for .NET 18.7 - Release Notes"><meta name=twitter:description content="Aspose.Imaging for .NET 18.7 - Release Notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css preload><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/imaging/>Aspose.Imaging Product Family</a><span class=divider></span></li><li><a href=/imaging/net/>Aspose.Imaging for .NET</a><span class=divider></span></li><li><a href=/imaging/net/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/imaging/net/release-notes/2018/>2018</a><span class=divider></span></li><li><a href=/imaging/net/release-notes/2018/aspose-imaging-for-net-18-7-release-notes/>Aspose.Imaging for .NET 18.7 - Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><section role=main class="container main-container page-package-details"><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section package-details-main"><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.Imaging for .NET 18.7 - Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><table><thead><tr><th style=text-align:left><strong>Key</strong></th><th style=text-align:left><strong>Summary</strong></th><th style=text-align:left><strong>Category</strong></th></tr></thead><tbody><tr><td style=text-align:left>IMAGINGNET-2990</td><td style=text-align:left>The extraction of the ICC Profile from a gray scale image</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGNET-2980</td><td style=text-align:left>Lock layers in Images</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGNET-1992</td><td style=text-align:left>Support save Emf/Emf+ images to file</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGNET-1603</td><td style=text-align:left>Support for writing SVG file for possible conversion of other formats to SVG</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGNET-3027</td><td style=text-align:left>Getting compression type of Tiff Image</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-3019</td><td style=text-align:left>The conversion GIF to PNG produces the corrupted output</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-3016</td><td style=text-align:left>Investigate and fix export to JPEG2000 in multi-threaded environment</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-3013</td><td style=text-align:left>Fix OpenTypeFontsCache for Platform environment</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-3010</td><td style=text-align:left>LoadArgb64Pixels causes exception without a license</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-3009</td><td style=text-align:left>Tiff XmpData and ExifData is not removed completely</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-3006</td><td style=text-align:left>SVG to JPG - scrumbled output</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2984</td><td style=text-align:left>The alpha channel enabled by default for PSD images.</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2976</td><td style=text-align:left>ImageSaveException: Image export failed. &mdash;> ArrayIndexOutOfBoundsException</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2969</td><td style=text-align:left>Expose WebPImage properties to public</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2943</td><td style=text-align:left>The conversion of PSD file with a layer overflowing the canvas gives corrupted TIFF output</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2894</td><td style=text-align:left>TIFF generation with embedded color profiles fails without license</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2888</td><td style=text-align:left>CMYK plane details needed</td><td style=text-align:left>Enhancement</td></tr></tbody></table><h1 id=public-api-changes><strong>Public API changes:</strong></h1><h2 id=added-apis><strong>Added APIs:</strong></h2><p>Class Aspose.Imaging.FileFormats.Psd.Layers.LayerResources.LayerLockType</p><p>Class Aspose.Imaging.FileFormats.Psd.Layers.LayerResources.LspfResource</p><p>Class Aspose.Imaging.ImageOptions.EmfOptions</p><p>Class Aspose.Imaging.ImageOptions.MetafileOptions</p><p>Field/Enum Aspose.Imaging.FileFormats.Psd.Layers.LayerResources.LayerLockType.LockAll</p><p>Field/Enum Aspose.Imaging.FileFormats.Psd.Layers.LayerResources.LayerLockType.LockImagePixels</p><p>Field/Enum Aspose.Imaging.FileFormats.Psd.Layers.LayerResources.LayerLockType.LockPosition</p><p>Field/Enum Aspose.Imaging.FileFormats.Psd.Layers.LayerResources.LayerLockType.LockTransparentPixels</p><p>Field/Enum Aspose.Imaging.FileFormats.Psd.Layers.LayerResources.LayerLockType.None</p><p>Field/Enum Aspose.Imaging.FileFormats.Psd.Layers.LayerResources.LspfResource.TypeToolKey</p><p>Method Aspose.Imaging.FileFormats.Emf.Emf.Records.EmfBlendFunction.ToInt</p><p>Method Aspose.Imaging.FileFormats.Emf.Emf.Records.EmfExcludeClipRect.#ctor</p><p>Method Aspose.Imaging.FileFormats.Emf.Emf.Records.EmfOffsetClipRgn.#ctor</p><p>Method Aspose.Imaging.FileFormats.Emf.Emf.Records.EmfPaintRgn.#ctor</p><p>Method Aspose.Imaging.FileFormats.Emf.Emf.Records.EmfRecord.#ctor</p><p>Method Aspose.Imaging.FileFormats.Psd.Layers.LayerResources.LspfResource.#ctor</p><p>Method Aspose.Imaging.FileFormats.Psd.Layers.LayerResources.LspfResource.Save(Aspose.Imaging.StreamContainer,System.Int32)</p><p>Method Aspose.Imaging.FileFormats.Wmf.Objects.WmfPitchAndFamily.ToByte</p><p>Method Aspose.Imaging.ImageOptions.EmfOptions.#ctor</p><p>Method Aspose.Imaging.ImageOptions.MetafileOptions.#ctor</p><p>Property Aspose.Imaging.FileFormats.Emf.Emf.Objects.EmfRegionDataHeader.RgnSize</p><p>Property Aspose.Imaging.FileFormats.Psd.Layers.Layer.LayerLock</p><p>Property Aspose.Imaging.FileFormats.Psd.Layers.LayerResources.LspfResource.Key</p><p>Property Aspose.Imaging.FileFormats.Psd.Layers.LayerResources.LspfResource.Length</p><p>Property Aspose.Imaging.FileFormats.Psd.Layers.LayerResources.LspfResource.LockType</p><p>Property Aspose.Imaging.FileFormats.Psd.Layers.LayerResources.LspfResource.PsdVersion</p><p>Property Aspose.Imaging.FileFormats.Psd.Layers.LayerResources.LspfResource.Signature</p><p>Property Aspose.Imaging.FileFormats.Psd.PsdImage.GrayColorProfile</p><p>Property Aspose.Imaging.ImageLoadOptions.PsdLoadOptions.IgnoreAlphaChannel</p><h2 id=removed-apis><strong>Removed APIs:</strong></h2><p>Property Aspose.Imaging.FileFormats.Emf.Emf.Records.EmfColorCorrectPalette.NReserved</p><p>Property Aspose.Imaging.FileFormats.Emf.Emf.Records.EmfEof.PaletteBuffer</p><p>Property Aspose.Imaging.FileFormats.Emf.Emf.Records.EmfSetLinkedUfis.Reserved</p><p>Property Aspose.Imaging.FileFormats.Emf.Emf.Records.EmfSetLinkedUfis.UNumLinkedUFI</p><p>Property Aspose.Imaging.FileFormats.Emf.EmfPlus.Records.EmfPlusDrawDriverString.GlyphsString</p><p>Property Aspose.Imaging.ImageOptions.BmpOptions.HorizontalResolution</p><p>Property Aspose.Imaging.ImageOptions.BmpOptions.VerticalResolution</p><h1 id=usage-examples><strong>Usage examples:</strong></h1><p><strong>IMAGINGNET-2990 The extraction of the ICC Profile from a gray scale image</strong></p><p>Please use the following code to extract Gray (monochrome) ICC profile from PSD image and embed it to TIFF image.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>TestJira2990_ExtractIccProfiles_ApplyIcc</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	string dir <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;c:\aspose.work\IMAGINGNET\2990\&#34;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	string sourcePath = dir + &#34;</span>gray<span style=color:#f92672>-</span>d15<span style=color:#f92672>.</span><span style=color:#a6e22e>psd</span><span style=color:#e6db74>&#34;;            
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	string outputPath = dir + &#34;</span>gray<span style=color:#f92672>-</span>d15<span style=color:#f92672>.</span><span style=color:#a6e22e>psd</span><span style=color:#f92672>.</span><span style=color:#a6e22e>apply</span><span style=color:#f92672>-</span>icc<span style=color:#f92672>.</span><span style=color:#a6e22e>tif</span><span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Save to grayscale TIFF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>	TiffOptions saveOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> TiffOptions<span style=color:#f92672>(</span>TiffExpectedFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>Default</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>Photometric</span> <span style=color:#f92672>=</span> TiffPhotometrics<span style=color:#f92672>.</span><span style=color:#a6e22e>MinIsBlack</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>BitsPerSample</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ushort<span style=color:#f92672>[]</span> <span style=color:#f92672>{</span> 8 <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// If the image contains a built-in Gray ICC profile, it is not be applied by default in contrast of the CMYK profile.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Enable ICC conversion explicitly.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>	LoadOptions loadOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> LoadOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	loadOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>UseIccProfileConversion</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	using <span style=color:#f92672>(</span>PsdImage psdImage <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>sourcePath<span style=color:#f92672>,</span> loadOptions<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// Embed the gray ICC profile to the output TIFF.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// The built-in Gray Profile can be read via the PsdImage.GrayColorProfile property.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>		saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>IccProfile</span> <span style=color:#f92672>=</span> ToMemoryStream<span style=color:#f92672>(</span>psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>GrayColorProfile</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputPath<span style=color:#f92672>,</span> saveOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> MemoryStream <span style=color:#a6e22e>ToMemoryStream</span><span style=color:#f92672>(</span>StreamSource streamSource<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	Stream srcStream <span style=color:#f92672>=</span> streamSource<span style=color:#f92672>.</span><span style=color:#a6e22e>Stream</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	MemoryStream dstStream <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> MemoryStream<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>int</span> byteCount<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> buffer <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>1024<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>long</span> pos <span style=color:#f92672>=</span> srcStream<span style=color:#f92672>.</span><span style=color:#a6e22e>Position</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	srcStream<span style=color:#f92672>.</span><span style=color:#a6e22e>Seek</span><span style=color:#f92672>(</span>0<span style=color:#f92672>,</span> SeekOrigin<span style=color:#f92672>.</span><span style=color:#a6e22e>Begin</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>while</span> <span style=color:#f92672>((</span>byteCount <span style=color:#f92672>=</span> srcStream<span style=color:#f92672>.</span><span style=color:#a6e22e>Read</span><span style=color:#f92672>(</span>buffer<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> buffer<span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span><span style=color:#f92672>))</span> <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		dstStream<span style=color:#f92672>.</span><span style=color:#a6e22e>Write</span><span style=color:#f92672>(</span>buffer<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> byteCount<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	srcStream<span style=color:#f92672>.</span><span style=color:#a6e22e>Seek</span><span style=color:#f92672>(</span>pos<span style=color:#f92672>,</span> SeekOrigin<span style=color:#f92672>.</span><span style=color:#a6e22e>Begin</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> dstStream<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p>You can also set loadOptions.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=UseIccProfileConversion&linkCreation=true&fromPageId=66950105">UseIccProfileConversion</a> = false to disable ICC color conversion explicitly as shown below:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>TestJira2990_ExtractIccProfiles_IgnoreIcc</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	string dir <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;c:\aspose.work\IMAGINGNET\2990\&#34;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	string sourcePath = dir + &#34;</span>gray<span style=color:#f92672>-</span>d15<span style=color:#f92672>.</span><span style=color:#a6e22e>psd</span><span style=color:#e6db74>&#34;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	string outputPath = dir + &#34;</span>gray<span style=color:#f92672>-</span>d15<span style=color:#f92672>.</span><span style=color:#a6e22e>psd</span><span style=color:#f92672>.</span><span style=color:#a6e22e>ignore</span><span style=color:#f92672>-</span>icc<span style=color:#f92672>.</span><span style=color:#a6e22e>tif</span><span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Save to grayscale TIFF
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>	TiffOptions saveOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> TiffOptions<span style=color:#f92672>(</span>TiffExpectedFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>Default</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>Photometric</span> <span style=color:#f92672>=</span> TiffPhotometrics<span style=color:#f92672>.</span><span style=color:#a6e22e>MinIsBlack</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>BitsPerSample</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ushort<span style=color:#f92672>[]</span> <span style=color:#f92672>{</span> 8 <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Disable the ICC color conversion explicitly to get the original colors without applying a built-in ICC profile.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>	LoadOptions loadOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> LoadOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	loadOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>UseIccProfileConversion</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Or just omit loadOptions because the built-in Gray ICC profile is not applied by default in contrast of the CMYK profile. 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>	using <span style=color:#f92672>(</span>PsdImage psdImage <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>sourcePath<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// Embed the gray ICC profile to the output TIFF.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// The built-in Gray Profile can be read via the PsdImage.GrayColorProfile property.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>		saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>IccProfile</span> <span style=color:#f92672>=</span> ToMemoryStream<span style=color:#f92672>(</span>psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>GrayColorProfile</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputPath<span style=color:#f92672>,</span> saveOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2980 Lock layers in Images</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string sourceFile <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;layerLock.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outputFile <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;result.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>PsdImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>sourceFile<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    Layer<span style=color:#f92672>[]</span> layers <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Layers</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    layers<span style=color:#f92672>[</span>4<span style=color:#f92672>].</span><span style=color:#a6e22e>LayerLock</span> <span style=color:#f92672>=</span> LayerLockType<span style=color:#f92672>.</span><span style=color:#a6e22e>LockAll</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    layers<span style=color:#f92672>[</span>2<span style=color:#f92672>].</span><span style=color:#a6e22e>LayerLock</span> <span style=color:#f92672>=</span> LayerLockType<span style=color:#f92672>.</span><span style=color:#a6e22e>None</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    layers<span style=color:#f92672>[</span>3<span style=color:#f92672>].</span><span style=color:#a6e22e>LayerLock</span> <span style=color:#f92672>=</span> LayerLockType<span style=color:#f92672>.</span><span style=color:#a6e22e>LockTransparentPixels</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    layers<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>LayerLock</span> <span style=color:#f92672>=</span> LayerLockType<span style=color:#f92672>.</span><span style=color:#a6e22e>LockImagePixels</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    layers<span style=color:#f92672>[</span>5<span style=color:#f92672>].</span><span style=color:#a6e22e>LayerLock</span> <span style=color:#f92672>=</span> LayerLockType<span style=color:#f92672>.</span><span style=color:#a6e22e>LockPosition</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    layers<span style=color:#f92672>[</span>5<span style=color:#f92672>].</span><span style=color:#a6e22e>Flags</span> <span style=color:#f92672>=</span> LayerFlags<span style=color:#f92672>.</span><span style=color:#a6e22e>TransparencyProtected</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputFile<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-1992 Support save Emf/Emf+ images to file</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>TestSaveEmf</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    var path <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;TestEmfBezier.emf&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    using <span style=color:#f92672>(</span>var image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>MetaImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>path<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>path <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.emf&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> EmfOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>TestSaveEmfPlus</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    var path <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;TestEmfPlusFigures.emf&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    using <span style=color:#f92672>(</span>var image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>MetaImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>path<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>path <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.emf&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> EmfOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>TestSaveEmfGraphics</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    EmfRecorderGraphics2D graphics <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> EmfRecorderGraphics2D<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>new</span> Rectangle<span style=color:#f92672>(</span>0<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> 5000<span style=color:#f92672>,</span> 5000<span style=color:#f92672>),</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>new</span> Size<span style=color:#f92672>(</span>5000<span style=color:#f92672>,</span> 5000<span style=color:#f92672>),</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>new</span> Size<span style=color:#f92672>(</span>1000<span style=color:#f92672>,</span> 1000<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Font font <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Font<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Arial&#34;</span><span style=color:#f92672>,</span> 10<span style=color:#f92672>,</span> FontStyle<span style=color:#f92672>.</span><span style=color:#a6e22e>Bold</span> <span style=color:#f92672>|</span> FontStyle<span style=color:#f92672>.</span><span style=color:#a6e22e>Underline</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        graphics<span style=color:#f92672>.</span><span style=color:#a6e22e>DrawString</span><span style=color:#f92672>(</span>font<span style=color:#f92672>.</span><span style=color:#a6e22e>Name</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; &#34;</span> <span style=color:#f92672>+</span> font<span style=color:#f92672>.</span><span style=color:#a6e22e>Size</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; &#34;</span> <span style=color:#f92672>+</span> font<span style=color:#f92672>.</span><span style=color:#a6e22e>Style</span><span style=color:#f92672>.</span><span style=color:#a6e22e>ToString</span><span style=color:#f92672>(),</span> font<span style=color:#f92672>,</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>Brown</span><span style=color:#f92672>,</span> 10<span style=color:#f92672>,</span> 10<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        graphics<span style=color:#f92672>.</span><span style=color:#a6e22e>DrawString</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;some text&#34;</span><span style=color:#f92672>,</span> font<span style=color:#f92672>,</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>Brown</span><span style=color:#f92672>,</span> 10<span style=color:#f92672>,</span> 30<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        font <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Font<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Arial&#34;</span><span style=color:#f92672>,</span> 24<span style=color:#f92672>,</span> FontStyle<span style=color:#f92672>.</span><span style=color:#a6e22e>Italic</span> <span style=color:#f92672>|</span> FontStyle<span style=color:#f92672>.</span><span style=color:#a6e22e>Strikeout</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        graphics<span style=color:#f92672>.</span><span style=color:#a6e22e>DrawString</span><span style=color:#f92672>(</span>font<span style=color:#f92672>.</span><span style=color:#a6e22e>Name</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; &#34;</span> <span style=color:#f92672>+</span> font<span style=color:#f92672>.</span><span style=color:#a6e22e>Size</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; &#34;</span> <span style=color:#f92672>+</span> font<span style=color:#f92672>.</span><span style=color:#a6e22e>Style</span><span style=color:#f92672>.</span><span style=color:#a6e22e>ToString</span><span style=color:#f92672>(),</span> font<span style=color:#f92672>,</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>Brown</span><span style=color:#f92672>,</span> 20<span style=color:#f92672>,</span> 50<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        graphics<span style=color:#f92672>.</span><span style=color:#a6e22e>DrawString</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;some text&#34;</span><span style=color:#f92672>,</span> font<span style=color:#f92672>,</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>Brown</span><span style=color:#f92672>,</span> 20<span style=color:#f92672>,</span> 80<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        using <span style=color:#f92672>(</span>EmfImage image <span style=color:#f92672>=</span> graphics<span style=color:#f92672>.</span><span style=color:#a6e22e>EndRecording</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            var path <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;Fonts.emf&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>path<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> EmfOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p>I<strong>MAGINGNET-1603 Support for writing SVG file for possible conversion of other formats to SVG</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;mysvg.svg&#34;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    using <span style=color:#f92672>(</span>FileStream fs <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> FileStream<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;yoursvg.svg&#34;</span><span style=color:#f92672>,</span> FileMode<span style=color:#f92672>.</span><span style=color:#a6e22e>Create</span><span style=color:#f92672>,</span> FileAccess<span style=color:#f92672>.</span><span style=color:#a6e22e>ReadWrite</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>fs<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-3019 The conversion GIF to PNG produces the corrupted output.</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string path <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;source.gif&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outputPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;result.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>GifImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>GifImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>path<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputPath<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-3016 Investigate and fix export to JPEG2000 in multi-threaded environment</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#66d9ef>private</span> readonly string<span style=color:#f92672>[]</span> inputFiles <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> string<span style=color:#f92672>[]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;tiger.bmp&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;ImagePaletteColor.dicom&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;2086.gif&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;10.jpg&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;multi.jpx&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;1.png&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;3layers_maximized_comp.psd&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;33266.tif&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Animation1.webp&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> readonly StringBuilder stackTrace <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> StringBuilder<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> bool isError <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// this method should throw no exceptions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>TestSaveJpeg2000Multithreaded</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Thread<span style=color:#f92672>[]</span> threads <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Thread<span style=color:#f92672>[</span>inputFiles<span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span><span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> x <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> x <span style=color:#f92672>&lt;</span> inputFiles<span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span><span style=color:#f92672>;</span> x<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        string inputFile <span style=color:#f92672>=</span> inputFiles<span style=color:#f92672>[</span>x<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        threads<span style=color:#f92672>[</span>x<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Thread<span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> ThreadStart<span style=color:#f92672>(</span>delegate <span style=color:#f92672>{</span> SaveAsJpeg2000<span style=color:#f92672>(</span>inputFile<span style=color:#f92672>);</span> <span style=color:#f92672>}));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        threads<span style=color:#f92672>[</span>x<span style=color:#f92672>].</span><span style=color:#a6e22e>Start</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    foreach <span style=color:#f92672>(</span>Thread thread in threads<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        thread<span style=color:#f92672>.</span><span style=color:#a6e22e>Join</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>isError</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Exception<span style=color:#f92672>(</span>stackTrace<span style=color:#f92672>.</span><span style=color:#a6e22e>ToString</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>SaveAsJpeg2000</span><span style=color:#f92672>(</span>string inputFile<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    string outFile <span style=color:#f92672>=</span> inputFile <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.jp2&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    using <span style=color:#f92672>(</span>Image img <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>inputFile<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            img<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outFile<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> Jpeg2000Options<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>Exception e<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>isError</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            stackTrace<span style=color:#f92672>.</span><span style=color:#a6e22e>AppendLine</span><span style=color:#f92672>(</span>e<span style=color:#f92672>.</span><span style=color:#a6e22e>ToString</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    File<span style=color:#f92672>.</span><span style=color:#a6e22e>Delete</span><span style=color:#f92672>(</span>outFile<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-3010 LoadArgb64Pixels causes exception without a license</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>  <span style=color:#66d9ef>string</span> dir = <span style=color:#e6db74>@&#34;c:\aspose.work\IMAGINGNET\2934\&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>string</span> fileName = <span style=color:#e6db74>&#34;16bit Uncompressed, BigEndian, Rgb, Contiguous Gamma1.0.tif&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ICC profile is not applied for 16-bit color components at the moment, so disable that option explicitly.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>LoadOptions loadOptions = <span style=color:#66d9ef>new</span> LoadOptions();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>loadOptions.UseIccProfileConversion = <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Rectangle desiredArea = <span style=color:#66d9ef>new</span> Rectangle(<span style=color:#ae81ff>470</span>, <span style=color:#ae81ff>1350</span>, <span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>30</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> (RasterImage image = (RasterImage)Image.Load(dir + fileName, loadOptions))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>long</span>[] colors64Bit = image.LoadArgb64Pixels(image.Bounds);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>ushort</span> alpha, red, green, blue;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> y = desiredArea.Top; y &lt; desiredArea.Bottom; ++y)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> x = desiredArea.Left; x &lt; desiredArea.Right; ++x)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>int</span> offset = y * image.Width + x;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>long</span> color64 = colors64Bit[offset];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			alpha = (<span style=color:#66d9ef>ushort</span>)((color64 &gt;&gt; <span style=color:#ae81ff>48</span>) &amp; <span style=color:#ae81ff>0xffff</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			red = (<span style=color:#66d9ef>ushort</span>)((color64 &gt;&gt; <span style=color:#ae81ff>32</span>) &amp; <span style=color:#ae81ff>0xffff</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			green = (<span style=color:#66d9ef>ushort</span>)((color64 &gt;&gt; <span style=color:#ae81ff>16</span>) &amp; <span style=color:#ae81ff>0xffff</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			blue = (<span style=color:#66d9ef>ushort</span>)(color64 &amp; <span style=color:#ae81ff>0xffff</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			Console.WriteLine(<span style=color:#e6db74>&#34;A={0}, R={1}, G={2}, B={3}&#34;</span>, alpha, red, green, blue);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p><strong>IMAGINGNET-3006 SVG to JPG - scrumbled output</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>             string fileDir <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;D:\&#34;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            string[] files = new string[2]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>           {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                &#34;</span>Abu_Dhabi_Media<span style=color:#f92672>.</span><span style=color:#a6e22e>svg</span><span style=color:#e6db74>&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                &#34;</span>az<span style=color:#f92672>-</span>alkmaar<span style=color:#f92672>.</span><span style=color:#a6e22e>svg</span><span style=color:#e6db74>&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>           };
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            foreach (string fileName in files)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                string inputFileName = Path.Combine(fileDir, fileName);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                string outputFileName = inputFileName + &#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>jpg</span><span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>inputFileName<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    JpegOptions options <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> JpegOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputFileName<span style=color:#f92672>,</span> options<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2984 The alpha channel enabled by default for PSD images.</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string sourceFileName <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;alphachannel.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            string outputFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;result.jpg&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    PsdImage image <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                            sourceFileName<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>new</span> PsdLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> ReadOnlyMode <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>,</span> IgnoreAlphaChannel <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span> <span style=color:#f92672>}))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputFileName<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> JpegOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2969 Expose <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=WebPImage&linkCreation=true&fromPageId=66950105">WebPImage</a> properties to public</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string animFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Animation1.webp&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string animPathReSavedOptions <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Animation1_reSavedOptions.webp&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>WebPOptions options <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> WebPOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span><span style=color:#a6e22e>Quality</span> <span style=color:#f92672>=</span> 90f<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span><span style=color:#a6e22e>AnimLoopCount</span> <span style=color:#f92672>=</span> 5<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span><span style=color:#a6e22e>AnimBackgroundColor</span> <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>uint<span style=color:#f92672>)</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>Gray</span><span style=color:#f92672>.</span><span style=color:#a6e22e>ToArgb</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span><span style=color:#a6e22e>Lossless</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>WebPImage image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>animFileName<span style=color:#f92672>)</span> as WebPImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Debug<span style=color:#f92672>.</span><span style=color:#a6e22e>Assert</span><span style=color:#f92672>(</span>4278190080 <span style=color:#f92672>==</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Options</span><span style=color:#f92672>.</span><span style=color:#a6e22e>AnimBackgroundColor</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Debug<span style=color:#f92672>.</span><span style=color:#a6e22e>Assert</span><span style=color:#f92672>(</span>0 <span style=color:#f92672>==</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Options</span><span style=color:#f92672>.</span><span style=color:#a6e22e>AnimLoopCount</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>animPathReSavedOptions<span style=color:#f92672>,</span> options<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>WebPImage reSavedOptions <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>animPathReSavedOptions<span style=color:#f92672>)</span> as WebPImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Debug<span style=color:#f92672>.</span><span style=color:#a6e22e>Assert</span><span style=color:#f92672>(</span>reSavedOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>Options</span><span style=color:#f92672>.</span><span style=color:#a6e22e>AnimBackgroundColor</span> <span style=color:#f92672>==</span> options<span style=color:#f92672>.</span><span style=color:#a6e22e>AnimBackgroundColor</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Debug<span style=color:#f92672>.</span><span style=color:#a6e22e>Assert</span><span style=color:#f92672>(</span>reSavedOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>Options</span><span style=color:#f92672>.</span><span style=color:#a6e22e>AnimLoopCount</span> <span style=color:#f92672>==</span> options<span style=color:#f92672>.</span><span style=color:#a6e22e>AnimLoopCount</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Debug<span style=color:#f92672>.</span><span style=color:#a6e22e>Assert</span><span style=color:#f92672>(</span>reSavedOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>Options</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Lossless</span> <span style=color:#f92672>==</span> options<span style=color:#f92672>.</span><span style=color:#a6e22e>Lossless</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2894 TIFF generation with embedded color profiles fails without license</strong></p><p>follow code must be executed without license</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string fileName <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;D:\NavyExchangeCmyk.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>PsdImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>fileName<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	image<span style=color:#f92672>.</span><span style=color:#a6e22e>UseRawData</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	TiffOptions options <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> TiffOptions<span style=color:#f92672>(</span>TiffExpectedFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>TiffLzwCmyk</span><span style=color:#f92672>);</span>                
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>CmykColorProfile</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	  options<span style=color:#f92672>.</span><span style=color:#a6e22e>IccProfile</span> <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>CmykColorProfile</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Stream</span> as MemoryStream<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>fileName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.NoLic.tif&#34;</span><span style=color:#f92672>,</span> options<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p></div></div></div></div><hr></div></div></section></div></div></section></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>