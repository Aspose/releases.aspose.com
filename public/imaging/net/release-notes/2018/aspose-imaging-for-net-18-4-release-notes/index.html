<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.Imaging for .NET 18.4 - Release Notes</title><meta name=description content="Aspose.Imaging for .NET 18.4 - Release Notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/imaging/net/release-notes/2018/aspose-imaging-for-net-18-4-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/imaging/net/release-notes/2018/aspose-imaging-for-net-18-4-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.Imaging for .NET 18.4 - Release Notes "><meta property="og:description" content="Aspose.Imaging for .NET 18.4 - Release Notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/imaging/net/release-notes/2018/aspose-imaging-for-net-18-4-release-notes/"><meta itemprop=name content="Aspose.Imaging for .NET 18.4 - Release Notes"><meta itemprop=description content="Aspose.Imaging for .NET 18.4 - Release Notes – the latest updates and fixes."><meta itemprop=wordCount content="3075"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.Imaging for .NET 18.4 - Release Notes"><meta name=twitter:description content="Aspose.Imaging for .NET 18.4 - Release Notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css preload><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/imaging/>Aspose.Imaging Product Family</a><span class=divider></span></li><li><a href=/imaging/net/>Aspose.Imaging for .NET</a><span class=divider></span></li><li><a href=/imaging/net/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/imaging/net/release-notes/2018/>2018</a><span class=divider></span></li><li><a href=/imaging/net/release-notes/2018/aspose-imaging-for-net-18-4-release-notes/>Aspose.Imaging for .NET 18.4 - Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><section role=main class="container main-container page-package-details"><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section package-details-main"><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.Imaging for .NET 18.4 - Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><table><thead><tr><th style=text-align:left><strong>Key</strong></th><th style=text-align:left><strong>Summary</strong></th><th style=text-align:left><strong>Category</strong></th></tr></thead><tbody><tr><td style=text-align:left>IMAGINGNET-2924</td><td style=text-align:left>InterruptMonitor support for Java</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGNET-2893</td><td style=text-align:left>BMP to PDF conversion</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGNET-2681</td><td style=text-align:left>Convert PNG and JPEG images to PDF</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGNET-2368</td><td style=text-align:left>Support EPS file format (only raster preview)</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGNET-2302</td><td style=text-align:left>Need to investigate and support Layer Effects for PSD format</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGNET-2927</td><td style=text-align:left>Black text is not visible on transparent background when saving PSD into PDF</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2925</td><td style=text-align:left>Fix 24bpp options setting for export to BMP</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2896</td><td style=text-align:left>Evaluation watermark is missing when saving as SVG</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2895</td><td style=text-align:left>Venture License not works for ODG files</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2886</td><td style=text-align:left>SVG to raster has missing image parts</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2872</td><td style=text-align:left>Expose Codec property of JPEG2000 image to public</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2869</td><td style=text-align:left>Fix saving of multiple WEBP frames</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2867</td><td style=text-align:left>Fix duplication of resolution settings for BMP (check other formats as well)</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2850</td><td style=text-align:left>Exception on updating text layers</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2806</td><td style=text-align:left>Fix watermark on export metafile (EMF, WMF) to SVG</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2635</td><td style=text-align:left>Coordinate of left top corner is incorrect at update</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2407</td><td style=text-align:left>Convert DJVU to PNG throw exception when memory limitation</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2184</td><td style=text-align:left>Saving of PSD image produces invalid image colors</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-1962</td><td style=text-align:left>TIFF Codec can&rsquo;t save 16-bit channel image</td><td style=text-align:left>Enhancement</td></tr></tbody></table><h1 id=public-api-changes><strong>Public API changes:</strong></h1><h2 id=added-apis><strong>Added APIs:</strong></h2><p>No changes in API.</p><h2 id=removed-apis><strong>Removed APIs:</strong></h2><p>No changes in API.</p><h1 id=usage-examples><strong>Usage examples:</strong></h1><p><strong>IMAGINGNET-2924</strong> <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=InterruptMonitor&linkCreation=true&fromPageId=64456202"><strong>InterruptMonitor</strong></a> <strong>support for Java [.Net]</strong>
Please use the following code to interrupt Jpeg to Png conversion:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>InterruptJpegToPngConversion</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string dir <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;c:\aspose.work\IMAGINGNET\2924\&#34;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>ImageOptionsBase saveOptions = new PngOptions();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>InterruptMonitor monitor = new InterruptMonitor();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SaveImageWorker worker = new SaveImageWorker(dir + &#34;</span>big<span style=color:#f92672>.</span><span style=color:#a6e22e>jpg</span><span style=color:#e6db74>&#34;, dir + &#34;</span>big_out<span style=color:#f92672>.</span><span style=color:#a6e22e>png</span><span style=color:#e6db74>&#34;, saveOptions, monitor);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Thread thread = new Thread(new ThreadStart(worker.ThreadProc));
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>try
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>thread.Start();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>// The timeout should be less than the time required for full image conversion (without interruption).
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Thread.Sleep(3000);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>// Interrupt the process
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>monitor.Interrupt();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Console.WriteLine(&#34;</span>Interrupting the save thread <span style=color:#960050;background-color:#1e0010>#</span><span style=color:#f92672>{</span>0<span style=color:#f92672>}</span> at <span style=color:#f92672>{</span>1<span style=color:#f92672>}</span><span style=color:#e6db74>&#34;, thread.ManagedThreadId, System.DateTime.Now);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>// Wait for interruption...
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>thread.Join();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>finally
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>// If the file to be deleted does not exist, no exception is thrown.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>File.Delete(dir + &#34;</span>big_out<span style=color:#f92672>.</span><span style=color:#a6e22e>png</span><span style=color:#e6db74>&#34;);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// Initiates image conversion and waits for its interruption.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;/summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>private class SaveImageWorker
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// The path to the input image.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;/summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>private readonly string inputPath;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// The path to the output image.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;/summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>private readonly string outputPath;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// The interrupt monitor.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;/summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>private readonly InterruptMonitor monitor;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// The save options.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;/summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>private readonly ImageOptionsBase saveOptions;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// Initializes a new instance of the &lt;see cref=&#34;</span>SaveImageWorker<span style=color:#e6db74>&#34; /&gt; class.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;/summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;param name=&#34;</span>inputPath<span style=color:#e6db74>&#34;&gt;The path to the input image.&lt;/param&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;param name=&#34;</span>outputPath<span style=color:#e6db74>&#34;&gt;The path to the output image.&lt;/param&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;param name=&#34;</span>saveOptions<span style=color:#e6db74>&#34;&gt;The save options.&lt;/param&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;param name=&#34;</span>monitor<span style=color:#e6db74>&#34;&gt;The interrupt monitor.&lt;/param&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>public SaveImageWorker(string inputPath, string outputPath, ImageOptionsBase saveOptions, InterruptMonitor monitor)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>this.inputPath = inputPath;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>this.outputPath = outputPath;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>this.saveOptions = saveOptions;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>this.monitor = monitor;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// Tries to convert image from one format to another. Handles interruption.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/// &lt;/summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>public void ThreadProc()
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>using (Image image = Image.Load(this.inputPath))
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>InterruptMonitor.ThreadLocalInstance = this.monitor;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>try
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>image.Save(this.outputPath, this.saveOptions);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>catch (OperationInterruptedException e)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Console.WriteLine(&#34;</span>The save thread <span style=color:#960050;background-color:#1e0010>#</span><span style=color:#f92672>{</span>0<span style=color:#f92672>}</span> finishes at <span style=color:#f92672>{</span>1<span style=color:#f92672>}</span><span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#f92672>,</span> Thread<span style=color:#f92672>.</span><span style=color:#a6e22e>CurrentThread</span><span style=color:#f92672>.</span><span style=color:#a6e22e>ManagedThreadId</span><span style=color:#f92672>,</span> DateTime<span style=color:#f92672>.</span><span style=color:#a6e22e>Now</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Console<span style=color:#f92672>.</span><span style=color:#a6e22e>WriteLine</span><span style=color:#f92672>(</span>e<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>Exception e<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Console<span style=color:#f92672>.</span><span style=color:#a6e22e>WriteLine</span><span style=color:#f92672>(</span>e<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>InterruptMonitor<span style=color:#f92672>.</span><span style=color:#a6e22e>ThreadLocalInstance</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p>We have got the following output on my machine:</p><p>4/19/2018 7:00:39 PM **** Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=BlackBoxTest&linkCreation=true&fromPageId=64456202">BlackBoxTest</a>.Multithreading.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=InterruptMonitorTest&linkCreation=true&fromPageId=64456202">InterruptMonitorTest</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=InterruptJpegToPngConversion&linkCreation=true&fromPageId=64456202">InterruptJpegToPngConversion</a>
Interrupting the save thread #12 at 4/20/2018 12:00:42 AM
The save thread #12 finishes at 4/20/2018 12:00:42 AM
Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=CoreExceptions&linkCreation=true&fromPageId=64456202">CoreExceptions</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=OperationInterruptedException&linkCreation=true&fromPageId=64456202">OperationInterruptedException</a>: The operation has been interrupted &ndash;<del>> Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=CoreExceptions&linkCreation=true&fromPageId=64456202">CoreExceptions</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=OperationInterruptedException&linkCreation=true&fromPageId=64456202">OperationInterruptedException</a></del>-: The operation has been interrupted &mdash;> Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=CoreExceptions&linkCreation=true&fromPageId=64456202">CoreExceptions</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=OperationInterruptedException&linkCreation=true&fromPageId=64456202">OperationInterruptedException</a>: The operation has been interrupted.
at Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=FileFormats&linkCreation=true&fromPageId=64456202">FileFormats</a>.Jpeg.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=EncodingControllers&linkCreation=true&fromPageId=64456202">EncodingControllers</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=JpegDecodingController&linkCreation=true&fromPageId=64456202">JpegDecodingController</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=ConsumeDataRangeInterleaved&linkCreation=true&fromPageId=64456202">ConsumeDataRangeInterleaved</a>(Int32 startRow, Int32 endRow, Int32 lastRow, Rectangle areaToProcess) in C:\aspose.imaging.net\src\Core[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=FileFormats&linkCreation=true&fromPageId=64456202">FileFormats</a>]\Jpeg[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=EncodingControllers&linkCreation=true&fromPageId=64456202">EncodingControllers</a>][<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=JpegDecodingController&linkCreation=true&fromPageId=64456202">JpegDecodingController</a>].cs:line 862
at Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=FileFormats&linkCreation=true&fromPageId=64456202">FileFormats</a>.Jpeg.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=EncodingControllers&linkCreation=true&fromPageId=64456202">EncodingControllers</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=JpegDecodingController&linkCreation=true&fromPageId=64456202">JpegDecodingController</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=ConsumeDataRange&linkCreation=true&fromPageId=64456202">ConsumeDataRange</a>(Int32 startRow, Int32 endRow, Int32 lastRow, Rectangle areaToProcess) in C:\aspose.imaging.net\src\Core[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=FileFormats&linkCreation=true&fromPageId=64456202">FileFormats</a>]\Jpeg[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=EncodingControllers&linkCreation=true&fromPageId=64456202">EncodingControllers</a>][<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=JpegDecodingController&linkCreation=true&fromPageId=64456202">JpegDecodingController</a>].cs:line 794
at Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=FileFormats&linkCreation=true&fromPageId=64456202">FileFormats</a>.Jpeg.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=EncodingControllers&linkCreation=true&fromPageId=64456202">EncodingControllers</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=JpegDecodingController&linkCreation=true&fromPageId=64456202">JpegDecodingController</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=DecodeRowsRange&linkCreation=true&fromPageId=64456202">DecodeRowsRange</a>(<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=JpegRawDataReader&linkCreation=true&fromPageId=64456202">JpegRawDataReader</a> stream, Rectangle areaToProcess, Int32 startRow, Int32 endRow, Int32 lastRow, Boolean handleConsumeData) in C:\aspose.imaging.net\src\Core[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=FileFormats&linkCreation=true&fromPageId=64456202">FileFormats</a>]\Jpeg[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=EncodingControllers&linkCreation=true&fromPageId=64456202">EncodingControllers</a>][<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=JpegDecodingController&linkCreation=true&fromPageId=64456202">JpegDecodingController</a>].cs:line 360
at Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=FileFormats&linkCreation=true&fromPageId=64456202">FileFormats</a>.Jpeg.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=EncodingControllers&linkCreation=true&fromPageId=64456202">EncodingControllers</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=JpegDecodingController&linkCreation=true&fromPageId=64456202">JpegDecodingController</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=UnpackRowsRange&linkCreation=true&fromPageId=64456202">UnpackRowsRange</a>(Int32 startRow, Int32 endRow, Int32 lastRow, Rectangle areaToProcess) in C:\aspose.imaging.net\src\Core[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=FileFormats&linkCreation=true&fromPageId=64456202">FileFormats</a>]\Jpeg[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=EncodingControllers&linkCreation=true&fromPageId=64456202">EncodingControllers</a>][<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=JpegDecodingController&linkCreation=true&fromPageId=64456202">JpegDecodingController</a>].cs:line 636
at Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=FileFormats&linkCreation=true&fromPageId=64456202">FileFormats</a>.Jpeg.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=JpegPartialProcessor&linkCreation=true&fromPageId=64456202">JpegPartialProcessor</a>.Process(Rectangle areaToProcess) in C:\aspose.imaging.net\src\Core[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=FileFormats&linkCreation=true&fromPageId=64456202">FileFormats</a>]\Jpeg[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=JpegPartialProcessor&linkCreation=true&fromPageId=64456202">JpegPartialProcessor</a>].cs:line 218
at Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=FileFormats&linkCreation=true&fromPageId=64456202">FileFormats</a>.Jpeg.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=JpegDataReader&linkCreation=true&fromPageId=64456202">JpegDataReader</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=LoadRawData&linkCreation=true&fromPageId=64456202">LoadRawData</a>(Rectangle rectangle, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=RawDataSettings&linkCreation=true&fromPageId=64456202">RawDataSettings</a> rawDataSettings, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=IPartialRawDataLoader&linkCreation=true&fromPageId=64456202">IPartialRawDataLoader</a> rawDataLoader) in C:\aspose.imaging.net\src\Core[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=FileFormats&linkCreation=true&fromPageId=64456202">FileFormats</a>]\Jpeg[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=JpegDataReader&linkCreation=true&fromPageId=64456202">JpegDataReader</a>].cs:line 228
at Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PartialRawDataLoader&linkCreation=true&fromPageId=64456202">PartialRawDataLoader</a>.Process(Rectangle areaToProcess) in C:\aspose.imaging.net\src\Core[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PartialRawDataLoader&linkCreation=true&fromPageId=64456202">PartialRawDataLoader</a>].cs:line 59
at Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PartialProcessor&linkCreation=true&fromPageId=64456202">PartialProcessor</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=ProcessWithBasePartialProcessor&linkCreation=true&fromPageId=64456202">ProcessWithBasePartialProcessor</a>(<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=IPartialProcessor&linkCreation=true&fromPageId=64456202">IPartialProcessor</a> partialProcessor, IList`1 areas) in C:\aspose.imaging.net\src\Core[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PartialProcessor&linkCreation=true&fromPageId=64456202">PartialProcessor</a>].cs:line 556
at Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PartialProcessor&linkCreation=true&fromPageId=64456202">PartialProcessor</a>.Process(Rectangle areaToProcess, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=IPartialProcessor&linkCreation=true&fromPageId=64456202">IPartialProcessor</a> partialProcessor, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=ProcessingType&linkCreation=true&fromPageId=64456202">ProcessingType</a> processingType, Int32 fullWidth, Int32 fullHeight) in C:\aspose.imaging.net\src\Core[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PartialProcessor&linkCreation=true&fromPageId=64456202">PartialProcessor</a>].cs:line 189
at Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PartialProcessor&linkCreation=true&fromPageId=64456202">PartialProcessor</a>.Process(Rectangle areaToProcess, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=IPartialProcessor&linkCreation=true&fromPageId=64456202">IPartialProcessor</a> partialProcessor) in C:\aspose.imaging.net\src\Core[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PartialProcessor&linkCreation=true&fromPageId=64456202">PartialProcessor</a>].cs:line 52
at Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=InternalRasterImageLoader&linkCreation=true&fromPageId=64456202">InternalRasterImageLoader</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=LoadRawData&linkCreation=true&fromPageId=64456202">LoadRawData</a>(Rectangle rectangle, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=RawDataSettings&linkCreation=true&fromPageId=64456202">RawDataSettings</a> rawDataSettings, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=IPartialRawDataLoader&linkCreation=true&fromPageId=64456202">IPartialRawDataLoader</a> partialRawDataLoader) in C:\aspose.imaging.net\src\Core[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=InternalRasterImageLoader&linkCreation=true&fromPageId=64456202">InternalRasterImageLoader</a>].cs:line 141
at Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=RasterImage&linkCreation=true&fromPageId=64456202">RasterImage</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=LoadRawData&linkCreation=true&fromPageId=64456202">LoadRawData</a>(Rectangle rectangle, Rectangle destImageBounds, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=RawDataSettings&linkCreation=true&fromPageId=64456202">RawDataSettings</a> rawDataSettings, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=IPartialRawDataLoader&linkCreation=true&fromPageId=64456202">IPartialRawDataLoader</a> rawDataLoader) in C:\aspose.imaging.net\src\Core[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=RasterImage&linkCreation=true&fromPageId=64456202">RasterImage</a>].cs:line 919
at Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=FileFormats&linkCreation=true&fromPageId=64456202">FileFormats</a>.Png.Writers.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PngWriter&linkCreation=true&fromPageId=64456202">PngWriter</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=WritePixelData&linkCreation=true&fromPageId=64456202">WritePixelData</a>(<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PngStream&linkCreation=true&fromPageId=64456202">PngStream</a> pngStream, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=RasterImage&linkCreation=true&fromPageId=64456202">RasterImage</a> image, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PngFileSettings&linkCreation=true&fromPageId=64456202">PngFileSettings</a> fileSettings, Rectangle destImageBounds, Boolean cacheAllDataBeforeFiltering) in C:\aspose.imaging.net\src\Core[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=FileFormats&linkCreation=true&fromPageId=64456202">FileFormats</a>]\Png\Writers[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PngWriter&linkCreation=true&fromPageId=64456202">PngWriter</a>].cs:line 275
at Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=FileFormats&linkCreation=true&fromPageId=64456202">FileFormats</a>.Png.Writers.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PngWriter&linkCreation=true&fromPageId=64456202">PngWriter</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=SavePng&linkCreation=true&fromPageId=64456202">SavePng</a>(Stream stream, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=RasterImage&linkCreation=true&fromPageId=64456202">RasterImage</a> image, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PngOptions&linkCreation=true&fromPageId=64456202">PngOptions</a> pngOptions, Rectangle destImageBounds, Boolean cacheAllDataBeforeFiltering, String timeStamp) in C:\aspose.imaging.net\src\Core[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=FileFormats&linkCreation=true&fromPageId=64456202">FileFormats</a>]\Png\Writers[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PngWriter&linkCreation=true&fromPageId=64456202">PngWriter</a>].cs:line 181
at Aspose.Imaging.Exporters.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PngExporter&linkCreation=true&fromPageId=64456202">PngExporter</a>.Export(Image image, Stream stream, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=ImageOptionsBase&linkCreation=true&fromPageId=64456202">ImageOptionsBase</a> optionsBase, Rectangle boundsRectangle) in C:\aspose.imaging.net\src\Core\Exporters[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=PngExporter&linkCreation=true&fromPageId=64456202">PngExporter</a>].cs:line 76
at Aspose.Imaging.Image.Save(Stream stream, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=ImageOptionsBase&linkCreation=true&fromPageId=64456202">ImageOptionsBase</a> optionsBase, Rectangle boundsRectangle) in C:\aspose.imaging.net\src\Core\Image.cs:line 1029
— End of inner exception stack trace —
at Aspose.Imaging.Image.Save(Stream stream, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=ImageOptionsBase&linkCreation=true&fromPageId=64456202">ImageOptionsBase</a> optionsBase, Rectangle boundsRectangle) in C:\aspose.imaging.net\src\Core\Image.cs:line 1046
at Aspose.Imaging.Image.Save(String filePath, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=ImageOptionsBase&linkCreation=true&fromPageId=64456202">ImageOptionsBase</a> options, Rectangle boundsRectangle) in C:\aspose.imaging.net\src\Core\Image.cs:line 934
— End of inner exception stack trace —
at Aspose.Imaging.Image.Save(String filePath, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=ImageOptionsBase&linkCreation=true&fromPageId=64456202">ImageOptionsBase</a> options, Rectangle boundsRectangle) in C:\aspose.imaging.net\src\Core\Image.cs:line 945
at Aspose.Imaging.Image.Save(String filePath, <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=ImageOptionsBase&linkCreation=true&fromPageId=64456202">ImageOptionsBase</a> options) in C:\aspose.imaging.net\src\Core\Image.cs:line 911
at Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=BlackBoxTest&linkCreation=true&fromPageId=64456202">BlackBoxTest</a>.Multithreading.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=InterruptMonitorTest&linkCreation=true&fromPageId=64456202">InterruptMonitorTest</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=SaveImageWorker&linkCreation=true&fromPageId=64456202">SaveImageWorker</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=ThreadProc&linkCreation=true&fromPageId=64456202">ThreadProc</a>() in C:\aspose.imaging.net\test[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=BlackBoxTest&linkCreation=true&fromPageId=64456202">BlackBoxTest</a>]\Multithreading[<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=InterruptMonitorTest&linkCreation=true&fromPageId=64456202">InterruptMonitorTest</a>].cs:line 680
Finished Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=BlackBoxTest&linkCreation=true&fromPageId=64456202">BlackBoxTest</a>.Multithreading.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=InterruptMonitorTest&linkCreation=true&fromPageId=64456202">InterruptMonitorTest</a>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=InterruptJpegToPngConversion&linkCreation=true&fromPageId=64456202">InterruptJpegToPngConversion</a>
Aspose.Imaging.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=BlackBoxTest&linkCreation=true&fromPageId=64456202">BlackBoxTest</a>.Multithreading.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=InterruptMonitorTest&linkCreation=true&fromPageId=64456202">InterruptMonitorTest</a>.&linkCreation=true&fromPageId=10387586" class=&ldquo;createlink"linktype=&ldquo;raw&rdquo; wikidestination="&linkCreation=true&fromPageId=10387586&rdquo; class=&ldquo;createlink"linktype=&ldquo;raw&rdquo; wikidestination="<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=%2Fwiki%2Fpages%2Fcreatepage.action%3FspaceKey%3Dsupport%26title%3DInterruptJpegToPngConversion%3Ca+href%3D&linkCreation=true&fromPageId=64456202">False</a>&linkCreation=true&fromPageId=10387586&rdquo; class=&ldquo;createlink"linktype=&ldquo;raw&rdquo; wikidestination=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; originalalias=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; >InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; originalalias="<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=%2Fwiki%2Fpages%2Fcreatepage.action%3FspaceKey%3Dsupport%26title%3DInterruptJpegToPngConversion%3Ca+href%3D&linkCreation=true&fromPageId=64456202">False</a>&linkCreation=true&fromPageId=10387586" class=&ldquo;createlink"linktype=&ldquo;raw&rdquo; wikidestination=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; originalalias=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; >InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; ><a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=%2Fwiki%2Fpages%2Fcreatepage.action%3FspaceKey%3Dsupport%26title%3DInterruptJpegToPngConversion%3Ca+href%3D&linkCreation=true&fromPageId=64456202">False</a>&linkCreation=true&fromPageId=10387586" class=&ldquo;createlink"linktype=&ldquo;raw&rdquo; wikidestination=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; originalalias=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; >InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; originalalias="&linkCreation=true&fromPageId=10387586" class=&ldquo;createlink"linktype=&ldquo;raw&rdquo; wikidestination="<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=%2Fwiki%2Fpages%2Fcreatepage.action%3FspaceKey%3Dsupport%26title%3DInterruptJpegToPngConversion%3Ca+href%3D&linkCreation=true&fromPageId=64456202">False</a>&linkCreation=true&fromPageId=10387586&rdquo; class=&ldquo;createlink"linktype=&ldquo;raw&rdquo; wikidestination=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; originalalias=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; >InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; originalalias="<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=%2Fwiki%2Fpages%2Fcreatepage.action%3FspaceKey%3Dsupport%26title%3DInterruptJpegToPngConversion%3Ca+href%3D&linkCreation=true&fromPageId=64456202">False</a>&linkCreation=true&fromPageId=10387586" class=&ldquo;createlink"linktype=&ldquo;raw&rdquo; wikidestination=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; originalalias=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; >InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; ><a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=%2Fwiki%2Fpages%2Fcreatepage.action%3FspaceKey%3Dsupport%26title%3DInterruptJpegToPngConversion%3Ca+href%3D&linkCreation=true&fromPageId=64456202">False</a>&linkCreation=true&fromPageId=10387586" class=&ldquo;createlink"linktype=&ldquo;raw&rdquo; wikidestination=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; originalalias=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; >InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; >&linkCreation=true&fromPageId=10387586" class=&ldquo;createlink"linktype=&ldquo;raw&rdquo; wikidestination="<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=%2Fwiki%2Fpages%2Fcreatepage.action%3FspaceKey%3Dsupport%26title%3DInterruptJpegToPngConversion%3Ca+href%3D&linkCreation=true&fromPageId=64456202">False</a>&linkCreation=true&fromPageId=10387586&rdquo; class=&ldquo;createlink"linktype=&ldquo;raw&rdquo; wikidestination=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; originalalias=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; >InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; originalalias="<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=%2Fwiki%2Fpages%2Fcreatepage.action%3FspaceKey%3Dsupport%26title%3DInterruptJpegToPngConversion%3Ca+href%3D&linkCreation=true&fromPageId=64456202">False</a>&linkCreation=true&fromPageId=10387586" class=&ldquo;createlink"linktype=&ldquo;raw&rdquo; wikidestination=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; originalalias=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; >InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; ><a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=%2Fwiki%2Fpages%2Fcreatepage.action%3FspaceKey%3Dsupport%26title%3DInterruptJpegToPngConversion%3Ca+href%3D&linkCreation=true&fromPageId=64456202">False</a>&linkCreation=true&fromPageId=10387586" class=&ldquo;createlink"linktype=&ldquo;raw&rdquo; wikidestination=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; originalalias=&ldquo;InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a>&rdquo; >InterruptJpegToPngConversion<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=False&linkCreation=true&fromPageId=64456202">False</a> unit test finished. Measured: 39 virtualized methods.
4/19/2018 7:00:42 PM Success 686.163 Mbytes 3.211 Seconds</p><p><strong>IMAGINGNET-2893 BMP to PDF conversion</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string srcPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;balloon_ethalon.bmp&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outputFile <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;result.pdf&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>BmpImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>BmpImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>srcPath<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PdfOptions exportOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PdfOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>exportOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>PdfDocumentInfo</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Aspose<span style=color:#f92672>.</span><span style=color:#a6e22e>Imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>FileFormats</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Pdf</span><span style=color:#f92672>.</span><span style=color:#a6e22e>PdfDocumentInfo</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputFile<span style=color:#f92672>,</span> exportOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2681 Convert png and jpeg images to pdf</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string srcPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;result.jpg&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outputFile <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;result.pdf&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>JpegImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>JpegImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>srcPath<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PdfOptions exportOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PdfOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>exportOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>PdfDocumentInfo</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Aspose<span style=color:#f92672>.</span><span style=color:#a6e22e>Imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>FileFormats</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Pdf</span><span style=color:#f92672>.</span><span style=color:#a6e22e>PdfDocumentInfo</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputFile<span style=color:#f92672>,</span> exportOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string srcPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;multipage_specificColor_.djvu4_ethalon.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outputFile <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;result.pdf&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>PngImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PngImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>srcPath<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PdfOptions exportOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PdfOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>exportOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>PdfDocumentInfo</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Aspose<span style=color:#f92672>.</span><span style=color:#a6e22e>Imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>FileFormats</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Pdf</span><span style=color:#f92672>.</span><span style=color:#a6e22e>PdfDocumentInfo</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputFile<span style=color:#f92672>,</span> exportOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2368 Support EPS file format (only raster preview)</strong></p><p><strong>Typical usage</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> using <span style=color:#f92672>(</span>EpsImage epsImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;anyEpsFile.eps&#34;</span><span style=color:#f92672>)</span> as EpsImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// check if EPS image has any raster preview to proceed (for now only raster preview is supported)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>epsImage<span style=color:#f92672>.</span><span style=color:#a6e22e>HasRasterPreview</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>epsImage<span style=color:#f92672>.</span><span style=color:#a6e22e>PhotoshopThumbnail</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// process Photoshop thumbnail if it&#39;s present
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>epsImage<span style=color:#f92672>.</span><span style=color:#a6e22e>EpsType</span> <span style=color:#f92672>==</span> EpsType<span style=color:#f92672>.</span><span style=color:#a6e22e>Interchange</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Get EPS Interchange subformat instance
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>EpsInterchangeImage epsInterchangeImage <span style=color:#f92672>=</span> epsImage as EpsInterchangeImage<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>epsInterchangeImage<span style=color:#f92672>.</span><span style=color:#a6e22e>RasterPreview</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// process black-and-white Interchange raster preview if it&#39;s present
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Get EPS Binary subformat instance
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>EpsBinaryImage epsBinaryImage <span style=color:#f92672>=</span> epsImage as EpsBinaryImage<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>epsBinaryImage<span style=color:#f92672>.</span><span style=color:#a6e22e>TiffPreview</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// process TIFF preview if it&#39;s present
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>epsBinaryImage<span style=color:#f92672>.</span><span style=color:#a6e22e>WmfPreview</span><span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// process WMF preview if it&#39;s present
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// export EPS image to PNG (by default, best available quality preview is used for export)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>epsImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;anyEpsFile.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>Using load options for EPS Interchange image</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> using <span style=color:#f92672>(</span>EpsImage epsImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;EPSISuccess.eps&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> EpsLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> PreviewExportFormat <span style=color:#f92672>=</span> EpsPreviewFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>Default</span> <span style=color:#f92672>})</span> as EpsImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// by default, best available quality preview is used for export
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>epsImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;EPSISuccess_defaultLoadOption.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>EpsImage epsImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;EPSISuccess.eps&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> EpsLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> PreviewExportFormat <span style=color:#f92672>=</span> EpsPreviewFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>PhotoshopThumbnail</span> <span style=color:#f92672>})</span> as EpsImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// this Interchange image doesn&#39;t contain Photoshop thumbnail, so the default routine is used and raster black-and-white preview is exported
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>epsImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;EPSISuccess_photoshopLoadOption.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>EpsImage epsImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;EPSISuccess.eps&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> EpsLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> PreviewExportFormat <span style=color:#f92672>=</span> EpsPreviewFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>TIFF</span> <span style=color:#f92672>})</span> as EpsImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Interchange format doesn&#39;t support TIFF preview, so the default routine is used
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>epsImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;EPSISuccess_tiffLoadOption.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>EpsImage epsImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;EPSISuccess.eps&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> EpsLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> PreviewExportFormat <span style=color:#f92672>=</span> EpsPreviewFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>WMF</span> <span style=color:#f92672>})</span> as EpsImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Interchange format doesn&#39;t support WMF preview, so the default routine is used
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>epsImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;EPSISuccess_wmfLoadOption.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>Using load options for EPS Binary image with Photoshop thumbnail and 1-bit TIFF preview</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> using <span style=color:#f92672>(</span>EpsImage epsImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;jpgPhotoshop1bit.eps&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> EpsLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> PreviewExportFormat <span style=color:#f92672>=</span> EpsPreviewFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>Default</span> <span style=color:#f92672>})</span> as EpsImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// by default, best available quality preview is used for export - in this case, it&#39;s Photoshop thumbnail (which is 8-bit vs 1-bit TIFF)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>epsImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;jpgPhotoshop1bit_defaultLoadOption.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>EpsImage epsImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;jpgPhotoshop1bit.eps&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> EpsLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> PreviewExportFormat <span style=color:#f92672>=</span> EpsPreviewFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>PhotoshopThumbnail</span> <span style=color:#f92672>})</span> as EpsImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// this image contains Photoshop thumbnail, so it&#39;s used
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>epsImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;jpgPhotoshop1bit_photoshopLoadOption.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>EpsImage epsImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;jpgPhotoshop1bit.eps&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> EpsLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> PreviewExportFormat <span style=color:#f92672>=</span> EpsPreviewFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>TIFF</span> <span style=color:#f92672>})</span> as EpsImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// this image contains TIFF preview, so it&#39;s used
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>epsImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;jpgPhotoshop1bit_tiffLoadOption.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>EpsImage epsImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;jpgPhotoshop1bit.eps&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> EpsLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> PreviewExportFormat <span style=color:#f92672>=</span> EpsPreviewFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>WMF</span> <span style=color:#f92672>})</span> as EpsImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// this image doesn&#39;t contain WMF preview, so the default routine is used
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>epsImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;jpgPhotoshop1bit_wmfLoadOption.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>Using load options for EPS Binary image with Photoshop thumbnail and 8-bit TIFF preview</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> using <span style=color:#f92672>(</span>EpsImage epsImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;jpgPhotoshop8bit.eps&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> EpsLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> PreviewExportFormat <span style=color:#f92672>=</span> EpsPreviewFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>Default</span> <span style=color:#f92672>})</span> as EpsImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// by default, best available quality preview is used for export - in this case, it&#39;s TIFF preview (which is 8-bit as Photoshop thumbnail, but has higher resolution)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>epsImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;jpgPhotoshop8bit_defaultLoadOption.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>EpsImage epsImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;jpgPhotoshop8bit.eps&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> EpsLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> PreviewExportFormat <span style=color:#f92672>=</span> EpsPreviewFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>PhotoshopThumbnail</span> <span style=color:#f92672>})</span> as EpsImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// this image contains Photoshop thumbnail, so it&#39;s used
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>epsImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;jpgPhotoshop8bit_photoshopLoadOption.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>EpsImage epsImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;jpgPhotoshop8bit.eps&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> EpsLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> PreviewExportFormat <span style=color:#f92672>=</span> EpsPreviewFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>TIFF</span> <span style=color:#f92672>})</span> as EpsImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// this image contains TIFF preview, so it&#39;s used
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>epsImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;jpgPhotoshop8bit_tiffLoadOption.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>EpsImage epsImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;jpgPhotoshop8bit.eps&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> EpsLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> PreviewExportFormat <span style=color:#f92672>=</span> EpsPreviewFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>WMF</span> <span style=color:#f92672>})</span> as EpsImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// this image doesn&#39;t contain WMF preview, so the default routine is used
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>epsImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;jpgPhotoshop8bit_wmfLoadOption.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2302 Need investigate and support Layer Effects for PSD format</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string sourceFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;dropShadow.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string output <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;dropShadow.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PsdImage image <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Aspose<span style=color:#f92672>.</span><span style=color:#a6e22e>Imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Image</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sourceFileName<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>new</span> Aspose<span style=color:#f92672>.</span><span style=color:#a6e22e>Imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>ImageLoadOptions</span><span style=color:#f92672>.</span><span style=color:#a6e22e>PsdLoadOptions</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>LoadEffectsResource <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>UseDiskForLoadEffectsResource <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Debug<span style=color:#f92672>.</span><span style=color:#a6e22e>Assert</span><span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Layers</span><span style=color:#f92672>[</span>2<span style=color:#f92672>]</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Layer with effects resource was not recognized&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>output<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> Aspose<span style=color:#f92672>.</span><span style=color:#a6e22e>Imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>ImageOptions</span><span style=color:#f92672>.</span><span style=color:#a6e22e>PngOptions</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ColorType <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Aspose<span style=color:#f92672>.</span><span style=color:#a6e22e>Imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>FileFormats</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Png</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>.</span><span style=color:#a6e22e>PngColorType</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2927 Black text is not visible on transparent background when saving PSD into PDF</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string sourceFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;text.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>Aspose<span style=color:#f92672>.</span><span style=color:#a6e22e>Imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Image</span> image <span style=color:#f92672>=</span> Aspose<span style=color:#f92672>.</span><span style=color:#a6e22e>Imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Image</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>sourceFileName<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PsdLoadOptions<span style=color:#f92672>(){</span>ReadOnlyMode <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>}))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PsdImage psdImage <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>Aspose<span style=color:#f92672>.</span><span style=color:#a6e22e>Imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>FileFormats</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Psd</span><span style=color:#f92672>.</span><span style=color:#a6e22e>PsdImage</span><span style=color:#f92672>)</span>image<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PdfOptions exportOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PdfOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>exportOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>PdfDocumentInfo</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Aspose<span style=color:#f92672>.</span><span style=color:#a6e22e>Imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>FileFormats</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Pdf</span><span style=color:#f92672>.</span><span style=color:#a6e22e>PdfDocumentInfo</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;result.pdf&#34;</span><span style=color:#f92672>,</span> exportOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2925 Fix 24bpp options setting for export to BMP</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> using <span style=color:#f92672>(</span>Image img <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;test.jpg&#34;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>img<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;test.bmp&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> BmpOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> BitsPerPixel <span style=color:#f92672>=</span> img<span style=color:#f92672>.</span><span style=color:#a6e22e>BitsPerPixel</span> <span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2896 Evaluation watermark is missing when saving as SVG</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> License lic <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> License<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>lic<span style=color:#f92672>.</span><span style=color:#a6e22e>SetLicense</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string sourceFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;input.svg&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>sourceFileName<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>VentureLicenser<span style=color:#f92672>.</span><span style=color:#a6e22e>SetVentureLicensed</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>false</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;Evaluation only&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>12f<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>241<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>46<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SvgOptions svgOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SvgOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SvgRasterizationOptions svgRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SvgRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>svgOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>VectorRasterizationOptions</span> <span style=color:#f92672>=</span> svgRasterizationOptions<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>svgOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>VectorRasterizationOptions</span><span style=color:#f92672>.</span><span style=color:#a6e22e>PageWidth</span> <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Width</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>svgOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>VectorRasterizationOptions</span><span style=color:#f92672>.</span><span style=color:#a6e22e>PageHeight</span> <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Height</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>svgOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>Callback</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SvgResourceKeeperCallback<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;result.svg&#34;</span><span style=color:#f92672>,</span> svgOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2895 Venture Licenser not works for ODG files</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;input.odg&#34;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>VentureLicenser<span style=color:#f92672>.</span><span style=color:#a6e22e>SetVentureLicensed</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>false</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;Evaluation only&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>12f<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>241<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>46<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>var rasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> MetafileRasterizationOptions
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PageSize <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Size</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;output.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions <span style=color:#f92672>{</span> VectorRasterizationOptions <span style=color:#f92672>=</span> rasterizationOptions <span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;output.pdf&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PdfOptions <span style=color:#f92672>{</span> VectorRasterizationOptions <span style=color:#f92672>=</span> rasterizationOptions <span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2886 SVG to raster has missing image parts [.Net]</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string baseFolder <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;D:\Svg&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string fileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;svg_with_preserve_aspect_ratio.svg&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string inputFile <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>baseFolder<span style=color:#f92672>,</span> fileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outputFile <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>baseFolder<span style=color:#f92672>,</span> fileName<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;.png&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>inputFile<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SvgRasterizationOptions svgRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SvgRasterizationOptions<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>BackgroundColor <span style=color:#f92672>=</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>White</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PageWidth <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Width</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PageHeight <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Height</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ScaleX <span style=color:#f92672>=</span> 4<span style=color:#f92672>,</span> <span style=color:#75715e>//scaling for improve quality
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>ScaleY <span style=color:#f92672>=</span> 4
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputFile<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> VectorRasterizationOptions <span style=color:#f92672>=</span> svgRasterizationOptions <span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2872 Expose Codec property of JPEG2000 image to public</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> using <span style=color:#f92672>(</span>Jpeg2000Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;multi.jpx&#34;</span><span style=color:#f92672>)</span> as Jpeg2000Image<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Debug<span style=color:#f92672>.</span><span style=color:#a6e22e>Assert</span><span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Codec</span> <span style=color:#f92672>==</span> Jpeg2000Codec<span style=color:#f92672>.</span><span style=color:#a6e22e>Jp2</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2869 Fix saving of multiple WEBP frames</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> using <span style=color:#f92672>(</span>WebPImage image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Animation1.webp&#34;</span><span style=color:#f92672>)</span> as WebPImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>WebPOptions options <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> WebPOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span><span style=color:#a6e22e>Lossless</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span><span style=color:#a6e22e>Quality</span> <span style=color:#f92672>=</span> 90f<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span><span style=color:#a6e22e>AnimLoopCount</span> <span style=color:#f92672>=</span> 5<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span><span style=color:#a6e22e>AnimBackgroundColor</span> <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>uint<span style=color:#f92672>)</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>Gray</span><span style=color:#f92672>.</span><span style=color:#a6e22e>ToArgb</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;savedOptions.webp&#34;</span><span style=color:#f92672>,</span> options<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>WebPImage savedOptions <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;savedOptions.webp&#34;</span><span style=color:#f92672>)</span> as WebPImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Debug<span style=color:#f92672>.</span><span style=color:#a6e22e>Assert</span><span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Blocks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span> <span style=color:#f92672>==</span> savedOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>Blocks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;reSaved.webp&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>WebPImage reSaved <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;reSaved.webp&#34;</span><span style=color:#f92672>)</span> as WebPImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Debug<span style=color:#f92672>.</span><span style=color:#a6e22e>Assert</span><span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Blocks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span> <span style=color:#f92672>==</span> reSaved<span style=color:#f92672>.</span><span style=color:#a6e22e>Blocks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>WebPImage createdImage <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> WebPImage<span style=color:#f92672>(</span>image<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Debug<span style=color:#f92672>.</span><span style=color:#a6e22e>Assert</span><span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Blocks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span> <span style=color:#f92672>==</span> createdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Blocks</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2867 Fix duplication of resolution settings for BMP (check other formats as well)</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> using <span style=color:#f92672>(</span>Image metaImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;TestEmfMetaRgn.emf&#34;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>EmfRasterizationOptions rasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> EmfRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>BackgroundColor</span> <span style=color:#f92672>=</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>Yellow</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>PageWidth</span> <span style=color:#f92672>=</span> 400<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>PageHeight</span> <span style=color:#f92672>=</span> 400<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>BorderX</span> <span style=color:#f92672>=</span> 5<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>BorderY</span> <span style=color:#f92672>=</span> 10<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>metaImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;duplicatedApi.bmp&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> BmpOptions<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Depending on your settings, IDE can refuse to compile the following code due to obsolete API usage
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// and show message to use proper shared API - that&#39;s expected behavior
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>HorizontalResolution <span style=color:#f92672>=</span> 200<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>VerticalResolution <span style=color:#f92672>=</span> 200<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>VectorRasterizationOptions <span style=color:#f92672>=</span> rasterizationOptions
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>metaImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;sharedApi.bmp&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> BmpOptions<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ResolutionSettings <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ResolutionSetting<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HorizontalResolution <span style=color:#f92672>=</span> 200<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>VerticalResolution <span style=color:#f92672>=</span> 200
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>},</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>VectorRasterizationOptions <span style=color:#f92672>=</span> rasterizationOptions
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>BmpImage obsoleteApiImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;duplicatedApi.bmp&#34;</span><span style=color:#f92672>)</span> as BmpImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>BmpImage sharedApiImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;sharedApi.bmp&#34;</span><span style=color:#f92672>)</span> as BmpImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Debug<span style=color:#f92672>.</span><span style=color:#a6e22e>Assert</span><span style=color:#f92672>(</span>Convert<span style=color:#f92672>.</span><span style=color:#a6e22e>ToInt32</span><span style=color:#f92672>(</span>obsoleteApiImage<span style=color:#f92672>.</span><span style=color:#a6e22e>HorizontalResolution</span><span style=color:#f92672>)</span> <span style=color:#f92672>==</span> 200<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Debug<span style=color:#f92672>.</span><span style=color:#a6e22e>Assert</span><span style=color:#f92672>(</span>Convert<span style=color:#f92672>.</span><span style=color:#a6e22e>ToInt32</span><span style=color:#f92672>(</span>obsoleteApiImage<span style=color:#f92672>.</span><span style=color:#a6e22e>VerticalResolution</span><span style=color:#f92672>)</span> <span style=color:#f92672>==</span> 200<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Debug<span style=color:#f92672>.</span><span style=color:#a6e22e>Assert</span><span style=color:#f92672>(</span>Convert<span style=color:#f92672>.</span><span style=color:#a6e22e>ToInt32</span><span style=color:#f92672>(</span>obsoleteApiImage<span style=color:#f92672>.</span><span style=color:#a6e22e>HorizontalResolution</span><span style=color:#f92672>)</span> <span style=color:#f92672>==</span> Convert<span style=color:#f92672>.</span><span style=color:#a6e22e>ToInt32</span><span style=color:#f92672>(</span>sharedApiImage<span style=color:#f92672>.</span><span style=color:#a6e22e>HorizontalResolution</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Debug<span style=color:#f92672>.</span><span style=color:#a6e22e>Assert</span><span style=color:#f92672>(</span>Convert<span style=color:#f92672>.</span><span style=color:#a6e22e>ToInt32</span><span style=color:#f92672>(</span>obsoleteApiImage<span style=color:#f92672>.</span><span style=color:#a6e22e>VerticalResolution</span><span style=color:#f92672>)</span> <span style=color:#f92672>==</span> Convert<span style=color:#f92672>.</span><span style=color:#a6e22e>ToInt32</span><span style=color:#f92672>(</span>sharedApiImage<span style=color:#f92672>.</span><span style=color:#a6e22e>VerticalResolution</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2850 Exception on updating text layers</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;image7.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>PsdImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>PsdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>file<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>foreach <span style=color:#f92672>(</span>var layer in image<span style=color:#f92672>.</span><span style=color:#a6e22e>Layers</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>layer is TextLayer<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TextLayer textLayer <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>TextLayer<span style=color:#f92672>)</span>layer<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>String<span style=color:#f92672>.</span><span style=color:#a6e22e>IsNullOrEmpty</span><span style=color:#f92672>(</span>textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>Text</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>UpdateText</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;any string&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;1.psd&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PsdOptions <span style=color:#f92672>{</span> CompressionMethod <span style=color:#f92672>=</span> CompressionMethod<span style=color:#f92672>.</span><span style=color:#a6e22e>RLE</span> <span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2806 Fix watermark on export metafile (EMF, WMF) to SVG</strong>
tiger.emf.false.svg - exported a emf file without license, must have watermark
tiger.emf.True.svg - exported a emf file with license, should not contain watermark
castle.wmf.false.svg - exported a wmf file without license, must have watermark
castle.wmf.false.svg - exported a wmf file with license, should not contain watermark</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string<span style=color:#f92672>[]</span> fileNames <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> string<span style=color:#f92672>[</span>2<span style=color:#f92672>]</span> <span style=color:#f92672>{</span> <span style=color:#e6db74>&#34;castle.wmf&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;tiger.emf&#34;</span> <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string licenseFile <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Aspose.Imaging.lic&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>License licenseObj <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> License<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>bool<span style=color:#f92672>[]</span> license <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> bool<span style=color:#f92672>[]</span> <span style=color:#f92672>{</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>false</span> <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string baseFolder <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;D:\svg\&#34;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>try
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>foreach (bool lic in license)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>if (lic)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>licenseObj.SetLicense(Path.Combine(baseFolder, licenseFile));
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>else
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>licenseObj.SetLicense(&#34;&#34;);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>foreach (string fileName in fileNames)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>string inputFile = Path.Combine(baseFolder, fileName);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>string outputFile = Path.Combine(baseFolder, fileName + &#34;</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#34; + lic + &#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>svg</span><span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>inputFile<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>EmfRasterizationOptions wmfRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> EmfRasterizationOptions<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>BackgroundColor <span style=color:#f92672>=</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>White</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PageWidth <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Width</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PageHeight <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Height</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputFile<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> SvgOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> VectorRasterizationOptions <span style=color:#f92672>=</span> wmfRasterizationOptions <span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>licenseObj<span style=color:#f92672>.</span><span style=color:#a6e22e>SetLinense</span><span style=color:#f92672>(</span>Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>baseFolder<span style=color:#f92672>,</span> licenseFile<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2635 Coordinate of left top corner is incorrect at update [.Net]</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string sourceFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;logodpwit_006.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outFileNamePngClient <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;logodpwit_006_client.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outFileNamePngTopLeftPart <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;logodpwit_006_topLeftPart.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outFileNamePngTopLeftFull <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;logodpwit_006_topLeftFull.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outFileNamePngBottomRightPart <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;logodpwit_006_bottomRightPart.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outFileNamePngBottomRightFull <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;logodpwit_006_bottomRightFull.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PsdLoadOptions loadOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PsdLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> IgnoreTextLayerWidthOnUpdate <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span> <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PngOptions pngOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> ColorType <span style=color:#f92672>=</span> PngColorType<span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span> <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PsdImage image<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TextLayer textLayer<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>sourceFileName<span style=color:#f92672>,</span> loadOptions<span style=color:#f92672>)</span> as PsdImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>foreach <span style=color:#f92672>(</span>Layer layer in image<span style=color:#f92672>.</span><span style=color:#a6e22e>Layers</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>textLayer <span style=color:#f92672>=</span> layer as TextLayer<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>textLayer <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>Name</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Layer I&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// client&#39;s case
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>UpdateText</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;test&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outFileNamePngClient<span style=color:#f92672>,</span> pngOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>sourceFileName<span style=color:#f92672>,</span> loadOptions<span style=color:#f92672>)</span> as PsdImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>foreach <span style=color:#f92672>(</span>Layer layer in image<span style=color:#f92672>.</span><span style=color:#a6e22e>Layers</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>textLayer <span style=color:#f92672>=</span> layer as TextLayer<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>textLayer <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>Name</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Layer I&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// partially visible on top left
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>UpdateText</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;test&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> Point<span style=color:#f92672>(-</span>100<span style=color:#f92672>,</span> <span style=color:#f92672>-</span>100<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outFileNamePngTopLeftPart<span style=color:#f92672>,</span> pngOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>sourceFileName<span style=color:#f92672>,</span> loadOptions<span style=color:#f92672>)</span> as PsdImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>foreach <span style=color:#f92672>(</span>Layer layer in image<span style=color:#f92672>.</span><span style=color:#a6e22e>Layers</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>textLayer <span style=color:#f92672>=</span> layer as TextLayer<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>textLayer <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>Name</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Layer I&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// out of bounds on top left
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>UpdateText</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;test&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> Point<span style=color:#f92672>(-</span>5<span style=color:#f92672>,</span> <span style=color:#f92672>-</span>300<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outFileNamePngTopLeftFull<span style=color:#f92672>,</span> pngOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>sourceFileName<span style=color:#f92672>,</span> loadOptions<span style=color:#f92672>)</span> as PsdImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>foreach <span style=color:#f92672>(</span>Layer layer in image<span style=color:#f92672>.</span><span style=color:#a6e22e>Layers</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>textLayer <span style=color:#f92672>=</span> layer as TextLayer<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>textLayer <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>Name</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Layer I&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// partially visible on bottom right
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>UpdateText</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;test&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> Point<span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Bounds</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Right</span> <span style=color:#f92672>-</span> 200<span style=color:#f92672>,</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Bounds</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Bottom</span> <span style=color:#f92672>-</span> 200<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outFileNamePngBottomRightPart<span style=color:#f92672>,</span> pngOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>sourceFileName<span style=color:#f92672>,</span> loadOptions<span style=color:#f92672>)</span> as PsdImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>foreach <span style=color:#f92672>(</span>Layer layer in image<span style=color:#f92672>.</span><span style=color:#a6e22e>Layers</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>textLayer <span style=color:#f92672>=</span> layer as TextLayer<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>textLayer <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>Name</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Layer I&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// out of bounds on bottom right
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>UpdateText</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;test&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> Point<span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Bounds</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Right</span> <span style=color:#f92672>+</span> 50<span style=color:#f92672>,</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Bounds</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Bottom</span> <span style=color:#f92672>+</span> 50<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outFileNamePngBottomRightFull<span style=color:#f92672>,</span> pngOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2184 Saving of PSD image produces invalid image colors</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string inputFile <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;in.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outputFile <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;out.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>PsdImage img <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>inputFile<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PsdLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> ReadOnlyMode <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span> <span style=color:#f92672>}))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>img<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputFile<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-1962 TIFF Codec can&rsquo;t save 16-bit channel image</strong>
Please use the following code to convert PNG with alpha channel to 16-bit TIFF:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string dir <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;c:\aspose.work\IMAGINGNET\1962\&#34;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>// Use PNG image with alpha as a source image.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>string inputFilePath = dir + &#34;</span>Alpha<span style=color:#f92672>.</span><span style=color:#a6e22e>png</span><span style=color:#e6db74>&#34;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffCompressions[] compressions = new TiffCompressions[]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffCompressions.Lzw,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffCompressions.Deflate,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>};
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffByteOrder[] byteOrders = new TiffByteOrder[]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffByteOrder.BigEndian,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffByteOrder.LittleEndian,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>};
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffPhotometrics[] photometrics = new TiffPhotometrics[]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffPhotometrics.MinIsBlack,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffPhotometrics.MinIsWhite,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffPhotometrics.Rgb,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>};
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffPlanarConfigs[] planarConfigs = new TiffPlanarConfigs[]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffPlanarConfigs.Contiguous,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffPlanarConfigs.Separate,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>};
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>for (int compr = 0; compr &lt; compressions.Length; ++compr)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffCompressions compression = compressions[compr];
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>for (int bo = 0; bo &lt; byteOrders.Length; ++bo)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffByteOrder byteOrder = byteOrders[bo];
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>for (int ph = 0; ph &lt; photometrics.Length; ++ph)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffPhotometrics photometric = photometrics[ph];
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>for (int pcfg = 0; pcfg &lt; planarConfigs.Length; ++pcfg)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffPlanarConfigs planarConfig = planarConfigs[pcfg];
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>TiffOptions options = new TiffOptions(TiffExpectedFormat.Default, byteOrder);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>options.Compression = compression;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>options.Photometric = photometric;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>options.PlanarConfiguration = planarConfig;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>switch (photometric)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>case TiffPhotometrics.MinIsBlack:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>case TiffPhotometrics.MinIsWhite:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>// No extra samples are used, so alpha is supposed to be unspecified.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>options.BitsPerSample = new ushort[] { 16 }; // Grayscale
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>break;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>case TiffPhotometrics.Rgb:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>case TiffPhotometrics.Ycbcr:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>// No extra samples are used, so alpha is supposed to be unspecified.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>options.BitsPerSample = new ushort[] { 16, 16, 16 };
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>break;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>case TiffPhotometrics.Separated:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>// No extra samples are used, so alpha is supposed to be unspecified.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>options.BitsPerSample = new ushort[] { 16, 16, 16, 16 }; // CMYK
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>break;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>default:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>throw new NotSupportedException(&#34;</span>The <span style=color:#e6db74>&#34; + photometric + &#34;</span> photometric is not supported at the moment<span style=color:#f92672>.</span><span style=color:#e6db74>&#34;);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>string outputFilePath = dir + &#34;</span>16bit <span style=color:#e6db74>&#34; + compression + &#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34; + byteOrder + &#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34; + photometric + &#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34; + planarConfig + &#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>tif</span><span style=color:#e6db74>&#34;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>string etalonFilePath = dir + &#34;</span>16bit <span style=color:#e6db74>&#34; + compression + &#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34; + byteOrder + &#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34; + photometric + &#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34; + planarConfig + &#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>tif</span><span style=color:#e6db74>&#34;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>// Horizontal differencing prediction is recommended to use with LZW compression because LZW is probably
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>// the only TIFF encoding scheme that benefits significantly from a predictor step.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>if (compression == TiffCompressions.Lzw)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>options.Predictor = TiffPredictor.Horizontal;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>using (Image image = Image.Load(inputFilePath))
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>image.Save(outputFilePath, options);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>if (photometric == TiffPhotometrics.Rgb)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>options.BitsPerSample = new ushort[] { 16, 16, 16, 16 };
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>options.AlphaStorage = TiffAlphaStorage.Associated;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>outputFilePath = dir + &#34;</span>16bit <span style=color:#e6db74>&#34; + compression + &#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34; + byteOrder + &#34;</span><span style=color:#f92672>,</span> Rgba<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34; + planarConfig + &#34;</span><span style=color:#f92672>,</span> Associated<span style=color:#f92672>.</span><span style=color:#a6e22e>tif</span><span style=color:#e6db74>&#34;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>etalonFilePath = dir + &#34;</span>16bit <span style=color:#e6db74>&#34; + compression + &#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34; + byteOrder + &#34;</span><span style=color:#f92672>,</span> Rgba<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34; + planarConfig + &#34;</span><span style=color:#f92672>,</span> Associated<span style=color:#f92672>.</span><span style=color:#a6e22e>tif</span><span style=color:#e6db74>&#34;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>image.Save(outputFilePath, options);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>options.AlphaStorage = TiffAlphaStorage.Unassociated;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>outputFilePath = dir + &#34;</span>16bit <span style=color:#e6db74>&#34; + compression + &#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34; + byteOrder + &#34;</span><span style=color:#f92672>,</span> Rgba<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34; + planarConfig + &#34;</span><span style=color:#f92672>,</span> Unassociated<span style=color:#f92672>.</span><span style=color:#a6e22e>tif</span><span style=color:#e6db74>&#34;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>etalonFilePath = dir + &#34;</span>16bit <span style=color:#e6db74>&#34; + compression + &#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34; + byteOrder + &#34;</span><span style=color:#f92672>,</span> Rgba<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34; + planarConfig + &#34;</span><span style=color:#f92672>,</span> Unassociated<span style=color:#f92672>.</span><span style=color:#a6e22e>tif</span><span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputFilePath<span style=color:#f92672>,</span> options<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p></div></div></div></div><hr></div></div></section></div></div></section></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>