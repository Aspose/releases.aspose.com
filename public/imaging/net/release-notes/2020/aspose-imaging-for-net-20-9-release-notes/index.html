<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.Imaging for .NET 20.9 - Release notes</title><meta name=description content="Aspose.Imaging for .NET 20.9 - Release notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/imaging/net/release-notes/2020/aspose-imaging-for-net-20-9-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/imaging/net/release-notes/2020/aspose-imaging-for-net-20-9-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.Imaging for .NET 20.9 - Release notes "><meta property="og:description" content="Aspose.Imaging for .NET 20.9 - Release notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/imaging/net/release-notes/2020/aspose-imaging-for-net-20-9-release-notes/"><meta itemprop=name content="Aspose.Imaging for .NET 20.9 - Release notes"><meta itemprop=description content="Aspose.Imaging for .NET 20.9 - Release notes – the latest updates and fixes."><meta itemprop=wordCount content="2298"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.Imaging for .NET 20.9 - Release notes"><meta name=twitter:description content="Aspose.Imaging for .NET 20.9 - Release notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css preload><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/imaging/>Aspose.Imaging Product Family</a><span class=divider></span></li><li><a href=/imaging/net/>Aspose.Imaging for .NET</a><span class=divider></span></li><li><a href=/imaging/net/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/imaging/net/release-notes/2020/>2020</a><span class=divider></span></li><li><a href=/imaging/net/release-notes/2020/aspose-imaging-for-net-20-9-release-notes/>Aspose.Imaging for .NET 20.9 - Release notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><section role=main class="container main-container page-package-details"><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section package-details-main"><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.Imaging for .NET 20.9 - Release notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><table><thead><tr><th><strong>Key</strong></th><th><strong>Summary</strong></th><th><strong>Category</strong></th></tr></thead><tbody><tr><td>IMAGINGNET-4018</td><td>Support Jpeg, Jpeg2000 and RLE compression method in Dicom exporter</td><td>Feature</td></tr><tr><td>IMAGINGNET-3615</td><td>Converting PNG to TGA format</td><td>Feature</td></tr><tr><td>IMAGINGNET-4071</td><td>Implement support for Exif chunk in WebP format</td><td>Enhancement</td></tr><tr><td>IMAGINGNET-4067</td><td>Alpha channel is not taken into account when exporting PSD image</td><td>Enhancement</td></tr><tr><td>IMAGINGNET-4066</td><td>PsdOptions.XmpData property is not used in the PsdExporter</td><td>Enhancement</td></tr><tr><td>IMAGINGNET-4064</td><td>Export to EMF gives the image at the wrong scale</td><td>Enhancement</td></tr><tr><td>IMAGINGNET-4063</td><td>Export to WMF gives the image at the wrong scale</td><td>Enhancement</td></tr><tr><td>IMAGINGNET-4062</td><td>Support exporting XMP metadata from TiffOptions in the TIFF exporter</td><td>Enhancement</td></tr><tr><td>IMAGINGNET-4026</td><td>Index was outside the bounds of the array exception when loading JPF</td><td>Enhancement</td></tr><tr><td>IMAGINGNET-4003</td><td>Add CompressionLevel to the PngOptions while SaveData</td><td>Enhancement</td></tr><tr><td>IMAGINGNET-3992</td><td>Incorrect results of exporting a raster image to metafiles</td><td>Enhancement</td></tr><tr><td>IMAGINGNET-3990</td><td>NullReferenceException occurs when exporting images of several vector types</td><td>Enhancement</td></tr><tr><td>IMAGINGNET-3985</td><td>Implement additional resize methods as per Aspose.Psd resize</td><td>Enhancement</td></tr><tr><td>IMAGINGNET-3958</td><td>Image saving failed exception when saving TIFF</td><td>Enhancement</td></tr><tr><td>IMAGINGNET-3954</td><td>Image saving failed exception when saving SVG</td><td>Enhancement</td></tr><tr><td>IMAGINGNET-3938</td><td>Support of export and import to TGA fileformat</td><td>Enhancement</td></tr></tbody></table><h2 id=public-api-changes><strong>Public API changes:</strong></h2><p><strong>Added APIs:</strong></p><p>Class Aspose.Imaging.FileFormats.Dicom.ColorType</p><p>Class Aspose.Imaging.FileFormats.Dicom.Compression</p><p>Class Aspose.Imaging.FileFormats.Dicom.CompressionType</p><p>Class Aspose.Imaging.FileFormats.Tga.TgaImage</p><p>Class Aspose.Imaging.ImageOptions.TgaOptions</p><p>Field/Enum Aspose.Imaging.FileFormat.Tga</p><p>Field/Enum Aspose.Imaging.FileFormats.Dicom.ColorType.Grayscale16Bit</p><p>Field/Enum Aspose.Imaging.FileFormats.Dicom.ColorType.Grayscale8Bit</p><p>Field/Enum Aspose.Imaging.FileFormats.Dicom.ColorType.Rgb24Bit</p><p>Field/Enum Aspose.Imaging.FileFormats.Dicom.CompressionType.Jpeg</p><p>Field/Enum Aspose.Imaging.FileFormats.Dicom.CompressionType.Jpeg2000</p><p>Field/Enum Aspose.Imaging.FileFormats.Dicom.CompressionType.None</p><p>Field/Enum Aspose.Imaging.FileFormats.Dicom.CompressionType.Rle</p><p>Field/Enum Aspose.Imaging.ImageOptions.PngOptions.DefaultCompressionLevel</p><p>Method Aspose.Imaging.FileFormats.Dicom.Compression.#ctor</p><p>Method Aspose.Imaging.FileFormats.Emf.Emf.Records.EmfSetMapMode.#ctor</p><p>Method Aspose.Imaging.FileFormats.Emf.EmfImage.#ctor(System.Int32,System.Int32)</p><p>Method Aspose.Imaging.FileFormats.Tga.TgaImage.#ctor(Aspose.Imaging.RasterImage)</p><p>Method Aspose.Imaging.FileFormats.Tga.TgaImage.#ctor(System.IO.Stream)</p><p>Method Aspose.Imaging.FileFormats.Tga.TgaImage.#ctor(System.String)</p><p>Method Aspose.Imaging.FileFormats.Tga.TgaImage.Clone</p><p>Method Aspose.Imaging.FileFormats.Tga.TgaImage.Clone(Aspose.Imaging.FileFormats.Tga.TgaImage)</p><p>Method Aspose.Imaging.FileFormats.Tga.TgaImage.Equals(Aspose.Imaging.FileFormats.Tga.TgaImage)</p><p>Method Aspose.Imaging.FileFormats.Tga.TgaImage.Equals(System.Object)</p><p>Method Aspose.Imaging.FileFormats.Tga.TgaImage.GetHashCode</p><p>Method Aspose.Imaging.FileFormats.Tga.TgaImage.op_Equality(Aspose.Imaging.FileFormats.Tga.TgaImage,Aspose.Imaging.FileFormats.Tga.TgaImage)</p><p>Method Aspose.Imaging.FileFormats.Tga.TgaImage.op_Inequality(Aspose.Imaging.FileFormats.Tga.TgaImage,Aspose.Imaging.FileFormats.Tga.TgaImage)</p><p>Method Aspose.Imaging.FileFormats.Tga.TgaImage.RotateFlip(Aspose.Imaging.RotateFlipType)</p><p>Method Aspose.Imaging.FileFormats.Tga.TgaImage.SaveData(System.IO.Stream)</p><p>Method Aspose.Imaging.FileFormats.Tga.TgaImage.UpdateDimensions(System.Int32,System.Int32)</p><p>Method Aspose.Imaging.ImageOptions.TgaOptions.#ctor</p><p>Method Aspose.Imaging.ImageOptions.TgaOptions.#ctor(Aspose.Imaging.ImageOptions.TgaOptions)</p><p>Property Aspose.Imaging.FileFormats.Dicom.Compression.Jpeg</p><p>Property Aspose.Imaging.FileFormats.Dicom.Compression.Jpeg2000</p><p>Property Aspose.Imaging.FileFormats.Dicom.Compression.Type</p><p>Property Aspose.Imaging.FileFormats.Gif.Blocks.GifFrameBlock.IsInterlaced</p><p>Property Aspose.Imaging.FileFormats.Gif.GifImage.IsInterlaced</p><p>Property Aspose.Imaging.FileFormats.Png.PngImage.IsInterlaced</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.AuthorComments</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.AuthorName</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.BackgroundColor</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.BitsPerPixel</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.BytesPerPixel</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.DateTimeStamp</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.GammaValueDenominator</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.GammaValueNumerator</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.HasAlpha</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.HasBackgroundColor</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.HasColorMap</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.HasTransparentColor</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.Height</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.ImageId</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.IsGrayScale</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.JobNameOrId</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.JobTime</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.PixelAspectRatioDenominator</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.PixelAspectRatioNumerator</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.SoftwareId</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.SoftwareVersion</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.SoftwareVersionLetter</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.SoftwareVersionNumber</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.TransparentColor</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.Width</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.XOrigin</p><p>Property Aspose.Imaging.FileFormats.Tga.TgaImage.YOrigin</p><p>Property Aspose.Imaging.ImageOptions.DicomOptions.ColorType</p><p>Property Aspose.Imaging.ImageOptions.DicomOptions.Compression</p><p>Property Aspose.Imaging.ImageOptions.TiffOptions.CompressedQuality</p><p><strong>Removed APIs:</strong></p><h2 id=usage-examples><strong>Usage Examples:</strong></h2><p><strong>IMAGINGNET-4071 Implement support for Exif chunk in WebP format</strong></p><pre tabindex=0><code>You can work with WebP image which has Exif chunk inside.

using (Image image = Image.Load(&#34;STK-20200807-WA0011.webp&#34;))
{
    image.Save(&#34;Export.png&#34;, new PngOptions());
}
</code></pre><p><strong>IMAGINGNET-4067 Alpha channel is not taken into account when exporting PSD image</strong></p><pre tabindex=0><code>using (Image image = Image.Load(&#34;Progressive.png&#34;))
{
    image.Save(&#34;Progressive.png.psd&#34;, new PsdOptions()
                                   {
                                       CompressionMethod = CompressionMethod.RLE,
                                       ColorMode = ColorModes.Rgb,
                                       ChannelBitsCount = 8,
                                       ChannelsCount = 4
                                   });
}
</code></pre><p><strong>IMAGINGNET-4066 PsdOptions.XmpData property is not used in the PsdExporter</strong></p><pre tabindex=0><code>This sample shows how to add XMP data during the export:

static void Main(string[] args)
{
    using (var image = Image.Load(&#34;34171.jpeg&#34;))
    {
        var options = new PsdOptions
        {
            XmpData = CreateXmpData()
        };
        image.Save(&#34;Export1.psd&#34;, options);

        var jpegOptions = new JpegOptions
        {
            XmpData = CreateXmpData()
        };
        image.Save(&#34;Export2.jpeg&#34;, jpegOptions);
    }
}

private static XmpPacketWrapper CreateXmpData()
{
    XmpHeaderPi xmpHeader = new XmpHeaderPi(Guid.NewGuid().ToString());

    // Create an instance of Xmp-TrailerPi, XMPmeta class to set different attributes
    XmpTrailerPi xmpTrailer = new XmpTrailerPi(true);
    XmpMeta xmpMeta = new XmpMeta();
    xmpMeta.AddAttribute(&#34;Author&#34;, &#34;Mr Smith&#34;);
    xmpMeta.AddAttribute(&#34;Description&#34;, &#34;The fake metadata value&#34;);

    // Create an instance of XmpPacketWrapper that contains all metadata
    XmpPacketWrapper xmpData = new XmpPacketWrapper(xmpHeader, xmpTrailer, xmpMeta);

    // Create an instacne of Photoshop package and set photoshop attributes
    PhotoshopPackage photoshopPackage = new PhotoshopPackage();
    photoshopPackage.SetCity(&#34;London&#34;);
    photoshopPackage.SetCountry(&#34;England&#34;);
    photoshopPackage.SetColorMode(ColorMode.Rgb);
    photoshopPackage.SetCreatedDate(DateTime.UtcNow);

    // Add photoshop package into XMP metadata
    xmpData.AddPackage(photoshopPackage);

    // Create an instacne of DublinCore package and set dublinCore attributes
    DublinCorePackage dublinCorePackage = new DublinCorePackage();
    dublinCorePackage.SetAuthor(&#34;Mudassir Fayyaz&#34;);
    dublinCorePackage.SetTitle(&#34;Confessions of a Man Insane Enough to Live With the Beasts&#34;);
    dublinCorePackage.AddValue(&#34;dc:movie&#34;, &#34;Barfly&#34;);

    // Add dublinCore Package into XMP metadata
    xmpData.AddPackage(dublinCorePackage);
    return xmpData;
}
</code></pre><p><strong>IMAGINGNET-4064 Export to EMF gives the image at the wrong scale</strong></p><pre tabindex=0><code>using (Image image = Image.Load(@&#34;D:\cat.jpg&#34;))
{
  image.Save(@&#34;D:\cat.emf&#34;, new EmfOptions());
}

// Step 2. Export EMF image to any raster format
using (Image image = Image.Load(@&#34;D:\cat.emf&#34;))
{
  image.Save(@&#34;D:\cat.png&#34;, new PngOptions()
{
  VectorRasterizationOptions = new EmfRasterizationOptions()
  {
    PageWidth = image.Width,
    PageHeight = image.Height
  }
});
}
</code></pre><p><strong>IMAGINGNET-4063 Export to WMF gives the image at the wrong scale</strong></p><pre tabindex=0><code>using (Image image = Image.Load(@&#34;D:\cat.jpg&#34;))
{
  image.Save(@&#34;D:\cat.wmf&#34;, new WmfOptions());
}

// Step 2. Export EMF image to any raster format
using (Image image = Image.Load(@&#34;D:\cat.wmf&#34;))
{
  image.Save(@&#34;D:\cat.png&#34;, new PngOptions()
{
VectorRasterizationOptions = new EmfRasterizationOptions()
{
  PageWidth = image.Width,
  PageHeight = image.Height
}});
}
</code></pre><p><strong>IMAGINGNET-4062 Support exporting XMP metadata from TiffOptions in the TIFF exporter</strong></p><pre tabindex=0><code>### Saving of the TIFF image with the specified XmpData.


XmpPacketWrapper xmpPacketWrapper = new XmpPacketWrapper(xmpHeader, xmpTrailer, xmpMeta);

using (TiffImage image = (TiffImage)Image.Load(&#34;test.tiff&#34;))
{
    TiffOptions tiffOptions = new TiffOptions(TiffExpectedFormat.Default);
    tiffOptions.Photometric = TiffPhotometrics.Rgb;
    tiffOptions.Compression = TiffCompressions.Jpeg;
    tiffOptions.BitsPerSample = new ushort[] { 8, 8, 8 };
    tiffOptions.XmpData = xmpPacketWrapper;
    image.Save(&#34;output.tiff&#34;, tiffOptions);
}
</code></pre><p><strong>IMAGINGNET-4026 Index was outside the bounds of the array exception when loading JPF</strong></p><pre tabindex=0><code>Provided sample.jpf file can be successfully loaded and exported. The export result can be seen in the attachments.


using (Image image = Image.Load(&#34;sample.jpf&#34;))
{
    PngOptions saveOptions = new PngOptions();
    image.Save(&#34;sample.jpf.png&#34;, saveOptions);
}
</code></pre><p><strong>IMAGINGNET-4018 Support Jpeg, Jpeg2000 and RLE compression method in Dicom exporter</strong></p><pre tabindex=0><code>### What is a DICOM Image File?
The DICOM standard is useful for integrating all modern imaging equipments, accessories, networking servers, workstations and printers. Because of its ease of integration and continuous evolution this communication standard has over the years achieved a nearly universal level of acceptance among vendors of radiological equipment.

A DICOM image file is an outcome of the Digital Imaging and Communications in Medicine standard. Specifically, image files that are compliant with part 10 of the DICOM standard are generally referred to as “DICOM format files” or simply “DICOM files” and are represented as “.dcm”.

### DICOM compression settings
The property ***DicomOptions.Compression*** allows you to specify compression settings. For instance, ***CompressionType*** enumeration allows you to select compression algorithm: *None*, *Jpeg*, *Jpeg2000* or *Rle*. The *None* option corresponds to uncompressed DICOM image. The following code shows how to use DICOM compression settings:

using (var inputImage = Image.Load(&#34;original.jpg&#34;))
{
    var options = new DicomOptions
    {
        ColorType = ColorType.Rgb24Bit,
        Compression = new Compression { Type = CompressionType.None }
    };

    inputImage.Save(&#34;original_Uncompressed.dcm&#34;, options);
}

### Using JPEG compression in DICOM image
To use JPEG compression algorithm you should specify *CompressionType.Jpeg* enumeration value in ***Compression.Type*** property:

using (var inputImage = Image.Load(&#34;original.jpg&#34;))
{
    var options = new DicomOptions
    {
        ColorType = ColorType.Rgb24Bit,
        Compression = new Compression { Type = CompressionType.Jpeg }
    };

    inputImage.Save(&#34;original_JPEG.dcm&#34;, options);
}

You can tune JPEG compression algorithm using ***Compression.Jpeg*** property. For instance, you can specify the *CompressionType*, *SampleRoundingMode* and *Quality*:

using (var inputImage = Image.Load(&#34;original.jpg&#34;))
{
    var options = new DicomOptions
    {
        ColorType = ColorType.Rgb24Bit,
        Compression = new Compression
        {
            Type = CompressionType.Jpeg,
            Jpeg = new JpegOptions
            {
                CompressionType = JpegCompressionMode.Baseline,
                SampleRoundingMode = SampleRoundingMode.Truncate,
                Quality = 50
            }
        }
    };

    inputImage.Save(&#34;original_JPEG_2.dcm&#34;, options);
}

### Using JPEG 2000 compression in DICOM image
To use JPEG 2000 compression you need to use *CompressionType.Jpeg2000* enumeration value and ***Jpeg2000Options*** class for algorithm settings. The following code demonstrates how to specify JPEG 2000 *Codec* and *Irreversible* properties:

using (var inputImage = Image.Load(&#34;original.jpg&#34;))
{
    var options = new DicomOptions
    {
        ColorType = ColorType.Rgb24Bit,
        Compression = new Compression
        {
            Type = CompressionType.Jpeg2000,
            Jpeg2000 = new Jpeg2000Options
            {
                Codec = Jpeg2000Codec.Jp2,
                Irreversible = false
            }
        }
    };

    inputImage.Save(&#34;original_JPEG2000.dcm&#34;, options);
}

### Using RLE compression in DICOM image
For this compression type you need to use *CompressionType.Rle* enumeration value. The RLE compression algorithm doesn&#39;t have additional settings. The following code shows how you can use RLE compression algorithm in DICOM image:

using (var inputImage = Image.Load(&#34;original.jpg&#34;))
{
    var options = new DicomOptions
    {
        ColorType = ColorType.Rgb24Bit,
        Compression = new Compression { Type = CompressionType.Rle }
    };

    inputImage.Save(&#34;original_RLE.dcm&#34;, options);
}

### How to change Color Type in DICOM compression
The property ***DicomOptions.ColorType*** allows you to change color type in DICOM compression. There are several supported color types: *Grayscale8Bit*, *Grayscale16Bit* and *Rgb24Bit*. Use the following code in order to change the color type:

using (var inputImage = Image.Load(&#34;original.jpg&#34;))
{
    var options = new DicomOptions { ColorType = ColorType.Grayscale8Bit };

    inputImage.Save(&#34;original_8Bit.dcm&#34;, options);
}
</code></pre><p><strong>IMAGINGNET-4003 Add CompressionLevel to the PngOptions while SaveData</strong></p><pre tabindex=0><code>### Saving of the PNG image with different compression levels.


using (PngImage img = (PngImage)Image.Load(&#34;test.png&#34;))
{
    for (int i = 0; i &lt;= 9; i++)
    {
        using (MemoryStream stream = new MemoryStream())
        {
            PngOptions options = (PngOptions)img.GetOriginalOptions();
            options.CompressionLevel = i;
            options.Source = new StreamSource(stream);
            PngImage image = (PngImage)Image.Create(options, img.Width, img.Height);
            image.SaveArgb32Pixels(img.Bounds, img.LoadArgb32Pixels(img.Bounds));

            string outputFile = string.Format(@&#34;compressionTest{0}.png&#34;, i);
            img.Save(outputFile);
        }
    }
}
</code></pre><p><strong>IMAGINGNET-3992 Incorrect results of exporting a raster image to metafiles</strong></p><pre tabindex=0><code>Emf:

string fileName = @&#34;input.png&#34;;
string baseFolder = @&#34;D:\&#34;;
string inputFilePath = Path.Combine(baseFolder, fileName);
string outputFilePath = inputFilePath + &#34;.emf&#34;;
using (Image image = Image.Load(inputFilePath))
{
   image.Save(outputFilePath, new EmfOptions());
}


Wmf:

string fileName = @&#34;input.png&#34;;
string baseFolder = @&#34;D:\&#34;;
string inputFilePath = Path.Combine(baseFolder, fileName);
string outputFilePath = inputFilePath + &#34;.wmf&#34;;
using (Image image = Image.Load(inputFilePath))
{
   image.Save(outputFilePath, new WmfOptions());
}
</code></pre><p><strong>IMAGINGNET-3990 NullReferenceException occurs when exporting images of several vector types</strong></p><pre tabindex=0><code>Emf:

        public void Example()
        {
            string inputFile = @&#34;cat.emf&#34;;
            string baseFolder = @&#34;D:\&#34;;
            string inputFilePath = Path.Combine(baseFolder, inputFile);
            string outputFilePath = inputFilePath + &#34;.png&#34;;
            ExportRecordedEmf(inputFilePath, outputFilePath);
            outputFilePath = Path.Combine(baseFolder, &#34;empty.emf.png&#34;);
            ExportNewEmf(outputFilePath);
        }

        public void ExportNewEmf(string outputFileName)
        {
            using (EmfImage emfImage = new EmfImage(100, 100))
            {
                using (FileStream outStream = new FileStream(outputFileName, FileMode.Create))
                {
                    EmfRasterizationOptions emfRasterizationOptions = new EmfRasterizationOptions();
                    emfRasterizationOptions.PageWidth = emfImage.Width;
                    emfRasterizationOptions.PageHeight = emfImage.Height;
                    emfImage.Save(outStream, new PngOptions { VectorRasterizationOptions = emfRasterizationOptions });
                }
            }
        }

        public void ExportRecordedEmf(string inputFile, string outputFile)
        {
            using (EmfImage canvasEmfImage = (EmfImage)Image.Load(inputFile))
            {
                using (EmfImage recordedEmfImage = EmfRecorderGraphics2D.FromEmfImage(canvasEmfImage).EndRecording())
                {
                    using (FileStream outStream = new FileStream(outputFile, FileMode.Create))
                    {
                        EmfRasterizationOptions emfRasterizationOptions = new EmfRasterizationOptions();
                        emfRasterizationOptions.PageWidth = recordedEmfImage.Width;
                        emfRasterizationOptions.PageHeight = recordedEmfImage.Height;
                        recordedEmfImage.Save(outStream, new PngOptions { VectorRasterizationOptions = emfRasterizationOptions });
                    }
                }
            }
        }

Wmf:

        public void Example()
        {
            string inputFile = @&#34;2036.wmf&#34;;
            string baseFolder = @&#34;D:\&#34;;
            string inputFilePath = Path.Combine(baseFolder, inputFile);
            string outputFilePath = inputFilePath + &#34;.png&#34;;
            ExportRecordedWmf(inputFilePath, outputFilePath);
            outputFilePath = Path.Combine(baseFolder,&#34;empty.wmf.png&#34;);
            ExportNewWmf(outputFilePath);
        }

        public void ExportNewWmf(string outputFileName)
        {
            using (WmfImage wmfImage = new WmfImage(100, 100))
            {
                using (FileStream outStream = new FileStream(outputFileName, FileMode.Create))
                {
                    WmfRasterizationOptions wmfRasterizationOptions = new WmfRasterizationOptions()
                    wmfRasterizationOptions.PageWidth = wmfImage.Width;
                    wmfRasterizationOptions.PageHeight = wmfImage.Height;
                    wmfImage.Save(outStream, new PngOptions {VectorRasterizationOptions = wmfRasterizationOptions});
                }
            }
        }

        public void ExportRecordedWmf(string inputFile, string outputFile)
        {
            using (WmfImage canvasWmfImage = (WmfImage)Image.Load(inputFile))
            {
                using (WmfImage recordedWmfImage = WmfRecorderGraphics2D.FromWmfImage(canvasWmfImage).EndRecording())
                {
                    using (FileStream outStream = new FileStream(outputFile, FileMode.Create))
                    {
                        WmfRasterizationOptions wmfRasterizationOptions = new WmfRasterizationOptions()
                        wmfRasterizationOptions.PageWidth = recordedWmfImage.Width;
                        wmfRasterizationOptions.PageHeight = recordedWmfImage.Height;
                        recordedWmfImage.Save(outStream, new PngOptions { VectorRasterizationOptions = wmfRasterizationOptions });
                    }
                }
            }
        }

SVG:

        public void Example()
        {
            string outputFile = &#34;empty.svg.png&#34;;
            string baseFolder = @&#34;D:\&#34;;
            string outputFilePath = Path.Combine(baseFolder, outputFile);
            ExportNewSvg(outputFilePath);
        }

        public void ExportNewSvg(string outputFileName)
        {
            using (SvgImage svgImage = new SvgImage(100, 100))
            {
                using (FileStream outStream = new FileStream(outputFileName, FileMode.Create))
                {
                    SvgRasterizationOptions wmfRasterizationOptions = new SvgRasterizationOptions();
                    wmfRasterizationOptions.PageWidth = svgImage.Width;
                    wmfRasterizationOptions.PageHeight = svgImage.Height;
                    svgImage.Save(outStream, new PngOptions { VectorRasterizationOptions = wmfRasterizationOptions });
                }
            }
        }
</code></pre><p><strong>IMAGINGNET-3985 Implement additional resize methods as per Aspose.Psd resize</strong></p><pre tabindex=0><code>### New Resize Types in Aspose.Imaging library
New resize types were implemented in *Aspose.Imaging* library:

**CatmullRom** - The Catmull-Rom cubic interpolation method.
**CubicConvolution** - The Cubic Convolution interpolation method.
**CubicBSpline** - The CubicBSpline cubic interpolation method.
**Mitchell** - The Mitchell cubic interpolation method.
**SinC** - The Sinc (Lanczos3) cubic interpolation method.
**Bell** - The Bell interpolation method.

### Resize image using specific Resize Type
The next source code sample demonstrates how you can use specific Resize Type to resize the image:

{{code}}
using (var image = Image.Load(&#34;Photo.jpg&#34;))
{
    image.Resize(640, 480, ResizeType.CatmullRom);
    image.Save(&#34;ResizedPhoto.jpg&#34;);

    image.Resize(1024, 768, ResizeType.CubicConvolution);
    image.Save(&#34;ResizedPhoto2.jpg&#34;);

    var resizeSettings = new ImageResizeSettings
    {
        Mode = ResizeType.CubicBSpline,
        FilterType = ImageFilterType.SmallRectangular
    };

    image.Resize(800, 800, resizeSettings);
    image.Save(&#34;ResizedPhoto3.jpg&#34;);
}
</code></pre><p><strong>IMAGINGNET-3958 Image saving failed exception when saving TIFF</strong></p><pre tabindex=0><code>Without strict mode

string fileName = &#34;sample.tiff&#34;;
string baseFolder = @&#34;D:\&#34;;
string inputFilePath = Path.Combine(baseFolder, fileName);
string outputFilePath = inputFilePath + &#34;.png&#34;;

using (Image image = Image.Load(inputFilePath))
{
    TiffImage tiffImage = image as TiffImage;
    tiffImage.Pages[0].Save(outputFilePath, new PngOptions());
}

With strict mode

string fileName = &#34;sample.tiff&#34;;
string baseFolder = @&#34;D:\&#34;;
string inputFilePath = Path.Combine(baseFolder, fileName);
try
{
   using (Image image = Image.Load(inputFilePath, new LoadOptions() { DataRecoveryMode = DataRecoveryMode.None }))
   {
      image.CacheData();
   }

   throw new TestException(&#34;Error DataRecoveryMode&#34;);
}
catch (EndOfStreamException)
{

}
</code></pre><p><strong>IMAGINGNET-3954 Image saving failed exception when saving SVG</strong></p><pre tabindex=0><code>string baseFolder = @&#34;D:\&#34;;
string fileName = &#34;sample.svg&#34;;
string inputFile = Path.Combine(baseFolder, fileName);
string outputFile = inputFile + &#34;.png&#34;;
using (Image image =  Image.Load(inputFile))
{
   PngOptions options = new PngOptions();
   options.VectorRasterizationOptions = new SvgRasterizationOptions() {PageSize = image.Size};
   image.Save(outputFile, options);
}
</code></pre><p><strong>IMAGINGNET-3938 Support of export and import to TGA fileformat</strong></p><pre tabindex=0><code>### Saving of the JPG image as a TGA image.


using (RasterImage image = (JpegImage)Image.Load(&#34;test.jpg&#34;))
{
    image.Save(&#34;test.tga&#34;, new TgaOptions());
}


### Loading of the PNG image, conversion of it to the TgaImage and saving as a TGA image.


using (RasterImage image = (RasterImage)Image.Load(&#34;test.png&#34;))
{
    using (TgaImage tgaImage = new TgaImage(image))
    {
        tgaImage.Save(&#34;test.tga&#34;);
    }
}


### Getting values of the public properties of the loaded TGA image.


using (TgaImage image = (TgaImage)Image.Load(&#34;test.tga&#34;))
{
    DateTime? dateTimeStamp = image.DateTimeStamp;
    string authorName = image.AuthorName;
    string authorComments = image.AuthorComments;
    string imageId = image.ImageId;
    string jobNameOrId = image.JobNameOrId;
    TimeSpan? jobTime = image.JobTime;
    Color? keyColor = image.TransparentColor;
    string softwareId = image.SoftwareId;
    string softwareVersion = image.SoftwareVersion;
    char softwareVersionLetter = image.SoftwareVersionLetter;
    int softwareVersionNumber = image.SoftwareVersionNumber;
    int xOrigin = image.XOrigin;
    int yOrigin = image.YOrigin;
    ushort gammaValueDenominator = image.GammaValueDenominator;
    ushort gammaValueNumerator = image.GammaValueNumerator;
    bool hasAlphaChannel = image.HasAlpha;
    bool hasColorMap = image.HasColorMap;
    ushort height = (ushort)image.Height;
    bool isGrayScale = image.IsGrayScale;
    ushort pixelAspectRatioDenominator = image.PixelAspectRatioDenominator;
    ushort pixelAspectRatioNumerator = image.PixelAspectRatioNumerator;
    Size size = image.Size;
    ushort width = (ushort)image.Width;
}


### Updating public properties of the loaded TGA image.


using (TgaImage image = (TgaImage)Image.Load(&#34;test.tga&#34;))
{
    image.DateTimeStamp = DateTime.UtcNow;
    image.AuthorName = &#34;John Smith&#34;;
    image.AuthorComments = &#34;Comment&#34;;
    image.ImageId = &#34;ImageId&#34;;
    image.JobNameOrId = &#34;Important Job&#34;;
    image.JobTime = TimeSpan.FromDays(10);
    image.TransparentColor = Color.FromArgb(123);
    image.SoftwareId = &#34;SoftwareId&#34;;
    image.SoftwareVersion = &#34;abc1&#34;;
    image.SoftwareVersionLetter = &#39;a&#39;;
    image.SoftwareVersionNumber = 2;
    image.XOrigin = 1000;
    image.YOrigin = 1000;

    image.Save(&#34;test.tga&#34;)
}
</code></pre><p><strong>IMAGINGNET-3615 Converting PNG to TGA format</strong></p><pre tabindex=0><code>### Loading of the PNG image and saving it as a TGA image.


using (RasterImage image = (PngImage)Image.Load(&#34;test.png&#34;))
{
    image.Save(&#34;test.tga&#34;, new TgaOptions());
}


### Loading of the PNG image, conversion of it to the TgaImage and saving as a TGA image.


using (RasterImage image = (RasterImage)Image.Load(&#34;test.png&#34;))
{
    using (TgaImage tgaImage = new TgaImage(image))
    {
        tgaImage.Save(&#34;test.tga&#34;);
    }
}
</code></pre></p></div></div></div></div><hr></div></div></section></div></div></section></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>