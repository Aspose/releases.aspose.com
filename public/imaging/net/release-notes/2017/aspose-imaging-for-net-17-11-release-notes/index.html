<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.Imaging for .NET 17.11 - Release Notes</title><meta name=description content="Aspose.Imaging for .NET 17.11 - Release Notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/imaging/net/release-notes/2017/aspose-imaging-for-net-17-11-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/imaging/net/release-notes/2017/aspose-imaging-for-net-17-11-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.Imaging for .NET 17.11 - Release Notes "><meta property="og:description" content="Aspose.Imaging for .NET 17.11 - Release Notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/imaging/net/release-notes/2017/aspose-imaging-for-net-17-11-release-notes/"><meta itemprop=name content="Aspose.Imaging for .NET 17.11 - Release Notes"><meta itemprop=description content="Aspose.Imaging for .NET 17.11 - Release Notes – the latest updates and fixes."><meta itemprop=wordCount content="2526"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.Imaging for .NET 17.11 - Release Notes"><meta name=twitter:description content="Aspose.Imaging for .NET 17.11 - Release Notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/imaging/>Aspose.Imaging Product Family</a><span class=divider></span></li><li><a href=/imaging/net/>Aspose.Imaging for .NET</a><span class=divider></span></li><li><a href=/imaging/net/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/imaging/net/release-notes/2017/>2017</a><span class=divider></span></li><li><a href=/imaging/net/release-notes/2017/aspose-imaging-for-net-17-11-release-notes/>Aspose.Imaging for .NET 17.11 - Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><div class=container><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section"><div class=box1><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.Imaging for .NET 17.11 - Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><table><thead><tr><th style=text-align:left><strong>Key</strong></th><th style=text-align:left><strong>Summary</strong></th><th style=text-align:left><strong>Category</strong></th></tr></thead><tbody><tr><td style=text-align:left>IMAGINGNET-2457</td><td style=text-align:left>Aspose.Imaging 17.6.0 : Managing resources while saving Metafile images as SVG</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGNET-2456</td><td style=text-align:left>Saving SVG with fonts embedded or exported</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGNET-2439</td><td style=text-align:left>Add possibility to force fonts cache update</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGNET-2396</td><td style=text-align:left>Provide setting for replacing missing fonts</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGNET-2375</td><td style=text-align:left>Add support for color replacement in PSD layers</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGNET-2043</td><td style=text-align:left>Support for ODG (OpenDocument graphics)</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGNET-1842</td><td style=text-align:left>Support for the combination of ColorType as Grayscale & CompressionType as Progressive for the JpegOptions class</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGNET-2569</td><td style=text-align:left>PSD Conversion CMYK to RGB with alpha channel doesn&rsquo;t work</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2546</td><td style=text-align:left>Improperly computed TiffFrame.HorizontalResolution</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2544</td><td style=text-align:left>Improve memory usage of Tiff options, JPEG, PNG decoders</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2539</td><td style=text-align:left>Improve performance the de-convolution filter in case low memory</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2526</td><td style=text-align:left>Converting DNG image into JPG provides output with light spots</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2523</td><td style=text-align:left>Improper text rendering in generated PNG</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2517</td><td style=text-align:left>Some PNG files are incorrectly read with LoadOptions</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2516</td><td style=text-align:left>Optimize the Aspose.Imaging.Color structure.</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2465</td><td style=text-align:left>Aspose.Imaging 17.7.0: Adds evaluation message when loading SVG with venture licenser</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2462</td><td style=text-align:left>SVG is not properly converted PNG</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2431</td><td style=text-align:left>Improve performance of CMYK colors processing</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2387</td><td style=text-align:left>Improve performance JPEG decoder</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2379</td><td style=text-align:left>UpdateText changes layer properties and fonts</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-2361</td><td style=text-align:left>KeyNotFoundException when saving PSD image</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGNET-1596</td><td style=text-align:left>Dithering may work incorrectly when partial loading occurs</td><td style=text-align:left>Enhancement</td></tr></tbody></table><h1 id=public-api-changes><strong>Public API changes:</strong></h1><h2 id=added-apis><strong>Added APIs:</strong></h2><p>Nothing</p><h2 id=removed-apis><strong>Removed APIs:</strong></h2><p>Nothing</p><h1 id=usage-examples><strong>Usage examples:</strong></h1><p><strong>IMAGINGNET-2457 Aspose.Imaging 17.6.0 : Managing resources while saving Metafile images as SVG</strong>
\1. Add class to project:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> using System<span style=color:#f92672>.</span><span style=color:#a6e22e>IO</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using Aspose<span style=color:#f92672>.</span><span style=color:#a6e22e>Svg</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using ImageOptions<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using Imaging<span style=color:#f92672>.</span><span style=color:#a6e22e>FileFormats</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Svg</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>internal <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SvgImageTester</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>region Constants
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>const</span> string ImageFolderName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Images&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>const</span> string OutFolderName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Out&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>const</span> string SourceFolder <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;D:\ImageTests&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> readonly string OutFolder <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>SourceFolder<span style=color:#f92672>,</span> OutFolderName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> readonly string ImageFolder <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>OutFolder<span style=color:#f92672>,</span> ImageFolderName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>endregion
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>region Methods
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>SaveWithEmbeddedImages</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string<span style=color:#f92672>[]</span> files <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> string<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> <span style=color:#f92672>{</span> <span style=color:#e6db74>&#34;auto.svg&#34;</span> <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> files<span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span><span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>,</span> files<span style=color:#f92672>[</span>i<span style=color:#f92672>],</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>SaveWithExportImages</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string<span style=color:#f92672>[]</span> files <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> string<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> <span style=color:#f92672>{</span> <span style=color:#e6db74>&#34;auto.svg&#34;</span> <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string<span style=color:#f92672>[][]</span> expectedImages <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> string<span style=color:#f92672>[</span>1<span style=color:#f92672>][]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>new</span> string<span style=color:#f92672>[</span>16<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;svg_img1.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;svg_img10.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;svg_img11.png&#34;</span><span style=color:#f92672>,</span><span style=color:#e6db74>&#34;svg_img12.png&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;svg_img13.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;svg_img14.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;svg_img15.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;svg_img16.png&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;svg_img2.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;svg_img3.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;svg_img4.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;svg_img5.png&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;svg_img6.png&#34;</span><span style=color:#f92672>,</span><span style=color:#e6db74>&#34;svg_img7.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;svg_img8.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;svg_img9.png&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>},</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> files<span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span><span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#66d9ef>false</span><span style=color:#f92672>,</span> files<span style=color:#f92672>[</span>i<span style=color:#f92672>],</span> expectedImages<span style=color:#f92672>[</span>i<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>bool useEmbedded<span style=color:#f92672>,</span> string fileName<span style=color:#f92672>,</span> string<span style=color:#f92672>[]</span> expectedImages<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>Exists</span><span style=color:#f92672>(</span>OutFolder<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>CreateDirectory</span><span style=color:#f92672>(</span>OutFolder<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string storeType <span style=color:#f92672>=</span> useEmbedded <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;Embedded&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Stream&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string inputFile <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>SourceFolder<span style=color:#f92672>,</span> fileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outFileName <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>GetFileNameWithoutExtension</span><span style=color:#f92672>(</span>fileName<span style=color:#f92672>)</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;_&#34;</span> <span style=color:#f92672>+</span> storeType <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.svg&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outputFile <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>OutFolder<span style=color:#f92672>,</span> outFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string imageFolder <span style=color:#f92672>=</span> string<span style=color:#f92672>.</span><span style=color:#a6e22e>Empty</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>inputFile<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>EmfRasterizationOptions emfRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> EmfRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>emfRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>BackgroundColor</span> <span style=color:#f92672>=</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>White</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>emfRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>PageWidth</span> <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Width</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>emfRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>PageHeight</span> <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Height</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string testingFileName <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>GetFileNameWithoutExtension</span><span style=color:#f92672>(</span>inputFile<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>imageFolder <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>ImageFolder<span style=color:#f92672>,</span> testingFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputFile<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>new</span> SvgOptions
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>VectorRasterizationOptions <span style=color:#f92672>=</span> emfRasterizationOptions<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Callback <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>new</span> SvgCallbackImageTest<span style=color:#f92672>(</span>useEmbedded<span style=color:#f92672>,</span> imageFolder<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Link <span style=color:#f92672>=</span> ImageFolderName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/&#34;</span> <span style=color:#f92672>+</span> testingFileName
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>useEmbedded<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string<span style=color:#f92672>[]</span> files <span style=color:#f92672>=</span> Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>GetFiles</span><span style=color:#f92672>(</span>imageFolder<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>files<span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span> <span style=color:#f92672>!=</span> expectedImages<span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Exception<span style=color:#f92672>(</span>string<span style=color:#f92672>.</span><span style=color:#a6e22e>Format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Expected count font files = {0}, Current count image files = {1}&#34;</span><span style=color:#f92672>,</span> expectedImages<span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span><span style=color:#f92672>,</span> files<span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> files<span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span><span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string file <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>GetFileName</span><span style=color:#f92672>(</span>files<span style=color:#f92672>[</span>i<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>string<span style=color:#f92672>.</span><span style=color:#a6e22e>IsNullOrEmpty</span><span style=color:#f92672>(</span>file<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Exception<span style=color:#f92672>(</span>string<span style=color:#f92672>.</span><span style=color:#a6e22e>Format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Expected file name: &#39;{0}&#39;, current is empty&#34;</span><span style=color:#f92672>,</span> expectedImages<span style=color:#f92672>[</span>i<span style=color:#f92672>]));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>file<span style=color:#f92672>.</span><span style=color:#a6e22e>ToLower</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> expectedImages<span style=color:#f92672>[</span>i<span style=color:#f92672>])</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Exception<span style=color:#f92672>(</span>string<span style=color:#f92672>.</span><span style=color:#a6e22e>Format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Expected file name: &#39;{0}&#39;, current: &#39;{1}&#39;&#34;</span><span style=color:#f92672>,</span> expectedImages<span style=color:#f92672>[</span>i<span style=color:#f92672>],</span> file<span style=color:#f92672>.</span><span style=color:#a6e22e>ToLower</span><span style=color:#f92672>()));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>endregion
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SvgCallbackImageTest</span> <span style=color:#f92672>:</span> SvgResourceKeeperCallback
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>region Fields
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// The out folder
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> readonly string outFolder<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// The use embedded font
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> readonly bool useEmbeddedImage<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>endregion
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>region Constructors
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Initializes a new instance of the &lt;see cref=&#34;SvgTests.SvgCallbackFontTest&#34; /&gt; class.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;useEbeddedImage&#34;&gt;if set to &lt;c&gt;true&lt;/c&gt; [use ebedded image].&lt;/param&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;outFolder&#34;&gt;The out folder.&lt;/param&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#a6e22e>SvgCallbackImageTest</span><span style=color:#f92672>(</span>bool useEbeddedImage<span style=color:#f92672>,</span> string outFolder<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>useEmbeddedImage</span> <span style=color:#f92672>=</span> useEbeddedImage<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>outFolder</span> <span style=color:#f92672>=</span> outFolder<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>endregion
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>region Properties
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> string Link <span style=color:#f92672>{</span> get<span style=color:#f92672>;</span> set<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>endregion
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>region Methods
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Called when image resource ready.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;imageData&#34;&gt;The resource data.&lt;/param&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;imageType&#34;&gt;Type of the image.&lt;/param&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;suggestedFileName&#34;&gt;Name of the suggested file.&lt;/param&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;useEmbeddedImage&#34;&gt;if set to &lt;c&gt;true&lt;/c&gt; the embedded image must be used.&lt;/param&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;returns&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Returns path to saved resource. Path should be relative to target SVG document.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/returns&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> override string <span style=color:#a6e22e>OnImageResourceReady</span><span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> imageData<span style=color:#f92672>,</span> SvgImageType imageType<span style=color:#f92672>,</span> string suggestedFileName<span style=color:#f92672>,</span> ref bool useEmbeddedImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>useEmbeddedImage <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>useEmbeddedImage</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>useEmbeddedImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> suggestedFileName<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string fontFolder <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>outFolder</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>Exists</span><span style=color:#f92672>(</span>fontFolder<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>CreateDirectory</span><span style=color:#f92672>(</span>fontFolder<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string fileName <span style=color:#f92672>=</span> fontFolder <span style=color:#f92672>+</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;\&#34; + Path.GetFileName(suggestedFileName);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>using (FileStream fs = new FileStream(fileName, FileMode.Create))
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>fs.Write(imageData, 0, imageData.Length);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>return @&#34;</span><span style=color:#f92672>./</span><span style=color:#e6db74>&#34; + this.Link + &#34;</span><span style=color:#f92672>/</span><span style=color:#960050;background-color:#1e0010>&#34;</span> <span style=color:#f92672>+</span> suggestedFileName<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>endregion
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p>\2. Update path int constant <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=SourceFolder&linkCreation=true&fromPageId=54133163">SourceFolder</a>
\3. Testing svg file with embedded images, export images and embedded images</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> SvgImageTester svgFontTester <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SvgImageTester<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>svgFontTester<span style=color:#f92672>.</span><span style=color:#a6e22e>SaveWithExportImages</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>svgFontTester<span style=color:#f92672>.</span><span style=color:#a6e22e>SaveWithEmbeddedImages</span><span style=color:#f92672>();</span></span></span></code></pre></div><p>As a result the test execution be created files in folder &lsquo;Out&rsquo; <strong>auto_embedded.svg</strong>, <strong>auto_stream.svg</strong> and folder &lsquo;Images&rsquo;, which contains image files from auto_stream.svg.</p><p><strong>IMAGINGNET-2456 Saving SVG with fonts embedded or exported</strong>
\1. Add class to project:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> using System<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using System<span style=color:#f92672>.</span><span style=color:#a6e22e>IO</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using Aspose<span style=color:#f92672>.</span><span style=color:#a6e22e>Svg</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using Aspose<span style=color:#f92672>.</span><span style=color:#a6e22e>Svg</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Options</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using ImageOptions<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using Imaging<span style=color:#f92672>.</span><span style=color:#a6e22e>FileFormats</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Svg</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>internal <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SvgFontTester</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>region Constants
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>const</span> string FontFolderName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;fonts&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>const</span> string OutFolderName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Out&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>const</span> string SourceFolder <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;D:\FontTests&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> readonly string OutFolder <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>SourceFolder<span style=color:#f92672>,</span> OutFolderName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> readonly string FontFolder <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>OutFolder<span style=color:#f92672>,</span> FontFolderName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>endregion
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>region Methods
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>ReadFileWithEmbeddedFontsAndExportToPdf</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>ReadAndExportToPdf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;EmbeddedFonts.svg&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>ReadFileWithExportedFontsAndExportToPdf</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>ReadAndExportToPdf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;ExportedFonts.svg&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>SaveWithEmbeddedFonts</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string<span style=color:#f92672>[]</span> files <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> string<span style=color:#f92672>[</span>3<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;exportedFonts.svg&#34;</span><span style=color:#f92672>,</span> <span style=color:#75715e>// File with exported fonts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;embeddedFonts.svg&#34;</span><span style=color:#f92672>,</span> <span style=color:#75715e>// File with embedded fonts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;mysvg.svg&#34;</span> <span style=color:#75715e>// simple file
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> files<span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span><span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>,</span> files<span style=color:#f92672>[</span>i<span style=color:#f92672>],</span> 0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>SaveWithExportFonts</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string<span style=color:#f92672>[]</span> files <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> string<span style=color:#f92672>[</span>3<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;exportedFonts.svg&#34;</span><span style=color:#f92672>,</span> <span style=color:#75715e>// File with exported fonts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;embeddedFonts.svg&#34;</span><span style=color:#f92672>,</span> <span style=color:#75715e>// File with embedded fonts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;mysvg.svg&#34;</span> <span style=color:#75715e>// simple file
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> expectedFontsCount <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span>3<span style=color:#f92672>]</span> <span style=color:#f92672>{</span>4<span style=color:#f92672>,</span>4<span style=color:#f92672>,</span>1<span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> files<span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span><span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#66d9ef>false</span><span style=color:#f92672>,</span> files<span style=color:#f92672>[</span>i<span style=color:#f92672>],</span> expectedFontsCount<span style=color:#f92672>[</span>i<span style=color:#f92672>]);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>ReadAndExportToPdf</span><span style=color:#f92672>(</span>string inputFileName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>Exists</span><span style=color:#f92672>(</span>OutFolder<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>CreateDirectory</span><span style=color:#f92672>(</span>OutFolder<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string inputFile <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>SourceFolder<span style=color:#f92672>,</span> inputFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outFile <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>OutFolder<span style=color:#f92672>,</span> inputFileName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.pdf&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>inputFile<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outFile<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>new</span> PdfOptions <span style=color:#f92672>{</span> VectorRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SvgRasterizationOptions <span style=color:#f92672>{</span> PageSize <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Size</span> <span style=color:#f92672>}</span> <span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>bool useEmbedded<span style=color:#f92672>,</span> string fileName<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> expectedCountFonts<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>Exists</span><span style=color:#f92672>(</span>OutFolder<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>CreateDirectory</span><span style=color:#f92672>(</span>OutFolder<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string fontStoreType <span style=color:#f92672>=</span> useEmbedded <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;Embedded&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Stream&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string inputFile <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>SourceFolder<span style=color:#f92672>,</span> fileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outFileName <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>GetFileNameWithoutExtension</span><span style=color:#f92672>(</span>fileName<span style=color:#f92672>)</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;_&#34;</span> <span style=color:#f92672>+</span> fontStoreType <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.svg&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outputFile <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>OutFolder<span style=color:#f92672>,</span> outFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string fontFolder <span style=color:#f92672>=</span> string<span style=color:#f92672>.</span><span style=color:#a6e22e>Empty</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ApsReader<span style=color:#f92672>.</span><span style=color:#a6e22e>ResetSvgContentCounter</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>inputFile<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>EmfRasterizationOptions emfRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> EmfRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>emfRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>BackgroundColor</span> <span style=color:#f92672>=</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>White</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>emfRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>PageWidth</span> <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Width</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>emfRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>PageHeight</span> <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Height</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string testingFileName <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>GetFileNameWithoutExtension</span><span style=color:#f92672>(</span>inputFile<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fontFolder <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>FontFolder<span style=color:#f92672>,</span> testingFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputFile<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>new</span> SvgOptions
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>VectorRasterizationOptions <span style=color:#f92672>=</span> emfRasterizationOptions<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Callback <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>new</span> SvgCallbackFontTest<span style=color:#f92672>(</span>useEmbedded<span style=color:#f92672>,</span> fontFolder<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Link <span style=color:#f92672>=</span> FontFolderName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/&#34;</span> <span style=color:#f92672>+</span> testingFileName
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>useEmbedded<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string<span style=color:#f92672>[]</span> files <span style=color:#f92672>=</span> Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>GetFiles</span><span style=color:#f92672>(</span>fontFolder<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>files<span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span> <span style=color:#f92672>!=</span> expectedCountFonts<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Exception<span style=color:#f92672>(</span>string<span style=color:#f92672>.</span><span style=color:#a6e22e>Format</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;Expected count font files = {0}, Current count font files = {1}&#34;</span><span style=color:#f92672>,</span> expectedCountFonts<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>files<span style=color:#f92672>.</span><span style=color:#a6e22e>Length</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>endregion
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SvgCallbackFontTest</span> <span style=color:#f92672>:</span> SvgResourceKeeperCallback
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>region Fields
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// The out folder
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> readonly string outFolder<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// The use embedded font
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> readonly bool useEmbeddedFont<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// The font counter
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> fontCounter <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>endregion
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>region Constructors
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Initializes a new instance of the &lt;see cref=&#34;SvgTests.SvgCallbackFontTest&#34; /&gt; class.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;useEbeddedFont&#34;&gt;if set to &lt;c&gt;true&lt;/c&gt; [use ebedded font].&lt;/param&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;outFolder&#34;&gt;The out folder.&lt;/param&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#a6e22e>SvgCallbackFontTest</span><span style=color:#f92672>(</span>bool useEbeddedFont<span style=color:#f92672>,</span> string outFolder<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>useEmbeddedFont</span> <span style=color:#f92672>=</span> useEbeddedFont<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>outFolder</span> <span style=color:#f92672>=</span> outFolder<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>Exists</span><span style=color:#f92672>(</span>outFolder<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>Delete</span><span style=color:#f92672>(</span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>outFolder</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>endregion
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>region Properties
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> string Link <span style=color:#f92672>{</span> get<span style=color:#f92672>;</span> set<span style=color:#f92672>;</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>endregion
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>region Methods
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Called when font resource ready to be saved to storage.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/summary&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;param name=&#34;args&#34;&gt;The arguments.&lt;/param&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;returns&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// Returns path to saved resource. Path should be relative to target SVG document.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;/returns&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/// &lt;exception cref=&#34;System.NotImplementedException&#34;&gt;&lt;/exception&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> override <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>OnFontResourceReady</span><span style=color:#f92672>(</span>FontStoringArgs args<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>useEmbeddedFont</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>args<span style=color:#f92672>.</span><span style=color:#a6e22e>FontStoreType</span> <span style=color:#f92672>=</span> FontStoreType<span style=color:#f92672>.</span><span style=color:#a6e22e>Embedded</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>args<span style=color:#f92672>.</span><span style=color:#a6e22e>FontStoreType</span> <span style=color:#f92672>=</span> FontStoreType<span style=color:#f92672>.</span><span style=color:#a6e22e>Stream</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string fontFolder <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>outFolder</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>Exists</span><span style=color:#f92672>(</span>fontFolder<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Directory<span style=color:#f92672>.</span><span style=color:#a6e22e>CreateDirectory</span><span style=color:#f92672>(</span>fontFolder<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string fName <span style=color:#f92672>=</span> args<span style=color:#f92672>.</span><span style=color:#a6e22e>SourceFontFileName</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>File<span style=color:#f92672>.</span><span style=color:#a6e22e>Exists</span><span style=color:#f92672>(</span>fName<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fName <span style=color:#f92672>=</span> string<span style=color:#f92672>.</span><span style=color:#a6e22e>Format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;font_{0}.ttf&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>fontCounter</span><span style=color:#f92672>++);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string fileName <span style=color:#f92672>=</span> fontFolder <span style=color:#f92672>+</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;\&#34; + Path.GetFileName(fName);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>args.DestFontStream = new FileStream(fileName, FileMode.OpenOrCreate);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>args.DisposeStream = true;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>args.FontFileUri = &#34;</span><span style=color:#f92672>./</span><span style=color:#e6db74>&#34; + this.Link + &#34;</span><span style=color:#f92672>/</span><span style=color:#960050;background-color:#1e0010>&#34;</span> <span style=color:#f92672>+</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>GetFileName</span><span style=color:#f92672>(</span>fName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span>endregion
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p>\2. Update path int constant <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=SourceFolder&linkCreation=true&fromPageId=54133163">SourceFolder</a>
\3. Testing
3.1. Reading svg file with exported fonts:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> SvgFontTester svgFontTester <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SvgFontTester<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>svgFontTester<span style=color:#f92672>.</span><span style=color:#a6e22e>ReadFileWithExportedFontsAndExportToPdf</span><span style=color:#f92672>();</span></span></span></code></pre></div><p>As a result the test execution be created file <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=ExportedFonts&linkCreation=true&fromPageId=54133163"><strong>ExportedFonts</strong></a><strong>.svg.pdf</strong> in <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=SourceFolder&linkCreation=true&fromPageId=54133163">SourceFolder</a>\Out.</p><p>3.2. Reading svg file with ebedded fonts:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> SvgFontTester svgFontTester <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SvgFontTester<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>svgFontTester<span style=color:#f92672>.</span><span style=color:#a6e22e>ReadFileWithEmbeddedFontsAndExportToPdf</span><span style=color:#f92672>();</span></span></span></code></pre></div><p>As a result the test execution be created file <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=EmbeddedFonts&linkCreation=true&fromPageId=54133163"><strong>EmbeddedFonts</strong></a><strong>.svg.pdf</strong> in <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=SourceFolder&linkCreation=true&fromPageId=54133163">SourceFolder</a>\Out.</p><p>3.3. Save svg to svg with embedded fonts</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> SvgFontTester svgFontTester <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SvgFontTester<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>svgFontTester<span style=color:#f92672>.</span><span style=color:#a6e22e>SaveWithEmbeddedFonts</span><span style=color:#f92672>();</span></span></span></code></pre></div><p>As a result the test execution be created files: <strong>embeddedFonts_Embedded.svg</strong> (embedded to embedded), <strong>exportedFonts_Embedded.svg</strong> (export to embedded) ,<strong>mysvg_Embedded.svg</strong> (simple to embedded) in <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=SourceFolder&linkCreation=true&fromPageId=54133163">SourceFolder</a>\Out.</p><p>3.4. Save svg to svg with exported fonts</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> SvgFontTester svgFontTester <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SvgFontTester<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>svgFontTester<span style=color:#f92672>.</span><span style=color:#a6e22e>SaveWithExportFonts</span><span style=color:#f92672>();</span></span></span></code></pre></div><p>As a result the test execution be created files: <strong>embeddedFonts_Stream.svg</strong> (embedded to exported), <strong>exportedFonts_Stream.svg</strong> (export to exported) ,<strong>mysvg_Stream.svg</strong> (simple to exported)
in <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=SourceFolder&linkCreation=true&fromPageId=54133163">SourceFolder</a>\Out, and folders with fonts: <strong>embeddedFonts, exportedFonts, mysvg</strong> in <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=SourceFolder&linkCreation=true&fromPageId=54133163">SourceFolder</a>\Out\fonts</p><p><strong>IMAGINGNET-2439 Add possibility to force fonts cache update</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> using <span style=color:#f92672>(</span>PsdImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;input.psd&#34;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;NoFont.psd&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Console<span style=color:#f92672>.</span><span style=color:#a6e22e>WriteLine</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;You have 2 minutes to install the font&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Thread<span style=color:#f92672>.</span><span style=color:#a6e22e>Sleep</span><span style=color:#f92672>(</span>TimeSpan<span style=color:#f92672>.</span><span style=color:#a6e22e>FromMinutes</span><span style=color:#f92672>(</span>2<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>OpenTypeFontsCache<span style=color:#f92672>.</span><span style=color:#a6e22e>UpdateCache</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>PsdImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;input.psd&#34;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;HasFont.psd&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2396 Provide setting for replacing missing fonts</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;testReplacementNotAvailableFonts.psd&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PsdLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> DefaultReplacementFont <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Arial&#34;</span> <span style=color:#f92672>}))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PsdImage psdImage <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>image<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>psdImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;result.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> ColorType <span style=color:#f92672>=</span> PngColorType<span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span> <span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2375 Add support for color replacement in PSD layers</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string fileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;photooverlay_5_new&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PngOptions pngOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> ColorType <span style=color:#f92672>=</span> PngColorType<span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span> <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>PsdImage input <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>fileName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.psd&#34;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>foreach <span style=color:#f92672>(</span>Layer layer in input<span style=color:#f92672>.</span><span style=color:#a6e22e>Layers</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>layer<span style=color:#f92672>.</span><span style=color:#a6e22e>Name</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Maincolor&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>layer<span style=color:#f92672>.</span><span style=color:#a6e22e>ReplaceNonTransparentColors</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>Orange</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>fileName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;_nonTransparentColors_result.png&#34;</span><span style=color:#f92672>,</span> pngOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>fileName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;_nonTransparentColors_result.psd&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>PsdImage input <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>fileName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.psd&#34;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>foreach <span style=color:#f92672>(</span>Layer layer in input<span style=color:#f92672>.</span><span style=color:#a6e22e>Layers</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>layer<span style=color:#f92672>.</span><span style=color:#a6e22e>Name</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Maincolor&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>layer<span style=color:#f92672>.</span><span style=color:#a6e22e>ReplaceColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>LightGreen</span><span style=color:#f92672>,</span> 40<span style=color:#f92672>,</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>Orange</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>fileName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;_specificColor_result.png&#34;</span><span style=color:#f92672>,</span> pngOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>fileName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;_specificColor_result.psd&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2043 Support for ODG (<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=OpenDocument&linkCreation=true&fromPageId=54133163">OpenDocument</a></strong> <strong>graphics)</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string<span style=color:#f92672>[]</span> files <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> string<span style=color:#f92672>[</span>2<span style=color:#f92672>]</span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#34;example.odg&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;example1.odg&#34;</span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string folder <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;D:\&#34;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>MetafileRasterizationOptions rasterizationOptions = new MetafileRasterizationOptions();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>foreach (string file in files)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>string fileName = Path.Combine(folder, file);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>using (Image image = Image.Load(fileName))
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>rasterizationOptions.PageSize = image.Size;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>string outFileName = fileName.Replace(&#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>odg</span><span style=color:#e6db74>&#34;, &#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>png</span><span style=color:#e6db74>&#34;);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>image.Save(outFileName,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>new PngOptions
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>VectorRasterizationOptions = rasterizationOptions
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>});
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>outFileName = fileName.Replace(&#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>odg</span><span style=color:#e6db74>&#34;, &#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>pdf</span><span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outFileName<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>new</span> PdfOptions
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>VectorRasterizationOptions <span style=color:#f92672>=</span> rasterizationOptions
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-1842 Support for the combination of</strong> <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=ColorType&linkCreation=true&fromPageId=54133163"><strong>ColorType</strong></a> <strong>as Grayscale &</strong> <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=CompressionType&linkCreation=true&fromPageId=54133163"><strong>CompressionType</strong></a> <strong>as Progressive for the</strong> <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=JpegOptions&linkCreation=true&fromPageId=54133163"><strong>JpegOptions</strong></a> <strong>class</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string sourcePath <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;c:\aspose.work\IMAGINGNET\1842\src.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outputPath <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;c:\aspose.work\IMAGINGNET\1842\out.jpg&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>JpegOptions jpegOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> JpegOptions<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ColorType <span style=color:#f92672>=</span> JpegCompressionColorMode<span style=color:#f92672>.</span><span style=color:#a6e22e>Grayscale</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>CompressionType <span style=color:#f92672>=</span> JpegCompressionMode<span style=color:#f92672>.</span><span style=color:#a6e22e>Progressive</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Quality <span style=color:#f92672>=</span> 100<span style=color:#f92672>,</span> <span style=color:#75715e>// make the output image bigger to observe progressive scanning :)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>sourcePath<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputPath<span style=color:#f92672>,</span> jpegOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2569 PSD Conversion CMYK to RGB with alpha channel doesn&rsquo;t work.</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string sourcePath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;CmykWithAlpha.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outputPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;RgbWithAlpha.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PsdOptions psdOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PsdOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>psdOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>ColorMode</span> <span style=color:#f92672>=</span> ColorModes<span style=color:#f92672>.</span><span style=color:#a6e22e>Rgb</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>psdOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>CompressionMethod</span> <span style=color:#f92672>=</span> CompressionMethod<span style=color:#f92672>.</span><span style=color:#a6e22e>RLE</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>RasterImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>RasterImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>sourcePath<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>LoadPixels</span><span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Bounds</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputPath<span style=color:#f92672>,</span> psdOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2546 Improperly computed</strong> <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=TiffFrame&linkCreation=true&fromPageId=54133163"><strong>TiffFrame</strong></a><strong>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=HorizontalResolution&linkCreation=true&fromPageId=54133163">HorizontalResolution</a></strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string sourcePath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sample.tif&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>TiffImage tiffImage <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>TiffImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>sourcePath<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>foreach <span style=color:#f92672>(</span>TiffFrame frame in tiffImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Frames</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Console<span style=color:#f92672>.</span><span style=color:#a6e22e>WriteLine</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;TiffFrame Resolution: {0}x{1}, TiffFrame Size: {2}x{3}&#34;</span><span style=color:#f92672>,</span> frame<span style=color:#f92672>.</span><span style=color:#a6e22e>HorizontalResolution</span><span style=color:#f92672>,</span> frame<span style=color:#f92672>.</span><span style=color:#a6e22e>VerticalResolution</span><span style=color:#f92672>,</span> frame<span style=color:#f92672>.</span><span style=color:#a6e22e>Width</span><span style=color:#f92672>,</span> frame<span style=color:#f92672>.</span><span style=color:#a6e22e>Height</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>MemoryStream ms <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> MemoryStream<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>frame<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>ms<span style=color:#f92672>,</span> frame<span style=color:#f92672>.</span><span style=color:#a6e22e>FrameOptions</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ms<span style=color:#f92672>.</span><span style=color:#a6e22e>Seek</span><span style=color:#f92672>(</span>0<span style=color:#f92672>,</span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>IO</span><span style=color:#f92672>.</span><span style=color:#a6e22e>SeekOrigin</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Begin</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>RasterImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>RasterImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>ms<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Console<span style=color:#f92672>.</span><span style=color:#a6e22e>WriteLine</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;RasterImage Resolution: {0}x{1}, RasterImage Size: {2}x{3}&#34;</span><span style=color:#f92672>,</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>HorizontalResolution</span><span style=color:#f92672>,</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>VerticalResolution</span><span style=color:#f92672>,</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Width</span><span style=color:#f92672>,</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Height</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2539 Improve performance the deconvolution filter in case low memory</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string inputFilePath <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;D:\coloredGaussImage.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outputFilePth <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;D:\partialColoredGaussImage.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> maxAllocatedMemory <span style=color:#f92672>=</span> 256 <span style=color:#f92672>*</span> 1024 <span style=color:#f92672>*</span> 1024<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>GaussWienerFilterOptions options <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> GaussWienerFilterOptions<span style=color:#f92672>(</span>35<span style=color:#f92672>,</span> 6<span style=color:#f92672>.</span><span style=color:#a6e22e>5</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Brightness <span style=color:#f92672>=</span> 1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>inputFilePath<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>RasterImage rasterImage <span style=color:#f92672>=</span> image as RasterImage<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>rasterImage <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>BlackBoxTestsController<span style=color:#f92672>.</span><span style=color:#a6e22e>SetMaxAllocatedBytesCount</span><span style=color:#f92672>(</span>maxAllocatedMemory<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rasterImage<span style=color:#f92672>.</span><span style=color:#a6e22e>Filter</span><span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Bounds</span><span style=color:#f92672>,</span> options<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>BlackBoxTestsController<span style=color:#f92672>.</span><span style=color:#a6e22e>SetMaxAllocatedBytesCount</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputFilePth<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2526 Converting DNG image into JPG provides output with light spots</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string folder <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;D:\dng\&#34;;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>string[] fileNames = new string[3] {&#34;</span>L1004220<span style=color:#f92672>.</span><span style=color:#a6e22e>DNG</span><span style=color:#e6db74>&#34;, &#34;</span>L1004235<span style=color:#f92672>.</span><span style=color:#a6e22e>DNG</span><span style=color:#e6db74>&#34;, &#34;</span>L1004432<span style=color:#f92672>.</span><span style=color:#a6e22e>DNG</span><span style=color:#e6db74>&#34;};
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>foreach (string fileName in fileNames)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>string inputFileName = Path.Combine(folder, fileName);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>string outFileName = inputFileName+&#34;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>jpg</span><span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>inputFileName<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outFileName<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> JpegOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2523 Improper text rendering in generated PNG</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> ResolutionSetting resSetting <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ResolutionSetting<span style=color:#f92672>(</span>120<span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>,</span> 120<span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PngOptions pngOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ColorType <span style=color:#f92672>=</span> PngColorType<span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ResolutionSettings <span style=color:#f92672>=</span> resSetting
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PsdOptions psdOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PsdOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> ResolutionSettings <span style=color:#f92672>=</span> resSetting <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>PsdImage image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;presentazione generale ritaglioLight.psd&#34;</span><span style=color:#f92672>)</span> as PsdImage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;result.png&#34;</span><span style=color:#f92672>,</span> pngOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;result.psd&#34;</span><span style=color:#f92672>,</span> psdOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2517 Some png files are incorrectly read with</strong> <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=LoadOptions&linkCreation=true&fromPageId=54133163"><strong>LoadOptions</strong></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;D:\sample.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> LoadOptions<span style=color:#f92672>()))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;D:\sample3.png&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2465 Aspose.Imaging 17.7.0: Adds evaluation message when loading SVG with venture licenser</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>WithLicense</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>SaveFile</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>WithoutLicense</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>SaveFile</span><span style=color:#f92672>(</span><span style=color:#66d9ef>false</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>SaveFile</span><span style=color:#f92672>(</span>bool license<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string fileName <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;auto.svg&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outFileName <span style=color:#f92672>=</span> license <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;withLicense.svg.png&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;withoutLicense.svg.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string folder <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;D:\&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string inputFile <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>folder<span style=color:#f92672>,</span> fileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outputFile <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>folder<span style=color:#f92672>,</span> outFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>License lic <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> License<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            lic<span style=color:#f92672>.</span><span style=color:#a6e22e>SetLicense</span><span style=color:#f92672>(</span>string<span style=color:#f92672>.</span><span style=color:#a6e22e>Empty</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>inputFile<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>license<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>VentureUnitTester<span style=color:#f92672>.</span><span style=color:#a6e22e>LicenseVenture</span><span style=color:#f92672>(</span>image<span style=color:#f92672>,</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PngOptions options <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span><span style=color:#a6e22e>VectorRasterizationOptions</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SvgRasterizationOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> PageSize <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Size</span> <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputFile<span style=color:#f92672>,</span> options<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2462 SVG is not properly converted PNG</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string inputFileName <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;D:\test.svg&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outFileName <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;D:\test.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>inputFileName<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> SvgLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> DefaultHeight <span style=color:#f92672>=</span> 1080<span style=color:#f92672>,</span> DefaultWidth <span style=color:#f92672>=</span> 1920 <span style=color:#f92672>}))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outFileName<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>VectorRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SvgRasterizationOptions<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PageSize <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>Size</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2387 Improve performance Jpeg decoder</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string<span style=color:#f92672>[]</span> files <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> string<span style=color:#f92672>[]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;cmyk.jpg&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;rgb.jpg&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;ycbcr.jpg&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;ycck.jpg&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;grayscale.jpg&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;H2V1FancyUpsampler.jpg&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string folder <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;Issues\IMAGINGNET-2387&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DateTime s1 <span style=color:#f92672>=</span> DateTime<span style=color:#f92672>.</span><span style=color:#a6e22e>Now</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>foreach <span style=color:#f92672>(</span>string file in files<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string fileName <span style=color:#f92672>=</span> Path<span style=color:#f92672>.</span><span style=color:#a6e22e>Combine</span><span style=color:#f92672>(</span>folder<span style=color:#f92672>,</span> file<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DateTime s <span style=color:#f92672>=</span> DateTime<span style=color:#f92672>.</span><span style=color:#a6e22e>Now</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> 10<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>fileName<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> pixels <span style=color:#f92672>=</span> <span style=color:#f92672>((</span>RasterImage<span style=color:#f92672>)</span>image<span style=color:#f92672>).</span><span style=color:#a6e22e>LoadArgb32Pixels</span><span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Bounds</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DateTime e <span style=color:#f92672>=</span> DateTime<span style=color:#f92672>.</span><span style=color:#a6e22e>Now</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Console<span style=color:#f92672>.</span><span style=color:#a6e22e>WriteLine</span><span style=color:#f92672>(</span>string<span style=color:#f92672>.</span><span style=color:#a6e22e>Format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;{0} - {1:0.00} sec&#34;</span><span style=color:#f92672>,</span> file<span style=color:#f92672>,</span> <span style=color:#f92672>(</span>e <span style=color:#f92672>-</span> s<span style=color:#f92672>).</span><span style=color:#a6e22e>TotalSeconds</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DateTime e1 <span style=color:#f92672>=</span> DateTime<span style=color:#f92672>.</span><span style=color:#a6e22e>Now</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Console<span style=color:#f92672>.</span><span style=color:#a6e22e>WriteLine</span><span style=color:#f92672>(</span>string<span style=color:#f92672>.</span><span style=color:#a6e22e>Format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Total duration - {0:0.00} sec&#34;</span><span style=color:#f92672>,</span> <span style=color:#f92672>(</span>e1 <span style=color:#f92672>-</span> s1<span style=color:#f92672>).</span><span style=color:#a6e22e>TotalSeconds</span><span style=color:#f92672>));</span></span></span></code></pre></div><p>On the current version, the value of &ldquo;Total duration&rdquo; should be 15-20% less than at version 17.9
For example: results on system (Windows 10, Intel Core I5 2500K, configuration - Debug)</p><table><thead><tr><th style=text-align:left><strong>Imaging Version</strong></th><th style=text-align:left><strong>cmyk.jpg</strong></th><th style=text-align:left><strong>rgb.jpg</strong></th><th style=text-align:left><strong>ycbcr.jpg</strong></th><th style=text-align:left><strong>ycck.jpg</strong></th><th style=text-align:left><strong>grayscale.jpg</strong></th><th style=text-align:left><a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=H2V1FancyUpsampler&linkCreation=true&fromPageId=54133163"><strong>H2V1FancyUpsampler</strong></a><strong>.jpg</strong></th><th style=text-align:left><strong>Total</strong></th></tr></thead><tbody><tr><td style=text-align:left><strong>17.9</strong></td><td style=text-align:left>9,75</td><td style=text-align:left>0,49</td><td style=text-align:left>0,21</td><td style=text-align:left>6,73</td><td style=text-align:left>0,13</td><td style=text-align:left>19,94</td><td style=text-align:left>37,26</td></tr><tr><td style=text-align:left><strong>current</strong></td><td style=text-align:left>8,35</td><td style=text-align:left>0,24</td><td style=text-align:left>0,16</td><td style=text-align:left>6,46</td><td style=text-align:left>0,11</td><td style=text-align:left>14,33</td><td style=text-align:left>29,66</td></tr><tr><td style=text-align:left><strong>percent</strong></td><td style=text-align:left>24.6</td><td style=text-align:left>51</td><td style=text-align:left>23.8</td><td style=text-align:left>4</td><td style=text-align:left>15.3</td><td style=text-align:left>28</td><td style=text-align:left>20.4</td></tr><tr><td style=text-align:left>Configuration Release:</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td style=text-align:left>Total duration (current version) = 13.1 sec</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td style=text-align:left>Total duration (17.9) = 15.5 sec</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td style=text-align:left>Percent = 15.5%</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><p><strong>IMAGINGNET-2379</strong> <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=UpdateText&linkCreation=true&fromPageId=54133163"><strong>UpdateText</strong></a> <strong>changes layer properties and fonts</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> using <span style=color:#f92672>(</span>PsdImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;asianSymbols.psd&#34;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>foreach <span style=color:#f92672>(</span>Layer layer in image<span style=color:#f92672>.</span><span style=color:#a6e22e>Layers</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>layer is TextLayer<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TextLayer textLayer <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>TextLayer<span style=color:#f92672>)</span>layer<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>UpdateText</span><span style=color:#f92672>(</span>textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>Text</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;test&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;asianSymbolsResult.psd&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PsdOptions <span style=color:#f92672>{</span> CompressionMethod <span style=color:#f92672>=</span> CompressionMethod<span style=color:#f92672>.</span><span style=color:#a6e22e>RLE</span> <span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;asianSymbolsResult.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{</span> ColorType <span style=color:#f92672>=</span> PngColorType<span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span> <span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-2361</strong> <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingnet&title=KeyNotFoundException&linkCreation=true&fromPageId=54133163"><strong>KeyNotFoundException</strong></a> <strong>when saving Psd image</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string path <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;John-OConnor_Spring-Reflections_example.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>RasterImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>RasterImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>path<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>path <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.psd&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PsdOptions<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ChannelsCount <span style=color:#f92672>=</span> 3<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>CompressionMethod <span style=color:#f92672>=</span> Imaging<span style=color:#f92672>.</span><span style=color:#a6e22e>FileFormats</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Psd</span><span style=color:#f92672>.</span><span style=color:#a6e22e>CompressionMethod</span><span style=color:#f92672>.</span><span style=color:#a6e22e>RLE</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGNET-1596 Dithering may work incorrectly when partial loading occurs</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> string sourcePath <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;c:\aspose.work\IMAGINGNET\1596\src.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string outputPath <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#e6db74>&#34;c:\aspose.work\IMAGINGNET\1596\out.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Setting some small value for this limit engages the partial loading mechanism.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> maxAllocatedColors <span style=color:#f92672>=</span> 15<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>using <span style=color:#f92672>(</span>RasterImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>RasterImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>Load</span><span style=color:#f92672>(</span>sourcePath<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Helpers<span style=color:#f92672>.</span><span style=color:#a6e22e>BlackBox</span><span style=color:#f92672>.</span><span style=color:#a6e22e>BlackBoxTestsController</span><span style=color:#f92672>.</span><span style=color:#a6e22e>SetMaxAllocatedColorsCount</span><span style=color:#f92672>(</span>maxAllocatedColors<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Only black and white pixels will be presented in the output image.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Dither</span><span style=color:#f92672>(</span>DitheringMethod<span style=color:#f92672>.</span><span style=color:#a6e22e>FloydSteinbergDithering</span><span style=color:#f92672>,</span> 1<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>Save</span><span style=color:#f92672>(</span>outputPath<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> Aspose<span style=color:#f92672>.</span><span style=color:#a6e22e>Imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>ImageOptions</span><span style=color:#f92672>.</span><span style=color:#a6e22e>PngOptions</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Helpers<span style=color:#f92672>.</span><span style=color:#a6e22e>BlackBox</span><span style=color:#f92672>.</span><span style=color:#a6e22e>BlackBoxTestsController</span><span style=color:#f92672>.</span><span style=color:#a6e22e>SetMaxAllocatedColorsCount</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p></div></div></div></div><hr></div></div></section></div></div></div></div></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>