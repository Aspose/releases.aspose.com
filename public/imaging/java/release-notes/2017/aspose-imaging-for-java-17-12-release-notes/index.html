<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.Imaging for Java 17.12 - Release Notes</title><meta name=description content="Aspose.Imaging for Java 17.12 - Release Notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/imaging/java/release-notes/2017/aspose-imaging-for-java-17-12-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/imaging/java/release-notes/2017/aspose-imaging-for-java-17-12-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.Imaging for Java 17.12 - Release Notes "><meta property="og:description" content="Aspose.Imaging for Java 17.12 - Release Notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/imaging/java/release-notes/2017/aspose-imaging-for-java-17-12-release-notes/"><meta itemprop=name content="Aspose.Imaging for Java 17.12 - Release Notes"><meta itemprop=description content="Aspose.Imaging for Java 17.12 - Release Notes – the latest updates and fixes."><meta itemprop=wordCount content="1531"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.Imaging for Java 17.12 - Release Notes"><meta name=twitter:description content="Aspose.Imaging for Java 17.12 - Release Notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/imaging/>Aspose.Imaging Product Family</a><span class=divider></span></li><li><a href=/imaging/java/>Aspose.Imaging for Java</a><span class=divider></span></li><li><a href=/imaging/java/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/imaging/java/release-notes/2017/>2017</a><span class=divider></span></li><li><a href=/imaging/java/release-notes/2017/aspose-imaging-for-java-17-12-release-notes/>Aspose.Imaging for Java 17.12 - Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><div class=container><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section"><div class=box1><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.Imaging for Java 17.12 - Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><table><thead><tr><th style=text-align:left><strong>Key</strong></th><th style=text-align:left><strong>Summary</strong></th><th style=text-align:left><strong>Category</strong></th></tr></thead><tbody><tr><td style=text-align:left>IMAGINGJAVA-849</td><td style=text-align:left>Support for converting CMYK PSD to CMYK TIFF</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGJAVA-870</td><td style=text-align:left>TypeTool6ResourceProcessor.ReplaceTextInGlobalResources does not work</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-869</td><td style=text-align:left>Incorrect condition statement in DgImage.RawProcess</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-868</td><td style=text-align:left>Incorrect condition statement in DgImage.Unpack</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-867</td><td style=text-align:left>Improve Djvu performance</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-866</td><td style=text-align:left>Corrupted DngImage.Width and DngImage.Height after calling the Image.GetPixel method</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-865</td><td style=text-align:left>GIF image is not properly converted to Png</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-864</td><td style=text-align:left>Incorrect number conversion in OpenDocument support class: OdEnhancedGeometryReader.ReadEnd</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-862</td><td style=text-align:left>Image exception on load TIFF image</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-861</td><td style=text-align:left>Improve memory usage of Jpeg fomat through improving work with buffer</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-860</td><td style=text-align:left>OpenTypeInfoCacheProcessor.UpdateFontsCacheFromFolders throws exception and breaks the work if there are zero files in Fonts directory</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-859</td><td style=text-align:left>Image saving failed when saving JPEG2000 as PNG</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-858</td><td style=text-align:left>Exception on converting emf to SVG</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-857</td><td style=text-align:left>Fix PSD crop operation</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-856</td><td style=text-align:left>Fix PSD test rendering for specific case</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-855</td><td style=text-align:left>Exception on saving TIFF Image</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-854</td><td style=text-align:left>GIF not properly converted to PNG</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-834</td><td style=text-align:left>When PSD is converted to PNG, an ArgumentOutOfRangeException occurs</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-783</td><td style=text-align:left>Darker colors and color reproducibility</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-618</td><td style=text-align:left>Converting EMF to PNG in not producing correct outpout</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-510</td><td style=text-align:left>EMF image export error</td><td style=text-align:left>Enhancement</td></tr></tbody></table><h1 id=public-api-changes><strong>Public API changes:</strong></h1><h2 id=added-apis><strong>Added APIs:</strong></h2><p>Please see corresponding cumulative <a href=/imaging/net/release-notes/2017/aspose-imaging-for-net-17-12-release-notes/>API changes for Aspose.Imaging for .Net 17.12</a> version</p><h2 id=removed-apis><strong>Removed APIs:</strong></h2><p><code> </code>Nothing</p><h1 id=usage-examples><strong>Usage examples:</strong></h1><p><strong>IMAGINGJAVA-849 Support for converting CMYK PSD to CMYK Tiff [Java]</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>test</span><span style=color:#f92672>()</span> <span style=color:#66d9ef>throws</span> IOException
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String folder <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\tiff\\&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//With IccProfile
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>psdToTiffCmyk</span><span style=color:#f92672>(</span>folder<span style=color:#f92672>,</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//Without IccProfile
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>psdToTiffCmyk</span><span style=color:#f92672>(</span>folder<span style=color:#f92672>,</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>psdToTiffCmyk</span><span style=color:#f92672>(</span>String folder<span style=color:#f92672>,</span> <span style=color:#66d9ef>boolean</span> isIccProfile<span style=color:#f92672>)</span> <span style=color:#66d9ef>throws</span> IOException
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String fileName <span style=color:#f92672>=</span> String<span style=color:#f92672>.</span><span style=color:#a6e22e>format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;cmyk_%b.tiff&#34;</span><span style=color:#f92672>,</span> isIccProfile<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String inputFile <span style=color:#f92672>=</span> folder <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;cmyk.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String inputIccFile <span style=color:#f92672>=</span> folder <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;JapanWebCoated.icc&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String outputFile <span style=color:#f92672>=</span> folder <span style=color:#f92672>+</span> fileName<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>inputFile<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>isIccProfile<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>FileInputStream f <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> FileInputStream<span style=color:#f92672>(</span>inputIccFile<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> icc <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>f<span style=color:#f92672>.</span><span style=color:#a6e22e>available</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span><span style=color:#a6e22e>read</span><span style=color:#f92672>(</span>icc<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outputFile<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> TiffOptions<span style=color:#f92672>(</span>TiffExpectedFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>TiffLzwCmyk</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>setIccProfile<span style=color:#f92672>(</span>icc<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outputFile<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> TiffOptions<span style=color:#f92672>(</span>TiffExpectedFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>TiffLzwCmyk</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-870</strong> <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingjava&title=TypeTool6ResourceProcessor&linkCreation=true&fromPageId=60229174"><strong>TypeTool6ResourceProcessor</strong></a><strong>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingjava&title=ReplaceTextInGlobalResources&linkCreation=true&fromPageId=60229174">ReplaceTextInGlobalResources</a></strong> <strong>does not work. [Java]</strong>
Fix is related to saving PSD metadata after text update (part of it was just not saved), which can be checked by working with updated PSD file directly from Photoshop. If export to other format was the case for you, just don&rsquo;t bother with it.
<strong>IMAGINGJAVA-869 Incorrect condition statement in</strong> <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingjava&title=DgImage&linkCreation=true&fromPageId=60229174"><strong>DgImage</strong></a><strong>.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingjava&title=RawProcess&linkCreation=true&fromPageId=60229174">RawProcess</a></strong> <strong>[Java]</strong>
input file: <a href="https://www.dropbox.com/s/1tdg0uswgq9q68e/Phantom1.DNG?dl=0">Phantom1.dng</a>
output file: <a href="https://www.dropbox.com/s/f1ewcskl8xol28y/Phantom1.png?dl=0">phantom1.png</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String inputFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\Phantom1.dng&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String outFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\Phantom1.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>inputFileName<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> DngLoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{{</span> setFbdd<span style=color:#f92672>(</span>NoiseReductionType<span style=color:#f92672>.</span><span style=color:#a6e22e>Full</span><span style=color:#f92672>);</span> <span style=color:#f92672>}});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outFileName<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-868 Incorrect condition statement in</strong> <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingjava&title=DgImage&linkCreation=true&fromPageId=60229174"><strong>DgImage</strong></a><strong>.Unpack [Java]</strong>
input file: <a href="https://www.dropbox.com/s/1tdg0uswgq9q68e/Phantom1.DNG?dl=0">Phantom1.dng</a>
output file: <a href="https://www.dropbox.com/s/f1ewcskl8xol28y/Phantom1.png?dl=0">phantom1.png</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String inputFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\Phantom1.dng&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String outFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\Phantom1.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>inputFileName<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> DngLoadOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outFileName<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-867 Improve Djvu performance [Java]</strong>
Time of execute in the current library less by 20% than in library 17.10.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String fileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;superhero.djvu&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String outputFile <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;result.tiff&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DjvuImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>DjvuImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>fileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TiffOptions exportOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> TiffOptions<span style=color:#f92672>(</span>TiffExpectedFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>Default</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>exportOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setMultiPageOptions</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> DjvuMultiPageOptions<span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> IntRange<span style=color:#f92672>(</span>0<span style=color:#f92672>,</span> 10<span style=color:#f92672>)));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outputFile<span style=color:#f92672>,</span> exportOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>exportOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><table><thead><tr><th style=text-align:left><strong>Configuration</strong></th><th style=text-align:left><strong>time in Current lib</strong></th><th style=text-align:left><strong>time in 17.10</strong></th></tr></thead><tbody><tr><td style=text-align:left>Core i5 10GB Win 10 x64</td><td style=text-align:left>10.905s</td><td style=text-align:left>13.317s</td></tr><tr><td style=text-align:left><strong>IMAGINGJAVA-866 Corrupted</strong> <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingjava&title=DngImage&linkCreation=true&fromPageId=60229174"><strong>DngImage</strong></a><strong>.Width and</strong> <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingjava&title=DngImage&linkCreation=true&fromPageId=60229174"><strong>DngImage</strong></a><strong>.Height after calling the Image.<a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingjava&title=GetPixel&linkCreation=true&fromPageId=60229174">GetPixel</a></strong> <strong>method. [Java]</strong></td><td></td><td></td></tr><tr><td style=text-align:left>input file: <a href="https://www.dropbox.com/s/zasvoi1brpys7pj/berries-raw.dng?dl=0">berries-raw</a></td><td></td><td></td></tr></tbody></table><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#66d9ef>int</span> expectedWidth<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> expectedHeight<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String inputFilename <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;berries-raw.dng&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String outFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;result.tiff&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DngImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>DngImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>inputFilename<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>expectedWidth <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>expectedHeight <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Color c <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getPixel</span><span style=color:#f92672>(</span>3303<span style=color:#f92672>,</span> 1787<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>c<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>expectedWidth <span style=color:#f92672>!=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span>String<span style=color:#f92672>.</span><span style=color:#a6e22e>format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Current file: Expected width = %d, Actual width = %d&#34;</span><span style=color:#f92672>,</span> expectedWidth<span style=color:#f92672>,</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>()));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>expectedHeight <span style=color:#f92672>!=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span>String<span style=color:#f92672>.</span><span style=color:#a6e22e>format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Current file: Expected height = %d, Actual height = %d&#34;</span><span style=color:#f92672>,</span> expectedHeight<span style=color:#f92672>,</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>()));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>outFileName<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>new</span> TiffOptions<span style=color:#f92672>(</span>TiffExpectedFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>TiffNoCompressionRgb</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Image image2 <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>outFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>expectedWidth <span style=color:#f92672>!=</span> image2<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span>String<span style=color:#f92672>.</span><span style=color:#a6e22e>format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Result file: Expected width = %d, Actual width = %d&#34;</span><span style=color:#f92672>,</span> expectedWidth<span style=color:#f92672>,</span> image2<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>()));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>expectedHeight <span style=color:#f92672>!=</span> image2<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span>String<span style=color:#f92672>.</span><span style=color:#a6e22e>format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Result file: Expected height = %d, Actual height = %d&#34;</span><span style=color:#f92672>,</span> expectedHeight<span style=color:#f92672>,</span> image2<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>()));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image2<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-865 Gif image is not properly converted to Png [Java]</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String path <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;transbugs.gif&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Image m_oDocument <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>path<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> m_iResolution <span style=color:#f92672>=</span> 98<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PngOptions OptionsIM <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>OptionsIM<span style=color:#f92672>.</span><span style=color:#a6e22e>setColorType</span><span style=color:#f92672>(</span>PngColorType<span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ResolutionSetting oResIM <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ResolutionSetting<span style=color:#f92672>(</span>m_iResolution<span style=color:#f92672>,</span> m_iResolution<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>OptionsIM<span style=color:#f92672>.</span><span style=color:#a6e22e>setResolutionSettings</span><span style=color:#f92672>(</span>oResIM<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>m_oDocument<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>path <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.png&#34;</span><span style=color:#f92672>,</span> OptionsIM<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>m_oDocument<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p>**IMAGINGJAVA-864 Incorrect number conversion in <strong>OpenDocument</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> Locale loc <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Locale<span style=color:#f92672>(</span> <span style=color:#e6db74>&#34;ru&#34;</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;RU&#34;</span> <span style=color:#f92672>)</span> <span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Locale<span style=color:#f92672>.</span><span style=color:#a6e22e>setDefault</span><span style=color:#f92672>(</span> loc <span style=color:#f92672>)</span> <span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String inputFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\Odg\\modifiersTest.odg&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String outputFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\Odg\\modifiersTest.pdf&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ImageOptionsBase options <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PdfOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>final</span> OdgImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>OdgImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>inputFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span><span style=color:#a6e22e>setVectorRasterizationOptions</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> MetafileRasterizationOptions<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>setPageWidth<span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>setPageHeight<span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outputFileName<span style=color:#f92672>,</span> options<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-862 Image exception on load Tiff image [Java]</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String inputFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\posterUfficio_crop.tif&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String outFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\posterUfficio_crop.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>inputFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outFileName<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-859 Image saving failed when saving JPEG2000 as PNG [Java]</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String inputImage <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Input.jp2&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String outputImage <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Ouput.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>inputImage<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outputImage<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-858 Exception on converting emf to svg [Java]</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String path <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;C:\\Temp\\Errors\\&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>path <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;powerpoint_emf.emf&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>final</span> EmfRasterizationOptions emfRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> EmfRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>emfRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setBackgroundColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getWhite</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>emfRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPageWidth</span><span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>emfRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPageHeight</span><span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>path <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;owerpoint_emf.svg&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> SvgOptions<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>setVectorRasterizationOptions<span style=color:#f92672>(</span>emfRasterizationOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-857 Fix PSD crop operation [Java]</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> PsdLoadOptions psdLoadOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PsdLoadOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>psdLoadOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setLoadEffectsResource</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PsdImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;MSFT_DevEva_Web_Twitter-800x320_2-DVG.PSD&#34;</span><span style=color:#f92672>,</span> psdLoadOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Rectangle rect <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Rectangle<span style=color:#f92672>(</span>10<span style=color:#f92672>,</span> 30<span style=color:#f92672>,</span> 100<span style=color:#f92672>,</span> 100<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>crop</span><span style=color:#f92672>(</span>rect<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;MSFT_DevEva_Web_Twitter-800x320_2-DVG_new_ethalon.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{{</span> setColorType<span style=color:#f92672>(</span>PngColorType<span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span><span style=color:#f92672>);</span> <span style=color:#f92672>}});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-856 Fix PSD test rendering for specific case [Java]</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> PsdImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;1.psd&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;1.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{{</span> setColorType<span style=color:#f92672>(</span>PngColorType<span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span><span style=color:#f92672>);</span> <span style=color:#f92672>}});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-855 Exception on saving Tiff Image [Java]</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String sourceFilePath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Carelogic-1-11082017-3016-CH.tif&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String outputFilePath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Carelogic-1-11082017-3016-CH Out.tif&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> resolution <span style=color:#f92672>=</span> 96<span style=color:#f92672>;</span> <span style=color:#75715e>// Set the output resolution to some non-zero value!
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>RasterImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>RasterImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>sourceFilePath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TiffOptions saveOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> TiffOptions<span style=color:#f92672>(</span>TiffExpectedFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>Default</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setResolutionSettings</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> ResolutionSetting<span style=color:#f92672>(</span>resolution<span style=color:#f92672>,</span> resolution<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setCompression</span><span style=color:#f92672>(</span>TiffCompressions<span style=color:#f92672>.</span><span style=color:#a6e22e>None</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setBitsPerSample</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> <span style=color:#f92672>{</span> 1 <span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> width <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>()</span> <span style=color:#f92672>*</span> resolution <span style=color:#f92672>/</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span><span style=color:#f92672>)</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getHorizontalResolution</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> height <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>()</span> <span style=color:#f92672>*</span> resolution <span style=color:#f92672>/</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span><span style=color:#f92672>)</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getVerticalResolution</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>resize</span><span style=color:#f92672>(</span>width<span style=color:#f92672>,</span> height<span style=color:#f92672>);</span> <span style=color:#75715e>// No more exception here!
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outputFilePath<span style=color:#f92672>,</span> saveOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-854 Gif not properly converted to png [Java]</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;6.gif&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>file<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>file <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-834 When PSD is converted to PNG, an</strong> <a href="https://docs.aspose.com/pages/createpage.action?spaceKey=imagingjava&title=ArgumentOutOfRangeException&linkCreation=true&fromPageId=60229174"><strong>ArgumentOutOfRangeException</strong></a> <strong>occurs</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> PsdImage input <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Cloud_AzPlat_Banner3A_SB_EN_US_160x600.psd&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TextLayer textLayer<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>Layer layer <span style=color:#f92672>:</span> input<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>layer <span style=color:#66d9ef>instanceof</span> TextLayer<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>textLayer <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>TextLayer<span style=color:#f92672>)</span>layer<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>textLayer<span style=color:#f92672>.</span><span style=color:#a6e22e>updateText</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;123\u0003abc&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Cloud_AzPlat_Banner3A_SB_EN_US_160x600_updated.psd&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PsdOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{{</span> setCompressionMethod<span style=color:#f92672>(</span>CompressionMethod<span style=color:#f92672>.</span><span style=color:#a6e22e>RLE</span><span style=color:#f92672>);</span> <span style=color:#f92672>}});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>input <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span>Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Cloud_AzPlat_Banner3A_SB_EN_US_160x600_updated.psd&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Cloud_AzPlat_Banner3A_SB_EN_US_160x600_updated.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{{</span> setColorType<span style=color:#f92672>(</span>PngColorType<span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span><span style=color:#f92672>);</span> <span style=color:#f92672>}});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>input<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-783 Darker colors and color reproducibility</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>test783</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>License l <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> License<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>l<span style=color:#f92672>.</span><span style=color:#a6e22e>setLicense</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Aspose.Imaging.Java.lic&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String path <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;C:\\Temp\\Errors\\783\\&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Load Tiff image with embedded Icc
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String embeddedIccProfileTiff <span style=color:#f92672>=</span> path <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;Cmyk-CmykProfile.tif&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TiffImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>TiffImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>embeddedIccProfileTiff<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// get icc by tag
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>TiffDataType tag <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getActiveFrame</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getFrameOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getTagByType</span><span style=color:#f92672>(</span>TiffTags<span style=color:#f92672>.</span><span style=color:#a6e22e>IccProfile</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> profileStream <span style=color:#f92672>=</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[])</span> tag<span style=color:#f92672>.</span><span style=color:#a6e22e>getValue</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>AssertProfile<span style=color:#f92672>(</span>profileStream<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// icc property
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> profileStream2 <span style=color:#f92672>=</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getActiveFrame</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getFrameOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getIccProfile</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Must be the same
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>Compare<span style=color:#f92672>(</span>profileStream<span style=color:#f92672>,</span> profileStream2<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>AssertProfile<span style=color:#f92672>(</span>profileStream2<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Load Psd image with embedded Icc
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String embeddedIccProfilePsd <span style=color:#f92672>=</span> path <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;NavyExchangeCmyk.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PsdImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>embeddedIccProfilePsd<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>com<span style=color:#f92672>.</span><span style=color:#a6e22e>aspose</span><span style=color:#f92672>.</span><span style=color:#a6e22e>imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>system</span><span style=color:#f92672>.</span><span style=color:#a6e22e>io</span><span style=color:#f92672>.</span><span style=color:#a6e22e>MemoryStream</span> profileStream <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>com<span style=color:#f92672>.</span><span style=color:#a6e22e>aspose</span><span style=color:#f92672>.</span><span style=color:#a6e22e>imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>system</span><span style=color:#f92672>.</span><span style=color:#a6e22e>io</span><span style=color:#f92672>.</span><span style=color:#a6e22e>MemoryStream</span><span style=color:#f92672>)</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getCmykColorProfile</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getStream</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>AssertProfile<span style=color:#f92672>(</span>profileStream<span style=color:#f92672>.</span><span style=color:#a6e22e>toArray</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Convert Psd image with embedded Cmyk Icc to Tiff with embedded Cmyk Icc
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String embeddedIccProfilePsd <span style=color:#f92672>=</span> path <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;NavyExchangeCmyk.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>final</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> sourceIccData<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PsdImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>embeddedIccProfilePsd<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TiffOptions options <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> TiffOptions<span style=color:#f92672>(</span>TiffExpectedFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>TiffLzwRgba</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// add Icc profile tag
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>sourceIccData <span style=color:#f92672>=</span> <span style=color:#f92672>((</span>com<span style=color:#f92672>.</span><span style=color:#a6e22e>aspose</span><span style=color:#f92672>.</span><span style=color:#a6e22e>imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>system</span><span style=color:#f92672>.</span><span style=color:#a6e22e>io</span><span style=color:#f92672>.</span><span style=color:#a6e22e>MemoryStream</span><span style=color:#f92672>)</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getCmykColorProfile</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getStream</span><span style=color:#f92672>()).</span><span style=color:#a6e22e>toArray</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TiffUndefinedType tmp <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> TiffUndefinedType<span style=color:#f92672>(</span>TiffTags<span style=color:#f92672>.</span><span style=color:#a6e22e>IccProfile</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>tmp<span style=color:#f92672>.</span><span style=color:#a6e22e>setData</span><span style=color:#f92672>(</span>sourceIccData<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>options<span style=color:#f92672>.</span><span style=color:#a6e22e>addTag</span><span style=color:#f92672>(</span>tmp<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>embeddedIccProfilePsd <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;_output.tiff&#34;</span><span style=color:#f92672>,</span> options<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// verify
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>TiffImage image2 <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>TiffImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>embeddedIccProfilePsd <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;_output.tiff&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> profileStream <span style=color:#f92672>=</span> image2<span style=color:#f92672>.</span><span style=color:#a6e22e>getActiveFrame</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getFrameOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getIccProfile</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>AssertProfile<span style=color:#f92672>(</span>profileStream<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Assert<span style=color:#f92672>.</span><span style=color:#a6e22e>assertTrue</span><span style=color:#f92672>(</span>Compare<span style=color:#f92672>(</span>profileStream<span style=color:#f92672>,</span> sourceIccData<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image2<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>AssertProfile</span><span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> profileStream<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>msAssert<span style=color:#f92672>.</span><span style=color:#a6e22e>isNotNull</span><span style=color:#f92672>(</span>profileStream<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>msAssert<span style=color:#f92672>.</span><span style=color:#a6e22e>isFalse</span><span style=color:#f92672>(</span>Compare<span style=color:#f92672>(</span>profileStream<span style=color:#f92672>,</span> IccProfileHelper<span style=color:#f92672>.</span><span style=color:#a6e22e>getDefaultCmykProfile</span><span style=color:#f92672>()));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>msAssert<span style=color:#f92672>.</span><span style=color:#a6e22e>isFalse</span><span style=color:#f92672>(</span>Compare<span style=color:#f92672>(</span>profileStream<span style=color:#f92672>,</span> IccProfileHelper<span style=color:#f92672>.</span><span style=color:#a6e22e>getDefaultRgbProfile</span><span style=color:#f92672>()));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>Compare</span><span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> data1<span style=color:#f92672>,</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> data2<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>data1<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span> <span style=color:#f92672>!=</span> data2<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> data2<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>data1<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>!=</span> data2<span style=color:#f92672>[</span>i<span style=color:#f92672>])</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>IccProfileHelper</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>\* &lt;p&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>\* The cmyk profile path.
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>\* &lt;/p&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> String CmykProfilePath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;com/aspose/imaging/internal/System/Drawing/rswop.icm&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>\* &lt;p&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>\* The rgb profile path.
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>\* &lt;/p&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> String RgbProfilePath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;com/aspose/imaging/internal/System/Drawing/sRGB_v4_ICC_preference_displayclass.icc&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> <span style=color:#a6e22e>getDefaultCmykProfile</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> getResource<span style=color:#f92672>(</span>CmykProfilePath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> <span style=color:#a6e22e>getDefaultRgbProfile</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> getResource<span style=color:#f92672>(</span>RgbProfilePath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> <span style=color:#a6e22e>getResource</span><span style=color:#f92672>(</span>String resourceName<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>InputStream stream <span style=color:#f92672>=</span> com<span style=color:#f92672>.</span><span style=color:#a6e22e>aspose</span><span style=color:#f92672>.</span><span style=color:#a6e22e>imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Image</span><span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>.</span><span style=color:#a6e22e>getClassLoader</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getResourceAsStream</span><span style=color:#f92672>(</span>resourceName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>stream <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Error loading icc profile resource&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> buffer <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#75715e>/*Byte*/</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>stream<span style=color:#f92672>.</span><span style=color:#a6e22e>available</span><span style=color:#f92672>()];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>stream<span style=color:#f92672>.</span><span style=color:#a6e22e>read</span><span style=color:#f92672>(</span>buffer<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> buffer<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>IOException e<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> FrameworkException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Error loading icc profile resource&#34;</span><span style=color:#f92672>,</span> e<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-618 Converting EMF to PNG in not producing correct outpout</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;image13.emf&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>final</span> Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>file<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>final</span> EmfRasterizationOptions vectorRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> EmfRasterizationOptions<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>setPageWidth<span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>setPageHeight<span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>file <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.Png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>setVectorRasterizationOptions<span style=color:#f92672>(</span>vectorRasterizationOptions<span style=color:#f92672>);</span> <span style=color:#f92672>}});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-510 Emf image export error</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String filePath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Picture1.emf&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String outPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Picture1&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Image mf <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>filePath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>EmfRasterizationOptions emfRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> EmfRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>emfRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setBackgroundColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getGray</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>emfRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPageWidth</span><span style=color:#f92672>(</span>mf<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>emfRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPageHeight</span><span style=color:#f92672>(</span>mf<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PngOptions pngOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pngOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setVectorRasterizationOptions</span><span style=color:#f92672>(</span>emfRasterizationOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mf<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outPath <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;_IMAGINGNET-2007.png&#34;</span><span style=color:#f92672>,</span> pngOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>emfRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPageWidth</span><span style=color:#f92672>(</span>100<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>emfRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPageHeight</span><span style=color:#f92672>(</span>100<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mf<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outPath <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;_IMAGINGNET-2007_small.png&#34;</span><span style=color:#f92672>,</span> pngOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>finally</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mf<span style=color:#f92672>.</span><span style=color:#a6e22e>dispose</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p></div></div></div></div><hr></div></div></section></div></div></div></div></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>