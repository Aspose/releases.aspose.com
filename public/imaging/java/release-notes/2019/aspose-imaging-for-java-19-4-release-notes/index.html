<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.Imaging for Java 19.4 - Release Notes</title><meta name=description content="Aspose.Imaging for Java 19.4 - Release Notes – the latest updates and fixes."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/imaging/java/release-notes/2019/aspose-imaging-for-java-19-4-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/imaging/java/release-notes/2019/aspose-imaging-for-java-19-4-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.Imaging for Java 19.4 - Release Notes "><meta property="og:description" content="Aspose.Imaging for Java 19.4 - Release Notes – the latest updates and fixes."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/imaging/java/release-notes/2019/aspose-imaging-for-java-19-4-release-notes/"><meta itemprop=name content="Aspose.Imaging for Java 19.4 - Release Notes"><meta itemprop=description content="Aspose.Imaging for Java 19.4 - Release Notes – the latest updates and fixes."><meta itemprop=wordCount content="2197"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.Imaging for Java 19.4 - Release Notes"><meta name=twitter:description content="Aspose.Imaging for Java 19.4 - Release Notes – the latest updates and fixes."><link href=/css/bootstrap.css rel=stylesheet type=text/css preload><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/imaging/>Aspose.Imaging Product Family</a><span class=divider></span></li><li><a href=/imaging/java/>Aspose.Imaging for Java</a><span class=divider></span></li><li><a href=/imaging/java/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/imaging/java/release-notes/2019/>2019</a><span class=divider></span></li><li><a href=/imaging/java/release-notes/2019/aspose-imaging-for-java-19-4-release-notes/>Aspose.Imaging for Java 19.4 - Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><section role=main class="container main-container page-package-details"><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section package-details-main"><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.Imaging for Java 19.4 - Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><div class="alert alert-primary" role=alert>This page contains release notes for Aspose.Imaging for Java 19.4</div><table><thead><tr><th style=text-align:left><strong>Key</strong></th><th style=text-align:left><strong>Summary</strong></th><th style=text-align:left><strong>Category</strong></th></tr></thead><tbody><tr><td style=text-align:left>IMAGINGJAVA-1248</td><td style=text-align:left>Add Device Independent Bitmap File (.dib) file format support</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGJAVA-1247</td><td style=text-align:left>How to apply masking to a raster image</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGJAVA-1249</td><td style=text-align:left>Add new  properties to VectorRasterizationOptions</td><td style=text-align:left>Feature</td></tr><tr><td style=text-align:left>IMAGINGJAVA-1233</td><td style=text-align:left>PSD performance fell down several times</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-1288</td><td style=text-align:left>The unhandled exception raises while loading WMF image</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-1257</td><td style=text-align:left>Fix CDR FileFormat: it is set to Undefined instead of CDR</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-1224</td><td style=text-align:left>Large memory consumption while loading PNG image</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-1252</td><td style=text-align:left>Extend support for loading fonts from custom directories to SVG format</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-1251</td><td style=text-align:left>Incorrect conversion of specific WMF images to SVG and PNG</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-1258</td><td style=text-align:left>CmxRasterizationOptions size settings do not work</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-1292</td><td style=text-align:left>Backport Aspose.PSD code to Aspose.Imaging Q1/2019</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>IMAGINGJAVA-1256</td><td style=text-align:left>Preserve transparency converting TIFF image to transparent PNG with resize</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>IMAGINGJAVA-1250</td><td style=text-align:left>Saving EMF as SVG the resulting transformation is incorrect</td><td style=text-align:left>Bug</td></tr></tbody></table><h1 id=public-api-changes><strong>Public API changes:</strong></h1><h2 id=added-apis><strong>Added APIs:</strong></h2><p>Please see corresponding cumulative <a href=/imaging/net/release-notes/2019/aspose-imaging-for-net-19-4-release-notes/>API changes for Aspose.Imaging for .NET 19.4</a> version</p><h2 id=removed-apis><strong>Removed APIs:</strong></h2><p>No Change</p><h1 id=usage-examples><strong>Usage examples:</strong></h1><p><strong>IMAGINGJAVA-1248 Add Device Independent Bitmap File (.dib) file format support</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;sample.dib&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>FileFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>(</span>FileFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>,</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getFileFormat</span><span style=color:#f92672>()));</span> <span style=color:#75715e>// Output is &#34;Bmp&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;sample.png&#34;</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-1247 How to apply masking to a raster image</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#75715e>// Runs the manual segmentation algorithm which is used user-defined shapes
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>doManualImageMasking</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> String sourceFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Colored by Faith_small.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> String outputFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Colored by Faith_small_manual.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> GraphicsPath manualMask <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> GraphicsPath<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> Figure firstFigure <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Figure<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> firstFigure<span style=color:#f92672>.</span><span style=color:#a6e22e>addShape</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> EllipseShape<span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> RectangleF<span style=color:#f92672>(</span>100<span style=color:#f92672>,</span> 30<span style=color:#f92672>,</span> 40<span style=color:#f92672>,</span> 40<span style=color:#f92672>)));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> firstFigure<span style=color:#f92672>.</span><span style=color:#a6e22e>addShape</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> RectangleShape<span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> RectangleF<span style=color:#f92672>(</span>10<span style=color:#f92672>,</span> 200<span style=color:#f92672>,</span> 50<span style=color:#f92672>,</span> 30<span style=color:#f92672>)));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> manualMask<span style=color:#f92672>.</span><span style=color:#a6e22e>addFigure</span><span style=color:#f92672>(</span>firstFigure<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> GraphicsPath subPath <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> GraphicsPath<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> Figure secondFigure <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Figure<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> secondFigure<span style=color:#f92672>.</span><span style=color:#a6e22e>addShape</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>new</span> PolygonShape<span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> PointF<span style=color:#f92672>[]</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>new</span> PointF<span style=color:#f92672>(</span>310<span style=color:#f92672>,</span> 100<span style=color:#f92672>),</span> <span style=color:#66d9ef>new</span> PointF<span style=color:#f92672>(</span>350<span style=color:#f92672>,</span> 200<span style=color:#f92672>),</span> <span style=color:#66d9ef>new</span> PointF<span style=color:#f92672>(</span>250<span style=color:#f92672>,</span> 200<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>},</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> secondFigure<span style=color:#f92672>.</span><span style=color:#a6e22e>addShape</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> PieShape<span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> RectangleF<span style=color:#f92672>(</span>10<span style=color:#f92672>,</span> 10<span style=color:#f92672>,</span> 80<span style=color:#f92672>,</span> 80<span style=color:#f92672>),</span> 30<span style=color:#f92672>,</span> 120<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> subPath<span style=color:#f92672>.</span><span style=color:#a6e22e>addFigure</span><span style=color:#f92672>(</span>secondFigure<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> manualMask<span style=color:#f92672>.</span><span style=color:#a6e22e>addPath</span><span style=color:#f92672>(</span>subPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> RasterImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>RasterImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>sourceFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  MaskingOptions maskingOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> MaskingOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  maskingOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setMethod</span><span style=color:#f92672>(</span>SegmentationMethod<span style=color:#f92672>.</span><span style=color:#a6e22e>Manual</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  maskingOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setDecompose</span><span style=color:#f92672>(</span><span style=color:#66d9ef>false</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  ManualMaskingArgs args <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ManualMaskingArgs<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  args<span style=color:#f92672>.</span><span style=color:#a6e22e>setMask</span><span style=color:#f92672>(</span>manualMask<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  maskingOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setArgs</span><span style=color:#f92672>(</span>args<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  PngOptions options <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  options<span style=color:#f92672>.</span><span style=color:#a6e22e>setColorType</span><span style=color:#f92672>(</span>PngColorType<span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  options<span style=color:#f92672>.</span><span style=color:#a6e22e>setSource</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> StreamSource<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  maskingOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setExportOptions</span><span style=color:#f92672>(</span>options<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  MaskingResult<span style=color:#f92672>[]</span> maskingResults <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ImageMasking<span style=color:#f92672>(</span>image<span style=color:#f92672>).</span><span style=color:#a6e22e>decompose</span><span style=color:#f92672>(</span>maskingOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Image resultImage <span style=color:#f92672>=</span> maskingResults<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getImage</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   resultImage<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outputFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   resultImage<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  image<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Runs the automatic segmentation algorithm with pre-prepared points (as emulation of the user input in the interactive masking session)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>doAutoImageMasking</span><span style=color:#f92672>()</span> <span style=color:#66d9ef>throws</span> IOException <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> String sourceFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Colored by Faith_small.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> String inputPointsFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Java_ColoredByFaith_small.dat&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> AutoMaskingArgs maskingArgs <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> AutoMaskingArgs<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> fillInputPoints<span style=color:#f92672>(</span>inputPointsFileName<span style=color:#f92672>,</span> maskingArgs<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> String outputFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Colored by Faith_small_auto.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> RasterImage image <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>RasterImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>sourceFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  MaskingOptions maskingOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> MaskingOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  maskingOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setMethod</span><span style=color:#f92672>(</span>SegmentationMethod<span style=color:#f92672>.</span><span style=color:#a6e22e>GraphCut</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  maskingOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setArgs</span><span style=color:#f92672>(</span>maskingArgs<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  maskingOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setDecompose</span><span style=color:#f92672>(</span><span style=color:#66d9ef>false</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  PngOptions options <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  options<span style=color:#f92672>.</span><span style=color:#a6e22e>setColorType</span><span style=color:#f92672>(</span>PngColorType<span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  options<span style=color:#f92672>.</span><span style=color:#a6e22e>setSource</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> StreamSource<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  maskingOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setExportOptions</span><span style=color:#f92672>(</span>options<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  MaskingResult<span style=color:#f92672>[]</span> maskingResults <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ImageMasking<span style=color:#f92672>(</span>image<span style=color:#f92672>).</span><span style=color:#a6e22e>decompose</span><span style=color:#f92672>(</span>maskingOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Image resultImage <span style=color:#f92672>=</span> maskingResults<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getImage</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   resultImage<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outputFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   resultImage<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  image<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e> * &lt;p&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e> *     Fills the input points.
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e> * &lt;/p&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param filePath The file path.
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @param autoMaskingArgs The automatic masking arguments.
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>fillInputPoints</span><span style=color:#f92672>(</span>String filePath<span style=color:#f92672>,</span> AutoMaskingArgs autoMaskingArgs<span style=color:#f92672>)</span> <span style=color:#66d9ef>throws</span> IOException <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> InputStream inputStream <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> FileInputStream<span style=color:#f92672>(</span>filePath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  LEIntegerReader reader <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> LEIntegerReader<span style=color:#f92672>(</span>inputStream<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>boolean</span> hasObjectRectangles <span style=color:#f92672>=</span> inputStream<span style=color:#f92672>.</span><span style=color:#a6e22e>read</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>boolean</span> hasObjectPoints <span style=color:#f92672>=</span> inputStream<span style=color:#f92672>.</span><span style=color:#a6e22e>read</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  autoMaskingArgs<span style=color:#f92672>.</span><span style=color:#a6e22e>setObjectsRectangles</span><span style=color:#f92672>(</span><span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  autoMaskingArgs<span style=color:#f92672>.</span><span style=color:#a6e22e>setObjectsPoints</span><span style=color:#f92672>(</span><span style=color:#66d9ef>null</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>hasObjectRectangles<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>int</span> len <span style=color:#f92672>=</span> reader<span style=color:#f92672>.</span><span style=color:#a6e22e>read</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Rectangle<span style=color:#f92672>[]</span> rects <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Rectangle<span style=color:#f92672>[</span>len<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> len<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// firstly Y
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> y <span style=color:#f92672>=</span> reader<span style=color:#f92672>.</span><span style=color:#a6e22e>read</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// secondly X
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> x <span style=color:#f92672>=</span> reader<span style=color:#f92672>.</span><span style=color:#a6e22e>read</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// width
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> width <span style=color:#f92672>=</span> reader<span style=color:#f92672>.</span><span style=color:#a6e22e>read</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// height
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> height <span style=color:#f92672>=</span> reader<span style=color:#f92672>.</span><span style=color:#a6e22e>read</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    rects<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Rectangle<span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>,</span> width<span style=color:#f92672>,</span> height<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   autoMaskingArgs<span style=color:#f92672>.</span><span style=color:#a6e22e>setObjectsRectangles</span><span style=color:#f92672>(</span>rects<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>hasObjectPoints<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>int</span> len <span style=color:#f92672>=</span> reader<span style=color:#f92672>.</span><span style=color:#a6e22e>read</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Point<span style=color:#f92672>[][]</span> points <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Point<span style=color:#f92672>[</span>len<span style=color:#f92672>][];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> len<span style=color:#f92672>;</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> il <span style=color:#f92672>=</span> reader<span style=color:#f92672>.</span><span style=color:#a6e22e>read</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    points<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Point<span style=color:#f92672>[</span>il<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> j <span style=color:#f92672>&lt;</span> il<span style=color:#f92672>;</span> j<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     <span style=color:#66d9ef>int</span> x <span style=color:#f92672>=</span> reader<span style=color:#f92672>.</span><span style=color:#a6e22e>read</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     <span style=color:#66d9ef>int</span> y <span style=color:#f92672>=</span> reader<span style=color:#f92672>.</span><span style=color:#a6e22e>read</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     points<span style=color:#f92672>[</span>i<span style=color:#f92672>][</span>j<span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Point<span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   autoMaskingArgs<span style=color:#f92672>.</span><span style=color:#a6e22e>setObjectsPoints</span><span style=color:#f92672>(</span>points<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  inputStream<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>LEIntegerReader</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>private</span> InputStream stream<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> buffer <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[</span>4<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> LEIntegerReader<span style=color:#f92672>(</span>InputStream stream<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>stream</span> <span style=color:#f92672>=</span> stream<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>read</span><span style=color:#f92672>()</span> <span style=color:#66d9ef>throws</span> IOException <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> len <span style=color:#f92672>=</span> stream<span style=color:#f92672>.</span><span style=color:#a6e22e>read</span><span style=color:#f92672>(</span>buffer<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>len <span style=color:#f92672>!=</span> 4<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Unexpected EOF&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#f92672>((</span>buffer<span style=color:#f92672>[</span>3<span style=color:#f92672>]</span> <span style=color:#f92672>&amp;</span> 0xff<span style=color:#f92672>)</span> <span style=color:#f92672>&lt;&lt;</span> 24<span style=color:#f92672>)</span> <span style=color:#f92672>|</span> <span style=color:#f92672>((</span>buffer<span style=color:#f92672>[</span>2<span style=color:#f92672>]</span> <span style=color:#f92672>&amp;</span> 0xff<span style=color:#f92672>)</span> <span style=color:#f92672>&lt;&lt;</span> 16<span style=color:#f92672>)</span> <span style=color:#f92672>|</span> <span style=color:#f92672>((</span>buffer<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> <span style=color:#f92672>&amp;</span> 0xff<span style=color:#f92672>)</span> <span style=color:#f92672>&lt;&lt;</span> 8<span style=color:#f92672>)</span> <span style=color:#f92672>|</span> <span style=color:#f92672>(</span>buffer<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> <span style=color:#f92672>&amp;</span> 0xFF<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-1249 Add new  properties to VectorRasterizationOptions</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String basePath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\TextHintTest\\&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String<span style=color:#f92672>[]</span> files <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> String<span style=color:#f92672>[]</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;TextHintTest.cdr&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;TextHintTest.cmx&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;TextHintTest.emf&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;TextHintTest.wmf&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;TextHintTest.odg&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;TextHintTest.svg&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> textRenderingHints <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> TextRenderingHint<span style=color:#f92672>.</span><span style=color:#a6e22e>AntiAlias</span><span style=color:#f92672>,</span> TextRenderingHint<span style=color:#f92672>.</span><span style=color:#a6e22e>AntiAliasGridFit</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  TextRenderingHint<span style=color:#f92672>.</span><span style=color:#a6e22e>ClearTypeGridFit</span><span style=color:#f92672>,</span> TextRenderingHint<span style=color:#f92672>.</span><span style=color:#a6e22e>SingleBitPerPixel</span><span style=color:#f92672>,</span> TextRenderingHint<span style=color:#f92672>.</span><span style=color:#a6e22e>SingleBitPerPixelGridFit</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>String fileName<span style=color:#f92672>:</span> files<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>basePath <span style=color:#f92672>+</span> fileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  VectorRasterizationOptions vectorRasterizationOptions<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>image <span style=color:#66d9ef>instanceof</span> CdrImage<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   vectorRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CdrRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>image <span style=color:#66d9ef>instanceof</span> CmxImage<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   vectorRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CmxRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>image <span style=color:#66d9ef>instanceof</span> EmfImage<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   vectorRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> EmfRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>image <span style=color:#66d9ef>instanceof</span> WmfImage<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   vectorRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> WmfRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>image <span style=color:#66d9ef>instanceof</span> OdgImage<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   vectorRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> OdgRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>image <span style=color:#66d9ef>instanceof</span> SvgImage<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   vectorRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SvgRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;This is image is not supported in this example&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  vectorRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPageSize</span><span style=color:#f92672>(</span>Size<span style=color:#f92672>.</span><span style=color:#a6e22e>to_SizeF</span><span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getSize</span><span style=color:#f92672>()));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> textRenderingHint<span style=color:#f92672>:</span> textRenderingHints<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   String outputFileName <span style=color:#f92672>=</span> basePath <span style=color:#f92672>+</span> String<span style=color:#f92672>.</span><span style=color:#a6e22e>format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;image_%s%s.png&#34;</span><span style=color:#f92672>,</span> TextRenderingHint<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>(</span>TextRenderingHint<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>,</span> textRenderingHint<span style=color:#f92672>),</span> fileName<span style=color:#f92672>.</span><span style=color:#a6e22e>substring</span><span style=color:#f92672>(</span>fileName<span style=color:#f92672>.</span><span style=color:#a6e22e>lastIndexOf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#39;.&#39;</span><span style=color:#f92672>)));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   vectorRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setTextRenderingHint</span><span style=color:#f92672>(</span>textRenderingHint<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   PngOptions pngOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   pngOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setVectorRasterizationOptions</span><span style=color:#f92672>(</span>vectorRasterizationOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outputFileName<span style=color:#f92672>,</span> pngOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  image<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//Example 2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>String basePath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\SmoothingTest\\&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String<span style=color:#f92672>[]</span> files <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> String<span style=color:#f92672>[]</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;SmoothingTest.cdr&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;SmoothingTest.cmx&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;SmoothingTest.emf&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;SmoothingTest.wmf&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;SmoothingTest.odg&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;SmoothingTest.svg&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> smoothingModes <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> SmoothingMode<span style=color:#f92672>.</span><span style=color:#a6e22e>AntiAlias</span><span style=color:#f92672>,</span> SmoothingMode<span style=color:#f92672>.</span><span style=color:#a6e22e>None</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>String fileName<span style=color:#f92672>:</span> files<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>basePath <span style=color:#f92672>+</span> fileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  VectorRasterizationOptions vectorRasterizationOptions<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>image <span style=color:#66d9ef>instanceof</span> CdrImage<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   vectorRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CdrRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>image <span style=color:#66d9ef>instanceof</span> CmxImage<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   vectorRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CmxRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>image <span style=color:#66d9ef>instanceof</span> EmfImage<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   vectorRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> EmfRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>image <span style=color:#66d9ef>instanceof</span> WmfImage<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   vectorRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> WmfRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>image <span style=color:#66d9ef>instanceof</span> OdgImage<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   vectorRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> OdgRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>image <span style=color:#66d9ef>instanceof</span> SvgImage<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   vectorRasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SvgRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;This is image is not supported in this example&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  vectorRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPageSize</span><span style=color:#f92672>(</span>Size<span style=color:#f92672>.</span><span style=color:#a6e22e>to_SizeF</span><span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getSize</span><span style=color:#f92672>()));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> smoothingMode<span style=color:#f92672>:</span> smoothingModes<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   String outputFileName <span style=color:#f92672>=</span> basePath <span style=color:#f92672>+</span> String<span style=color:#f92672>.</span><span style=color:#a6e22e>format</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;image_%s%s.png&#34;</span><span style=color:#f92672>,</span> TextRenderingHint<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>(</span>SmoothingMode<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>,</span> smoothingMode<span style=color:#f92672>),</span> fileName<span style=color:#f92672>.</span><span style=color:#a6e22e>substring</span><span style=color:#f92672>(</span>fileName<span style=color:#f92672>.</span><span style=color:#a6e22e>lastIndexOf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#39;.&#39;</span><span style=color:#f92672>)));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   vectorRasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setSmoothingMode</span><span style=color:#f92672>(</span>smoothingMode<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   PngOptions pngOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   pngOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setVectorRasterizationOptions</span><span style=color:#f92672>(</span>vectorRasterizationOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outputFileName<span style=color:#f92672>,</span> pngOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  image<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-1233 PSD performance fell down several times</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#75715e>// TestIMAGINGJAVA-1233
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>String sourceFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\spp\\1.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String outFileNamePng <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\spp\\imaging3203.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String outFileNamePsd <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\spp\\imaging3203.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>long</span> tmStart<span style=color:#f92672>,</span> tmEnd<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>sourceFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> tmStart <span style=color:#f92672>=</span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>nanoTime</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> PngOptions options <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> options<span style=color:#f92672>.</span><span style=color:#a6e22e>setColorType</span><span style=color:#f92672>(</span>PngColorType<span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outFileNamePng<span style=color:#f92672>,</span> options<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outFileNamePsd<span style=color:#f92672>,</span> <span style=color:#66d9ef>new</span> PsdOptions<span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> tmEnd <span style=color:#f92672>=</span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>nanoTime</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>((</span><span style=color:#e6db74>&#34;ELAPSED (secs): &#34;</span> <span style=color:#f92672>+</span> <span style=color:#f92672>(</span>tmEnd <span style=color:#f92672>-</span> tmStart<span style=color:#f92672>)</span> <span style=color:#f92672>/</span> 1000000000<span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>));</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-1288 The unhandled exception raises while loading WMF image</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> com<span style=color:#f92672>.</span><span style=color:#a6e22e>aspose</span><span style=color:#f92672>.</span><span style=color:#a6e22e>imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Image</span> asposeWmfImage <span style=color:#f92672>=</span> com<span style=color:#f92672>.</span><span style=color:#a6e22e>aspose</span><span style=color:#f92672>.</span><span style=color:#a6e22e>imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Image</span><span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;source.wmf&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>RuntimeException e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>e<span style=color:#f92672>.</span><span style=color:#a6e22e>getMessage</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-1256 Preserve transparency converting TIFF image to transparent PNG with resize</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;actual_with_alpha.tif&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> PngOptions optionsIM <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> optionsIM<span style=color:#f92672>.</span><span style=color:#a6e22e>setColorType</span><span style=color:#f92672>(</span>com<span style=color:#f92672>.</span><span style=color:#a6e22e>aspose</span><span style=color:#f92672>.</span><span style=color:#a6e22e>imaging</span><span style=color:#f92672>.</span><span style=color:#a6e22e>fileformats</span><span style=color:#f92672>.</span><span style=color:#a6e22e>png</span><span style=color:#f92672>.</span><span style=color:#a6e22e>PngColorType</span><span style=color:#f92672>.</span><span style=color:#a6e22e>TruecolorWithAlpha</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> optionsIM<span style=color:#f92672>.</span><span style=color:#a6e22e>setResolutionSettings</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> ResolutionSetting<span style=color:#f92672>(</span>120 f<span style=color:#f92672>,</span> 120 f<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;silver_dog.png&#34;</span><span style=color:#f92672>,</span> optionsIM<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-1257 Fix CDR FileFormat: it is set to Undefined instead of CDR</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String baseFolder <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String fileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;test.cdr&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String inputFileName <span style=color:#f92672>=</span> baseFolder <span style=color:#f92672>+</span> fileName<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>long</span> expectedFileFormat <span style=color:#f92672>=</span> FileFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>Cdr</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>long</span> realFileFormat <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>getFileFormat</span><span style=color:#f92672>(</span>inputFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Assert<span style=color:#f92672>.</span><span style=color:#a6e22e>assertEquals</span><span style=color:#f92672>(</span>expectedFileFormat<span style=color:#f92672>,</span> realFileFormat<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;File format is incorrect!&#34;</span><span style=color:#f92672>);</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-1252 Extend support for loading fonts from custom directories to SVG format</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String fontFolderPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;fonts&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>FontSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>setFontsFolder</span><span style=color:#f92672>(</span>fontFolderPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Image svgImage <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;missing-font2.svg&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> PngOptions options <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> svgImage<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;svg.png&#34;</span><span style=color:#f92672>,</span> options<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> svgImage<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-1251 Incorrect conversion of specific WMF images to SVG and PNG</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String basePath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\1251\\&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String<span style=color:#f92672>[]</span> files <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> String<span style=color:#f92672>[]</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;thistlegirl_wmfsample.wmf&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;WMF sample.wmf&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>String fileName<span style=color:#f92672>:</span> files<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> String inputFileName <span style=color:#f92672>=</span> basePath <span style=color:#f92672>+</span> fileName<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> String outputFileNamePng <span style=color:#f92672>=</span> inputFileName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.png&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> String outputFileNameSvg <span style=color:#f92672>=</span> inputFileName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.svg&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>inputFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  WmfRasterizationOptions rasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> WmfRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  rasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setBackgroundColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getWhiteSmoke</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  rasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPageWidth</span><span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  rasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPageHeight</span><span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  PngOptions pngOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PngOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  pngOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setVectorRasterizationOptions</span><span style=color:#f92672>(</span>rasterizationOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outputFileNamePng<span style=color:#f92672>,</span> pngOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  SvgOptions svgOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SvgOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  svgOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setVectorRasterizationOptions</span><span style=color:#f92672>(</span>rasterizationOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outputFileNameSvg<span style=color:#f92672>,</span> svgOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  image<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-1258 CmxRasterizationOptions size settings do not work</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String testDirectory <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\data\\&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String imageName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;test.cmx&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>testDirectory <span style=color:#f92672>+</span> imageName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> BmpOptions bmpOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> BmpOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> VectorRasterizationOptions options <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CmxRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> options<span style=color:#f92672>.</span><span style=color:#a6e22e>setPageWidth</span><span style=color:#f92672>(</span>100<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> options<span style=color:#f92672>.</span><span style=color:#a6e22e>setPageHeight</span><span style=color:#f92672>(</span>200<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> bmpOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setVectorRasterizationOptions</span><span style=color:#f92672>(</span>options<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>testDirectory <span style=color:#f92672>+</span> imageName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.bmp&#34;</span><span style=color:#f92672>,</span> bmpOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-1292 Backport Aspose.PSD code to Aspose.Imaging Q1/2019</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#75715e>// https://issue.kharkov.dynabic.com/issues/PSDNET-74
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span> <span style=color:#75715e>// ColorOverlay adding at runtime
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span> String sourceFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ThreeRegularLayers.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> String exportPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ThreeRegularLayersChanged.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> PsdLoadOptions loadOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PsdLoadOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> loadOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setLoadEffectsResource</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> PsdImage im <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>sourceFileName<span style=color:#f92672>,</span> loadOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  ColorOverlayEffect effect <span style=color:#f92672>=</span> im<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>()[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getBlendingOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>addColorOverlay</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  effect<span style=color:#f92672>.</span><span style=color:#a6e22e>setColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getGreen</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  effect<span style=color:#f92672>.</span><span style=color:#a6e22e>setOpacity</span><span style=color:#f92672>((</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> 128<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  effect<span style=color:#f92672>.</span><span style=color:#a6e22e>setBlendMode</span><span style=color:#f92672>(</span>BlendMode<span style=color:#f92672>.</span><span style=color:#a6e22e>Normal</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  im<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>exportPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  im<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> newPattern <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getAqua</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toArgb</span><span style=color:#f92672>(),</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getRed</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toArgb</span><span style=color:#f92672>(),</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getRed</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toArgb</span><span style=color:#f92672>(),</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getAqua</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toArgb</span><span style=color:#f92672>(),</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getAqua</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toArgb</span><span style=color:#f92672>(),</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getWhite</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toArgb</span><span style=color:#f92672>(),</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getWhite</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toArgb</span><span style=color:#f92672>(),</span> Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getAqua</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toArgb</span><span style=color:#f92672>(),</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Rectangle newPatternBounds <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Rectangle<span style=color:#f92672>(</span>0<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> 4<span style=color:#f92672>,</span> 2<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>UUID guid <span style=color:#f92672>=</span> UUID<span style=color:#f92672>.</span><span style=color:#a6e22e>randomUUID</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String newPatternName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;$$$/Presets/Patterns/Pattern=Some new pattern name\0&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#75715e>// Pattern overlay effect. Example
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span> <span style=color:#75715e>// https://issue.kharkov.dynabic.com/issues/PSDNET-84
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span> String sourceFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;PatternOverlay.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> String exportPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;PatternOverlayChanged.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> PsdLoadOptions loadOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PsdLoadOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> loadOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setLoadEffectsResource</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> PsdImage im <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>sourceFileName<span style=color:#f92672>,</span> loadOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  PatternOverlayEffect patternOverlay <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PatternOverlayEffect<span style=color:#f92672>)</span> im<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>()[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getBlendingOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getEffects</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>patternOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>getBlendMode</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> BlendMode<span style=color:#f92672>.</span><span style=color:#a6e22e>Normal</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   patternOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>getOpacity</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 127 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>patternOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>isVisible</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Pattern overlay effect was read wrong&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  PatternFillSettings settings <span style=color:#f92672>=</span> patternOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>getSettings</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getColor</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getEmpty</span><span style=color:#f92672>())</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getFillType</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> FillType<span style=color:#f92672>.</span><span style=color:#a6e22e>Pattern</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getPatternId</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;85163837-eb9e-5b43-86fb-e6d5963ea29a\0&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getPatternName</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;$$$/Presets/Patterns/OpticalSquares=Optical Squares\0&#34;</span><span style=color:#f92672>)</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getPointType</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getScale</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 100 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getLinked</span><span style=color:#f92672>()</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Math<span style=color:#f92672>.</span><span style=color:#a6e22e>abs</span><span style=color:#f92672>(</span>0 <span style=color:#f92672>-</span> settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getHorizontalOffset</span><span style=color:#f92672>())</span> <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>001</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Math<span style=color:#f92672>.</span><span style=color:#a6e22e>abs</span><span style=color:#f92672>(</span>0 <span style=color:#f92672>-</span> settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getVerticalOffset</span><span style=color:#f92672>())</span> <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>001</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Pattern overlay effect was read wrong&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Test editing
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  settings<span style=color:#f92672>.</span><span style=color:#a6e22e>setColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getGreen</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  patternOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>setOpacity</span><span style=color:#f92672>((</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> 193<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  patternOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>setBlendMode</span><span style=color:#f92672>(</span>BlendMode<span style=color:#f92672>.</span><span style=color:#a6e22e>Difference</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  settings<span style=color:#f92672>.</span><span style=color:#a6e22e>setHorizontalOffset</span><span style=color:#f92672>(</span>15<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  settings<span style=color:#f92672>.</span><span style=color:#a6e22e>setVerticalOffset</span><span style=color:#f92672>(</span>11<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  PattResource resource<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>LayerResource globalLayerResource<span style=color:#f92672>:</span> im<span style=color:#f92672>.</span><span style=color:#a6e22e>getGlobalLayerResources</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>globalLayerResource <span style=color:#66d9ef>instanceof</span> PattResource<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    resource <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PattResource<span style=color:#f92672>)</span> globalLayerResource<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    resource<span style=color:#f92672>.</span><span style=color:#a6e22e>setPatternId</span><span style=color:#f92672>(</span>guid<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    resource<span style=color:#f92672>.</span><span style=color:#a6e22e>setName</span><span style=color:#f92672>(</span>newPatternName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    resource<span style=color:#f92672>.</span><span style=color:#a6e22e>setPattern</span><span style=color:#f92672>(</span>newPattern<span style=color:#f92672>,</span> newPatternBounds<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  settings<span style=color:#f92672>.</span><span style=color:#a6e22e>setPatternName</span><span style=color:#f92672>(</span>newPatternName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  settings<span style=color:#f92672>.</span><span style=color:#a6e22e>setPatternId</span><span style=color:#f92672>(</span>guid<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\0&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  im<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>exportPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  im<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> String exportPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;PatternOverlayChanged.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> PsdLoadOptions loadOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PsdLoadOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> loadOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setLoadEffectsResource</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#75715e>// Test file after edit
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span> PsdImage im <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>exportPath<span style=color:#f92672>,</span> loadOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  PatternOverlayEffect patternOverlay <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PatternOverlayEffect<span style=color:#f92672>)</span> im<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>()[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getBlendingOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getEffects</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>patternOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>getBlendMode</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> BlendMode<span style=color:#f92672>.</span><span style=color:#a6e22e>Difference</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   patternOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>getOpacity</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> 193 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>patternOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>isVisible</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Pattern overlay effect was read wrong&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  PatternFillSettings fillSettings <span style=color:#f92672>=</span> patternOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>getSettings</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>fillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>getColor</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getEmpty</span><span style=color:#f92672>())</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   fillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>getFillType</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> FillType<span style=color:#f92672>.</span><span style=color:#a6e22e>Pattern</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Pattern overlay effect was read wrong&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  PattResource resource <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>LayerResource globalLayerResource<span style=color:#f92672>:</span> im<span style=color:#f92672>.</span><span style=color:#a6e22e>getGlobalLayerResources</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>globalLayerResource <span style=color:#66d9ef>instanceof</span> PattResource<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    resource <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PattResource<span style=color:#f92672>)</span> globalLayerResource<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>resource <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;PattResource not found&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Check the pattern data
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>Arrays<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>newPattern<span style=color:#f92672>,</span> resource<span style=color:#f92672>.</span><span style=color:#a6e22e>getPatternData</span><span style=color:#f92672>())</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>newPatternBounds<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> Rectangle<span style=color:#f92672>(</span>0<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> resource<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>(),</span> resource<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>()))</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>resource<span style=color:#f92672>.</span><span style=color:#a6e22e>getPatternId</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>guid<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>())</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>newPatternName<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>resource<span style=color:#f92672>.</span><span style=color:#a6e22e>getName</span><span style=color:#f92672>()))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Pattern overlay effect was read wrong&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  im<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#75715e>// Gradient overlay effect. Example
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span> <span style=color:#75715e>// https://issue.kharkov.dynabic.com/issues/PSDNET-83
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span> String sourceFileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;GradientOverlay.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> String exportPath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;GradientOverlayChanged.psd&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> PsdLoadOptions loadOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PsdLoadOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> loadOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setLoadEffectsResource</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> PsdImage im <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>sourceFileName<span style=color:#f92672>,</span> loadOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  GradientOverlayEffect gradientOverlay <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>GradientOverlayEffect<span style=color:#f92672>)</span> im<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>()[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getBlendingOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getEffects</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>gradientOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>getBlendMode</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> BlendMode<span style=color:#f92672>.</span><span style=color:#a6e22e>Normal</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   gradientOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>getOpacity</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> 255 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>gradientOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>isVisible</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Gradient overlay effect was read wrong&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  GradientFillSettings settings <span style=color:#f92672>=</span> gradientOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>getSettings</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getColor</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getEmpty</span><span style=color:#f92672>())</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getFillType</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> FillType<span style=color:#f92672>.</span><span style=color:#a6e22e>Gradient</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getAlignWithLayer</span><span style=color:#f92672>()</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getGradientType</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> GradientType<span style=color:#f92672>.</span><span style=color:#a6e22e>Linear</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Math<span style=color:#f92672>.</span><span style=color:#a6e22e>abs</span><span style=color:#f92672>(</span>33 <span style=color:#f92672>-</span> settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getAngle</span><span style=color:#f92672>())</span> <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>001</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getDither</span><span style=color:#f92672>()</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Math<span style=color:#f92672>.</span><span style=color:#a6e22e>abs</span><span style=color:#f92672>(</span>129 <span style=color:#f92672>-</span> settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getHorizontalOffset</span><span style=color:#f92672>())</span> <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>001</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Math<span style=color:#f92672>.</span><span style=color:#a6e22e>abs</span><span style=color:#f92672>(</span>156 <span style=color:#f92672>-</span> settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getVerticalOffset</span><span style=color:#f92672>())</span> <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>001</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getReverse</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Gradient overlay effect was read wrong&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Color Points
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  GradientColorPoint<span style=color:#f92672>[]</span> colorPoints <span style=color:#f92672>=</span> settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getColorPoints</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>colorPoints<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span> <span style=color:#f92672>!=</span> 3 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>colorPoints<span style=color:#f92672>[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getColor</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>fromArgb</span><span style=color:#f92672>(</span>9<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> 178<span style=color:#f92672>))</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   colorPoints<span style=color:#f92672>[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 0 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   colorPoints<span style=color:#f92672>[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getMedianPointLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 50 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>colorPoints<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getColor</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getRed</span><span style=color:#f92672>())</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   colorPoints<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 2048 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   colorPoints<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getMedianPointLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 50 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>colorPoints<span style=color:#f92672>[</span>2<span style=color:#f92672>].</span><span style=color:#a6e22e>getColor</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>fromArgb</span><span style=color:#f92672>(</span>255<span style=color:#f92672>,</span> 252<span style=color:#f92672>,</span> 0<span style=color:#f92672>))</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   colorPoints<span style=color:#f92672>[</span>2<span style=color:#f92672>].</span><span style=color:#a6e22e>getLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 4096 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   colorPoints<span style=color:#f92672>[</span>2<span style=color:#f92672>].</span><span style=color:#a6e22e>getMedianPointLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 50<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Gradient overlay effect was read wrong&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Transparency points
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  GradientTransparencyPoint<span style=color:#f92672>[]</span> transparencyPoints <span style=color:#f92672>=</span> settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getTransparencyPoints</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>transparencyPoints<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span> <span style=color:#f92672>!=</span> 2 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   transparencyPoints<span style=color:#f92672>[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 0 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   transparencyPoints<span style=color:#f92672>[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getMedianPointLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 50 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Math<span style=color:#f92672>.</span><span style=color:#a6e22e>abs</span><span style=color:#f92672>(</span>transparencyPoints<span style=color:#f92672>[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getOpacity</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> 100<span style=color:#f92672>)</span> <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>001</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   transparencyPoints<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 4096 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   transparencyPoints<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getMedianPointLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 50 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Math<span style=color:#f92672>.</span><span style=color:#a6e22e>abs</span><span style=color:#f92672>(</span>transparencyPoints<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getOpacity</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> 100<span style=color:#f92672>)</span> <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>001</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Gradient overlay effect was read wrong&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Test editing
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  settings<span style=color:#f92672>.</span><span style=color:#a6e22e>setColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getGreen</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  gradientOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>setOpacity</span><span style=color:#f92672>((</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> 193<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  gradientOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>setBlendMode</span><span style=color:#f92672>(</span>BlendMode<span style=color:#f92672>.</span><span style=color:#a6e22e>Lighten</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  settings<span style=color:#f92672>.</span><span style=color:#a6e22e>setAlignWithLayer</span><span style=color:#f92672>(</span><span style=color:#66d9ef>false</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  settings<span style=color:#f92672>.</span><span style=color:#a6e22e>setGradientType</span><span style=color:#f92672>(</span>GradientType<span style=color:#f92672>.</span><span style=color:#a6e22e>Radial</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  settings<span style=color:#f92672>.</span><span style=color:#a6e22e>setAngle</span><span style=color:#f92672>(</span>45<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  settings<span style=color:#f92672>.</span><span style=color:#a6e22e>setDither</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  settings<span style=color:#f92672>.</span><span style=color:#a6e22e>setHorizontalOffset</span><span style=color:#f92672>(</span>15<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  settings<span style=color:#f92672>.</span><span style=color:#a6e22e>setVerticalOffset</span><span style=color:#f92672>(</span>11<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  settings<span style=color:#f92672>.</span><span style=color:#a6e22e>setReverse</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Add new color point
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  GradientColorPoint colorPoint <span style=color:#f92672>=</span> settings<span style=color:#f92672>.</span><span style=color:#a6e22e>addColorPoint</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  colorPoint<span style=color:#f92672>.</span><span style=color:#a6e22e>setColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getGreen</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  colorPoint<span style=color:#f92672>.</span><span style=color:#a6e22e>setLocation</span><span style=color:#f92672>(</span>4096<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  colorPoint<span style=color:#f92672>.</span><span style=color:#a6e22e>setMedianPointLocation</span><span style=color:#f92672>(</span>75<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Change location of previous point
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getColorPoints</span><span style=color:#f92672>()[</span>2<span style=color:#f92672>].</span><span style=color:#a6e22e>setLocation</span><span style=color:#f92672>(</span>3000<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Add new transparency point
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  GradientTransparencyPoint transparencyPoint <span style=color:#f92672>=</span> settings<span style=color:#f92672>.</span><span style=color:#a6e22e>addTransparencyPoint</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  transparencyPoint<span style=color:#f92672>.</span><span style=color:#a6e22e>setOpacity</span><span style=color:#f92672>(</span>25<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  transparencyPoint<span style=color:#f92672>.</span><span style=color:#a6e22e>setMedianPointLocation</span><span style=color:#f92672>(</span>25<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  transparencyPoint<span style=color:#f92672>.</span><span style=color:#a6e22e>setLocation</span><span style=color:#f92672>(</span>4096<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Change location of previous transparency point
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  settings<span style=color:#f92672>.</span><span style=color:#a6e22e>getTransparencyPoints</span><span style=color:#f92672>()[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>setLocation</span><span style=color:#f92672>(</span>2315<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  im<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>exportPath<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  im<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#75715e>// Test file after edit
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span> PsdImage im2 <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PsdImage<span style=color:#f92672>)</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>exportPath<span style=color:#f92672>,</span> loadOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  GradientOverlayEffect gradientOverlay <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>GradientOverlayEffect<span style=color:#f92672>)</span> im2<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayers</span><span style=color:#f92672>()[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getBlendingOptions</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getEffects</span><span style=color:#f92672>()[</span>0<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>gradientOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>getBlendMode</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> BlendMode<span style=color:#f92672>.</span><span style=color:#a6e22e>Lighten</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   gradientOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>getOpacity</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> 193 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>gradientOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>isVisible</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Gradient overlay effect was read wrong&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  GradientFillSettings fillSettings <span style=color:#f92672>=</span> gradientOverlay<span style=color:#f92672>.</span><span style=color:#a6e22e>getSettings</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Assert<span style=color:#f92672>.</span><span style=color:#a6e22e>assertEquals</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getEmpty</span><span style=color:#f92672>(),</span> fillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>getColor</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Assert<span style=color:#f92672>.</span><span style=color:#a6e22e>assertEquals</span><span style=color:#f92672>(</span>FillType<span style=color:#f92672>.</span><span style=color:#a6e22e>Gradient</span><span style=color:#f92672>,</span> fillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>getFillType</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Check color points
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  GradientColorPoint<span style=color:#f92672>[]</span> colorPoints <span style=color:#f92672>=</span> fillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>getColorPoints</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>colorPoints<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span> <span style=color:#f92672>!=</span> 4 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>colorPoints<span style=color:#f92672>[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getColor</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>fromArgb</span><span style=color:#f92672>(</span>9<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> 178<span style=color:#f92672>))</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   colorPoints<span style=color:#f92672>[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 0 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   colorPoints<span style=color:#f92672>[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getMedianPointLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 50 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>colorPoints<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getColor</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getRed</span><span style=color:#f92672>())</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   colorPoints<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 2048 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   colorPoints<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getMedianPointLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 50 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>colorPoints<span style=color:#f92672>[</span>2<span style=color:#f92672>].</span><span style=color:#a6e22e>getColor</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>fromArgb</span><span style=color:#f92672>(</span>255<span style=color:#f92672>,</span> 252<span style=color:#f92672>,</span> 0<span style=color:#f92672>))</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   colorPoints<span style=color:#f92672>[</span>2<span style=color:#f92672>].</span><span style=color:#a6e22e>getLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 3000 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   colorPoints<span style=color:#f92672>[</span>2<span style=color:#f92672>].</span><span style=color:#a6e22e>getMedianPointLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 50 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>!</span>colorPoints<span style=color:#f92672>[</span>3<span style=color:#f92672>].</span><span style=color:#a6e22e>getColor</span><span style=color:#f92672>().</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>getGreen</span><span style=color:#f92672>())</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   colorPoints<span style=color:#f92672>[</span>3<span style=color:#f92672>].</span><span style=color:#a6e22e>getLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 4096 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   colorPoints<span style=color:#f92672>[</span>3<span style=color:#f92672>].</span><span style=color:#a6e22e>getMedianPointLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 75<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Gradient overlay effect was read wrong&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Check transparent points
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  GradientTransparencyPoint<span style=color:#f92672>[]</span> transparencyPoints <span style=color:#f92672>=</span> fillSettings<span style=color:#f92672>.</span><span style=color:#a6e22e>getTransparencyPoints</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>transparencyPoints<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span> <span style=color:#f92672>!=</span> 3 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   transparencyPoints<span style=color:#f92672>[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 0 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   transparencyPoints<span style=color:#f92672>[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getMedianPointLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 50 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Math<span style=color:#f92672>.</span><span style=color:#a6e22e>abs</span><span style=color:#f92672>(</span>transparencyPoints<span style=color:#f92672>[</span>0<span style=color:#f92672>].</span><span style=color:#a6e22e>getOpacity</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> 100<span style=color:#f92672>)</span> <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>001</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   transparencyPoints<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 2315 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   transparencyPoints<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getMedianPointLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 50 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Math<span style=color:#f92672>.</span><span style=color:#a6e22e>abs</span><span style=color:#f92672>(</span>transparencyPoints<span style=color:#f92672>[</span>1<span style=color:#f92672>].</span><span style=color:#a6e22e>getOpacity</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> 100<span style=color:#f92672>)</span> <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>001</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   transparencyPoints<span style=color:#f92672>[</span>2<span style=color:#f92672>].</span><span style=color:#a6e22e>getLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 4096 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   transparencyPoints<span style=color:#f92672>[</span>2<span style=color:#f92672>].</span><span style=color:#a6e22e>getMedianPointLocation</span><span style=color:#f92672>()</span> <span style=color:#f92672>!=</span> 25 <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Math<span style=color:#f92672>.</span><span style=color:#a6e22e>abs</span><span style=color:#f92672>(</span>transparencyPoints<span style=color:#f92672>[</span>2<span style=color:#f92672>].</span><span style=color:#a6e22e>getOpacity</span><span style=color:#f92672>()</span> <span style=color:#f92672>-</span> 25<span style=color:#f92672>)</span> <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>001</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> RuntimeException<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Gradient overlay effect was read wrong&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  im2<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div><p><strong>IMAGINGJAVA-1250  Saving EMF as SVG the resulting transformation is incorrect</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span> String baseFolder <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;D:\\&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String fileName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;input.emf&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String inputFileName <span style=color:#f92672>=</span> baseFolder <span style=color:#f92672>+</span> fileName<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>String outputFileName <span style=color:#f92672>=</span> inputFileName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.svg&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Image image <span style=color:#f92672>=</span> Image<span style=color:#f92672>.</span><span style=color:#a6e22e>load</span><span style=color:#f92672>(</span>inputFileName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> EmfRasterizationOptions rasterizationOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> EmfRasterizationOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> rasterizationOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPageSize</span><span style=color:#f92672>(</span>Size<span style=color:#f92672>.</span><span style=color:#a6e22e>to_SizeF</span><span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getSize</span><span style=color:#f92672>()));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> SvgOptions svgOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SvgOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> svgOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setVectorRasterizationOptions</span><span style=color:#f92672>(</span>rasterizationOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>outputFileName<span style=color:#f92672>,</span> svgOptions<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span> <span style=color:#66d9ef>finally</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span></span></span></code></pre></div></p></div></div></div></div><hr></div></div></section></div></div></section></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>