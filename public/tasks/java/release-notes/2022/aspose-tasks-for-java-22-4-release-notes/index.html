<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.Tasks for Java 22.4 Release Notes</title><meta name=description content="The page contains the release notes for Aspose.Tasks for Java 22.4."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/tasks/java/release-notes/2022/aspose-tasks-for-java-22-4-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/tasks/java/release-notes/2022/aspose-tasks-for-java-22-4-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.Tasks for Java 22.4 Release Notes "><meta property="og:description" content="The page contains the release notes for Aspose.Tasks for Java 22.4."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/tasks/java/release-notes/2022/aspose-tasks-for-java-22-4-release-notes/"><meta itemprop=name content="Aspose.Tasks for Java 22.4 Release Notes"><meta itemprop=description content="The page contains the release notes for Aspose.Tasks for Java 22.4."><meta itemprop=wordCount content="1145"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.Tasks for Java 22.4 Release Notes"><meta name=twitter:description content="The page contains the release notes for Aspose.Tasks for Java 22.4."><link href=/css/bootstrap.css rel=stylesheet type=text/css><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/tasks/>Aspose.Tasks Product Family</a><span class=divider></span></li><li><a href=/tasks/java/>Aspose.Tasks for Java</a><span class=divider></span></li><li><a href=/tasks/java/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/tasks/java/release-notes/2022/>2022</a><span class=divider></span></li><li><a href=/tasks/java/release-notes/2022/aspose-tasks-for-java-22-4-release-notes/>Aspose.Tasks for Java 22.4 Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><div class=container><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section"><div class=box1><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.Tasks for Java 22.4 Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><div class="alert alert-primary" role=alert>This page contains release notes information for <a href=https://releases.aspose.com/tasks/java/new-releases/aspose.tasks-for-java-22.4/>Aspose.Tasks for Java 22.4</a>.</div><h2 id=all-changes><strong>All Changes</strong></h2><table><thead><tr><th style=text-align:left><strong>Key</strong></th><th style=text-align:left><strong>Summary</strong></th><th style=text-align:left><strong>Issue Type</strong></th></tr></thead><tbody><tr><td style=text-align:left>TASKSJAVA-1130</td><td style=text-align:left>Support for thread interruption for Project loading operation</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>TASKSNET-10310</td><td style=text-align:left>Add cancellation token support for Project loading operation</td><td style=text-align:left>New Feature</td></tr><tr><td style=text-align:left>TASKSNET-10498</td><td style=text-align:left>Add reading/writing of Status date from/to XER file.</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>TASKSNET-10496</td><td style=text-align:left>Make WorkingTime immutable</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>TASKSNET-10480</td><td style=text-align:left>Add an API to set user-specified callback which allows to substitute absent fonts when a project is rendered to a graphical format</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>TASKSNET-10471</td><td style=text-align:left>Remove unnecessary memory allocations when reading Task, Assignment, Resource properties.</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>TASKSNET-2596</td><td style=text-align:left>Add support for &ldquo;Calculation for task and group summary rows&rdquo; custom field option</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>TASKSNET-10499</td><td style=text-align:left>Fix reading\writing of Guids from\to XER file</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-10485</td><td style=text-align:left>Fix rendering of holidays in Gantt Chart view</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-10484</td><td style=text-align:left>Fix reading of Finish Milestones from XER format</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-10483</td><td style=text-align:left>Fix parsing of formulas with different separators</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-10479</td><td style=text-align:left>Fix differences of calculated custom fields between versions</td><td style=text-align:left>Bug</td></tr></tbody></table><h2 id=public-api-and-backwards-incompatible-changes><strong>Public API and Backwards Incompatible Changes</strong></h2><table><thead><tr><th style=text-align:left><strong>The following public types were added:</strong></th><th style=text-align:left><strong>Description</strong></th></tr></thead><tbody><tr><td style=text-align:left>com.aspose.tasks.FontResolveCallbackDelegate</td><td style=text-align:left>Represents a method callback to handle font resolve event.</td></tr><tr><td style=text-align:left>com.aspose.tasks.FontResolveEventArgs</td><td style=text-align:left>Provides arguments for the callback that is invoked when font is resolved.</td></tr><tr><td style=text-align:left>com.aspose.tasks.SummaryRowsCalculationType</td><td style=text-align:left>Specifies the type of a calculation of the custom attribute&rsquo;s value for summary rows.</td></tr><tr><td style=text-align:left>com.aspose.tasks.FontDescriptor</td><td style=text-align:left>Represents font information.</td></tr><tr><td style=text-align:left>com.aspose.tasks.FontStyles</td><td style=text-align:left>Specifies style information applied to text.</td></tr></tbody></table><table><thead><tr><th style=text-align:left><strong>The following public methods and properties were added:</strong></th><th style=text-align:left><strong>Description</strong></th></tr></thead><tbody><tr><td style=text-align:left>com.aspose.tasks.ExtendedAttributeDefinition.SummaryRowsCalculationType</td><td style=text-align:left>Gets or sets the type of calculation of the custom attribute&rsquo;s value for summary rows.</td></tr><tr><td style=text-align:left>com.aspose.tasks.FontResolveEventArgs.RequestedFontName</td><td style=text-align:left>Gets the name of requested font.</td></tr><tr><td style=text-align:left>com.aspose.tasks.FontResolveEventArgs.ResolvedFontName</td><td style=text-align:left>Gets or sets the name of resolved font. Can be set to control fonts used to render a view.</td></tr><tr><td style=text-align:left>com.aspose.tasks.OleObject.#ctor</td><td style=text-align:left>Initializes a new instance of the <see cref=T:com.aspose.tasks.OleObject>class.</td></tr><tr><td style=text-align:left>com.aspose.tasks.Project.enumerateAllChildTasks</td><td style=text-align:left>Recursively enumerates all project&rsquo;s tasks including root task.</td></tr><tr><td style=text-align:left>com.aspose.tasks.Saving.HtmlSaveOptions.FontResolveCallback</td><td style=text-align:left>Gets or sets a callback which can be used to customize resolved fonts.</td></tr><tr><td style=text-align:left>com.aspose.tasks.Saving.ImageSaveOptions.FontResolveCallback</td><td style=text-align:left>Gets or sets a callback which can be used to customize resolved fonts.</td></tr><tr><td style=text-align:left>com.aspose.tasks.Saving.PdfSaveOptions.FontResolveCallback</td><td style=text-align:left>Gets or sets a callback which can be used to customize resolved fonts.</td></tr><tr><td style=text-align:left>com.aspose.tasks.FontDescriptor.#ctor(String,float)</td><td style=text-align:left>Initializes a new instance of the <see cref=T:com.aspose.tasks.FontDescriptor>class with the specified font family and size.</td></tr><tr><td style=text-align:left>com.aspose.tasks.FontDescriptor.#ctor(String,float,com.aspose.tasks.FontStyles)</td><td style=text-align:left>Initializes a new instance of the <see cref=T:com.aspose.tasks.FontDescriptor>class with the specified font family, size and style.</td></tr><tr><td style=text-align:left>com.aspose.tasks.FontDescriptor.#ctor(com.aspose.tasks.FontDescriptor,com.aspose.tasks.FontStyles)</td><td style=text-align:left>Initializes a new instance of the <see cref=T:com.aspose.tasks.FontDescriptor>class with the specified font and style.</td></tr><tr><td style=text-align:left>com.aspose.tasks.FontDescriptor.FontFamily</td><td style=text-align:left>Gets the name of the font&rsquo;s family.</td></tr><tr><td style=text-align:left>com.aspose.tasks.FontDescriptor.Size</td><td style=text-align:left>Gets size of the font.</td></tr><tr><td style=text-align:left>com.aspose.tasks.FontDescriptor.Style</td><td style=text-align:left>Gets style of the font.</td></tr><tr><td style=text-align:left>com.aspose.tasks.TableTextStyle.#ctor(int,com.aspose.tasks.FontDescriptor)</td><td style=text-align:left>Initializes a new instance of the <see cref=T:com.aspose.tasks.TableTextStyle>class with the specified font.</td></tr><tr><td style=text-align:left>com.aspose.tasks.TableTextStyle.#ctor(int,float,com.aspose.tasks.FontStyles)</td><td style=text-align:left>Initializes a new instance of the <see cref=T:com.aspose.tasks.TableTextStyle>class with the specified font size and font style.</td></tr><tr><td style=text-align:left>com.aspose.tasks.TableTextStyle.#ctor(int,com.aspose.tasks.FontStyles)</td><td style=text-align:left>Initializes a new instance of the <see cref=T:com.aspose.tasks.TableTextStyle>class with the default font settings and the specified font style.</td></tr><tr><td style=text-align:left>com.aspose.tasks.TextStyle.#ctor(float,com.aspose.tasks.FontStyles)</td><td style=text-align:left>Initializes a new instance of the <see cref=T:com.aspose.tasks.TextStyle>class with the default font and specified font size and style.</td></tr><tr><td style=text-align:left>com.aspose.tasks.TextStyle.#ctor(com.aspose.tasks.FontStyles)</td><td style=text-align:left>Initializes a new instance of the <see cref=T:com.aspose.tasks.TextStyle>class with the default font and specified font style.</td></tr><tr><td style=text-align:left>com.aspose.tasks.TextStyle.#ctor(com.aspose.tasks.FontDescriptor)</td><td style=text-align:left>Initializes a new instance of the <see cref=T:com.aspose.tasks.TextStyle>class with the specified font settings.</td></tr><tr><td style=text-align:left>com.aspose.tasks.TextStyle.Font</td><td style=text-align:left>Gets or sets font of the text style.</td></tr><tr><td style=text-align:left>com.aspose.tasks.WorkingTime.#ctor(double,double)</td><td style=text-align:left>Initializes a new instance of the <see cref=T:com.aspose.tasks.WorkingTime>class with an interval item with the specified start and finish times.</td></tr><tr><td style=text-align:left>com.aspose.tasks.WorkingTime.#ctor(int,int)</td><td style=text-align:left>Initializes a new instance of the <see cref=T:com.aspose.tasks.WorkingTime>class with an interval item with the specified start and finish times.</td></tr><tr><td style=text-align:left>com.aspose.tasks.WorkingTime.From</td><td style=text-align:left>Gets the beginning of a working time.</td></tr><tr><td style=text-align:left>com.aspose.tasks.WorkingTime.To</td><td style=text-align:left>Gets the end of a working time.</td></tr></tbody></table><table><thead><tr><th style=text-align:left><strong>The following public methods and properties were deleted:</strong></th><th style=text-align:left><strong>Description</strong></th></tr></thead><tbody><tr><td style=text-align:left>com.aspose.tasks.WorkWeek.#ctor(com.aspose.tasks.Calendar)</td><td style=text-align:left></td></tr></tbody></table><table><thead><tr><th style=text-align:left><strong>The following public enumerations were added:</strong></th><th style=text-align:left><strong>Description</strong></th></tr></thead><tbody><tr><td style=text-align:left>com.aspose.tasks.SummaryRowsCalculationType.None</td><td style=text-align:left>Means the custom attribute&rsquo;s value for summary rows is not calculated.</td></tr><tr><td style=text-align:left>com.aspose.tasks.SummaryRowsCalculationType.Rollup</td><td style=text-align:left>Means the custom attribute&rsquo;s value for summary rows is calculated using rollup function defined in <see cref=P:com.aspose.tasks.ExtendedAttributeDefinition.RollupType>.</td></tr><tr><td style=text-align:left>com.aspose.tasks.SummaryRowsCalculationType.UseFormula</td><td style=text-align:left>Means the custom attribute&rsquo;s value for summary rows is calculated using formula defined in <see cref=P:com.aspose.tasks.ExtendedAttributeDefinition.Formula>.</td></tr><tr><td style=text-align:left>com.aspose.tasks.FontStyles.Regular</td><td style=text-align:left>Normal text.</td></tr><tr><td style=text-align:left>com.aspose.tasks.FontStyles.Bold</td><td style=text-align:left>Bold text.</td></tr><tr><td style=text-align:left>com.aspose.tasks.FontStyles.Italic</td><td style=text-align:left>Italic text.</td></tr><tr><td style=text-align:left>com.aspose.tasks.FontStyles.Underline</td><td style=text-align:left>Underlined text.</td></tr><tr><td style=text-align:left>com.aspose.tasks.FontStyles.Strikeout</td><td style=text-align:left>Text with a line through the middle.</td></tr></tbody></table><h2 id=examples-and-additional-notes><strong>Examples and additional notes</strong></h2><p><strong>Related issue: TASKSNET-10310 - Add cancellation token support for Project loading operation</strong></p><p>Now CancellationToken can be specified to allow cancellation of long project loading operation:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>CancellationTokenSource cts <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> CancellationTokenSource<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>LoadOptions loadOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> LoadOptions<span style=color:#f92672>()</span> <span style=color:#f92672>{{</span>
</span></span><span style=display:flex><span>    setCancellationToken<span style=color:#f92672>(</span>cts<span style=color:#f92672>.</span><span style=color:#a6e22e>getToken</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Project p <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Project<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;test.mpp&#34;</span><span style=color:#f92672>,</span> loadOptions<span style=color:#f92672>);</span></span></span></code></pre></div><p><strong>Related issue: TASKSNET-10480 - Add an API to set user-specified callback which allows to substitute absent fonts when a project is rendered to a graphical format</strong></p><p>The user can use any font to customize View&rsquo;s text styles using MS Project. When the project is saved, the font information (actually a font name and size) is persisted to MPP file.
Sometimes the resulting MPP file is opened on another environment where the specified font may be missing. To address this issue we introduced FontResolveCallback
which can be used to intercept font resolving event. The callback is invoked when the project&rsquo;s view is saved to a graphical format and the rendering engine resolves a font to render a text.</p><p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Project project <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Project<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Input.mpp&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>PdfSaveOptions so <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PdfSaveOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>so<span style=color:#f92672>.</span><span style=color:#a6e22e>setPresentationFormat</span><span style=color:#f92672>(</span>PresentationFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>GanttChart</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>so<span style=color:#f92672>.</span><span style=color:#a6e22e>setTimescale</span><span style=color:#f92672>(</span>Timescale<span style=color:#f92672>.</span><span style=color:#a6e22e>DefinedInView</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>so<span style=color:#f92672>.</span><span style=color:#a6e22e>setFontResolveCallback</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> FontResolveCallbackDelegate<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>invoke</span><span style=color:#f92672>(</span>FontResolveEventArgs args<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>Objects<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>args<span style=color:#f92672>.</span><span style=color:#a6e22e>getRequestedFontName</span><span style=color:#f92672>(),</span> args<span style=color:#f92672>.</span><span style=color:#a6e22e>getResolvedFontName</span><span style=color:#f92672>()))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Looks like the exact font cannot be found and fallback font was resolved.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#75715e>// We can override the fallback font.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            args<span style=color:#f92672>.</span><span style=color:#a6e22e>setResolvedFontName</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Arial&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Or simply substitute the specific font:
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>Objects<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span>args<span style=color:#f92672>.</span><span style=color:#a6e22e>getRequestedFontName</span><span style=color:#f92672>(),</span> <span style=color:#e6db74>&#34;Comic Sans MS&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            args<span style=color:#f92672>.</span><span style=color:#a6e22e>setResolvedFontName</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Arial&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>project<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Output.pdf&#34;</span><span style=color:#f92672>,</span> so<span style=color:#f92672>);</span></span></span></code></pre></div><strong>Related issue: TASKSNET-2596 - Add support for &ldquo;Calculation for task and group summary rows&rdquo; custom field option</strong></p><p>The API for Extended attributes were improved. The previous ExtendedAttributeDefinition API where
ExtendedAttributeDefinition.CalculationType should be one of the following: { None, Lookup, Rollup, Calculation } didn&rsquo;t
reflect all the cases such as extended attribute where values for leaf tasks are calculated using formula and values of
the summary tasks are calculated using rollup.
ExtendedAttributeDefinition.SummaryRowsCalculationType property (with values None, Rollup, UseFormula) was added to
reflect MS Project&rsquo;s model of extended attribute&rsquo;s settings.
ExtendedAttributeDefinition.CalculationType&rsquo;s values are now limited to (None, Lookup, Formula) values.</p><p><img src=../ExtendedAttributeDefinition.png alt="Extended attribute settings in MS Project">
The following example creates an extended attribute which values for leaf tasks are calculated using formula and values for summary tasks are calculated using average rollup:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Project project <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Project<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Test.mpp&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>ExtendedAttributeDefinition definition <span style=color:#f92672>=</span> ExtendedAttributeDefinition<span style=color:#f92672>.</span><span style=color:#a6e22e>createTaskDefinition</span><span style=color:#f92672>(</span>ExtendedAttributeTask<span style=color:#f92672>.</span><span style=color:#a6e22e>Cost1</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;Calculated cost&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>definition<span style=color:#f92672>.</span><span style=color:#a6e22e>setCalculationType</span><span style=color:#f92672>(</span>CalculationType<span style=color:#f92672>.</span><span style=color:#a6e22e>Formula</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>definition<span style=color:#f92672>.</span><span style=color:#a6e22e>setFormula</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;[Cost] * 3.14&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>definition<span style=color:#f92672>.</span><span style=color:#a6e22e>setSummaryRowsCalculationType</span><span style=color:#f92672>(</span>SummaryRowsCalculationType<span style=color:#f92672>.</span><span style=color:#a6e22e>Rollup</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>definition<span style=color:#f92672>.</span><span style=color:#a6e22e>setRollupType</span><span style=color:#f92672>(</span>RollupType<span style=color:#f92672>.</span><span style=color:#a6e22e>Average</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>project<span style=color:#f92672>.</span><span style=color:#a6e22e>getExtendedAttributes</span><span style=color:#f92672>().</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>definition<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>project<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Output.mpp&#34;</span><span style=color:#f92672>);</span></span></span></code></pre></div><strong>Related issue: TASKSNET-10496 - Make WorkingTime immutable</strong></p><p>In order to optimize calendar-related calculations WorkingTime class was made immutable (so properties cannot be modified after object is created).
Also 2 new overloads of constructor of WorkingTime class were added to allow less verbose creation of WorkingTime:</p><p>22.3 version:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>WorkingTime wt <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> WorkingTime<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> GregorianCalendar<span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> Calendar<span style=color:#f92672>.</span><span style=color:#a6e22e>JANUARY</span><span style=color:#f92672>,</span> 1<span style=color:#f92672>,</span> 9<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> 0<span style=color:#f92672>).</span><span style=color:#a6e22e>getTime</span><span style=color:#f92672>(),</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> GregorianCalendar<span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> Calendar<span style=color:#f92672>.</span><span style=color:#a6e22e>JANUARY</span><span style=color:#f92672>,</span> 1<span style=color:#f92672>,</span> 12<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> 0<span style=color:#f92672>).</span><span style=color:#a6e22e>getTime</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>WorkingTime wt2 <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> WorkingTime<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> GregorianCalendar<span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> Calendar<span style=color:#f92672>.</span><span style=color:#a6e22e>JANUARY</span><span style=color:#f92672>,</span> 1<span style=color:#f92672>,</span> 9<span style=color:#f92672>,</span> 15<span style=color:#f92672>,</span> 0<span style=color:#f92672>).</span><span style=color:#a6e22e>getTime</span><span style=color:#f92672>(),</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> GregorianCalendar<span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> Calendar<span style=color:#f92672>.</span><span style=color:#a6e22e>JANUARY</span><span style=color:#f92672>,</span> 1<span style=color:#f92672>,</span> 12<span style=color:#f92672>,</span> 15<span style=color:#f92672>,</span> 0<span style=color:#f92672>).</span><span style=color:#a6e22e>getTime</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span><span style=color:#f92672>);</span></span></span></code></pre></div>22.4+ version:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>WorkingTime wt <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> WorkingTime<span style=color:#f92672>(</span>9<span style=color:#f92672>,</span> 12<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Calculate time of the day in milliseconds using formula:
</span></span></span><span style=display:flex><span><span style=color:#75715e>// (hours * 3600 + minutes * 60 + seconds) * 1000.0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>WorkingTime wt2 <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> WorkingTime<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>(</span>9 <span style=color:#f92672>*</span> 3600 <span style=color:#f92672>+</span> 15 <span style=color:#f92672>*</span> 60<span style=color:#f92672>)</span> <span style=color:#f92672>*</span> 1000<span style=color:#f92672>.</span><span style=color:#a6e22e>0</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>(</span>12 <span style=color:#f92672>*</span> 3600 <span style=color:#f92672>+</span> 15 <span style=color:#f92672>*</span> 60<span style=color:#f92672>)</span> <span style=color:#f92672>*</span> 1000<span style=color:#f92672>.</span><span style=color:#a6e22e>0</span>
</span></span><span style=display:flex><span><span style=color:#f92672>);</span></span></span></code></pre></div></p></p></div></div></div></div><hr></div></div></section></div></div></div></div></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>