<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Aspose.Tasks for Java 21.3 Release Notes</title><meta name=description content="The page contains the release notes for Aspose.Tasks for Java 21.3."><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=canonical href=https://releases-qa.aspose.com/tasks/java/release-notes/2021/aspose-tasks-for-java-21-3-release-notes/><link rel=alternate hreflang=x-default href=https://releases-qa.aspose.com/tasks/java/release-notes/2021/aspose-tasks-for-java-21-3-release-notes/><meta name=robots content="noindex, nofollow"><link rel=apple-touch-icon sizes=180x180 href=/res_repo/apple-touch-icon.png><link rel=icon type=image/png href=/res_repo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/res_repo/favicon-16x16.png sizes=16x16><link rel=mask-icon href=/res_repo/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Aspose.Tasks for Java 21.3 Release Notes "><meta property="og:description" content="The page contains the release notes for Aspose.Tasks for Java 21.3."><meta property="og:type" content="article"><meta property="og:url" content="https://releases-qa.aspose.com/tasks/java/release-notes/2021/aspose-tasks-for-java-21-3-release-notes/"><meta itemprop=name content="Aspose.Tasks for Java 21.3 Release Notes"><meta itemprop=description content="The page contains the release notes for Aspose.Tasks for Java 21.3."><meta itemprop=wordCount content="953"><meta name=twitter:card content="summary"><meta name=twitter:title content="Aspose.Tasks for Java 21.3 Release Notes"><meta name=twitter:description content="The page contains the release notes for Aspose.Tasks for Java 21.3."><link href=/css/bootstrap.css rel=stylesheet type=text/css><script src=https://releases-qa.aspose.com/res_repo/js/jquery-1.10.2.min.js></script></head><body><div id=header></div><div class=downloadpage><div class="container-fluid bcrumb1"><div id=sticky1 class=stickytopheight>&nbsp;</div><div class=container><div class=moduletable><ul id=dvBC class=breadcrumb><li><a href=/>Home</a><span class=divider></span></li><li><a href=/tasks/>Aspose.Tasks Product Family</a><span class=divider></span></li><li><a href=/tasks/java/>Aspose.Tasks for Java</a><span class=divider></span></li><li><a href=/tasks/java/release-notes/>Release Notes</a><span class=divider></span></li><li><a href=/tasks/java/release-notes/2021/>2021</a><span class=divider></span></li><li><a href=/tasks/java/release-notes/2021/aspose-tasks-for-java-21-3-release-notes/>Aspose.Tasks for Java 21.3 Release Notes</a><span class=divider></span></li></ul></div></div></div><div class="container-fluid content2 vpanel-left"><div class=container><div class=row><div class="col-md-3 vpanel tree-section"><p class=list-title>Browse our Products<button type=button class=treeview-toggle> <span class=sr-only>Toggle navigation</span> <span class="icon expand-icon glyphicon glyphicon-hide"></span></button></p><div id=tree class="treeview hidetree"></div></div><div class="col-md-9 lhs1 col-xs-12 mobilehide node-section"><div class=box1><section role=main class="main-container page-package-details"><div class=row><div class="col-sm-9 package-details-main"><h1><strong>Aspose.Tasks for Java 21.3 Release Notes</strong></h1><div class="tab-content body-tab-content"><div role=tabpanel class="tab-pane active" id=readme-tab><div class=readme-common><div id=readme-container><p><div class="alert alert-primary" role=alert>This page contains release notes information for <a href=https://releases.aspose.com/tasks/java/new-releases/aspose.tasks-for-java-21.3/>Aspose.Tasks for Java 21.3</a>.</div><h2 id=all-changes><strong>All Changes</strong></h2><table><thead><tr><th style=text-align:left><strong>Key</strong></th><th style=text-align:left><strong>Summary</strong></th><th style=text-align:left><strong>Issue Type</strong></th></tr></thead><tbody><tr><td style=text-align:left>TASKSNET-4597</td><td style=text-align:left>Add support for &lsquo;Task Summary Name&rsquo; field.</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>TASKSNET-4642</td><td style=text-align:left>Add support for user-defined page size when saving project to graphical format</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>TASKSNET-4636</td><td style=text-align:left>Improve rendering of Gantt view page legend to use &ldquo;adaptive&rdquo; items layout</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>TASKSNET-4635</td><td style=text-align:left>Add handling of &ldquo;AADSTS53003: Access has been blocked by Conditional Access policies.<br>The access policy does not allow token issuance.&rdquo; error and return clear message to the user</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>TASKSNET-4632</td><td style=text-align:left>Fix Actual Duration while setting Actual Finish date of the task</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>TASKSNET-4467</td><td style=text-align:left>Improve support of XML baseline for MSP 2019</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>TASKSNET-3585</td><td style=text-align:left>Add support of &ldquo;RenderToSinglePage&rdquo; option to TaskUsage, ResourceUsage,<br>TaskSheet and ResourceSheet views</td><td style=text-align:left>Enhancement</td></tr><tr><td style=text-align:left>TASKSNET-4631</td><td style=text-align:left>Fix incorrect position of not fit task labels when rendering Gantt chart view</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-4628</td><td style=text-align:left>Fix incorrect error message shown when trying to read a list of projects from empty Project Online account</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-4599</td><td style=text-align:left>Fix application of bar styles with non-default names when rendering Gantt chart view</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-4588</td><td style=text-align:left>Fix exception when trying to add a new task in XER project</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-4601</td><td style=text-align:left>Fix duplicated resources when reading XER of P6XML file</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-4668</td><td style=text-align:left>Fix recalculation of projects with external links</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-4667</td><td style=text-align:left>Fix ArgumentOutOfRangeException while recalculate a project</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-4666</td><td style=text-align:left>Fix NullReferenceException while recalculate the project</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-4644</td><td style=text-align:left>Fix XerPrimaveraReader to construct project with non broken integrity</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-4640</td><td style=text-align:left>Fix System.OverflowException when trying to save password-protected project twice</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-4611</td><td style=text-align:left>Fix exception when opening specific password protected MPP</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-4608</td><td style=text-align:left>Portrait/Landscape orientation setting ignored when printing / saving to PDF</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-4604</td><td style=text-align:left>Fix current timescale position is reset when the project is saved by Aspose.Tasks</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-4410</td><td style=text-align:left>Content of a resource&rsquo;s notes is not shown in MS Project</td><td style=text-align:left>Bug</td></tr><tr><td style=text-align:left>TASKSNET-4051</td><td style=text-align:left>Fix calculating of duration while convert MPP format</td><td style=text-align:left>Bug</td></tr></tbody></table><h2 id=public-api-and-backwards-incompatible-changes><strong>Public API and Backwards Incompatible Changes</strong></h2><table><thead><tr><th style=text-align:left><strong>The following public methods and properties were added:</strong></th><th style=text-align:left><strong>Description</strong></th></tr></thead><tbody><tr><td style=text-align:left>com.aspose.tasks.View.forViewScreen(/<em>ViewScreen</em>/ int)</td><td style=text-align:left>Constructs a new instance of the <see cref=View>class which can be displayed in the specified ViewScreen.</td></tr><tr><td style=text-align:left>com.aspose.tasks.SaveOptions.CustomPageSize</td><td style=text-align:left>Gets or sets the custom page size in points (1 point = 1/72 of inch).</td></tr><tr><td style=text-align:left>com.aspose.tasks.SaveOptions.RenderToSinglePage</td><td style=text-align:left>Gets or sets a value indicating whether image should be rendered to a single page. Currently is supported for Gantt chart view.</td></tr><tr><td style=text-align:left>com.aspose.tasks.PageSettings.PaperSizeId</td><td style=text-align:left>Gets or sets an integer representing one of the PrinterPaperSize values or a custom page size id.</td></tr></tbody></table><table><thead><tr><th style=text-align:left><strong>The following public enumerations were added:</strong></th><th style=text-align:left><strong>Description</strong></th></tr></thead><tbody><tr><td style=text-align:left>com.aspose.tasks.Shape.Diamond</td><td style=text-align:left>Indicates Diamond shape.</td></tr><tr><td style=text-align:left>com.aspose.tasks.TaskSummaryName</td><td style=text-align:left>The name of the summary task associated with the task.</td></tr><tr><td style=text-align:left>com.aspose.tasks.PageSize.DefinedInView</td><td style=text-align:left>Use page size defined in View&rsquo;s <see cref=T:com.aspose.tasks.PageSettings>(View.PageInfo.PageSettings).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.Custom</td><td style=text-align:left>Indicates that the paper size is defined by the user.</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperLetterSmall</td><td style=text-align:left>Indicates Small Letter printer paper size (8.5 in. by 11 in.).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperLedger</td><td style=text-align:left>Indicates Ledger printer paper size (17 in. by 11 in.).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperStatement</td><td style=text-align:left>Indicates Statement printer paper size (5.5 in. by 8.5 in.).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperA4Small</td><td style=text-align:left>Indicates Small A4 printer paper size (210 mm by 297 mm).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperA5</td><td style=text-align:left>Indicates A5 printer paper size (148 mm by 210 mm).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperFolio</td><td style=text-align:left>Indicates Folio printer paper size (8.5 in. by 13 in.).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperQuarto</td><td style=text-align:left>Indicates Quarto printer paper size (215 mm by 275 mm).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperStandard10x14</td><td style=text-align:left>Indicates Standard printer paper size (10 in. by 14 in.).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperStandard11x17</td><td style=text-align:left>Indicates Standard printer paper size (11 in. by 17 in.).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperNote</td><td style=text-align:left>Indicates Note printer paper size (8.5 in. by 11 in.).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperCSheet</td><td style=text-align:left>Indicates C paper printer paper size (17 in. by 22 in.).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperDSheet</td><td style=text-align:left>Indicates D paper printer paper size (22 in. by 34 in.).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperESheet</td><td style=text-align:left>Indicates E paper printer paper size (34 in. by 44 in.).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperStandard9x11</td><td style=text-align:left>Indicates Standard printer paper size (9 in. by 11 in.).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperStandard10x11</td><td style=text-align:left>Indicates Standard printer paper size (10 in. by 11 in.).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperStandard15x11</td><td style=text-align:left>Indicates Standard printer paper size (15 in. by 11 in.).</td></tr><tr><td style=text-align:left>com.aspose.tasks.PrinterPaperSize.PaperA2</td><td style=text-align:left>Indicates A2 printer paper size (420 mm by 594 mm).</td></tr></tbody></table><h2 id=examples><strong>Examples</strong></h2><p>Related issue: TASKSNET-4597 - Field &lsquo;TaskSummaryName&rsquo; can be used in view&rsquo;s columns</p><p>In order to show &lsquo;TaskSummaryName&rsquo; column in exported document the next code sample can be used:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>TableField field <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> TableField<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>field<span style=color:#f92672>.</span><span style=color:#a6e22e>setField</span><span style=color:#f92672>(</span>Field<span style=color:#f92672>.</span><span style=color:#a6e22e>TaskSummaryName</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>field<span style=color:#f92672>.</span><span style=color:#a6e22e>setTitle</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Task Summary Name&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>field<span style=color:#f92672>.</span><span style=color:#a6e22e>setWidth</span><span style=color:#f92672>(</span>30<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>project<span style=color:#f92672>.</span><span style=color:#a6e22e>getViews</span><span style=color:#f92672>().</span><span style=color:#a6e22e>toList</span><span style=color:#f92672>().</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span>0<span style=color:#f92672>).</span><span style=color:#a6e22e>getTable</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getTableFields</span><span style=color:#f92672>().</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>field<span style=color:#f92672>);</span></span></span></code></pre></div></p><p>Related issue: TASKSNET-4642 - Add support for user-defined page size when saving a project to a graphical format</p><p>SaveOptions.CustomPageSize property added so the user can specify custom page size when saving a project to graphical formats.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Project project <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Project<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;test.mpp&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>ImageSaveOptions saveOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ImageSaveOptions<span style=color:#f92672>(</span>SaveFileFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>PNG</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setTimescale</span><span style=color:#f92672>(</span>Timescale<span style=color:#f92672>.</span><span style=color:#a6e22e>DefinedInView</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setCustomPageSize</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> java<span style=color:#f92672>.</span><span style=color:#a6e22e>awt</span><span style=color:#f92672>.</span><span style=color:#a6e22e>Dimension</span><span style=color:#f92672>(</span>1224<span style=color:#f92672>,</span> 340<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setStartDate</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> GregorianCalendar<span style=color:#f92672>(</span>2012<span style=color:#f92672>,</span> Calendar<span style=color:#f92672>.</span><span style=color:#a6e22e>DECEMBER</span><span style=color:#f92672>,</span> 22<span style=color:#f92672>).</span><span style=color:#a6e22e>getTime</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setEndDate</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> GregorianCalendar<span style=color:#f92672>(</span>2013<span style=color:#f92672>,</span> Calendar<span style=color:#f92672>.</span><span style=color:#a6e22e>MAY</span><span style=color:#f92672>,</span> 10<span style=color:#f92672>).</span><span style=color:#a6e22e>getTime</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPresentationFormat</span><span style=color:#f92672>(</span>PresentationFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>ResourceUsage</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>project<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;output.png&#34;</span><span style=color:#f92672>,</span> saveOptions<span style=color:#f92672>);</span></span></span></code></pre></div><p>Related issue: TASKSNET-3585 - Add support of &ldquo;RenderToSinglePage&rdquo; option to TaskUsage, ResourceUsage, TaskSheet and ResourceSheet views</p><p>Now SaveOptions.RenderToSinglePage property can be used to specify that the project should be rendered to single page document. In this case the size of the page is adjusted to fit project on one page.
SaveOptions.RenderToSinglePage flag is applicable when project is saved to PDF or graphical formats.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Project project <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Project<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;test.mpp&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PdfSaveOptions saveOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> PdfSaveOptions<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setTimescale</span><span style=color:#f92672>(</span>Timescale<span style=color:#f92672>.</span><span style=color:#a6e22e>DefinedInView</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setRenderToSinglePage</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setStartDate</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> GregorianCalendar<span style=color:#f92672>(</span>2012<span style=color:#f92672>,</span> Calendar<span style=color:#f92672>.</span><span style=color:#a6e22e>DECEMBER</span><span style=color:#f92672>,</span> 22<span style=color:#f92672>).</span><span style=color:#a6e22e>getTime</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setEndDate</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> GregorianCalendar<span style=color:#f92672>(</span>2013<span style=color:#f92672>,</span> Calendar<span style=color:#f92672>.</span><span style=color:#a6e22e>MAY</span><span style=color:#f92672>,</span> 10<span style=color:#f92672>).</span><span style=color:#a6e22e>getTime</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPresentationFormat</span><span style=color:#f92672>(</span>PresentationFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>TaskUsage</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>project<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;output.pdf&#34;</span><span style=color:#f92672>,</span> saveOptions<span style=color:#f92672>);</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Project project <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Project<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;TestProject.mpp&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ImageSaveOptions saveOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ImageSaveOptions<span style=color:#f92672>(</span>SaveFileFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>PNG</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setTimescale</span><span style=color:#f92672>(</span>Timescale<span style=color:#f92672>.</span><span style=color:#a6e22e>DefinedInView</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setRenderToSinglePage</span><span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setStartDate</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> GregorianCalendar<span style=color:#f92672>(</span>2012<span style=color:#f92672>,</span> Calendar<span style=color:#f92672>.</span><span style=color:#a6e22e>DECEMBER</span><span style=color:#f92672>,</span> 22<span style=color:#f92672>).</span><span style=color:#a6e22e>getTime</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setEndDate</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> GregorianCalendar<span style=color:#f92672>(</span>2013<span style=color:#f92672>,</span> Calendar<span style=color:#f92672>.</span><span style=color:#a6e22e>MAY</span><span style=color:#f92672>,</span> 10<span style=color:#f92672>).</span><span style=color:#a6e22e>getTime</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPresentationFormat</span><span style=color:#f92672>(</span>PresentationFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>TaskUsage</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setHorizontalResolution</span><span style=color:#f92672>(</span>300<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setVerticalResolution</span><span style=color:#f92672>(</span>300<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>project<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;output.png&#34;</span><span style=color:#f92672>,</span> saveOptions<span style=color:#f92672>);</span></span></span></code></pre></div><p>Related issue: TASKSNET-4608 - Portrait/Landscape orientation setting ignored when printing / saving to pdf</p><p>Added PageSize.DefinedInView enum value so the user can specify that the project should be rendered using page size and page orientation settings defined in view&rsquo;s settings.
These settings can be changed using &ldquo;Page Setup&rdquo; dialog of Microsoft Project.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Project project <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Project<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;test.mpp&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>View view <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>View v <span style=color:#f92672>:</span> project<span style=color:#f92672>.</span><span style=color:#a6e22e>getViews</span><span style=color:#f92672>())</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>v<span style=color:#f92672>.</span><span style=color:#a6e22e>getScreen</span><span style=color:#f92672>()</span> <span style=color:#f92672>==</span> ViewScreen<span style=color:#f92672>.</span><span style=color:#a6e22e>Gantt</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        view <span style=color:#f92672>=</span> v<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Page size specified in view settings: &#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>+</span> PrinterPaperSize<span style=color:#f92672>.</span><span style=color:#a6e22e>toString</span><span style=color:#f92672>(</span>PrinterPaperSize<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>,</span> view<span style=color:#f92672>.</span><span style=color:#a6e22e>getPageInfo</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getPageSettings</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getPaperSize</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Page orientation: &#34;</span> 
</span></span><span style=display:flex><span>        <span style=color:#f92672>+</span> <span style=color:#f92672>(</span>view<span style=color:#f92672>.</span><span style=color:#a6e22e>getPageInfo</span><span style=color:#f92672>().</span><span style=color:#a6e22e>getPageSettings</span><span style=color:#f92672>().</span><span style=color:#a6e22e>isPortrait</span><span style=color:#f92672>()</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;Portrait&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Landscape&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ImageSaveOptions saveOptions <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ImageSaveOptions<span style=color:#f92672>(</span>SaveFileFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>PNG</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPageSize</span><span style=color:#f92672>(</span>PageSize<span style=color:#f92672>.</span><span style=color:#a6e22e>DefinedInView</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setTimescale</span><span style=color:#f92672>(</span>Timescale<span style=color:#f92672>.</span><span style=color:#a6e22e>DefinedInView</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setStartDate</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> GregorianCalendar<span style=color:#f92672>(</span>2012<span style=color:#f92672>,</span> Calendar<span style=color:#f92672>.</span><span style=color:#a6e22e>DECEMBER</span><span style=color:#f92672>,</span> 22<span style=color:#f92672>).</span><span style=color:#a6e22e>getTime</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setEndDate</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> GregorianCalendar<span style=color:#f92672>(</span>2013<span style=color:#f92672>,</span> Calendar<span style=color:#f92672>.</span><span style=color:#a6e22e>MAY</span><span style=color:#f92672>,</span> 10<span style=color:#f92672>).</span><span style=color:#a6e22e>getTime</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>saveOptions<span style=color:#f92672>.</span><span style=color:#a6e22e>setPresentationFormat</span><span style=color:#f92672>(</span>PresentationFormat<span style=color:#f92672>.</span><span style=color:#a6e22e>GanttChart</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>project<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;output.png&#34;</span><span style=color:#f92672>,</span> saveOptions<span style=color:#f92672>);</span></span></span></code></pre></div></p></div></div></div></div><hr></div></div></section></div></div></div></div></div></div><div id=dvHidden style=display:none></div><div id=footer></div><a class=backtop>&nbsp;</a><div id=DynabicMenuFooter></div><script type=text/javascript>const langarray=[]</script><script type=text/javascript>jQuery(document).ready(function(){let e=$(".nested").hide(),t=$(".treeview-animated-element");$(".treeview-animated-items-header").hover(function(){$(this).children.toggleClass("Mydiv")}),$(".treeview-animated-items-header").click(function(){return console.log("mala"),$this=$(this),console.log($this.attr("id")),$target=$this.siblings(".nested"),$pointerPlus=$this.children(".fa-plus"),$pointerMinus=$this.children(".fa-minus"),$pointerPlus.removeClass("fa-plus"),$pointerPlus.addClass("fa-minus"),$pointerMinus.removeClass("fa-minus"),$pointerMinus.addClass("fa-plus"),$this.toggleClass("open"),$target.hasClass("active")?$target.removeClass("active").slideUp():$target.addClass("active").slideDown(),!1})})</script><script>(function(e,s,o,a,t,n,i){e.ContainerizeMenuObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=s.createElement(o),i=s.getElementsByTagName(o)[0],n.async=1,n.src=a,i.parentNode.append(n)})(window,document,"script","https://menu.containerize.com/scripts/engine.min.js?v=1.0.1","aspose-en")</script><script src=https://releases-qa.aspose.com/res_repo/js/highlight.min.js></script>
<script src=https://releases-qa.aspose.com/res_repo/js/bootstrap.min.js></script>
<script src=/js/bundle.min.js></script>
<script src=/js/dynabic.treeview.js></script>
<script src=/js/treeviewmanager.js></script>
<script>hljs.highlightAll()</script><link rel=stylesheet type=text/css href=https://releases-qa.aspose.com/res_repo/css/hugocustom.css><script>$(".btn-showside .mb-5").on("click",function(){$("main .flex .dn.db-l").toggleClass("showsidebar"),$("main .flex .w-100").toggleClass("noscroll")}),$(".btn-showmenu").on("click",function(){$("nav.bg-primary-color-dark").toggleClass("showmenu")}),$(".btn-plain").on("click",function(){$("main .flex .dn.db-l").removeClass("showsidebar"),$("main .flex .dn.db-l").removeClass("showsidebar"),$("nav.bg-primary-color-dark").removeClass("showmenu")}),$(".ss-bar ul li a[data-target]").on("click",function(){$(this).find(".i.fa-angle-down").hasClass("fa-angle-up")?$(this).find("i.fa-angle-down").removeClass("fa-angle-up"):$(this).find("i.fa-angle-down").toggleClass("fa-angle-up")}),$(".btn-showside").on("click",function(){$(".ss-bar").toggleClass("showsidebar")}),$(".btn-plain").on("click",function(){$(".ss-bar").removeClass("showsidebar")})</script><script>$(document).ready(function(){$("div pre").removeAttr("style");var e,t=$(location).attr("hash");"#package-explorer"==t&&(e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]'),e&&e.click()),$('a:has(img[alt="banner"]').click(function(){event.preventDefault();var e=document.querySelector('.nav-tabs a[href="#packageexplorer-tab"]');e&&e.click()}),$(window).scroll(function(){$(this).scrollTop()>150?$(".backtop").fadeIn():$(".backtop").fadeOut()}),$(".backtop").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".linkshow").on("click",function(){$(this).find("i").toggleClass("fa-minus-square"),$(".linkshowbox").toggleClass("hide")}),document.querySelector("body").addEventListener("click",function(t){if(t.target.classList.contains("searchButton")){$(".ss-bar").removeClass("showsidebar");try{var e=$("input[name=q]").val();gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}if(t.target.classList.contains("fa-search")){$(".ss-bar").removeClass("showsidebar");try{e=$("input[name=q]").val(),gtag("config","UA-3109235-2",{page_path:"/search/?q="+e})}catch(e){}}},!0)})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>