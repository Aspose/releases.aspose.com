---
id: "aspose-cells-for-java-17-02-0-release-notes"
slug: "aspose-cells-for-java-17-02-0-release-notes"
linktitle: "Aspose.Cells for Java 17.02.0 发行说明"
title: "Aspose.Cells for Java 17.02.0 发行说明"
weight: 110
description: "Aspose.Cells for Java 17.02.0 发行说明 – the latest updates and fixes."
type: "repository"
layout: "release"
family_listing_page_title: "Aspose.Cells for Java 17.02.0 发行说明"
---
{{% alert color="primary" %}} 

此页面包含发行说明[Aspose.Cells for Java 17.02.0](https://releases.aspose.com/cells/java/new-releases/aspose.cells-for-java-17.02.0/).

{{% /alert %}} 

|**钥匙**|**概括**|**类别**|
|:- |:- |:- |
|CELLSJAVA-42009|支持 MS Excel 2016 TreeMap Chart|新功能|
|CELLSJAVA-42008|支持 MS Excel 2016 瀑布图|新功能|
|CELLSJAVA-41521|支持将文本转换为列 MS Excel 功能|新功能|
|CELLSJAVA-42165|将包含隐藏行和列的范围复制到新工作簿并将其转换为 HTML 时数据丢失|漏洞|
|CELLSJAVA-42164|将包含隐藏行和列的范围复制到新工作簿并将其转换为 HTML 时数据丢失 - II|漏洞|
|CELLSJAVA-42162|将包含隐藏行和列的范围复制到新工作簿并将其转换为 HTML 时数据丢失 - III|漏洞|
|CELLSJAVA-40251|另存为 PDF 不保留格式|漏洞|
|CELLSJAVA-42187|Excel 公式无效并显示为“#DIV/0!”|漏洞|
|CELLSJAVA-42184|并发保存问题|漏洞|
|CELLSJAVA-42156|转换为 HTML 时单元格的顶部和底部边框消失|漏洞|
|CELLSJAVA-42147|Excel 公式无法正常工作|漏洞|
|CELLSJAVA-42131|使用 Aspose Cells API 重新计算多个公式会导致“#NUM!”错误|漏洞|
|CELLSJAVA-42188|在 GridWeb (Java) 演示项目中无法正确加载数学演示页面|漏洞|
|CELLSJAVA-41565|列表数据验证下拉列表在重新加载数据时不会关闭|漏洞|
|CELLSJAVA-42159|PageSetup.BlackAndWhite 似乎不起作用|漏洞|
|CELLSNET-45106|try catch 中的错误，并在 ExceptionType 发生更改时重新抛出异常|漏洞|
|CELLSJAVA-42189|瀑布图，当调用 calculate() 时，图表系列颜色将恢复。|漏洞|
|CELLSJAVA-42160|Excel 中的对数刻度错误导致 Aspose Cells 挂起|漏洞|
|CELLSJAVA-42158|将电子表格呈现为 PDF 时垂直轴绑定值已更改|漏洞|
|CELLSJAVA-42157|将图表呈现为 EMF 时，水平轴和垂直轴的边界值已更改|漏洞|
|CELLSJAVA-42133|希伯来语 - PDF 中缺少空格字符|漏洞|
|CELLSJAVA-42107|渲染到图像时图表被垂直抑制|漏洞|
|CELLSJAVA-42105|将图表导出到图像时缺少 DataTable 系列|漏洞|
|CELLSJAVA-42090|图表转换为图像时标题中缺少下划线|漏洞|
|CELLSJAVA-42086|图表中的背景图像错误|漏洞|
|CELLSJAVA-42084|输出 PDF 文件中缺少空间黑白图表的轴（希伯来文）标签/图例|漏洞|
|CELLSJAVA-41831|将电子表格转换为 HTML 时不呈现矩形的内容|漏洞|
|CELLSJAVA-42095|将电子表格转换为 HTML 时图表已更改|漏洞|
|CELLSJAVA-42096|将电子表格转换为 HTML 时图表中的公式已更改位置|漏洞|
|CELLSJAVA-42169|Excel 到 PDF 转换 - 阿拉伯文本被反转|漏洞|
|CELLSJAVA-42193|工作表名称在插入公式时变为大写|漏洞|
|CELLSJAVA-42191|调用 updateSelectedValue 更改 activeSheetIndex|漏洞|
|CELLSJAVA-42181|重新保存 XLS 文件后的受保护视图|漏洞|
|CELLSJAVA-42180|复制工作簿会更改标准高度|漏洞|
|CELLSJAVA-42177|以 XLS 格式保存工作簿时自定义验证中的公式丢失|漏洞|
|CELLSJAVA-42173|Excel 需要通过 Aspose.Cells 简单保存后恢复文件|漏洞|
|CELLSJAVA-42171|更改形状的字体后电子表格损坏|漏洞|
|CELLSJAVA-42168|无法更改集合中一些形状的字体|漏洞|
|CELLSJAVA-42166|受密码保护的 Excel 文件在加载时抛出异常|漏洞|
|CELLSJAVA-42163|目标工作簿的大小几乎是源工作簿的两倍|漏洞|
|CELLSJAVA-42161|跨工作簿复制工作表会更改公式|漏洞|
|CELLSJAVA-42154|无法读取复选框的文本值|漏洞|
|CELLSJAVA-42150|GetNames() 方法未返回所有名称|漏洞|
|CELLSJAVA-40511|Aspose.Cells生成的PDF的页面全黑|漏洞|
|CELLSJAVA-42179|加载 HTML 时 Workbook ctor 出现 NullPointerException|例外|
|CELLSJAVA-42174|加载 HTML 时 Workbook ctor 出现 NullPointerException - II|例外|
|CELLSJAVA-42192|CellsException：无效的孔大小：它必须在 10 到 90 之间|例外|
|CELLSJAVA-42190|异常：加载 XLSX 文件格式时出现“java.lang.IndexOutOfBoundsException”|例外|
|CELLSJAVA-42185|异常 - 只能调用 ReadElementString - 在打开工作簿时发生|例外|
## **公共 API 和向后不兼容的更改**
以下是对公众 API 所做的任何更改的列表，例如添加、重命名、删除或弃用成员，以及对 Aspose.Cells for Java 所做的任何非向后兼容更改。如果您对列出的任何更改有疑虑，请在Aspose.Cells 支持论坛。
### **添加了 HTMLLoadOptions.AutoFitColsAndRows 属性**
此版本的 Aspose.Cells for Java API 添加了 HTMLLoadOptions.AutoFitColsAndRows 属性，该属性指示 API 是否应在其对象模式下导入 HTML 时自动调整列和行。布尔类型属性的默认值为 false，这意味着单元格的高度和宽度将按原样导入，但是，当上述属性设置为 true 时，API 会尝试根据内容调整列宽和行高.

下面是 HTMLLoadOptions.AutoFitColsAndRows 属性的简单使用场景。

{{< highlight "java" >}}

 // Create an instance of HTMLLoadOptions

HTMLLoadOptions loadOptions = new HTMLLoadOptions();

// Set the AutoFitColsAndRows property to true

loadOptions.setAutoFitColsAndRows(true);

// Create an instance of Workbook and load HTML while passing

// the object of HTMLLoadOptions class created above

Workbook book = new Workbook(dir + "sample.htm", loadOptions);

{{< /highlight >}}
### **添加了 WorkbookSettings.WarningCallback 和 LoadOptions.WarningCallback 属性**
Aspose.Cells for Java 17.02.0 已将 WarningCallback 属性公开给 LoadOptions 和 WorkbookSettings 类，以便获取或设置警告回调。开发人员必须实现 IWarningCallback 接口才能在他们的应用程序中获得自定义警告。

下面是 LoadOptions.WarningCallback 属性的一个简单使用场景，用于在输入电子表格包含重复的命名范围时获取警告。

{{< highlight "java" >}}

 public class WarningCallback implements IWarningCallback

{

	public void warning(WarningInfo warningInfo)

    {

        if (warningInfo.getWarningType() == WarningType.DUPLICATE_DEFINED_NAME)

        {

            System.out.println("Duplicate Defined Names Found as " + warningInfo.getDescription());

        }

    }

}

{{< /highlight >}}

下面是如何使用上面定义的自定义类。

{{< highlight "java" >}}

 // Create an instance of LoadOptions class

LoadOptions options = new LoadOptions();

// Set the WarningCallback property to custom class

options.setWarningCallback(new WarningCallback());

// Load a sample spreadsheet in an instance of Workbook while 

// passing the object of LoadOptions class as defined above

Workbook book = new Workbook(dir + "sample.xlsx", options);

{{< /highlight >}}
### **添加了 Cells.textToColumns 方法**
最新版本 Aspose.Cells for Java API 暴露了 Cells.textToColumns 方法以模仿 Excel 的**文本到列**特征。 Excel 从提供此功能**数据工具**在下面**数据**标签。请注意，为了将一列的内容拆分为多列，数据应包含特定的分隔符，例如逗号（或任何其他字符），API 会根据该分隔符尝试将一个单元格的内容拆分为多个单元格。

这里有一个简单的使用场景来演示新暴露的API的用法。

{{< highlight "java" >}}

 // Create an instance of Workbook and load a sample

Workbook book = new Workbook(dir + "sample.xlsx");

// Retrieve the cells collection of the first worksheet in the sample

Cells cells = book.getWorksheets().get(0).getCells();

// Create an instance of TxtLoadOptions

TxtLoadOptions options = new TxtLoadOptions();

// Specify the separator

options.setSeparator(',');

// Split the data in range B2:B4

cells.textToColumns(1, 1, 3, options);

{{< /highlight >}}
### **添加了 Workbook.getFonts 方法**
Aspose.Cells for Java 17.02.0 公开了 Workbook 类的 getFonts 方法。 Workbook.getFonts 方法返回用于格式化给定电子表格的单元格内容的单个字体的列表。上述方法的返回类型是 typeFont 类的数组。

以下代码片段演示了 Workbook.getFonts 方法的用法。

{{< highlight "java" >}}

 // 创建一个 Workbook 实例并加载一个示例

工作簿 book = new Workbook(dir + "sample.xlsx");

// 检索电子表格中使用的字体列表

字体 []字体 = book.getFonts();

// 迭代列表并写入字体名称

对于 (int i = 0; i< fonts.length; i ++)

{

	Font font = fonts[i];

	System.out.println(font.getName());

}

{{< /highlight >}}
### **添加了 TxtSaveOptions.TrimLeadingBlankRowAndColumn 属性**
此版本的 Aspose.Cells for Java 公开了 TxtSaveOptions 类的布尔类型 TrimLeadingBlankRowAndColumn 属性，该属性指示在将数据导出为 CSV 或制表符分隔格式时是否应像 Excel 那样修剪前导空白行和列。上述属性的默认值为 false。如果工作表上的数据不是从第一个单元格开始的，即：A1，Excel 应用程序在将数据导出为 CSV 或制表符分隔格式时删除前导空白行和列，但是，Aspose.Cells API 默认保留如果必须使用 Aspose.Cells API 将导出的 CSV 或制表符分隔的文件导回，则同一样本的空白行和列将保留数据位置。

下面是 TrimLeadingBlankRowAndColumn 属性的简单使用场景。

{{< highlight "java" >}}

 // Create an instance of Workbook and load a sample

Workbook book = new Workbook(dir + "sample.xlsx");

// Create an instance of TxtSaveOptions

TxtSaveOptions options = new TxtSaveOptions();

// Set TrimLeadingBlankRowAndColumn property to true

options.setTrimLeadingBlankRowAndColumn(true);

// Export to CSV format while removing the leading blank rows & columns

book.save(dir + "output.csv", options);

{{< /highlight >}}
### **添加了 BuiltInDocumentPropertyCollection.Revision 属性和废弃的 BuiltInDocumentPropertyCollection.RevisionNumber 属性**
请改用 BuiltInDocumentPropertyCollection.Revision 属性。
### **添加了 Shape.TextShapeType 属性**
Shape.TextShapeType 属性从存储在 AutoShapeType 枚举中的预定义类型列表中获取或设置预设文本形状类型。
### **使用示例**
请查看 Aspose.Cells Wiki 文档中添加的帮助主题列表：

1. [在工作簿中加载 HTML 时自动调整列和行](https://docs.aspose.com/cells/zh/java/autofit-columns-and-rows-while-loading-html-in-workbook/)
1. [使用 Aspose.Cells 将文本转换为列](https://docs.aspose.com/cells/zh/java/convert-text-to-columns-using-aspose-cells/)
1. [获取电子表格或工作簿中使用的字体列表](https://docs.aspose.com/cells/zh/java/get-a-list-of-fonts-used-in-a-spreadsheet-or-workbook/)
1. [加载 Excel 文件时收到警告](https://docs.aspose.com/cells/zh/java/get-warnings-while-loading-excel-file/)
1. [读取和操作 Excel 2016 图表](https://docs.aspose.com/cells/zh/java/read-and-manipulate-excel-2016-charts/)
1. [将电子表格导出为 CSV 格式时修剪前导空白行和列](https://docs.aspose.com/cells/zh/java/trim-leading-blank-rows-and-columns-while-exporting-spreadsheets-to-csv-format/)
