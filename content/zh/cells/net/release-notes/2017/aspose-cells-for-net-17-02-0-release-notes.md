---
id: "aspose-cells-for-net-17-02-0-release-notes"
slug: "aspose-cells-for-net-17-02-0-release-notes"
linktitle: "Aspose.Cells for .NET 17.02.0 发行说明"
title: "Aspose.Cells for .NET 17.02.0 发行说明"
weight: 110
description: "Aspose.Cells for .NET 17.02.0 发行说明 – the latest updates and fixes."
type: "repository"
layout: "release"
family_listing_page_title: "Aspose.Cells for .NET 17.02.0 发行说明"
---
{{% alert color="primary" %}} 

此页面包含发行说明[Aspose.Cells for .NET 17.02.0](https://releases.aspose.com/cells/net/new-releases/aspose.cells-for-.net-17.02.0/).

{{% /alert %}} 

|**钥匙**|**概括**|**类别**|
|:- |:- |:- |
|CELLSNET-45049|将电子表格导出为 CSV 格式时修剪空白行和列|新功能|
|CELLSNET-45069|将工作表绑定到自定义集合对象 (Aspose.Cells.GridWeb)|新功能|
|CELLSNET-44787|SortRange 没有撤消/重做功能 (Aspose.Cells.GridDesktop)|新功能|
|CELLSNET-44746|Aspose.Cells.GridDesktop：执行剪切/复制/粘贴时撤消/重做功能出现问题|新功能|
|CELLSNET-44230|Aspose.Cells.GridDesktop 的拆分窗格功能|新功能|
|CELLSNET-44416|将数据导出到 DataTable 时自动重命名重复的列名|新功能|
|CELLSNET-44363|检索工作簿中所有字体名称的实用方法|新功能|
|CELLSNET-42687|获取电子表格中使用的字体列表|新功能|
|CELLSNET-45048|生成的 PDF 文件不符合 PDFA1B 标准|强化|
|CELLSNET-45099|瀑布图和 TreeMap 图表，Series.getValues() 应将值显示为显示|强化|
|CELLSNET-45026|CalculateFormula() 方法返回时间太长|表现|
|CELLSNET-45071|CellsException：内存不足，同时将工作簿转换为 TIFF|表现|
|CELLSNET-45067|转换为 PDF 花费的时间太长|表现|
|CELLSNET-45105|当 CultureInfo 是法语时加载 HTML 失败|漏洞|
|CELLSNET-45089|HTML 到 Excel：Excel 文件已损坏|漏洞|
|CELLSNET-45072|XLS 中的艺术字不在 HTML 中呈现|漏洞|
|CELLSNET-45053|某些 HTML 标签未被考虑在内，某些内容丢失|漏洞|
|CELLSNET-45039|将 HTML 呈现为 Excel 时不考虑混合样式规则|漏洞|
|CELLSNET-45036|导入 HTML 转换为 XLSX 时标记后的内容被修剪|漏洞|
|CELLSNET-45035|当部分内容位于 STRONG 标记之间时，整个单元格内容会变为粗体|漏洞|
|CELLSNET-45033|Cell 内容在导入时被修剪 HTML|漏洞|
|CELLSNET-44336|无法将 Html 正确转换为 XLSX|漏洞|
|CELLSNET-45096|调用CalculateFormula()后，公式结果错误|漏洞|
|CELLSNET-45093|SUMPRODUCT 函数不起作用|漏洞|
|CELLSNET-45085|PDF LOGNORM.DIST 函数的计算值不正确|漏洞|
|CELLSNET-44740|自定义 DateTime 模式不能应用于 GridColumn|漏洞|
|CELLSNET-45130|使用 Excel 导出 PDF 和 Aspose.Cells 的不同结果另存为 PDF|漏洞|
|CELLSNET-45095|电子表格中的图片尚未呈现给 PDF|漏洞|
|CELLSNET-45075|电子表格中的超链接未导出到 PDF|漏洞|
|CELLSNET-45074|Excel 中的格式问题到 PDF 渲染|漏洞|
|CELLSNET-45070|在 Mono 上将电子表格转换为 PDF 时，3D 饼图不呈现|漏洞|
|CELLSNET-41283|PDF 从 Excel 和 Aspose.Cells 保存时不同|漏洞|
|CELLSNET-41196|ToTiff 函数问题 - 显示额外的列|漏洞|
|CELLSNET-41195|ToTiff 功能问题 - 数据丢失|漏洞|
|CELLSNET-45097|图表在 Workbook.Copy 后丢失标签格式|漏洞|
|CELLSNET-45084|将电子表格转换为 PDF 时图形值不同|漏洞|
|CELLSNET-45082|加载和保存源 Excel 文件后，选项卡 Chart9 上的图表发生变化|漏洞|
|CELLSNET-45066|将电子表格转换为 PDF 时形状被水平压缩|漏洞|
|CELLSNET-45064|将电子表格转换为 PDF 时不呈现轴标签|漏洞|
|CELLSNET-44842|图表转换为图像时标签丢失|漏洞|
|CELLSNET-44410|旋转的形状组错误渲染为图像|漏洞|
|CELLSNET-45121|重新保存后Excel文档为空|漏洞|
|CELLSNET-45120|删除范围后图表无法正确计算/刷新|漏洞|
|CELLSNET-45118|保存为 XLSM 后电子表格损坏|漏洞|
|CELLSNET-45107|合并工作簿时合并图表后文本框丢失|漏洞|
|CELLSNET-45104|更改 LinkSource 正在创建双倍条目|漏洞|
|CELLSNET-45101|更改现有边框的样式似乎不起作用|漏洞|
|CELLSNET-45094|加载和保存后文本位置发生变化 XLS|漏洞|
|CELLSNET-45090|添加页脚后未保存多选项卡排序顺序|漏洞|
|CELLSNET-45086|重新保存 Excel 文件后出现额外的复选框和“复选框”文本|漏洞|
|CELLSNET-45065|通过简单的加载和保存操作添加不需要的单元格边框|漏洞|
|CELLSNET-45052|加载和保存文件后文本位置发生变化|漏洞|
|CELLSNET-44835|WebWorksheet.CreateSubtotal 方法中的 System.NotImplementedException|例外|
|CELLSNET-45068|加载 Excel 文件时抛出异常|例外|
|CELLSNET-45112|调用Pictures.Clear()，然后Save XLS时，发生System.ArgumentOutOfRangeException|例外|
|CELLSNET-45111|保存XLS时，出现System.ArgumentOutOfRangeException|例外|
|CELLSNET-45108|XLSB 的工作簿构造函数中的 System.NullReferenceException|例外|
|CELLSNET-45103|Range.MoveTo() 抛出异常|例外|
|CELLSNET-45088|将电子表格呈现为 PDF 文件格式时出现异常|例外|
|CELLSNET-45080|加载 HTML 文件格式时出现异常|例外|
### **公共 API 和向后不兼容的更改**
以下是对公众 API 所做的任何更改的列表，例如添加、重命名、删除或弃用成员，以及对 Aspose.Cells for .NET 所做的任何非向后兼容更改。如果您对列出的任何更改有疑虑，请在Aspose.Cells 支持论坛。
#### **添加了 HTMLLoadOptions.AutoFitColsAndRows 属性**
此版本的 Aspose.Cells for .NET API 添加了 HTMLLoadOptions.AutoFitColsAndRows 属性，该属性指示 API 是否应在其对象模式下导入 HTML 时自动调整列和行。布尔类型属性的默认值为 false，这意味着单元格的高度和宽度将按原样导入，但是，当上述属性设置为 true 时，API 会尝试根据内容调整列宽和行高.

下面是 HTMLLoadOptions.AutoFitColsAndRows 属性的简单使用场景。

{{< highlight "java" >}}

 // Create an instance of HTMLLoadOptions

var loadOptions = new HTMLLoadOptions();

// Set the AutoFitColsAndRows property to true

loadOptions.AutoFitColsAndRows = true;

// Create an instance of Workbook and load HTML while passing

// the object of HTMLLoadOptions class created above

var book = new Workbook(dir + "sample.htm", loadOptions);

{{< /highlight >}}
#### **添加了 LoadOptions.WarningCallback 和 WorkbookSettings.WarningCallback 属性**
Aspose.Cells for .NET 17.02.0 已将 WarningCallback 属性公开给 LoadOptions 和 WorkbookSettings 类，以便获取或设置警告回调。开发人员必须实现 IWarningCallback 接口才能在他们的应用程序中获得自定义警告。

下面是 LoadOptions.WarningCallback 属性的一个简单使用场景，用于在输入电子表格包含重复的命名范围时获取警告。

{{< highlight "java" >}}

 public class WarningCallback : IWarningCallback

{

    public void Warning(WarningInfo warningInfo)

    {

        if (warningInfo.WarningType == WarningType.DuplicateDefinedName)

        {

            Console.WriteLine("Duplicate Defined Names Found as " + warningInfo.Description);

        }

    }

}

{{< /highlight >}}

下面是如何使用上面定义的自定义类。

{{< highlight "java" >}}

 // Create an instance of LoadOptions class

var options = new LoadOptions();

// Set the WarningCallback property to custom class

options.WarningCallback = new WarningCallback();

// Load a sample spreadsheet in an instance of Workbook while 

// passing the object of LoadOptions class as defined above

var book = new Workbook(dir + "sample.xlsx", options);

{{< /highlight >}}
#### **添加了 Cells.TextToColumns 方法**
最新版本 Aspose.Cells for .NET API 暴露了 Cells.TextToColumns 方法以模仿 Excel 的**文本到列**特征。 Excel 从提供此功能**数据工具**在下面**数据**标签。请注意，为了将一列的内容拆分为多列，数据应包含特定的分隔符，例如逗号（或任何其他字符），API 会根据该分隔符尝试将一个单元格的内容拆分为多个单元格。

这里有一个简单的使用场景来演示新暴露的API的用法。

{{< highlight "java" >}}

 // Create an instance of Workbook and load a sample

var book = new Workbook(dir + "sample.xlsx");

// Retrieve the cells collection of the first worksheet in the sample

var cells = book.Worksheets[0].Cells;

// Create an instance of TxtLoadOptions

var options = new TxtLoadOptions();

// Specify the separator

options.Separator = ',';

// Split the data in range B2:B4

cells.TextToColumns(1, 1, 3, options);

{{< /highlight >}}
#### **添加了 Workbook.GetFonts 方法**
Aspose.Cells for .NET 17.02.0 公开了 Workbook 类的 GetFonts 方法。 Workbook.GetFonts 方法返回用于格式化给定电子表格的单元格内容的单个字体的列表。上述方法的返回类型是类型为 Aspose.Cells.Font 类的数组。

以下代码片段演示了 Workbook.GetFonts 方法的用法。

{{< highlight "java" >}}

 // Create an instance of Workbook and load a sample

var book = new Workbook(dir + "sample.xlsx");

// Retrieve the list of fonts used in spreadsheet

var fonts = book.GetFonts();

// Iterate the list and write font name

foreach (Aspose.Cells.Font font in fonts)

{

    Console.WriteLine(font.Name);

}

{{< /highlight >}}
#### **添加了 TxtSaveOptions.TrimLeadingBlankRowAndColumn 属性**
此版本的 Aspose.Cells for .NET 公开了 TxtSaveOptions 类的布尔类型 TrimLeadingBlankRowAndColumn 属性，该属性指示在将数据导出为 CSV 或制表符分隔格式时是否应像 Excel 那样修剪前导空白行和列。上述属性的默认值为 false。如果工作表上的数据不是从第一个单元格开始的，即：A1，Excel 应用程序在将数据导出为 CSV 或制表符分隔格式时删除前导空白行和列，但是，Aspose.Cells API 默认保留如果必须使用 Aspose.Cells API 将导出的 CSV 或制表符分隔的文件导回，则同一样本的空白行和列将保留数据位置。

下面是 TrimLeadingBlankRowAndColumn 属性的简单使用场景。

{{< highlight "java" >}}

 // Create an instance of Workbook and load a sample

var book = new Workbook(dir + "sample.xlsx");

// Create an instance of TxtSaveOptions

var options = new TxtSaveOptions();

// Set TrimLeadingBlankRowAndColumn property to true

options.TrimLeadingBlankRowAndColumn = true;

// Export to CSV format while removing the leading blank rows & columns

book.Save(dir + "output.csv", options);

{{< /highlight >}}
#### **添加了 BuiltInDocumentPropertyCollection.Revision 属性和废弃的 BuiltInDocumentPropertyCollection.RevisionNumber 属性**
请改用 BuiltInDocumentPropertyCollection.Revision 属性。
#### **添加了 Shape.TextShapeType 属性**
Shape.TextShapeType 属性从存储在 AutoShapeType 枚举中的预定义类型列表中获取或设置预设文本形状类型。
#### **添加了 ExportTableOptions.RenameStrategy 属性和 RenameStrategy 枚举**
Aspose.Cells for .NET 17.02.0 公开了 ExportTableOptions.RenameStrategy 属性以及 RenameStrategy 枚举，以处理要导出的第一行数据包含重复条目的情况。如果 ExportTableOptions.ExportColumnName 属性设置为 true，则 API 将导致异常，指示 DataTable 不能有具有相同名称的列。有了新的更改，API 允许将数字或字母附加到重复的列名，而 RenameStrategy 枚举中的适当值决定如何重命名重复的列名。

这是一个简单的使用场景，展示了新公开的 API。

{{< highlight "java" >}}

 // Create an instance of Workbook

var book = new Workbook();

// Retrieve the cells collection of first worksheet

var cells = book.Worksheets[0].Cells;

// Insert similar values in first row

// These values will serve as column names while exporting to DataTable

cells["A1"].PutValue("Column A");

cells["B1"].PutValue("Column A");

cells["C1"].PutValue("Column A");

// Insert some more data that will serve as first row of DataTable

cells["A2"].PutValue("Value 1");

cells["B2"].PutValue("Value 2");

cells["C2"].PutValue("Value 3");

// Create an instance of ExportTableOptions

var options = new ExportTableOptions();

// Set ExportColumnName property to true so that the 

// first row of worksheet data becomes the columns names of DataTable

options.ExportColumnName = true;

// Set the renaming strategy to Letter, 

// indicating the the API will append letters to duplicate column names

options.RenameStrategy = RenameStrategy.Letter;

// Export the data to DataTable while using the object of ExportTableOptions class

var table = cells.ExportDataTable(0, 0, 2, 3, options);

{{< /highlight >}}
#### **添加了 GridDesktop.DoSplit 和 GridDesktop.UnDoSplit 方法**
Aspose.Cells.GridDesktop for .NET 17.02.0 提供了两种新方法，可以将工作表的内容拆分为窗格或合并现有窗格。
#### **使用示例**
请查看 Aspose.Cells Wiki 文档中添加的帮助主题列表：

1. [在工作簿中加载 HTML 时自动调整列和行](https://docs.aspose.com/cells/zh/net/autofit-columns-and-rows-while-loading-html-in-workbook/)
1. [使用 Aspose.Cells 将文本转换为列](https://docs.aspose.com/cells/zh/net/convert-text-to-columns-using-aspose-cells/)
1. [获取电子表格或工作簿中使用的字体列表](https://docs.aspose.com/cells/zh/net/get-a-list-of-fonts-used-in-a-spreadsheet-or-workbook/)
1. [加载 Excel 文件时收到警告](https://docs.aspose.com/cells/zh/net/get-warnings-while-loading-excel-file/)
1. [读取和操作 Excel 2016 图表](https://docs.aspose.com/cells/zh/net/read-and-manipulate-excel-2016-charts/)
1. [将电子表格导出为 CSV 格式时修剪前导空白行和列](https://docs.aspose.com/cells/zh/net/trim-leading-blank-rows-and-columns-while-exporting-spreadsheets-to-csv-format/)
1. [使用 GridWeb 将工作表绑定到自定义集合对象](https://docs.aspose.com/cells/zh/net/binding-worksheet-to-a-customized-collection-object-using-gridweb/)
1. [导出工作表数据时自动重命名重复列](https://docs.aspose.com/cells/zh/net/rename-duplicate-columns-automatically-while-exporting-worksheet-data/)
1. [GridDesktop 工作表中的拆分窗格](https://docs.aspose.com/cells/zh/net/split-panes-in-griddesktop-worksheet/)
